∇ Container←Form_Make;⎕wself;ControlName;childlist;list;Fieldlist;Fieldcontrol;FrameWidth;Caption;buttonsize;buttonwhere;where;size;alignment;Header;PickList;NameList;value;sortorder;SortList;MaxRow;MaxCol;Parent;level;node;no;nn;NN;x;fnsize;framelist;relTests[1] [2] Fieldlist←Fieldcontrol←list←0 0⍴""[3] "fmSV" ⎕wi "pointer" 13[4] buttonsize←25 65 ⋄ buttonwhere←¯5[5] FormName ⎕wi "caption" ((FormName ⎕wi "caption")," - Spreading Dates Definition")[6] "fmSV" ⎕wi "∆caption" (("fmSV" ⎕wi "∆caption"),⊂("fmSV" ⎕wi "caption"))[7] :if 300<fnsize←1↑⍴⎕cr "Form_Make"[8]     "Generating Form" Win∆ProgressBar "Open"[9]     ("Menu Items:" "Form Controls:") Win∆ProgressBar "SetLabels"[10]     (1 1 "Help About") Win∆ProgressBar "FileUpdate"[11] :endif[12] [13] Container←"∆Dialog"[14] [15] ⎕wself←"fmSpreadDate" ⎕wi "New" "Form" "Hide"[16] ⎕wi "caption" ("fmSV" ⎕wi "caption")[17] ⎕wi "scale" 5[18] ⎕wi "font" ("fmSV" ⎕wi "font")[19] ⎕wi "border" 2 32 64[20] ⎕wi "where" (Win∆CentrePos 0.5 0.7×768 1024×1⌈CharSize÷13 6)[21] ⎕wi "limitwhere" (0.8×¯2↑⎕wi "where")[22] ⎕wi "tooltipwidth" 200[23] ⎕wi "onResize" "AutoResize"[24] ⎕wi "onClose" "ExitSystem ''"[25] ControlName←"fmSpreadDate"[26] relTests←1[27] 0 Menu_Make "fmSV"[28] 1 Menu_Make "fmSpreadDate"[29] "fmSpreadDate" Win∆CutCopyPaste "Build"[30] "fmSpreadDate" ⎕wi "∆helpid" 2167[31] list←list OVER "fmSpreadDate.bnSpreading_DatesHelp"[32] ⎕wself←"fmSpreadDate.bnSpreading_DatesHelp" ⎕wi "New" "Button"[33] ⎕wi "deferexit" 1[34] ⎕wi "extent" (size←1×buttonsize×1⌈CharSize÷13 6)[35] x←0.5×⍴where←Win∆Calcwhere 1,(¯10-size[1]),1,buttonwhere←buttonwhere-5+size[2][36] ⎕wi "∆where" ((x,2)⍴where)[37] ⎕wi "where" (("fmSpreadDate" ⎕wi "size") Win∆Resize ⎕wi "∆where")[38] ⎕wi "tooltip" "SuperVal Help"[39] ⎕wi "onClick" ("fmSV.mSpreading_DatesHelp.mContext"⎕wi "onClick")[40] ⎕wi "caption" "Help"[41] :if buttonimage[42]     ⎕wi "imagelist" "fmSV.iStandard"[43]     ⎕wi "imageindex" 12[44] :endif[45] ⎕wi "visible" ¯1[46] ⎕wi "onMouseDown" "∆HelpField←'#' ⎕wi 'focus' "[47] list←list OVER "fmSpreadDate.bnSpreading_DatesQuit"[48] ⎕wself←"fmSpreadDate.bnSpreading_DatesQuit" ⎕wi "New" "Button"[49] ⎕wi "style" 2[50] ⎕wi "deferexit" 1[51] ⎕wi "extent" (size←1×buttonsize×1⌈CharSize÷13 6)[52] x←0.5×⍴where←Win∆Calcwhere 1,(¯10-size[1]),1,buttonwhere←buttonwhere-5+size[2][53] ⎕wi "∆where" ((x,2)⍴where)[54] ⎕wi "where" (("fmSpreadDate" ⎕wi "size") Win∆Resize ⎕wi "∆where")[55] ⎕wi "tooltip" "Quit and Return"[56] ⎕wi "onClick" ("fmSV.mSpreading_DatesFile.mQuit"⎕wi "onClick")[57] ⎕wi "caption" "Quit"[58] ⎕wi "∆helpid" 4286[59] ⎕wi "order" .5[60] ⎕wi "visible" ¯1[61] ControlName ⎕wi "∆quitbutton" "fmSpreadDate.bnSpreading_DatesQuit"[62] list←list OVER "fmSpreadDate.bnSpreading_DatesSave"[63] ⎕wself←"fmSpreadDate.bnSpreading_DatesSave" ⎕wi "New" "Button"[64] ⎕wi "extent" (size←1×buttonsize×1⌈CharSize÷13 6)[65] x←0.5×⍴where←Win∆Calcwhere 1,(¯10-size[1]),1,buttonwhere←buttonwhere-5+size[2][66] ⎕wi "∆where" ((x,2)⍴where)[67] ⎕wi "where" (("fmSpreadDate" ⎕wi "size") Win∆Resize ⎕wi "∆where")[68] ⎕wi "tooltip" "Save Parameters"[69] ⎕wi "onClick" ("fmSV.mSpreading_DatesFile.mSave"⎕wi "onClick")[70] ⎕wi "caption" "Save"[71] :if buttonimage[72]     ⎕wi "imagelist" "fmSV.iStandard"[73]     ⎕wi "imageindex" 9[74] :endif[75] ⎕wi "∆helpid" 4287[76] ⎕wi "enabled" 0[77] ⎕wi "order" .5[78] ⎕wi "visible" ¯1[79] "fmSpreadDate" ⎕wi "onModified" "('Spreading_Dates' 'fmSpreadDate.bnSpreading_DatesSave') Win∆SaveEnabled (0≠⎕warg[1])"[80] list←list OVER "fmSpreadDate.bnSpreading_DatesSaveAs"[81] ⎕wself←"fmSpreadDate.bnSpreading_DatesSaveAs" ⎕wi "New" "Button"[82] ⎕wi "extent" (size←1×buttonsize×1⌈CharSize÷13 6)[83] x←0.5×⍴where←Win∆Calcwhere 1,(¯10-size[1]),1,buttonwhere←buttonwhere-5+size[2][84] ⎕wi "∆where" ((x,2)⍴where)[85] ⎕wi "where" (("fmSpreadDate" ⎕wi "size") Win∆Resize ⎕wi "∆where")[86] ⎕wi "tooltip" "Save Parameters As ..."[87] ⎕wi "onClick" ("fmSV.mSpreading_DatesFile.mSaveAs"⎕wi "onClick")[88] ⎕wi "caption" "Save As"[89] ⎕wi "∆helpid" 4288[90] ⎕wi "order" .5[91] ⎕wi "visible" ¯1[92] "fmSpreadDate" ⎕wi "∆audit" 1[93] [94] ⎕wself←"fmSpreadDate.cbgsdSTYPE" ⎕wi "New" "Combo"[95] Fieldlist←Fieldlist OVER "fmSpreadDate.cbgsdSTYPE"[96] Fieldcontrol←Fieldcontrol OVER "Combo"[97] ⎕wi "∆name" "gsdSTYPE"[98] ⎕wi "∆type" "Char"[99] ⎕wi "∆mandatory" 1[100] ⎕wi "enabled" (ClntCode=3)[101] ⎕wi "∆helpid" 4289[102] ⎕wi "tooltip" "Select the Prospective Benefit Spreading Method"[103] ⎕wi "style" 16 128 256 2[104] ⎕wi "∆where" (2 2⍴0.25 0 0.2 0)[105] ⎕wi "where" (("fmSpreadDate" ⎕wi "size") Win∆Resize (2 2⍴0.25 0 0.2 0))[106] PickList←⍙POPUPSdict ReadDictFile "SpreadMethod"[107] PickList←⊃m2n 1 0↓PickList[108] ⎕wi "list" PickList[109] ⎕wi "extent" (150,(¯10+6×¯1↑CharSize)+¯1↑Win∆TextSize ((0,⎕wi "limit")⌈⍴PickList)↑PickList)[110] ⎕wi "onClick" "0 0⍴(⊂⎕wi 'name') Spreading_Dates 'Change' "[111] [112] ⎕wself←"fmSpreadDate.llgsdSTYPE" ⎕wi "New" "Label"[113] ⎕wi "scale" 5[114] ⎕wi "style" 2[115] ⎕wi "enabled" (ClntCode=3)[116] ⎕wi "extent" (↑⎕wi "Draw" ("?text" "Spreading Method"))[117] ⎕wi "caption" "Spreading Method"[118] where←4↑,"fmSpreadDate.cbgsdSTYPE" ⎕wi "∆where"[119] x←0.5×⍴where←Win∆Calcwhere where-0 ¯3 0,10+¯1↑⎕wi "extent"[120] ⎕wi "∆where" ((x,2)⍴where)[121] ⎕wi "where" (("fmSpreadDate" ⎕wi "size") Win∆Resize ⎕wi "∆where")[122] [123] ⎕wself←"fmSpreadDate.cbgsdSSD" ⎕wi "New" "Combo"[124] Fieldlist←Fieldlist OVER "fmSpreadDate.cbgsdSSD"[125] Fieldcontrol←Fieldcontrol OVER "Combo"[126] ⎕wi "∆name" "gsdSSD"[127] ⎕wi "∆type" "Date"[128] ⎕wi "∆helpid" 4290[129] ⎕wi "tooltip" "Select the Prospective Benefit Spreading Start Date"[130] ⎕wi "style" 16 128 256 2[131] ⎕wi "∆where" (2 2⍴0.65 0 0.2 0)[132] ⎕wi "where" (("fmSpreadDate" ⎕wi "size") Win∆Resize (2 2⍴0.65 0 0.2 0))[133] PickList←GetStandDateList 3[134] ⎕wi "∆update" "GetStandDateList 3"[135] PickList←⊃m2n 1 0↓PickList[136] PickList←" " OVER PickList[137] ⎕wi "list" PickList[138] ⎕wi "extent" (150,(¯10+6×¯1↑CharSize)+¯1↑(50×CharSize)⌊Win∆TextSize PickList)[139] ⎕wi "onClick" "(⎕wi 'self') Win∆LabelUpdate ⊃¨(AbsDict for 'Type' 'Date' ) at 'Parameter' 'List' ⋄ 0 0⍴(⊂⎕wi 'name') Spreading_Dates 'Change' "[140] ⎕wi "∆rightlabel" "fmSpreadDate.lrgsdSSD"[141] [142] ⎕wself←"fmSpreadDate.lrgsdSSD" ⎕wi "New" "Label"[143] ⎕wi "scale" 5[144] ⎕wi "extent" (CharSize×¯2↑1,10)[145] ⎕wi "style" 32[146] ⎕wi "caption" " "[147] where←4↑,"fmSpreadDate.cbgsdSSD" ⎕wi "∆where"[148] x←0.5×⍴where←Win∆Calcwhere where+0,3,0,10+¯1↑"fmSpreadDate.cbgsdSSD" ⎕wi "extent"[149] ⎕wi "∆where" ((x,2)⍴where)[150] ⎕wi "where" (("fmSpreadDate" ⎕wi "size") Win∆Resize ⎕wi "∆where")[151] [152] ⎕wself←"fmSpreadDate.llgsdSSD" ⎕wi "New" "Label"[153] ⎕wi "scale" 5[154] ⎕wi "style" 2[155] ⎕wi "extent" (↑⎕wi "Draw" ("?text" "Spreading Start Date"))[156] ⎕wi "caption" "Spreading Start Date"[157] where←4↑,"fmSpreadDate.cbgsdSSD" ⎕wi "∆where"[158] x←0.5×⍴where←Win∆Calcwhere where-0 ¯3 0,10+¯1↑⎕wi "extent"[159] ⎕wi "∆where" ((x,2)⍴where)[160] ⎕wi "where" (("fmSpreadDate" ⎕wi "size") Win∆Resize ⎕wi "∆where")[161] [162] ⎕wself←"fmSpreadDate.cbgsdSFD" ⎕wi "New" "Combo"[163] Fieldlist←Fieldlist OVER "fmSpreadDate.cbgsdSFD"[164] Fieldcontrol←Fieldcontrol OVER "Combo"[165] ⎕wi "∆name" "gsdSFD"[166] ⎕wi "∆type" "Date"[167] ⎕wi "∆helpid" 4291[168] ⎕wi "tooltip" "Select the Prospective Benefit Spreading Finish Date"[169] ⎕wi "style" 16 128 256 2[170] ⎕wi "∆where" (2 2⍴0.65 0 0.6 0)[171] ⎕wi "where" (("fmSpreadDate" ⎕wi "size") Win∆Resize (2 2⍴0.65 0 0.6 0))[172] PickList←GetStandDateList 1[173] ⎕wi "∆update" "GetStandDateList 1"[174] PickList←⊃m2n 1 0↓PickList[175] PickList←" " OVER PickList[176] ⎕wi "list" PickList[177] ⎕wi "extent" (150,(¯10+6×¯1↑CharSize)+¯1↑(50×CharSize)⌊Win∆TextSize PickList)[178] ⎕wi "onClick" "(⎕wi 'self') Win∆LabelUpdate ⊃¨(AbsDict for 'Type' 'Date' ) at 'Parameter' 'List' ⋄ 0 0⍴(⊂⎕wi 'name') Spreading_Dates 'Change' "[179] ⎕wi "∆rightlabel" "fmSpreadDate.lrgsdSFD"[180] [181] ⎕wself←"fmSpreadDate.lrgsdSFD" ⎕wi "New" "Label"[182] ⎕wi "scale" 5[183] ⎕wi "extent" (CharSize×¯2↑1,10)[184] ⎕wi "style" 32[185] ⎕wi "caption" " "[186] where←4↑,"fmSpreadDate.cbgsdSFD" ⎕wi "∆where"[187] x←0.5×⍴where←Win∆Calcwhere where+0,3,0,10+¯1↑"fmSpreadDate.cbgsdSFD" ⎕wi "extent"[188] ⎕wi "∆where" ((x,2)⍴where)[189] ⎕wi "where" (("fmSpreadDate" ⎕wi "size") Win∆Resize ⎕wi "∆where")[190] [191] ⎕wself←"fmSpreadDate.llgsdSFD" ⎕wi "New" "Label"[192] ⎕wi "scale" 5[193] ⎕wi "style" 2[194] ⎕wi "extent" (↑⎕wi "Draw" ("?text" "Spreading Finish Date"))[195] ⎕wi "caption" "Spreading Finish Date"[196] where←4↑,"fmSpreadDate.cbgsdSFD" ⎕wi "∆where"[197] x←0.5×⍴where←Win∆Calcwhere where-0 ¯3 0,10+¯1↑⎕wi "extent"[198] ⎕wi "∆where" ((x,2)⍴where)[199] ⎕wi "where" (("fmSpreadDate" ⎕wi "size") Win∆Resize ⎕wi "∆where")[200] [201] ⎕wself←"fmSpreadDate.lParmDesc" ⎕wi "New" "Label"[202] ⎕wi "scale" 5[203] ⎕wi "extent" (CharSize×¯2↑1,80)[204] ⎕wi "style" 32[205] ⎕wi "caption" " "[206] ⎕wi "∆where" (2 2⍴0.96 0 0.02 0)[207] ⎕wi "where" (("fmSpreadDate" ⎕wi "size") Win∆Resize (2 2⍴0.96 0 0.02 0))[208] [209] "fmSpreadDate" ⎕wi "∆multifile" ""[210] "fmSpreadDate" ⎕wi "∆singlefile" ""[211] "fmSpreadDate" ⎕wi "∆format" ""[212] "fmSpreadDate" ⎕wi "∆financial" 0[213] "fmSpreadDate" ⎕wi "∆relrules" 1[214] "fmSpreadDate" ⎕wi "∆parm" 0[215] "fmSpreadDate" ⎕wi "∆decr" 0[216] "fmSpreadDate" ⎕wi "∆file" 0[217] "fmSpreadDate" ⎕wi "∆codefile" CodeFile[218] "fmSpreadDate" ⎕wi "∆inputstype" "ClientFile"[219] "fmSpreadDate" ⎕wi "∆inputsentry" "Multi"[220] "fmSpreadDate" ⎕wi "∆savecn" (⍳0)[221] "fmSpreadDate" ⎕wi "∆savedesc" ""[222] list←list OVER "fmSpreadDate"[223] "fmSpreadDate" ⎕wi "∆fieldlist" Fieldlist[224] "fmSpreadDate" ⎕wi "∆fieldcontrol" Fieldcontrol[225] childlist←"fmSV" ⎕wi "∆childlist"[226] list←(⊃¯1↑childlist) OVER list[227] childlist[⍴childlist]←⊂list[228] "fmSV" ⎕wi "∆childlist" childlist[229] list←,⎕split list[230] 0 0⍴((∨/¨(⊂".mSpreading_Dates")⍷¨list)/list) MultiWI "enabled" 1[231] :if 300<fnsize[232]     (fnsize fnsize ".") Win∆ProgressBar "MemberUpdate"[233]     Win∆ProgressBar "Hide"[234] :endif[235] "Init" OpenParameters "Spreading_Dates"[236] "fmSpreadDate.bnSpreading_DatesHelp" ⎕wi "visible" 1[237] "fmSpreadDate.bnSpreading_DatesQuit" ⎕wi "visible" 1[238] "fmSpreadDate.bnSpreading_DatesSave" ⎕wi "visible" 1[239] "fmSpreadDate.bnSpreading_DatesSaveAs" ⎕wi "visible" 1[240] "#" ⎕wi "focus" "fmSpreadDate.cbgsdSTYPE"[241] :if ~0∊⍴,Error←Win∆Initialise "Spreading_Dates"[242]     "Quit" EndModule Module[243]     "fmSV" ⎕wi "pointer" 0[244]     0 0⍴"fmSpreadDate" ⎕wi "Delete"[245]     :return[246] :endif[247] :if bar_open←commandbar^"Multi"≡"Multi"[248]     bar_open←0×"fmSpreadDate.mSpreading_DatesFile.m" Win∆CommandBar "SaveAsHelp"[249] :endif[250] "fmSpreadDate" ⎕wi "Paint"[251] "fmSV" ⎕wi "pointer" 11[252] "fmSpreadDate" ⎕wi "onWait" "0 0⍴Spreading_Dates 'Wait'"[253] 0 0⍴"fmSpreadDate" ⎕wi "Wait"[254] 0 0⍴"fmSpreadDate" ⎕wi "Delete"[255] "fmSV" ⎕wi "pointer" 0 ∇