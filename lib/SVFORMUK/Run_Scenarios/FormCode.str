∇ Container←Form_Make;⎕wself;ControlName;childlist;list;Fieldlist;Fieldcontrol;FrameWidth;Caption;buttonsize;buttonwhere;where;size;alignment;Header;PickList;NameList;value;sortorder;SortList;MaxRow;MaxCol;Parent;level;node;no;nn;NN;x;fnsize;framelist;relTests[1] [2] Fieldlist←Fieldcontrol←list←0 0⍴""[3] "fmSV" ⎕wi "pointer" 13[4] buttonsize←25 65 ⋄ buttonwhere←¯5[5] FormName ⎕wi "caption" ((FormName ⎕wi "caption")," - Scenario Run Parameters")[6] "fmSV" ⎕wi "∆caption" (("fmSV" ⎕wi "∆caption"),⊂("fmSV" ⎕wi "caption"))[7] :if 300<fnsize←1↑⍴⎕cr "Form_Make"[8]     "Generating Form" Win∆ProgressBar "Open"[9]     ("Menu Items:" "Form Controls:") Win∆ProgressBar "SetLabels"[10]     (1 1 "Help About") Win∆ProgressBar "FileUpdate"[11] :endif[12] [13] Container←"∆Dialog"[14] [15] ⎕wself←"fmRunScenarios" ⎕wi "New" "Form" "Hide"[16] ⎕wi "caption" ("fmSV" ⎕wi "caption")[17] ⎕wi "scale" 5[18] ⎕wi "font" ("fmSV" ⎕wi "font")[19] ⎕wi "border" 2 32 64[20] ⎕wi "where" (Win∆CentrePos 1.1 1.1 ×768 1024×1⌈CharSize÷13 6)[21] ⎕wi "limitwhere" (0.8×¯2↑⎕wi "where")[22] ⎕wi "tooltipwidth" 200[23] ⎕wi "onResize" "AutoResize"[24] ⎕wi "onClose" "ExitSystem ''"[25] ControlName←"fmRunScenarios"[26] relTests←0[27] 0 Menu_Make "fmSV"[28] 1 Menu_Make "fmRunScenarios"[29] "fmRunScenarios" Win∆CutCopyPaste "Build"[30] "fmRunScenarios" ⎕wi "∆helpid" 2261[31] list←list OVER "fmRunScenarios.bnRun_ScenariosHelp"[32] ⎕wself←"fmRunScenarios.bnRun_ScenariosHelp" ⎕wi "New" "Button"[33] ⎕wi "deferexit" 1[34] ⎕wi "extent" (size←1×buttonsize×1⌈CharSize÷13 6)[35] x←0.5×⍴where←Win∆Calcwhere 1,(¯10-size[1]),1,buttonwhere←buttonwhere-5+size[2][36] ⎕wi "∆where" ((x,2)⍴where)[37] ⎕wi "where" (("fmRunScenarios" ⎕wi "size") Win∆Resize ⎕wi "∆where")[38] ⎕wi "tooltip" "SuperVal Help"[39] ⎕wi "onClick" ("fmSV.mRun_ScenariosHelp.mContext"⎕wi "onClick")[40] ⎕wi "caption" "Help"[41] :if buttonimage[42]     ⎕wi "imagelist" "fmSV.iStandard"[43]     ⎕wi "imageindex" 12[44] :endif[45] ⎕wi "visible" ¯1[46] ⎕wi "onMouseDown" "∆HelpField←'#' ⎕wi 'focus' "[47] list←list OVER "fmRunScenarios.bnRun_ScenariosQuit"[48] ⎕wself←"fmRunScenarios.bnRun_ScenariosQuit" ⎕wi "New" "Button"[49] ⎕wi "style" 2[50] ⎕wi "deferexit" 1[51] ⎕wi "extent" (size←1×buttonsize×1⌈CharSize÷13 6)[52] x←0.5×⍴where←Win∆Calcwhere 1,(¯10-size[1]),1,buttonwhere←buttonwhere-5+size[2][53] ⎕wi "∆where" ((x,2)⍴where)[54] ⎕wi "where" (("fmRunScenarios" ⎕wi "size") Win∆Resize ⎕wi "∆where")[55] ⎕wi "tooltip" "Quit and Return"[56] ⎕wi "onClick" ("fmSV.mRun_ScenariosFile.mQuit"⎕wi "onClick")[57] ⎕wi "caption" "Quit"[58] ⎕wi "∆helpid" 5432[59] ⎕wi "order" .5[60] ⎕wi "visible" ¯1[61] ControlName ⎕wi "∆quitbutton" "fmRunScenarios.bnRun_ScenariosQuit"[62] list←list OVER "fmRunScenarios.bnRun_ScenariosSave"[63] ⎕wself←"fmRunScenarios.bnRun_ScenariosSave" ⎕wi "New" "Button"[64] ⎕wi "extent" (size←1×buttonsize×1⌈CharSize÷13 6)[65] x←0.5×⍴where←Win∆Calcwhere 1,(¯10-size[1]),1,buttonwhere←buttonwhere-5+size[2][66] ⎕wi "∆where" ((x,2)⍴where)[67] ⎕wi "where" (("fmRunScenarios" ⎕wi "size") Win∆Resize ⎕wi "∆where")[68] ⎕wi "tooltip" "Save Parameters"[69] ⎕wi "onClick" ("fmSV.mRun_ScenariosFile.mSave"⎕wi "onClick")[70] ⎕wi "caption" "Save"[71] :if buttonimage[72]     ⎕wi "imagelist" "fmSV.iStandard"[73]     ⎕wi "imageindex" 9[74] :endif[75] ⎕wi "∆helpid" 5433[76] ⎕wi "enabled" 0[77] ⎕wi "order" .5[78] ⎕wi "visible" ¯1[79] "fmRunScenarios" ⎕wi "onModified" "('Run_Scenarios' 'fmRunScenarios.bnRun_ScenariosSave') Win∆SaveEnabled (0≠⎕warg[1])"[80] list←list OVER "fmRunScenarios.bnRun_ScenariosSaveAs"[81] ⎕wself←"fmRunScenarios.bnRun_ScenariosSaveAs" ⎕wi "New" "Button"[82] ⎕wi "extent" (size←1×buttonsize×1⌈CharSize÷13 6)[83] x←0.5×⍴where←Win∆Calcwhere 1,(¯10-size[1]),1,buttonwhere←buttonwhere-5+size[2][84] ⎕wi "∆where" ((x,2)⍴where)[85] ⎕wi "where" (("fmRunScenarios" ⎕wi "size") Win∆Resize ⎕wi "∆where")[86] ⎕wi "tooltip" "Save Parameters As ..."[87] ⎕wi "onClick" ("fmSV.mRun_ScenariosFile.mSaveAs"⎕wi "onClick")[88] ⎕wi "caption" "Save As"[89] ⎕wi "∆helpid" 5434[90] ⎕wi "order" .5[91] ⎕wi "visible" ¯1[92] list←list OVER "fmRunScenarios.bnRun_ScenariosRun"[93] ⎕wself←"fmRunScenarios.bnRun_ScenariosRun" ⎕wi "New" "Button"[94] ⎕wi "style" 1[95] ⎕wi "extent" (size←1×buttonsize×1⌈CharSize÷13 6)[96] x←0.5×⍴where←Win∆Calcwhere 1,(¯10-size[1]),1,buttonwhere←buttonwhere-5+size[2][97] ⎕wi "∆where" ((x,2)⍴where)[98] ⎕wi "where" (("fmRunScenarios" ⎕wi "size") Win∆Resize ⎕wi "∆where")[99] ⎕wi "tooltip" "Save Parameters and Run Scenario Run Parameters"[100] ⎕wi "onClick" ("fmSV.mRun_ScenariosFile.mRun"⎕wi "onClick")[101] ⎕wi "caption" "Run"[102] :if buttonimage[103]     ⎕wi "imagelist" "fmSV.iStandard"[104]     ⎕wi "imageindex" 33[105] :endif[106] ⎕wi "∆helpid" 5435[107] ⎕wi "order" .5[108] ⎕wi "visible" ¯1[109] [110] ⎕wself←"fmRunScenarios.lvSavedBatch" ⎕wi "New" "Listview"[111] Fieldlist←Fieldlist OVER "fmRunScenarios.lvSavedBatch"[112] Fieldcontrol←Fieldcontrol OVER "Listview"[113] ⎕wi "∆name" "SavedBatch"[114] ⎕wi "∆type" "Listview"[115] ⎕wi "∆helpid" 5436[116] ⎕wi "tooltip" "Select the Valuation Batch Parameter Set to be Run"[117] list←list OVER "fmRunScenarios.lvSavedBatch"[118] ⎕wi "scale" 5[119] ⎕wi "viewmode" "report"[120] ⎕wi "style" 1 4 8[121] ⎕wi "∆where" (4 2⍴0.05 0 0.05 0 0.25 0 0.8 0)[122] ⎕wi "where" (("fmRunScenarios" ⎕wi "size") Win∆Resize (4 2⍴0.05 0 0.05 0 0.25 0 0.8 0))[123] ⎕wi "∆update" "'Batch_Display' GetScenList 'SavedBatch'"[124] (PickList NameList sortorder SortList)←4↑'Batch_Display' GetScenList 'SavedBatch'[125] ⎕wi "list" PickList[126] NameList[;1]←NameList[;1],¨⊂4↑" "[127] ⎕wi "columndisplay" NameList[128] ⎕wi "AutoFit" "header" "all"[129] ⎕wi "∆sortorder" sortorder[130] ⎕wi "∆sortlist" SortList[131] ⎕wi "onColClick" "('fmRunScenarios.lvSavedBatch' 'Run_Scenarios') Win∆SortListview ⎕warg"[132] :if 0=⎕nc "listviewDict"[133] listviewDict←MATRIX keysIn ListviewDict[134] :endif[135] :if ~mt sortorder←DLTB ↑((ListviewDict for "Control" "fmRunScenarios.lvSavedBatch") for "Parameters" "") at "Sort"[136] ("fmRunScenarios.lvSavedBatch" "Run_Scenarios") Win∆SortListview sortorder[137] :else[138] ("fmRunScenarios.lvSavedBatch" "Run_Scenarios") Win∆SortListview "Date/Time Saved"[139] :endif[140] ⎕wi "onResize" "Win∆SizeListview ⎕wi 'self'"[141] ⎕wi "onSelect" "0 0⍴(⊂⎕wi 'name') Run_Scenarios 'Change' "[142] ⎕wi "onExit" "⎕wres←0 List∆CHECK 'fmRunScenarios.lvSavedBatch'"[143] ⎕wi "onExitError" "Win∆ExitError ⎕warg"[144] [145] ⎕wself←"fmRunScenarios.llSavedBatch" ⎕wi "New" "Label"[146] ⎕wi "scale" 5[147] ⎕wi "style" 2[148] ⎕wi "extent" (↑⎕wi "Draw" ("?text" "Selected Valuation Batch"))[149] ⎕wi "caption" "Selected Valuation Batch"[150] where←4↑,"fmRunScenarios.lvSavedBatch" ⎕wi "∆where"[151] x←0.5×⍴where←Win∆Calcwhere where-0,(5+1↑⎕wi "extent"),0 0[152] ⎕wi "∆where" ((x,2)⍴where)[153] ⎕wi "where" (("fmRunScenarios" ⎕wi "size") Win∆Resize ⎕wi "∆where")[154] [155] :if 300<fnsize[156]     ((1↑⎕lc) fnsize "Frame - BatchButtons") Win∆ProgressBar "MemberUpdate"[157] :endif[158] [159] ⎕wself←"fmRunScenarios.fBatchButtons" ⎕wi "New" "Frame"[160] ⎕wi "scale" 5[161] ⎕wi "∆where" (4 2⍴0.05 0 0.85 0 0.25 0 0.15 0)[162] ⎕wi "where" (("fmRunScenarios" ⎕wi "size") Win∆Resize (4 2⍴0.05 0 0.85 0 0.25 0 0.15 0))[163] ⎕wi "style" 7[164] ⎕wi "onResize" "AutoResize"[165] list←list OVER "fmRunScenarios.fBatchButtons.bnRun_ScenariosAddBatch"[166] ⎕wself←"fmRunScenarios.fBatchButtons.bnRun_ScenariosAddBatch" ⎕wi "New" "Button"[167] ⎕wi "deferexit" 1[168] ⎕wi "extent" (size←1.4 1.384615385×buttonsize×1⌈CharSize÷13 6)[169] ⎕wi "∆where" (2 2⍴0.1 0 0.2 0)[170] ⎕wi "where" (("fmRunScenarios.fBatchButtons" ⎕wi "size") Win∆Resize (2 2⍴0.1 0 0.2 0))[171] ⎕wi "tooltip" "Add the Valuation Batch"[172] ⎕wi "onClick" ("fmSV.mRun_ScenariosFile.mAddBatch"⎕wi "onClick")[173] ⎕wi "∆helpid" 5437[174] ⎕wi "caption" (("⍺",⎕tcnl) char_replace "Add Valuation⍺Batch")[175] list←list OVER "fmRunScenarios.fBatchButtons.bnRun_ScenariosRemBatch"[176] ⎕wself←"fmRunScenarios.fBatchButtons.bnRun_ScenariosRemBatch" ⎕wi "New" "Button"[177] ⎕wi "deferexit" 1[178] ⎕wi "extent" (size←1.4 1.384615385×buttonsize×1⌈CharSize÷13 6)[179] ⎕wi "∆where" (2 2⍴0.5 0 0.2 0)[180] ⎕wi "where" (("fmRunScenarios.fBatchButtons" ⎕wi "size") Win∆Resize (2 2⍴0.5 0 0.2 0))[181] ⎕wi "tooltip" "Remove the Valuation Batch"[182] ⎕wi "onClick" ("fmSV.mRun_ScenariosFile.mRemoveBatch"⎕wi "onClick")[183] ⎕wi "∆helpid" 5438[184] ⎕wi "caption" (("⍺",⎕tcnl) char_replace "Remove⍺Valuation Batch")[185] [186] ⎕wself←"fmRunScenarios.lvSavedScens" ⎕wi "New" "Listview"[187] Fieldlist←Fieldlist OVER "fmRunScenarios.lvSavedScens"[188] Fieldcontrol←Fieldcontrol OVER "Listview"[189] ⎕wi "∆name" "SavedScens"[190] ⎕wi "∆type" "Spinner"[191] ⎕wi "∆helpid" 5439[192] ⎕wi "tooltip" "Select the Scenario Parameter Set(s) to be Run"[193] list←list OVER "fmRunScenarios.lvSavedScens"[194] ⎕wi "scale" 5[195] ⎕wi "viewmode" "report"[196] ⎕wi "style" 1 4 0[197] ⎕wi "∆where" (4 2⍴0.37 0 0.05 0 0.4 0 0.8 0)[198] ⎕wi "where" (("fmRunScenarios" ⎕wi "size") Win∆Resize (4 2⍴0.37 0 0.05 0 0.4 0 0.8 0))[199] ⎕wi "∆update" "'Scenarios' GetScenList 'SavedScens'"[200] (PickList NameList sortorder SortList)←4↑'Scenarios' GetScenList 'SavedScens'[201] ⎕wi "list" PickList[202] NameList[;1]←NameList[;1],¨⊂4↑" "[203] ⎕wi "columndisplay" NameList[204] ⎕wi "AutoFit" "header" "all"[205] ⎕wi "∆sortorder" sortorder[206] ⎕wi "∆sortlist" SortList[207] ⎕wi "onColClick" "('fmRunScenarios.lvSavedScens' 'Run_Scenarios') Win∆SortListview ⎕warg"[208] :if 0=⎕nc "listviewDict"[209] listviewDict←MATRIX keysIn ListviewDict[210] :endif[211] :if ~mt sortorder←DLTB ↑((ListviewDict for "Control" "fmRunScenarios.lvSavedScens") for "Parameters" "") at "Sort"[212] ("fmRunScenarios.lvSavedScens" "Run_Scenarios") Win∆SortListview sortorder[213] :else[214] ("fmRunScenarios.lvSavedScens" "Run_Scenarios") Win∆SortListview "Date/Time Saved"[215] :endif[216] ⎕wi "onResize" "Win∆SizeListview ⎕wi 'self'"[217] ⎕wi "∆spinner" "fmRunScenarios.spSavedScens"[218] ⎕wi "onPaint" "1 Sel∆LabelUpdate 'fmRunScenarios.lvSavedScens' "[219] ⎕wi "onSelect" "1 Sel∆LabelUpdate 'fmRunScenarios.lvSavedScens' ⋄ 0 0⍴(⊂⎕wi 'name') Run_Scenarios 'Change' "[220] ⎕wi "onExit" "⍎(0∊⍴,⎕wres←0 List∆CHECK 'fmRunScenarios.lvSavedScens')/'0 0⍴(⊂⎕wi ''name'') Run_Scenarios ''Change'' ' "[221] ⎕wi "onExitError" "Win∆ExitError ⎕warg"[222] ⎕wi "∆rightlabel" "fmRunScenarios.lrSavedScens"[223] [224] ⎕wself←"fmRunScenarios.lrSavedScens" ⎕wi "New" "Label"[225] ⎕wi "scale" 5[226] ⎕wi "extent" (CharSize×¯2↑1,19)[227] ⎕wi "style" 32[228] ⎕wi "caption" " "[229] where←4↑,"fmRunScenarios.lvSavedScens" ⎕wi "∆where"[230] x←0.5×⍴where←Win∆Calcwhere where+((5+1↑2↓"fmRunScenarios.lvSavedScens" ⎕wi "where") CDIV 1↑"fmRunScenarios" ⎕wi "size"),0 0 0[231] ⎕wi "∆where" ((x,2)⍴where)[232] ⎕wi "where" (("fmRunScenarios" ⎕wi "size") Win∆Resize ⎕wi "∆where")[233] [234] ⎕wself←"fmRunScenarios.llSavedScens" ⎕wi "New" "Label"[235] ⎕wi "scale" 5[236] ⎕wi "style" 2[237] ⎕wi "extent" (↑⎕wi "Draw" ("?text" "Selected Scenarios"))[238] ⎕wi "caption" "Selected Scenarios"[239] where←4↑,"fmRunScenarios.lvSavedScens" ⎕wi "∆where"[240] x←0.5×⍴where←Win∆Calcwhere where-0,(5+1↑⎕wi "extent"),0 0[241] ⎕wi "∆where" ((x,2)⍴where)[242] ⎕wi "where" (("fmRunScenarios" ⎕wi "size") Win∆Resize ⎕wi "∆where")[243] [244] ⎕wself←"fmRunScenarios.spSavedScens" ⎕wi "New" "Spinner"[245] ⎕wi "scale" 5[246] ⎕wi "range" 0 1[247] ⎕wi "wrap" 1[248] where←4↑,"fmRunScenarios.lvSavedScens" ⎕wi "∆where"[249] x←0.5×⍴where←Win∆Calcwhere where+0 20 0 ¯30[250] ⎕wi "∆where" ((x,2)⍴where)[251] ⎕wi "where" (("fmRunScenarios" ⎕wi "size") Win∆Resize ⎕wi "∆where")[252] ⎕wi "extent" 50 25[253] ⎕wi "onSpin" "0 0⍴⎕wres Run_Scenarios 'Spin' "[254] ⎕wi "tooltip" "Selections will be processed in the order displayed.
Use Spinners to re-order a single or contiguous set of selections"[255] [256] :if 300<fnsize[257]     ((1↑⎕lc) fnsize "Frame - ScenButtons") Win∆ProgressBar "MemberUpdate"[258] :endif[259] [260] ⎕wself←"fmRunScenarios.fScenButtons" ⎕wi "New" "Frame"[261] ⎕wi "scale" 5[262] ⎕wi "∆where" (4 2⍴0.49 0 0.85 0 0.25 0 0.15 0)[263] ⎕wi "where" (("fmRunScenarios" ⎕wi "size") Win∆Resize (4 2⍴0.49 0 0.85 0 0.25 0 0.15 0))[264] ⎕wi "style" 7[265] ⎕wi "onResize" "AutoResize"[266] list←list OVER "fmRunScenarios.fScenButtons.bnRun_ScenariosAddScen"[267] ⎕wself←"fmRunScenarios.fScenButtons.bnRun_ScenariosAddScen" ⎕wi "New" "Button"[268] ⎕wi "deferexit" 1[269] ⎕wi "extent" (size←1.4 1.384615385×buttonsize×1⌈CharSize÷13 6)[270] ⎕wi "∆where" (2 2⍴0.1 0 0.2 0)[271] ⎕wi "where" (("fmRunScenarios.fScenButtons" ⎕wi "size") Win∆Resize (2 2⍴0.1 0 0.2 0))[272] ⎕wi "tooltip" "Add Scenarios to the list"[273] ⎕wi "onClick" ("fmSV.mRun_ScenariosFile.mAddScen"⎕wi "onClick")[274] ⎕wi "∆helpid" 5440[275] ⎕wi "caption" (("⍺",⎕tcnl) char_replace "Add⍺Scenarios")[276] list←list OVER "fmRunScenarios.fScenButtons.bnRun_ScenariosRemScen"[277] ⎕wself←"fmRunScenarios.fScenButtons.bnRun_ScenariosRemScen" ⎕wi "New" "Button"[278] ⎕wi "deferexit" 1[279] ⎕wi "extent" (size←1.4 1.384615385×buttonsize×1⌈CharSize÷13 6)[280] ⎕wi "∆where" (2 2⍴0.5 0 0.2 0)[281] ⎕wi "where" (("fmRunScenarios.fScenButtons" ⎕wi "size") Win∆Resize (2 2⍴0.5 0 0.2 0))[282] ⎕wi "tooltip" "Remove Scenarios from the list"[283] ⎕wi "onClick" ("fmSV.mRun_ScenariosFile.mRemoveScen"⎕wi "onClick")[284] ⎕wi "∆helpid" 5441[285] ⎕wi "caption" (("⍺",⎕tcnl) char_replace "Remove⍺Scenarios")[286] [287] ⎕wself←"fmRunScenarios.ckCreateScenXL" ⎕wi "New" "Check"[288] Fieldlist←Fieldlist OVER "fmRunScenarios.ckCreateScenXL"[289] Fieldcontrol←Fieldcontrol OVER "Check"[290] ⎕wi "∆name" "CreateScenXL"[291] ⎕wi "∆type" "Check"[292] ⎕wi "∆helpid" 5442[293] ⎕wi "tooltip" "Indicate if you want to create the Scenarios Excel Output"[294] ⎕wi "style" 0[295] ⎕wi "caption" "Create Scenarios Excel Output"[296] ⎕wi "∆where" (2 2⍴0.82 0 0.2 0)[297] ⎕wi "where" (("fmRunScenarios" ⎕wi "size") Win∆Resize (2 2⍴0.82 0 0.2 0))[298] ⎕wi "extent" ((0 5×CharSize)+Win∆TextSize ⎕wi "caption")[299] ⎕wi "onClick" "(0 0⍴(⊂⎕wi 'name') Run_Scenarios 'Change' )"[300] [301] ⎕wself←"fmRunScenarios.edScenDBName" ⎕wi "New" "Edit"[302] Fieldlist←Fieldlist OVER "fmRunScenarios.edScenDBName"[303] Fieldcontrol←Fieldcontrol OVER "Edit"[304] ⎕wi "∆name" "ScenDBName"[305] ⎕wi "∆type" "Char"[306] ⎕wi "∆mandatory" 1[307] ⎕wi "∆valid" ('File' 'mdb' 'xls')[308] ⎕wi "∆helpid" 5443[309] ⎕wi "tooltip" "Specify the Scenario Run Output File Name"[310] ⎕wi "∆where" (2 2⍴0.82 0 0.6 0)[311] ⎕wi "where" (("fmRunScenarios" ⎕wi "size") Win∆Resize (2 2⍴0.82 0 0.6 0))[312] ⎕wi "onExit" "⍎(0∊⍴,⎕wres←0 INPUT∆CHECK 'fmRunScenarios.edScenDBName')/'0 0⍴(⊂⎕wi ''name'') Run_Scenarios ''Change'' ' "[313] ⎕wi "onExitError" "Win∆ExitError ⎕warg"[314] ⎕wi "extent" (2+CharSize×1 41)[315] [316] ⎕wself←"fmRunScenarios.llScenDBName" ⎕wi "New" "Label"[317] ⎕wi "scale" 5[318] ⎕wi "style" 2[319] ⎕wi "extent" (↑⎕wi "Draw" ("?text" "Scenarios Output Filename"))[320] ⎕wi "caption" "Scenarios Output Filename"[321] where←4↑,"fmRunScenarios.edScenDBName" ⎕wi "∆where"[322] x←0.5×⍴where←Win∆Calcwhere where-0 ¯3 0,10+¯1↑⎕wi "extent"[323] ⎕wi "∆where" ((x,2)⍴where)[324] ⎕wi "where" (("fmRunScenarios" ⎕wi "size") Win∆Resize ⎕wi "∆where")[325] [326] ⎕wself←"fmRunScenarios.ckOrigValnRun" ⎕wi "New" "Check"[327] Fieldlist←Fieldlist OVER "fmRunScenarios.ckOrigValnRun"[328] Fieldcontrol←Fieldcontrol OVER "Check"[329] ⎕wi "∆name" "OrigValnRun"[330] ⎕wi "∆type" "Check"[331] ⎕wi "∆helpid" 5444[332] ⎕wi "tooltip" "Indicate if you want to run the Valuations on the Primary Basis only when Valuation Results are not found in the Valuation Database"[333] ⎕wi "style" 0[334] ⎕wi "caption" "Only run Valuations on the Primary Basis not previously run"[335] ⎕wi "∆where" (2 2⍴0.88 0 0.2 0)[336] ⎕wi "where" (("fmRunScenarios" ⎕wi "size") Win∆Resize (2 2⍴0.88 0 0.2 0))[337] ⎕wi "extent" ((0 5×CharSize)+Win∆TextSize ⎕wi "caption")[338] ⎕wi "onClick" "(0 0⍴(⊂⎕wi 'name') Run_Scenarios 'Change' )"[339] [340] ⎕wself←"fmRunScenarios.ckScenValnRun" ⎕wi "New" "Check"[341] Fieldlist←Fieldlist OVER "fmRunScenarios.ckScenValnRun"[342] Fieldcontrol←Fieldcontrol OVER "Check"[343] ⎕wi "∆name" "ScenValnRun"[344] ⎕wi "∆type" "Check"[345] ⎕wi "∆helpid" 5445[346] ⎕wi "tooltip" "Indicate if you want to run the Valuations on the Scenarios only when Valuation Results are not found in the Valuation Database"[347] ⎕wi "style" 0[348] ⎕wi "caption" "Only run the Scenario Valuations not previously run"[349] ⎕wi "∆where" (2 2⍴0.88 0 0.6 0)[350] ⎕wi "where" (("fmRunScenarios" ⎕wi "size") Win∆Resize (2 2⍴0.88 0 0.6 0))[351] ⎕wi "extent" ((0 5×CharSize)+Win∆TextSize ⎕wi "caption")[352] ⎕wi "onClick" "(0 0⍴(⊂⎕wi 'name') Run_Scenarios 'Change' )"[353] [354] ⎕wself←"fmRunScenarios.ckSuppressXL" ⎕wi "New" "Check"[355] Fieldlist←Fieldlist OVER "fmRunScenarios.ckSuppressXL"[356] Fieldcontrol←Fieldcontrol OVER "Check"[357] ⎕wi "∆name" "SuppressXL"[358] ⎕wi "∆type" "Check"[359] ⎕wi "visible" (¯1+2×0)[360] ⎕wi "∆helpid" 5446[361] ⎕wi "tooltip" "Indicate if you want to suppress the normal Valuation Excel output"[362] ⎕wi "style" 0[363] ⎕wi "caption" "Suppress standard Excel Output"[364] ⎕wi "∆where" (2 2⍴0.95 0 0.4 0)[365] ⎕wi "where" (("fmRunScenarios" ⎕wi "size") Win∆Resize (2 2⍴0.95 0 0.4 0))[366] ⎕wi "extent" ((0 5×CharSize)+Win∆TextSize ⎕wi "caption")[367] ⎕wi "onClick" "(0 0⍴(⊂⎕wi 'name') Run_Scenarios 'Change' )"[368] [369] ⎕wself←"fmRunScenarios.ckScentrick" ⎕wi "New" "Check"[370] Fieldlist←Fieldlist OVER "fmRunScenarios.ckScentrick"[371] Fieldcontrol←Fieldcontrol OVER "Check"[372] ⎕wi "∆name" "Scentrick"[373] ⎕wi "∆type" "Check"[374] ⎕wi "visible" (¯1+2×0)[375] ⎕wi "tooltip" "Trick to sort listviews"[376] ⎕wi "style" 0[377] ⎕wi "caption" ""[378] ⎕wi "∆where" (2 2⍴1 0 1 0)[379] ⎕wi "where" (("fmRunScenarios" ⎕wi "size") Win∆Resize (2 2⍴1 0 1 0))[380] ⎕wi "extent" ((0 5×CharSize)+Win∆TextSize ⎕wi "caption")[381] ⎕wi "onClick" "(0 0⍴(⊂⎕wi 'name') Run_Scenarios 'Change' )"[382] list←list OVER "fmRunScenarios.bnRun_ScenariosEditBatch"[383] ⎕wself←"fmRunScenarios.bnRun_ScenariosEditBatch" ⎕wi "New" "Button"[384] ⎕wi "extent" (size←1.4 1×buttonsize×1⌈CharSize÷13 6)[385] x←0.5×⍴where←Win∆Calcwhere 1,(¯10-size[1]),1,buttonwhere←buttonwhere-5+size[2][386] ⎕wi "∆where" ((x,2)⍴where)[387] ⎕wi "where" (("fmRunScenarios" ⎕wi "size") Win∆Resize ⎕wi "∆where")[388] ⎕wi "tooltip" "Add/Edit a Valuation Batch"[389] ⎕wi "onClick" ("fmSV.mRun_ScenariosFile.mBatch"⎕wi "onClick")[390] ⎕wi "∆helpid" 5447[391] ⎕wi "caption" (("⍺",⎕tcnl) char_replace "Add/Edit⍺Batch")[392] list←list OVER "fmRunScenarios.bnRun_ScenariosEditScen"[393] ⎕wself←"fmRunScenarios.bnRun_ScenariosEditScen" ⎕wi "New" "Button"[394] ⎕wi "extent" (size←1.4 1×buttonsize×1⌈CharSize÷13 6)[395] x←0.5×⍴where←Win∆Calcwhere 1,(¯10-size[1]),1,buttonwhere←buttonwhere-5+size[2][396] ⎕wi "∆where" ((x,2)⍴where)[397] ⎕wi "where" (("fmRunScenarios" ⎕wi "size") Win∆Resize ⎕wi "∆where")[398] ⎕wi "tooltip" "Add/Edit a Scenario"[399] ⎕wi "onClick" ("fmSV.mRun_ScenariosFile.mScen"⎕wi "onClick")[400] ⎕wi "∆helpid" 5448[401] ⎕wi "caption" (("⍺",⎕tcnl) char_replace "Add/Edit⍺Scenario")[402] list←list OVER "fmRunScenarios.bnRun_ScenariosMonitor"[403] ⎕wself←"fmRunScenarios.bnRun_ScenariosMonitor" ⎕wi "New" "Button"[404] ⎕wi "extent" (size←1.4 1×buttonsize×1⌈CharSize÷13 6)[405] x←0.5×⍴where←Win∆Calcwhere 1,(¯10-size[1]),1,buttonwhere←buttonwhere-5+size[2][406] ⎕wi "∆where" ((x,2)⍴where)[407] ⎕wi "where" (("fmRunScenarios" ⎕wi "size") Win∆Resize ⎕wi "∆where")[408] ⎕wi "tooltip" "Monitor the timings for creation of Excel Output"[409] ⎕wi "onClick" ("fmSV.mRun_ScenariosFile.mMonitor"⎕wi "onClick")[410] ⎕wi "caption" (("⍺",⎕tcnl) char_replace "Monitor⍺Excel Timings")[411] [412] ⎕wself←"fmRunScenarios.lParmDesc" ⎕wi "New" "Label"[413] ⎕wi "scale" 5[414] ⎕wi "extent" (CharSize×¯2↑1,80)[415] ⎕wi "style" 32[416] ⎕wi "caption" " "[417] ⎕wi "∆where" (2 2⍴0.96 0 0.02 0)[418] ⎕wi "where" (("fmRunScenarios" ⎕wi "size") Win∆Resize (2 2⍴0.96 0 0.02 0))[419] [420] "fmRunScenarios" ⎕wi "∆multifile" ""[421] "fmRunScenarios" ⎕wi "∆singlefile" ""[422] "fmRunScenarios" ⎕wi "∆format" ""[423] "fmRunScenarios" ⎕wi "∆financial" 0[424] "fmRunScenarios" ⎕wi "∆relrules" 0[425] "fmRunScenarios" ⎕wi "∆parm" 0[426] "fmRunScenarios" ⎕wi "∆decr" 0[427] "fmRunScenarios" ⎕wi "∆file" 0[428] "fmRunScenarios" ⎕wi "∆codefile" CodeFile[429] "fmRunScenarios" ⎕wi "∆inputstype" "ClientFile"[430] "fmRunScenarios" ⎕wi "∆inputsentry" "Multi"[431] "fmRunScenarios" ⎕wi "∆savecn" (⍳0)[432] "fmRunScenarios" ⎕wi "∆savedesc" ""[433] list←list OVER "fmRunScenarios"[434] "fmRunScenarios" ⎕wi "∆fieldlist" Fieldlist[435] "fmRunScenarios" ⎕wi "∆fieldcontrol" Fieldcontrol[436] childlist←"fmSV" ⎕wi "∆childlist"[437] list←(⊃¯1↑childlist) OVER list[438] childlist[⍴childlist]←⊂list[439] "fmSV" ⎕wi "∆childlist" childlist[440] list←,⎕split list[441] 0 0⍴((∨/¨(⊂".mRun_Scenarios")⍷¨list)/list) MultiWI "enabled" 1[442] :if 300<fnsize[443]     (fnsize fnsize ".") Win∆ProgressBar "MemberUpdate"[444]     Win∆ProgressBar "Hide"[445] :endif[446] "Init" OpenParameters "Run_Scenarios"[447] "fmRunScenarios.bnRun_ScenariosHelp" ⎕wi "visible" 1[448] "fmRunScenarios.bnRun_ScenariosQuit" ⎕wi "visible" 1[449] "fmRunScenarios.bnRun_ScenariosSave" ⎕wi "visible" 1[450] "fmRunScenarios.bnRun_ScenariosSaveAs" ⎕wi "visible" 1[451] "fmRunScenarios.bnRun_ScenariosRun" ⎕wi "visible" 1[452] "#" ⎕wi "focus" "fmRunScenarios.lvSavedBatch"[453] :if ~0∊⍴,Error←Win∆Initialise "Run_Scenarios"[454]     "Quit" EndModule Module[455]     "fmSV" ⎕wi "pointer" 0[456]     0 0⍴"fmRunScenarios" ⎕wi "Delete"[457]     :return[458] :endif[459] :if bar_open←commandbar^"Multi"≡"Multi"[460]     bar_open←0×"fmRunScenarios.mRun_ScenariosFile.m" Win∆CommandBar "RunAsHelp"[461] :endif[462] "fmRunScenarios" ⎕wi "Paint"[463] "fmSV" ⎕wi "pointer" 11[464] "fmRunScenarios" ⎕wi "onWait" "0 0⍴Run_Scenarios 'Wait' ⋄ 'fmRunScenarios' ⎕wi 'modified' 0"[465] 0 0⍴"fmRunScenarios" ⎕wi "Wait"[466] 0 0⍴"fmRunScenarios" ⎕wi "Delete"[467] "fmSV" ⎕wi "pointer" 0 ∇