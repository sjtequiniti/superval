∇ Container←Form_Make;⎕wself;ControlName;childlist;list;Fieldlist;Fieldcontrol;FrameWidth;Caption;buttonsize;buttonwhere;where;size;alignment;Header;PickList;NameList;value;sortorder;SortList;MaxRow;MaxCol;Parent;level;node;no;nn;NN;x;fnsize;framelist;relTests[1] [2] Fieldlist←Fieldcontrol←list←0 0⍴""[3] "fmSV" ⎕wi "pointer" 13[4] buttonsize←25 65 ⋄ buttonwhere←¯5[5] FormName ⎕wi "caption" ((FormName ⎕wi "caption")," - Fix Record Length in File")[6] "fmSV" ⎕wi "∆caption" (("fmSV" ⎕wi "∆caption"),⊂("fmSV" ⎕wi "caption"))[7] :if 300<fnsize←1↑⍴⎕cr "Form_Make"[8]     "Generating Form" Win∆ProgressBar "Open"[9]     ("Menu Items:" "Form Controls:") Win∆ProgressBar "SetLabels"[10]     (1 1 "Help About") Win∆ProgressBar "FileUpdate"[11] :endif[12] [13] Container←"∆Dialog"[14] [15] ⎕wself←"fmFixFile" ⎕wi "New" "Form" "Hide"[16] ⎕wi "caption" ("fmSV" ⎕wi "caption")[17] ⎕wi "scale" 5[18] ⎕wi "font" ("fmSV" ⎕wi "font")[19] ⎕wi "border" 2 32 64[20] ⎕wi "where" (Win∆CentrePos .36 .48×768 1024×1⌈CharSize÷13 6)[21] ⎕wi "limitwhere" (0.8×¯2↑⎕wi "where")[22] ⎕wi "tooltipwidth" 200[23] ⎕wi "onResize" "AutoResize"[24] ⎕wi "onClose" "ExitSystem ''"[25] ControlName←"fmFixFile"[26] relTests←0[27] 0 Menu_Make "fmSV"[28] 1 Menu_Make "fmFixFile"[29] "fmFixFile" Win∆CutCopyPaste "Build"[30] "fmFixFile" ⎕wi "∆helpid" 2014[31] list←list OVER "fmFixFile.bnFix_FileHelp"[32] ⎕wself←"fmFixFile.bnFix_FileHelp" ⎕wi "New" "Button"[33] ⎕wi "deferexit" 1[34] ⎕wi "extent" (size←1×buttonsize×1⌈CharSize÷13 6)[35] x←0.5×⍴where←Win∆Calcwhere 1,(¯10-size[1]),1,buttonwhere←buttonwhere-5+size[2][36] ⎕wi "∆where" ((x,2)⍴where)[37] ⎕wi "where" (("fmFixFile" ⎕wi "size") Win∆Resize ⎕wi "∆where")[38] ⎕wi "tooltip" "SuperVal Help"[39] ⎕wi "onClick" ("fmSV.mFix_FileHelp.mContext"⎕wi "onClick")[40] ⎕wi "caption" "Help"[41] :if buttonimage[42]     ⎕wi "imagelist" "fmSV.iStandard"[43]     ⎕wi "imageindex" 12[44] :endif[45] ⎕wi "visible" ¯1[46] ⎕wi "onMouseDown" "∆HelpField←'#' ⎕wi 'focus' "[47] list←list OVER "fmFixFile.bnFix_FileQuit"[48] ⎕wself←"fmFixFile.bnFix_FileQuit" ⎕wi "New" "Button"[49] ⎕wi "style" 2[50] ⎕wi "deferexit" 1[51] ⎕wi "extent" (size←1×buttonsize×1⌈CharSize÷13 6)[52] x←0.5×⍴where←Win∆Calcwhere 1,(¯10-size[1]),1,buttonwhere←buttonwhere-5+size[2][53] ⎕wi "∆where" ((x,2)⍴where)[54] ⎕wi "where" (("fmFixFile" ⎕wi "size") Win∆Resize ⎕wi "∆where")[55] ⎕wi "tooltip" "Quit and Return"[56] ⎕wi "onClick" ("fmSV.mFix_FileFile.mQuit"⎕wi "onClick")[57] ⎕wi "caption" "Quit"[58] ⎕wi "∆helpid" 3096[59] ⎕wi "order" .5[60] ⎕wi "visible" ¯1[61] ControlName ⎕wi "∆quitbutton" "fmFixFile.bnFix_FileQuit"[62] list←list OVER "fmFixFile.bnFix_FileSave"[63] ⎕wself←"fmFixFile.bnFix_FileSave" ⎕wi "New" "Button"[64] ⎕wi "extent" (size←1×buttonsize×1⌈CharSize÷13 6)[65] x←0.5×⍴where←Win∆Calcwhere 1,(¯10-size[1]),1,buttonwhere←buttonwhere-5+size[2][66] ⎕wi "∆where" ((x,2)⍴where)[67] ⎕wi "where" (("fmFixFile" ⎕wi "size") Win∆Resize ⎕wi "∆where")[68] ⎕wi "tooltip" "Save Parameters"[69] ⎕wi "onClick" ("fmSV.mFix_FileFile.mSave"⎕wi "onClick")[70] ⎕wi "caption" "Save"[71] :if buttonimage[72]     ⎕wi "imagelist" "fmSV.iStandard"[73]     ⎕wi "imageindex" 9[74] :endif[75] ⎕wi "∆helpid" 3097[76] ⎕wi "enabled" 0[77] ⎕wi "order" .5[78] ⎕wi "visible" ¯1[79] "fmFixFile" ⎕wi "onModified" "('Fix_File' 'fmFixFile.bnFix_FileSave') Win∆SaveEnabled (0≠⎕warg[1])"[80] list←list OVER "fmFixFile.bnFix_FileRun"[81] ⎕wself←"fmFixFile.bnFix_FileRun" ⎕wi "New" "Button"[82] ⎕wi "style" 1[83] ⎕wi "extent" (size←1×buttonsize×1⌈CharSize÷13 6)[84] x←0.5×⍴where←Win∆Calcwhere 1,(¯10-size[1]),1,buttonwhere←buttonwhere-5+size[2][85] ⎕wi "∆where" ((x,2)⍴where)[86] ⎕wi "where" (("fmFixFile" ⎕wi "size") Win∆Resize ⎕wi "∆where")[87] ⎕wi "tooltip" "Save Parameters and Run Fix Record Length in File"[88] ⎕wi "onClick" ("fmSV.mFix_FileFile.mRun"⎕wi "onClick")[89] ⎕wi "caption" "Run"[90] :if buttonimage[91]     ⎕wi "imagelist" "fmSV.iStandard"[92]     ⎕wi "imageindex" 33[93] :endif[94] ⎕wi "∆helpid" 3098[95] ⎕wi "order" .5[96] ⎕wi "visible" ¯1[97] [98] ⎕wself←"fmFixFile.edFILE" ⎕wi "New" "Edit"[99] Fieldlist←Fieldlist OVER "fmFixFile.edFILE"[100] Fieldcontrol←Fieldcontrol OVER "Edit"[101] ⎕wi "∆name" "FILE"[102] ⎕wi "∆type" "File"[103] ⎕wi "∆mandatory" 1[104] ⎕wi "∆valid" ('Input' 'Single')[105] ⎕wi "∆helpid" 3099[106] ⎕wi "tooltip" "Specify the File to be Fixed
(Double Click for Open File Dialog)"[107] ⎕wi "∆where" (2 2⍴0.1 0 0.4 0)[108] ⎕wi "where" (("fmFixFile" ⎕wi "size") Win∆Resize (2 2⍴0.1 0 0.4 0))[109] ⎕wi "onExit" "⍎(0∊⍴,⎕wres←0 INPUT∆CHECK 'fmFixFile.edFILE')/'0 0⍴(⊂⎕wi ''name'') Fix_File ''Change'' ' "[110] ⎕wi "onExitError" "Win∆ExitError ⎕warg"[111] ⎕wi "extent" (2+CharSize×1 31)[112] ⎕wi "pointer" ">cur 1001 shell32.dll"[113] ⎕wi "onMouseDouble" "'Input Single' GetFileList 'Single' "[114] ⎕wi "targetformats" "FileName"[115] ⎕wi "onDrop" "'fmFixFile.edFILE' Win∆DropTarget 0 ('Input' 'Single')"[116] ⎕wi "onChange" "0 0⍴(⊂⎕wi 'name') Fix_File 'Change' "[117] [118] ⎕wself←"fmFixFile.llFILE" ⎕wi "New" "Label"[119] ⎕wi "scale" 5[120] ⎕wi "style" 2[121] ⎕wi "extent" (↑⎕wi "Draw" ("?text" "Input Data File"))[122] ⎕wi "caption" "Input Data File"[123] where←4↑,"fmFixFile.edFILE" ⎕wi "∆where"[124] x←0.5×⍴where←Win∆Calcwhere where-0 ¯3 0,10+¯1↑⎕wi "extent"[125] ⎕wi "∆where" ((x,2)⍴where)[126] ⎕wi "where" (("fmFixFile" ⎕wi "size") Win∆Resize ⎕wi "∆where")[127] [128] ⎕wself←"fmFixFile.cblast" ⎕wi "New" "Combo"[129] Fieldlist←Fieldlist OVER "fmFixFile.cblast"[130] Fieldcontrol←Fieldcontrol OVER "Combo"[131] ⎕wi "∆name" "last"[132] ⎕wi "∆type" "Char"[133] ⎕wi "∆mandatory" 1[134] ⎕wi "∆helpid" 3100[135] ⎕wi "tooltip" "Select the Type of Input Data File"[136] ⎕wi "style" 16 128 256 2[137] ⎕wi "∆where" (2 2⍴0.25 0 0.4 0)[138] ⎕wi "where" (("fmFixFile" ⎕wi "size") Win∆Resize (2 2⍴0.25 0 0.4 0))[139] PickList←⍙POPUPSdict ReadDictFile "InputType"[140] PickList←⊃m2n 1 0↓PickList[141] ⎕wi "list" PickList[142] ⎕wi "extent" (150,(¯10+6×¯1↑CharSize)+¯1↑Win∆TextSize ((0,⎕wi "limit")⌈⍴PickList)↑PickList)[143] ⎕wi "onClick" "0 0⍴(⊂⎕wi 'name') Fix_File 'Change' "[144] [145] ⎕wself←"fmFixFile.lllast" ⎕wi "New" "Label"[146] ⎕wi "scale" 5[147] ⎕wi "style" 2[148] ⎕wi "extent" (↑⎕wi "Draw" ("?text" "Input Data Type"))[149] ⎕wi "caption" "Input Data Type"[150] where←4↑,"fmFixFile.cblast" ⎕wi "∆where"[151] x←0.5×⍴where←Win∆Calcwhere where-0 ¯3 0,10+¯1↑⎕wi "extent"[152] ⎕wi "∆where" ((x,2)⍴where)[153] ⎕wi "where" (("fmFixFile" ⎕wi "size") Win∆Resize ⎕wi "∆where")[154] [155] ⎕wself←"fmFixFile.edfILENAME" ⎕wi "New" "Edit"[156] Fieldlist←Fieldlist OVER "fmFixFile.edfILENAME"[157] Fieldcontrol←Fieldcontrol OVER "Edit"[158] ⎕wi "∆name" "fILENAME"[159] ⎕wi "∆type" "File"[160] ⎕wi "∆mandatory" 1[161] ⎕wi "∆valid" ('New' 'Single')[162] ⎕wi "∆helpid" 3101[163] ⎕wi "tooltip" "Specify the Fixed Data File Name
(Double Click for Open File Dialog)"[164] ⎕wi "∆where" (2 2⍴0.4 0 0.4 0)[165] ⎕wi "where" (("fmFixFile" ⎕wi "size") Win∆Resize (2 2⍴0.4 0 0.4 0))[166] ⎕wi "onExit" "⍎(0∊⍴,⎕wres←0 INPUT∆CHECK 'fmFixFile.edfILENAME')/'0 0⍴(⊂⎕wi ''name'') Fix_File ''Change'' ' "[167] ⎕wi "onExitError" "Win∆ExitError ⎕warg"[168] ⎕wi "extent" (2+CharSize×1 31)[169] ⎕wi "pointer" ">cur 1001 shell32.dll"[170] ⎕wi "onMouseDouble" "'New Single' GetFileList 'Single' "[171] ⎕wi "targetformats" "FileName"[172] ⎕wi "onDrop" "'fmFixFile.edfILENAME' Win∆DropTarget 0 ('New' 'Single')"[173] ⎕wi "onChange" "0 0⍴(⊂⎕wi 'name') Fix_File 'Change' "[174] [175] ⎕wself←"fmFixFile.llfILENAME" ⎕wi "New" "Label"[176] ⎕wi "scale" 5[177] ⎕wi "style" 2[178] ⎕wi "extent" (↑⎕wi "Draw" ("?text" "Fixed Input Data File"))[179] ⎕wi "caption" "Fixed Input Data File"[180] where←4↑,"fmFixFile.edfILENAME" ⎕wi "∆where"[181] x←0.5×⍴where←Win∆Calcwhere where-0 ¯3 0,10+¯1↑⎕wi "extent"[182] ⎕wi "∆where" ((x,2)⍴where)[183] ⎕wi "where" (("fmFixFile" ⎕wi "size") Win∆Resize ⎕wi "∆where")[184] [185] ⎕wself←"fmFixFile.ckdataind" ⎕wi "New" "Check"[186] Fieldlist←Fieldlist OVER "fmFixFile.ckdataind"[187] Fieldcontrol←Fieldcontrol OVER "Check"[188] ⎕wi "∆name" "dataind"[189] ⎕wi "∆type" "Check"[190] ⎕wi "∆helpid" 3102[191] ⎕wi "tooltip" "Indicate if Multiple Blank Columns are to be deleted"[192] ⎕wi "style" 0[193] ⎕wi "caption" "Delete Multiple Blank Columns"[194] ⎕wi "∆where" (2 2⍴0.55 0 0.4 0)[195] ⎕wi "where" (("fmFixFile" ⎕wi "size") Win∆Resize (2 2⍴0.55 0 0.4 0))[196] ⎕wi "extent" ((0 5×CharSize)+Win∆TextSize ⎕wi "caption")[197] ⎕wi "onClick" "(0 0⍴(⊂⎕wi 'name') Fix_File 'Change' )"[198] [199] ⎕wself←"fmFixFile.edNUMRECS" ⎕wi "New" "Edit"[200] Fieldlist←Fieldlist OVER "fmFixFile.edNUMRECS"[201] Fieldcontrol←Fieldcontrol OVER "Edit"[202] ⎕wi "∆name" "NUMRECS"[203] ⎕wi "∆type" "Num"[204] ⎕wi "∆valid" ('Int' 'Scalar' '+')[205] ⎕wi "∆helpid" 3103[206] ⎕wi "tooltip" "Specify the Total Number of Records in Fixed File 
(Blank for ALL Data Records)"[207] ⎕wi "limit" 7[208] ⎕wi "∆where" (2 2⍴0.7 0 0.4 0)[209] ⎕wi "where" (("fmFixFile" ⎕wi "size") Win∆Resize (2 2⍴0.7 0 0.4 0))[210] ⎕wi "onExit" "⍎(0∊⍴,⎕wres←0 INPUT∆CHECK 'fmFixFile.edNUMRECS')/'0 0⍴(⊂⎕wi ''name'') Fix_File ''Change'' ' "[211] ⎕wi "onExitError" "Win∆ExitError ⎕warg"[212] ⎕wi "onKeyPress" "⎕wres←¯2×~⎕warg∊8 32 48 49 50 51 52 53 54 55 56 57"[213] ⎕wi "extent" (2+CharSize×1 8)[214] [215] ⎕wself←"fmFixFile.lrNUMRECS" ⎕wi "New" "Label"[216] ⎕wi "scale" 5[217] ⎕wi "extent" (↑⎕wi "Draw" ("?text" "records"))[218] ⎕wi "caption" "records"[219] where←4↑,"fmFixFile.edNUMRECS" ⎕wi "∆where"[220] x←0.5×⍴where←Win∆Calcwhere where+0,3,0,10+¯1↑"fmFixFile.edNUMRECS" ⎕wi "extent"[221] ⎕wi "∆where" ((x,2)⍴where)[222] ⎕wi "where" (("fmFixFile" ⎕wi "size") Win∆Resize ⎕wi "∆where")[223] [224] ⎕wself←"fmFixFile.llNUMRECS" ⎕wi "New" "Label"[225] ⎕wi "scale" 5[226] ⎕wi "style" 2[227] ⎕wi "extent" (↑⎕wi "Draw" ("?text" (("⍺",⎕tcnl) char_replace "Limit Number of Records⍺in Fixed File")))[228] ⎕wi "caption" (("⍺",⎕tcnl) char_replace "Limit Number of Records⍺in Fixed File")[229] where←4↑,"fmFixFile.edNUMRECS" ⎕wi "∆where"[230] size←1↑"fmFixFile.edNUMRECS" ⎕wi "extent"[231] size←¯3⌈0.5×(1↑⎕wi "extent")-size[232] x←0.5×⍴where←Win∆Calcwhere where-0,size,0,10+¯1↑⎕wi "extent"[233] ⎕wi "∆where" ((x,2)⍴where)[234] ⎕wi "where" (("fmFixFile" ⎕wi "size") Win∆Resize ⎕wi "∆where")[235] [236] "fmFixFile" ⎕wi "∆multifile" ""[237] "fmFixFile" ⎕wi "∆singlefile" "fmFixFile.edFILE"[238] "fmFixFile" ⎕wi "∆format" ""[239] "fmFixFile" ⎕wi "∆financial" 0[240] "fmFixFile" ⎕wi "∆relrules" 0[241] "fmFixFile" ⎕wi "∆parm" 0[242] "fmFixFile" ⎕wi "∆decr" 0[243] "fmFixFile" ⎕wi "∆file" 0[244] "fmFixFile" ⎕wi "∆codefile" CodeFile[245] "fmFixFile" ⎕wi "∆inputstype" "ClientFile"[246] "fmFixFile" ⎕wi "∆inputsentry" "Single"[247] "fmFixFile" ⎕wi "∆savecn" (⍳0)[248] "fmFixFile" ⎕wi "∆savedesc" ""[249] list←list OVER "fmFixFile"[250] "fmFixFile" ⎕wi "∆fieldlist" Fieldlist[251] "fmFixFile" ⎕wi "∆fieldcontrol" Fieldcontrol[252] childlist←"fmSV" ⎕wi "∆childlist"[253] list←(⊃¯1↑childlist) OVER list[254] childlist[⍴childlist]←⊂list[255] "fmSV" ⎕wi "∆childlist" childlist[256] list←,⎕split list[257] 0 0⍴((∨/¨(⊂".mFix_File")⍷¨list)/list) MultiWI "enabled" 1[258] :if 300<fnsize[259]     (fnsize fnsize ".") Win∆ProgressBar "MemberUpdate"[260]     Win∆ProgressBar "Hide"[261] :endif[262] "Init" OpenParameters "Fix_File"[263] "fmFixFile.bnFix_FileHelp" ⎕wi "visible" 1[264] "fmFixFile.bnFix_FileQuit" ⎕wi "visible" 1[265] "fmFixFile.bnFix_FileSave" ⎕wi "visible" 1[266] "fmFixFile.bnFix_FileRun" ⎕wi "visible" 1[267] "#" ⎕wi "focus" "fmFixFile.edFILE"[268] :if ~0∊⍴,Error←Win∆Initialise "Fix_File"[269]     "Quit" EndModule Module[270]     "fmSV" ⎕wi "pointer" 0[271]     0 0⍴"fmFixFile" ⎕wi "Delete"[272]     :return[273] :endif[274] :if bar_open←commandbar^"Multi"≡"Single"[275]     bar_open←0×"fmFixFile.mFix_FileFile.m" Win∆CommandBar "RunHelp"[276] :endif[277] "fmFixFile" ⎕wi "Paint"[278] "fmSV" ⎕wi "pointer" 11[279] "fmFixFile" ⎕wi "onWait" "0 0⍴Fix_File 'Wait' ⋄ 'fmFixFile' ⎕wi 'modified' 0"[280] 0 0⍴"fmFixFile" ⎕wi "Wait"[281] 0 0⍴"fmFixFile" ⎕wi "Delete"[282] "fmSV" ⎕wi "pointer" 0 ∇