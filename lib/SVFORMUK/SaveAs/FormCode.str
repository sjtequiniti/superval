∇ Container←Form_Make;⎕wself;ControlName;childlist;list;Fieldlist;Fieldcontrol;FrameWidth;Caption;buttonsize;buttonwhere;where;size;alignment;Header;PickList;NameList;value;sortorder;SortList;MaxRow;MaxCol;Parent;level;node;no;nn;NN;x;fnsize;framelist;relTests[1] [2] Fieldlist←Fieldcontrol←list←0 0⍴""[3] "fmSV" ⎕wi "pointer" 13[4] buttonsize←25 65 ⋄ buttonwhere←¯5[5] FormName ⎕wi "caption" ((FormName ⎕wi "caption")," - Save Parameters As")[6] "fmSV" ⎕wi "∆caption" (("fmSV" ⎕wi "∆caption"),⊂("fmSV" ⎕wi "caption"))[7] :if 300<fnsize←1↑⍴⎕cr "Form_Make"[8]     "Generating Form" Win∆ProgressBar "Open"[9]     ("Menu Items:" "Form Controls:") Win∆ProgressBar "SetLabels"[10]     (1 1 "Help About") Win∆ProgressBar "FileUpdate"[11] :endif[12] [13] Container←"∆Dialog"[14] [15] ⎕wself←"fmSaveAs" ⎕wi "New" "Form" "Hide"[16] ⎕wi "caption" ("fmSV" ⎕wi "caption")[17] ⎕wi "scale" 5[18] ⎕wi "font" ("fmSV" ⎕wi "font")[19] ⎕wi "border" 2 32 64[20] ⎕wi "where" (Win∆CentrePos .35 .70×768 1024×1⌈CharSize÷13 6)[21] ⎕wi "limitwhere" (0.8×¯2↑⎕wi "where")[22] ⎕wi "tooltipwidth" 200[23] ⎕wi "onResize" "AutoResize"[24] ⎕wi "onClose" "ExitSystem ''"[25] ControlName←"fmSaveAs"[26] relTests←0[27] 0 Menu_Make "fmSV"[28] 0 Menu_Make "fmSaveAs"[29] "fmSaveAs" Win∆CutCopyPaste "Build"[30] "fmSaveAs" ⎕wi "∆helpid" 2003[31] list←list OVER "fmSaveAs.bnSaveAsHelp"[32] ⎕wself←"fmSaveAs.bnSaveAsHelp" ⎕wi "New" "Button"[33] ⎕wi "deferexit" 1[34] ⎕wi "extent" (size←1×buttonsize×1⌈CharSize÷13 6)[35] x←0.5×⍴where←Win∆Calcwhere 1,(¯10-size[1]),1,buttonwhere←buttonwhere-5+size[2][36] ⎕wi "∆where" ((x,2)⍴where)[37] ⎕wi "where" (("fmSaveAs" ⎕wi "size") Win∆Resize ⎕wi "∆where")[38] ⎕wi "tooltip" "SuperVal Help"[39] ⎕wi "onClick" ("fmSV.mSaveAsHelp.mContext"⎕wi "onClick")[40] ⎕wi "caption" "Help"[41] :if buttonimage[42]     ⎕wi "imagelist" "fmSV.iStandard"[43]     ⎕wi "imageindex" 12[44] :endif[45] ⎕wi "visible" ¯1[46] ⎕wi "onMouseDown" "∆HelpField←'#' ⎕wi 'focus' "[47] list←list OVER "fmSaveAs.bnSaveAsQuit"[48] ⎕wself←"fmSaveAs.bnSaveAsQuit" ⎕wi "New" "Button"[49] ⎕wi "style" 2[50] ⎕wi "deferexit" 1[51] ⎕wi "extent" (size←1×buttonsize×1⌈CharSize÷13 6)[52] x←0.5×⍴where←Win∆Calcwhere 1,(¯10-size[1]),1,buttonwhere←buttonwhere-5+size[2][53] ⎕wi "∆where" ((x,2)⍴where)[54] ⎕wi "where" (("fmSaveAs" ⎕wi "size") Win∆Resize ⎕wi "∆where")[55] ⎕wi "tooltip" "Cancel and Return"[56] ⎕wi "onClick" ("fmSV.mSaveAsFile.mQuit"⎕wi "onClick")[57] ⎕wi "caption" "Cancel"[58] ⎕wi "∆helpid" 3015[59] ⎕wi "order" .5[60] ⎕wi "visible" ¯1[61] list←list OVER "fmSaveAs.bnSaveAsSave"[62] ⎕wself←"fmSaveAs.bnSaveAsSave" ⎕wi "New" "Button"[63] ⎕wi "style" 1[64] ⎕wi "extent" (size←1×buttonsize×1⌈CharSize÷13 6)[65] x←0.5×⍴where←Win∆Calcwhere 1,(¯10-size[1]),1,buttonwhere←buttonwhere-5+size[2][66] ⎕wi "∆where" ((x,2)⍴where)[67] ⎕wi "where" (("fmSaveAs" ⎕wi "size") Win∆Resize ⎕wi "∆where")[68] ⎕wi "tooltip" "Save Parameters"[69] ⎕wi "onClick" ("fmSV.mSaveAsFile.mSave"⎕wi "onClick")[70] ⎕wi "caption" "OK"[71] ⎕wi "∆helpid" 3016[72] ⎕wi "order" .5[73] ⎕wi "visible" ¯1[74] "fmSaveAs" ⎕wi "∆modified" 1[75] [76] ⎕wself←"fmSaveAs.cbSaveFile" ⎕wi "New" "Combo"[77] Fieldlist←Fieldlist OVER "fmSaveAs.cbSaveFile"[78] Fieldcontrol←Fieldcontrol OVER "Combo"[79] ⎕wi "∆name" "SaveFile"[80] ⎕wi "∆type" "Char"[81] ⎕wi "∆mandatory" 1[82] ⎕wi "∆helpid" 3017[83] ⎕wi "tooltip" "Specify a new or Select an existing Parameters File"[84] ⎕wi "limit" 40[85] ⎕wi "onExit" "⍎(mt ,⎕wres←0 INPUT∆CHECK 'fmSaveAs.cbSaveFile')/'0 0⍴(⊂⎕wi ''name'') SaveAs ''Change'' ' "[86] ⎕wi "onExitError" "Win∆ExitError ⎕warg"[87] ⎕wi "style" 16 128 256 0[88] ⎕wi "∆where" (2 2⍴0.1 0 0.2 0)[89] ⎕wi "where" (("fmSaveAs" ⎕wi "size") Win∆Resize (2 2⍴0.1 0 0.2 0))[90] PickList←InputsType GetParmFiles 1[91] ⎕wi "∆update" "InputsType GetParmFiles 1"[92] PickList←⊃m2n 1 0↓PickList[93] PickList←" " OVER PickList[94] ⎕wi "list" PickList[95] ⎕wi "extent" (150,(¯10+8×¯1↑CharSize)+¯1↑Win∆TextSize ((0,⎕wi "limit")⌈⍴PickList)↑PickList)[96] ⎕wi "onClick" "0 0⍴(⊂⎕wi 'name') SaveAs 'Change' "[97] [98] ⎕wself←"fmSaveAs.llSaveFile" ⎕wi "New" "Label"[99] ⎕wi "scale" 5[100] ⎕wi "style" 2[101] ⎕wi "extent" (↑⎕wi "Draw" ("?text" "Parameter File"))[102] ⎕wi "caption" "Parameter File"[103] where←4↑,"fmSaveAs.cbSaveFile" ⎕wi "∆where"[104] x←0.5×⍴where←Win∆Calcwhere where-0 ¯3 0,10+¯1↑⎕wi "extent"[105] ⎕wi "∆where" ((x,2)⍴where)[106] ⎕wi "where" (("fmSaveAs" ⎕wi "size") Win∆Resize ⎕wi "∆where")[107] [108] ⎕wself←"fmSaveAs.ckEditFileDesc" ⎕wi "New" "Check"[109] Fieldlist←Fieldlist OVER "fmSaveAs.ckEditFileDesc"[110] Fieldcontrol←Fieldcontrol OVER "Check"[111] ⎕wi "∆name" "EditFileDesc"[112] ⎕wi "∆type" "Check"[113] ⎕wi "∆helpid" 3018[114] ⎕wi "tooltip" "Check this to enable Editing of Parameter File Description"[115] ⎕wi "style" 0[116] ⎕wi "caption" "Edit Parameter File Description"[117] ⎕wi "∆where" (2 2⍴0.12 0 0.7 0)[118] ⎕wi "where" (("fmSaveAs" ⎕wi "size") Win∆Resize (2 2⍴0.12 0 0.7 0))[119] ⎕wi "extent" ((0 5×CharSize)+Win∆TextSize ⎕wi "caption")[120] ⎕wi "onClick" "(0 0⍴(⊂⎕wi 'name') SaveAs 'Change' )"[121] [122] ⎕wself←"fmSaveAs.edSaveFileDesc" ⎕wi "New" "Edit"[123] Fieldlist←Fieldlist OVER "fmSaveAs.edSaveFileDesc"[124] Fieldcontrol←Fieldcontrol OVER "Edit"[125] ⎕wi "∆name" "SaveFileDesc"[126] ⎕wi "∆type" "Char"[127] ⎕wi "∆mandatory" 1[128] ⎕wi "∆helpid" 3019[129] ⎕wi "tooltip" "Specify the Parameters File Description"[130] ⎕wi "∆where" (2 2⍴0.3 0 0.2 0)[131] ⎕wi "where" (("fmSaveAs" ⎕wi "size") Win∆Resize (2 2⍴0.3 0 0.2 0))[132] ⎕wi "onExit" "⍎(0∊⍴,⎕wres←0 INPUT∆CHECK 'fmSaveAs.edSaveFileDesc')/'0 0⍴(⊂⎕wi ''name'') SaveAs ''Change'' ' "[133] ⎕wi "onExitError" "Win∆ExitError ⎕warg"[134] ⎕wi "extent" (2+CharSize×1 81)[135] [136] ⎕wself←"fmSaveAs.llSaveFileDesc" ⎕wi "New" "Label"[137] ⎕wi "scale" 5[138] ⎕wi "style" 2[139] ⎕wi "extent" (↑⎕wi "Draw" ("?text" (("⍺",⎕tcnl) char_replace "Parameter File⍺Description")))[140] ⎕wi "caption" (("⍺",⎕tcnl) char_replace "Parameter File⍺Description")[141] where←4↑,"fmSaveAs.edSaveFileDesc" ⎕wi "∆where"[142] size←1↑"fmSaveAs.edSaveFileDesc" ⎕wi "extent"[143] size←¯3⌈0.5×(1↑⎕wi "extent")-size[144] x←0.5×⍴where←Win∆Calcwhere where-0,size,0,10+¯1↑⎕wi "extent"[145] ⎕wi "∆where" ((x,2)⍴where)[146] ⎕wi "where" (("fmSaveAs" ⎕wi "size") Win∆Resize ⎕wi "∆where")[147] [148] ⎕wself←"fmSaveAs.edSavedDesc" ⎕wi "New" "Edit"[149] Fieldlist←Fieldlist OVER "fmSaveAs.edSavedDesc"[150] Fieldcontrol←Fieldcontrol OVER "Edit"[151] ⎕wi "∆name" "SavedDesc"[152] ⎕wi "∆type" "Char"[153] ⎕wi "∆mandatory" 1[154] ⎕wi "∆helpid" 3020[155] ⎕wi "tooltip" "Specify the Parameter Set Description"[156] ⎕wi "∆where" (2 2⍴0.5 0 0.2 0)[157] ⎕wi "where" (("fmSaveAs" ⎕wi "size") Win∆Resize (2 2⍴0.5 0 0.2 0))[158] ⎕wi "onExit" "⍎(0∊⍴,⎕wres←0 INPUT∆CHECK 'fmSaveAs.edSavedDesc')/'0 0⍴(⊂⎕wi ''name'') SaveAs ''Change'' ' "[159] ⎕wi "onExitError" "Win∆ExitError ⎕warg"[160] ⎕wi "extent" (2+CharSize×1 81)[161] [162] ⎕wself←"fmSaveAs.llSavedDesc" ⎕wi "New" "Label"[163] ⎕wi "scale" 5[164] ⎕wi "style" 2[165] ⎕wi "extent" (↑⎕wi "Draw" ("?text" (("⍺",⎕tcnl) char_replace "Parameter Set⍺Description")))[166] ⎕wi "caption" (("⍺",⎕tcnl) char_replace "Parameter Set⍺Description")[167] where←4↑,"fmSaveAs.edSavedDesc" ⎕wi "∆where"[168] size←1↑"fmSaveAs.edSavedDesc" ⎕wi "extent"[169] size←¯3⌈0.5×(1↑⎕wi "extent")-size[170] x←0.5×⍴where←Win∆Calcwhere where-0,size,0,10+¯1↑⎕wi "extent"[171] ⎕wi "∆where" ((x,2)⍴where)[172] ⎕wi "where" (("fmSaveAs" ⎕wi "size") Win∆Resize ⎕wi "∆where")[173] [174] ⎕wself←"fmSaveAs.edSavedID" ⎕wi "New" "Edit"[175] Fieldlist←Fieldlist OVER "fmSaveAs.edSavedID"[176] Fieldcontrol←Fieldcontrol OVER "Edit"[177] ⎕wi "∆name" "SavedID"[178] ⎕wi "∆type" "Char"[179] ⎕wi "enabled" (0)[180] ⎕wi "∆helpid" 3021[181] ⎕wi "tooltip" "The Single Character Basis Identifier"[182] ⎕wi "limit" 1[183] ⎕wi "∆where" (2 2⍴0.5 0 0.05 0)[184] ⎕wi "where" (("fmSaveAs" ⎕wi "size") Win∆Resize (2 2⍴0.5 0 0.05 0))[185] ⎕wi "onExit" "⍎(0∊⍴,⎕wres←0 INPUT∆CHECK 'fmSaveAs.edSavedID')/'0 0⍴(⊂⎕wi ''name'') SaveAs ''Change'' ' "[186] ⎕wi "onExitError" "Win∆ExitError ⎕warg"[187] ⎕wi "extent" (2+CharSize×1 1.5)[188] [189] ⎕wself←"fmSaveAs.llSavedID" ⎕wi "New" "Label"[190] ⎕wi "scale" 5[191] ⎕wi "style" 2[192] ⎕wi "enabled" (0)[193] ⎕wi "extent" (↑⎕wi "Draw" ("?text" (("⍺",⎕tcnl) char_replace "Basis⍺Identifier")))[194] ⎕wi "caption" (("⍺",⎕tcnl) char_replace "Basis⍺Identifier")[195] where←4↑,"fmSaveAs.edSavedID" ⎕wi "∆where"[196] x←0.5×⍴where←Win∆Calcwhere where-0,(5+1↑⎕wi "extent"),0 0[197] ⎕wi "∆where" ((x,2)⍴where)[198] ⎕wi "where" (("fmSaveAs" ⎕wi "size") Win∆Resize ⎕wi "∆where")[199] [200] ⎕wself←"fmSaveAs.ckSaveRep" ⎕wi "New" "Check"[201] Fieldlist←Fieldlist OVER "fmSaveAs.ckSaveRep"[202] Fieldcontrol←Fieldcontrol OVER "Check"[203] ⎕wi "∆name" "SaveRep"[204] ⎕wi "∆type" "Check"[205] ⎕wi "∆helpid" 3022[206] ⎕wi "tooltip" "Specify if Saved Parameter Set is to replace the Parameter Set Opened"[207] ⎕wi "style" 0[208] ⎕wi "caption" "Replace Current Parameter Set"[209] ⎕wi "∆where" (2 2⍴0.7 0 0.2 0)[210] ⎕wi "where" (("fmSaveAs" ⎕wi "size") Win∆Resize (2 2⍴0.7 0 0.2 0))[211] ⎕wi "extent" ((0 5×CharSize)+Win∆TextSize ⎕wi "caption")[212] ⎕wi "onClick" "(0 0⍴(⊂⎕wi 'name') SaveAs 'Change' )"[213] [214] "fmSaveAs" ⎕wi "∆multifile" ""[215] "fmSaveAs" ⎕wi "∆singlefile" ""[216] "fmSaveAs" ⎕wi "∆format" ""[217] "fmSaveAs" ⎕wi "∆financial" 0[218] "fmSaveAs" ⎕wi "∆relrules" 0[219] "fmSaveAs" ⎕wi "∆parm" 0[220] "fmSaveAs" ⎕wi "∆decr" 0[221] "fmSaveAs" ⎕wi "∆file" 0[222] "fmSaveAs" ⎕wi "∆codefile" CodeFile[223] "fmSaveAs" ⎕wi "∆inputstype" ""[224] "fmSaveAs" ⎕wi "∆inputsentry" ""[225] "fmSaveAs" ⎕wi "∆savecn" (⍳0)[226] "fmSaveAs" ⎕wi "∆savedesc" ""[227] list←list OVER "fmSaveAs"[228] "fmSaveAs" ⎕wi "∆fieldlist" Fieldlist[229] "fmSaveAs" ⎕wi "∆fieldcontrol" Fieldcontrol[230] childlist←"fmSV" ⎕wi "∆childlist"[231] list←(⊃¯1↑childlist) OVER list[232] childlist[⍴childlist]←⊂list[233] "fmSV" ⎕wi "∆childlist" childlist[234] list←,⎕split list[235] 0 0⍴((∨/¨(⊂".mSaveAs")⍷¨list)/list) MultiWI "enabled" 1[236] :if 300<fnsize[237]     (fnsize fnsize ".") Win∆ProgressBar "MemberUpdate"[238]     Win∆ProgressBar "Hide"[239] :endif[240] "Init" OpenParameters "SaveAs"[241] "fmSaveAs.bnSaveAsHelp" ⎕wi "visible" 1[242] "fmSaveAs.bnSaveAsQuit" ⎕wi "visible" 1[243] "fmSaveAs.bnSaveAsSave" ⎕wi "visible" 1[244] "#" ⎕wi "focus" "fmSaveAs.cbSaveFile"[245] :if ~0∊⍴,Error←Win∆Initialise "SaveAs"[246]     "Quit" EndModule Module[247]     "fmSV" ⎕wi "pointer" 0[248]     0 0⍴"fmSaveAs" ⎕wi "Delete"[249]     :return[250] :endif[251] :if bar_open←commandbar^"Multi"≡""[252]     bar_open←0×"fmSaveAs.mSaveAsFile.m" Win∆CommandBar "OKHelp"[253] :endif[254] "fmSaveAs" ⎕wi "Paint"[255] "fmSV" ⎕wi "pointer" 11[256] "fmSaveAs" ⎕wi "onWait" "0 0⍴SaveAs 'Wait' ⋄ 'fmSaveAs' ⎕wi 'modified' 0"[257] 0 0⍴"fmSaveAs" ⎕wi "Wait"[258] 0 0⍴"fmSaveAs" ⎕wi "Delete"[259] "fmSV" ⎕wi "pointer" 0 ∇