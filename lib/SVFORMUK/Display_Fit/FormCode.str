∇ Container←Form_Make;⎕wself;ControlName;childlist;list;Fieldlist;Fieldcontrol;FrameWidth;Caption;buttonsize;buttonwhere;where;size;alignment;Header;PickList;NameList;value;sortorder;SortList;MaxRow;MaxCol;Parent;level;node;no;nn;NN;x;fnsize;framelist;relTests[1] [2] Fieldlist←Fieldcontrol←list←0 0⍴""[3] "fmSV" ⎕wi "pointer" 13[4] buttonsize←25 65 ⋄ buttonwhere←¯5[5] FormName ⎕wi "caption" ((FormName ⎕wi "caption")," - Display Fitted Tables")[6] "fmSV" ⎕wi "∆caption" (("fmSV" ⎕wi "∆caption"),⊂("fmSV" ⎕wi "caption"))[7] :if 300<fnsize←1↑⍴⎕cr "Form_Make"[8]     "Generating Form" Win∆ProgressBar "Open"[9]     ("Menu Items:" "Form Controls:") Win∆ProgressBar "SetLabels"[10]     (1 1 "Help About") Win∆ProgressBar "FileUpdate"[11] :endif[12] [13] Container←"∆Dialog"[14] [15] ⎕wself←"fmDisplayFit" ⎕wi "New" "Form" "Hide"[16] ⎕wi "caption" ("fmSV" ⎕wi "caption")[17] ⎕wi "scale" 5[18] ⎕wi "font" ("fmSV" ⎕wi "font")[19] ⎕wi "border" 2 32 64[20] ⎕wi "where" (Win∆CentrePos .45 .95×768 1024×1⌈CharSize÷13 6)[21] ⎕wi "limitwhere" (0.8×¯2↑⎕wi "where")[22] ⎕wi "tooltipwidth" 200[23] ⎕wi "onResize" "AutoResize"[24] ⎕wi "onClose" "ExitSystem ''"[25] ControlName←"fmDisplayFit"[26] relTests←0[27] 0 Menu_Make "fmSV"[28] 0 Menu_Make "fmDisplayFit"[29] "fmDisplayFit" Win∆CutCopyPaste "Build"[30] "fmDisplayFit" ⎕wi "∆helpid" 2116[31] list←list OVER "fmDisplayFit.bnDisplay_FitHelp"[32] ⎕wself←"fmDisplayFit.bnDisplay_FitHelp" ⎕wi "New" "Button"[33] ⎕wi "deferexit" 1[34] ⎕wi "extent" (size←1×buttonsize×1⌈CharSize÷13 6)[35] x←0.5×⍴where←Win∆Calcwhere 1,(¯10-size[1]),1,buttonwhere←buttonwhere-5+size[2][36] ⎕wi "∆where" ((x,2)⍴where)[37] ⎕wi "where" (("fmDisplayFit" ⎕wi "size") Win∆Resize ⎕wi "∆where")[38] ⎕wi "tooltip" "SuperVal Help"[39] ⎕wi "onClick" ("fmSV.mDisplay_FitHelp.mContext"⎕wi "onClick")[40] ⎕wi "caption" "Help"[41] :if buttonimage[42]     ⎕wi "imagelist" "fmSV.iStandard"[43]     ⎕wi "imageindex" 12[44] :endif[45] ⎕wi "visible" ¯1[46] ⎕wi "onMouseDown" "∆HelpField←'#' ⎕wi 'focus' "[47] list←list OVER "fmDisplayFit.bnDisplay_FitQuit"[48] ⎕wself←"fmDisplayFit.bnDisplay_FitQuit" ⎕wi "New" "Button"[49] ⎕wi "style" 2[50] ⎕wi "deferexit" 1[51] ⎕wi "extent" (size←1×buttonsize×1⌈CharSize÷13 6)[52] x←0.5×⍴where←Win∆Calcwhere 1,(¯10-size[1]),1,buttonwhere←buttonwhere-5+size[2][53] ⎕wi "∆where" ((x,2)⍴where)[54] ⎕wi "where" (("fmDisplayFit" ⎕wi "size") Win∆Resize ⎕wi "∆where")[55] ⎕wi "tooltip" "Quit and Return"[56] ⎕wi "onClick" ("fmSV.mDisplay_FitFile.mQuit"⎕wi "onClick")[57] ⎕wi "caption" "Quit"[58] ⎕wi "∆helpid" 4092[59] ⎕wi "order" .5[60] ⎕wi "visible" ¯1[61] ControlName ⎕wi "∆quitbutton" "fmDisplayFit.bnDisplay_FitQuit"[62] list←list OVER "fmDisplayFit.bnDisplay_FitSave"[63] ⎕wself←"fmDisplayFit.bnDisplay_FitSave" ⎕wi "New" "Button"[64] ⎕wi "extent" (size←1×buttonsize×1⌈CharSize÷13 6)[65] x←0.5×⍴where←Win∆Calcwhere 1,(¯10-size[1]),1,buttonwhere←buttonwhere-5+size[2][66] ⎕wi "∆where" ((x,2)⍴where)[67] ⎕wi "where" (("fmDisplayFit" ⎕wi "size") Win∆Resize ⎕wi "∆where")[68] ⎕wi "tooltip" "Save Parameters"[69] ⎕wi "onClick" ("fmSV.mDisplay_FitFile.mSave"⎕wi "onClick")[70] ⎕wi "caption" "Save"[71] :if buttonimage[72]     ⎕wi "imagelist" "fmSV.iStandard"[73]     ⎕wi "imageindex" 9[74] :endif[75] ⎕wi "∆helpid" 4093[76] ⎕wi "enabled" 0[77] ⎕wi "order" .5[78] ⎕wi "visible" ¯1[79] "fmDisplayFit" ⎕wi "onModified" "('Display_Fit' 'fmDisplayFit.bnDisplay_FitSave') Win∆SaveEnabled (0≠⎕warg[1])"[80] "fmDisplayFit" ⎕wi "∆modified" 1[81] [82] ⎕wself←"fmDisplayFit.lvFittedTables" ⎕wi "New" "Listview"[83] Fieldlist←Fieldlist OVER "fmDisplayFit.lvFittedTables"[84] Fieldcontrol←Fieldcontrol OVER "Listview"[85] ⎕wi "∆name" "FittedTables"[86] ⎕wi "∆type" "Listview"[87] ⎕wi "∆mandatory" 1[88] ⎕wi "∆helpid" 4094[89] ⎕wi "tooltip" "Select the Fitted Table to be displayed"[90] list←list OVER "fmDisplayFit.lvFittedTables"[91] ⎕wi "scale" 5[92] ⎕wi "viewmode" "report"[93] ⎕wi "style" 1 4 8[94] ⎕wi "∆where" (4 2⍴0 0 0 0 0.85 0 1 0)[95] ⎕wi "where" (("fmDisplayFit" ⎕wi "size") Win∆Resize (4 2⍴0 0 0 0 0.85 0 1 0))[96] ⎕wi "∆update" "FitDetails"[97] (PickList NameList sortorder SortList)←4↑FitDetails[98] ⎕wi "list" PickList[99] NameList[;1]←NameList[;1],¨⊂4↑" "[100] ⎕wi "columndisplay" NameList[101] ⎕wi "AutoFit" "header" "all"[102] ⎕wi "∆sortorder" sortorder[103] ⎕wi "∆sortlist" SortList[104] ⎕wi "onColClick" "('fmDisplayFit.lvFittedTables' 'Display_Fit') Win∆SortListview ⎕warg"[105] :if 0=⎕nc "listviewDict"[106] listviewDict←MATRIX keysIn ListviewDict[107] :endif[108] :if ~mt sortorder←DLTB ↑((ListviewDict for "Control" "fmDisplayFit.lvFittedTables") for "Parameters" "") at "Sort"[109] ("fmDisplayFit.lvFittedTables" "Display_Fit") Win∆SortListview sortorder[110] :else[111] ("fmDisplayFit.lvFittedTables" "Display_Fit") Win∆SortListview ""[112] :endif[113] ⎕wi "onResize" "Win∆SizeListview ⎕wi 'self'"[114] ⎕wi "onSelect" "0 0⍴(⊂⎕wi 'name') Display_Fit 'Change' "[115] ⎕wi "onExit" "⎕wres←0 List∆CHECK 'fmDisplayFit.lvFittedTables'"[116] ⎕wi "onExitError" "Win∆ExitError ⎕warg"[117] [118] "fmDisplayFit" ⎕wi "∆multifile" ""[119] "fmDisplayFit" ⎕wi "∆singlefile" ""[120] "fmDisplayFit" ⎕wi "∆format" ""[121] "fmDisplayFit" ⎕wi "∆financial" 0[122] "fmDisplayFit" ⎕wi "∆relrules" 0[123] "fmDisplayFit" ⎕wi "∆parm" 0[124] "fmDisplayFit" ⎕wi "∆decr" 0[125] "fmDisplayFit" ⎕wi "∆file" 0[126] "fmDisplayFit" ⎕wi "∆codefile" CodeFile[127] "fmDisplayFit" ⎕wi "∆inputstype" ""[128] "fmDisplayFit" ⎕wi "∆inputsentry" ""[129] "fmDisplayFit" ⎕wi "∆savecn" (⍳0)[130] "fmDisplayFit" ⎕wi "∆savedesc" ""[131] list←list OVER "fmDisplayFit"[132] "fmDisplayFit" ⎕wi "∆fieldlist" Fieldlist[133] "fmDisplayFit" ⎕wi "∆fieldcontrol" Fieldcontrol[134] childlist←"fmSV" ⎕wi "∆childlist"[135] list←(⊃¯1↑childlist) OVER list[136] childlist[⍴childlist]←⊂list[137] "fmSV" ⎕wi "∆childlist" childlist[138] list←,⎕split list[139] 0 0⍴((∨/¨(⊂".mDisplay_Fit")⍷¨list)/list) MultiWI "enabled" 1[140] :if 300<fnsize[141]     (fnsize fnsize ".") Win∆ProgressBar "MemberUpdate"[142]     Win∆ProgressBar "Hide"[143] :endif[144] "Init" OpenParameters "Display_Fit"[145] "fmDisplayFit.bnDisplay_FitHelp" ⎕wi "visible" 1[146] "fmDisplayFit.bnDisplay_FitQuit" ⎕wi "visible" 1[147] "fmDisplayFit.bnDisplay_FitSave" ⎕wi "visible" 1[148] "#" ⎕wi "focus" "fmDisplayFit.lvFittedTables"[149] :if ~0∊⍴,Error←Win∆Initialise "Display_Fit"[150]     "Quit" EndModule Module[151]     "fmSV" ⎕wi "pointer" 0[152]     0 0⍴"fmDisplayFit" ⎕wi "Delete"[153]     :return[154] :endif[155] :if bar_open←commandbar^"Multi"≡""[156]     bar_open←0×"fmDisplayFit.mDisplay_FitFile.m" Win∆CommandBar "SaveHelp"[157] :endif[158] "fmDisplayFit" ⎕wi "Paint"[159] "fmSV" ⎕wi "pointer" 11[160] "fmDisplayFit" ⎕wi "onWait" "0 0⍴Display_Fit 'Wait' ⋄ 'fmDisplayFit' ⎕wi 'modified' 0"[161] 0 0⍴"fmDisplayFit" ⎕wi "Wait"[162] 0 0⍴"fmDisplayFit" ⎕wi "Delete"[163] "fmSV" ⎕wi "pointer" 0 ∇