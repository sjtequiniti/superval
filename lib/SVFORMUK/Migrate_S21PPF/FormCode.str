∇ Container←Form_Make;⎕wself;ControlName;childlist;list;Fieldlist;Fieldcontrol;FrameWidth;Caption;buttonsize;buttonwhere;where;size;alignment;Header;PickList;NameList;value;sortorder;SortList;MaxRow;MaxCol;Parent;level;node;no;nn;NN;x;fnsize;framelist;relTests[1] [2] Fieldlist←Fieldcontrol←list←0 0⍴""[3] "fmSV" ⎕wi "pointer" 13[4] buttonsize←25 65 ⋄ buttonwhere←¯5[5] FormName ⎕wi "caption" ((FormName ⎕wi "caption")," - Migrating Superval/21 PPF Library Files")[6] "fmSV" ⎕wi "∆caption" (("fmSV" ⎕wi "∆caption"),⊂("fmSV" ⎕wi "caption"))[7] :if 300<fnsize←1↑⍴⎕cr "Form_Make"[8]     "Generating Form" Win∆ProgressBar "Open"[9]     ("Menu Items:" "Form Controls:") Win∆ProgressBar "SetLabels"[10]     (1 1 "Help About") Win∆ProgressBar "FileUpdate"[11] :endif[12] [13] Container←"∆Wizard"[14] [15] ⎕wself←"fmMigS21PPF" ⎕wi "New" "Form" "Hide"[16] ⎕wi "caption" ("fmSV" ⎕wi "caption")[17] ⎕wi "scale" 5[18] ⎕wi "font" ("fmSV" ⎕wi "font")[19] ⎕wi "border" 2 32 64[20] ⎕wi "where" (Win∆CentrePos .70 .98×768 1024×1⌈CharSize÷13 6)[21] ⎕wi "limitwhere" (0.8×¯2↑⎕wi "where")[22] ⎕wi "tooltipwidth" 200[23] ⎕wi "onResize" "AutoResize"[24] ⎕wi "onClose" "ExitSystem ''"[25] ControlName←"fmMigS21PPF"[26] relTests←0[27] 0 Menu_Make "fmSV"[28] 0 Menu_Make "fmMigS21PPF"[29] "fmMigS21PPF" Win∆CutCopyPaste "Build"[30] list←list OVER "fmMigS21PPF.bnMigrate_S21PPFHelp"[31] ⎕wself←"fmMigS21PPF.bnMigrate_S21PPFHelp" ⎕wi "New" "Button"[32] ⎕wi "deferexit" 1[33] ⎕wi "extent" (size←1×buttonsize×1⌈CharSize÷13 6)[34] x←0.5×⍴where←Win∆Calcwhere 1,(¯10-size[1]),1,buttonwhere←buttonwhere-5+size[2][35] ⎕wi "∆where" ((x,2)⍴where)[36] ⎕wi "where" (("fmMigS21PPF" ⎕wi "size") Win∆Resize ⎕wi "∆where")[37] ⎕wi "tooltip" "SuperVal Help"[38] ⎕wi "onClick" ("fmSV.mMigrate_S21PPFHelp.mContext"⎕wi "onClick")[39] ⎕wi "caption" "Help"[40] :if buttonimage[41]     ⎕wi "imagelist" "fmSV.iStandard"[42]     ⎕wi "imageindex" 12[43] :endif[44] ⎕wi "visible" ¯1[45] ⎕wi "onMouseDown" "∆HelpField←'#' ⎕wi 'focus' "[46] list←list OVER "fmMigS21PPF.bnMigrate_S21PPFQuit"[47] ⎕wself←"fmMigS21PPF.bnMigrate_S21PPFQuit" ⎕wi "New" "Button"[48] ⎕wi "style" 2[49] ⎕wi "deferexit" 1[50] ⎕wi "extent" (size←1×buttonsize×1⌈CharSize÷13 6)[51] x←0.5×⍴where←Win∆Calcwhere 1,(¯10-size[1]),1,buttonwhere←buttonwhere-5+size[2][52] ⎕wi "∆where" ((x,2)⍴where)[53] ⎕wi "where" (("fmMigS21PPF" ⎕wi "size") Win∆Resize ⎕wi "∆where")[54] ⎕wi "tooltip" "Cancel and Return"[55] ⎕wi "onClick" ("fmSV.mMigrate_S21PPFFile.mQuit"⎕wi "onClick")[56] ⎕wi "caption" "Cancel"[57] ⎕wi "∆helpid" 3868[58] ⎕wi "order" .5[59] ⎕wi "visible" ¯1[60] list←list OVER "fmMigS21PPF.bnMigrate_S21PPFNext"[61] ⎕wself←"fmMigS21PPF.bnMigrate_S21PPFNext" ⎕wi "New" "Button"[62] ⎕wi "style" 1[63] ⎕wi "extent" (size←1×buttonsize×1⌈CharSize÷13 6)[64] x←0.5×⍴where←Win∆Calcwhere 1,(¯10-size[1]),1,buttonwhere←buttonwhere-5+size[2][65] ⎕wi "∆where" ((x,2)⍴where)[66] ⎕wi "where" (("fmMigS21PPF" ⎕wi "size") Win∆Resize ⎕wi "∆where")[67] ⎕wi "tooltip" "Move on to Next Form"[68] ⎕wi "onClick" ("fmSV.mMigrate_S21PPFFile.mNext"⎕wi "onClick")[69] ⎕wi "caption" "Next"[70] :if buttonimage[71]     ⎕wi "imagelist" "fmSV.iStandard"[72]     ⎕wi "imageindex" 29[73] :endif[74] ⎕wi "∆helpid" 3869[75] list←list OVER "fmMigS21PPF.bnMigrate_S21PPFBack"[76] ⎕wself←"fmMigS21PPF.bnMigrate_S21PPFBack" ⎕wi "New" "Button"[77] ⎕wi "enabled" (0)[78] ⎕wi "extent" (size←1×buttonsize×1⌈CharSize÷13 6)[79] x←0.5×⍴where←Win∆Calcwhere 1,(¯10-size[1]),1,buttonwhere←buttonwhere-5+size[2][80] ⎕wi "∆where" ((x,2)⍴where)[81] ⎕wi "where" (("fmMigS21PPF" ⎕wi "size") Win∆Resize ⎕wi "∆where")[82] ⎕wi "tooltip" "Move back to Previous Form"[83] ⎕wi "onClick" ("fmSV.mMigrate_S21PPFFile.mBack"⎕wi "onClick")[84] ⎕wi "caption" "Back"[85] :if buttonimage[86]     ⎕wi "imagelist" "fmSV.iStandard"[87]     ⎕wi "imageindex" 28[88] :endif[89] ⎕wi "∆helpid" 3870[90] framelist←0 0⍴""[91] [92] :if 300<fnsize[93]     ((1↑⎕lc) fnsize "FrameV - PPF Sets Selections") Win∆ProgressBar "MemberUpdate"[94] :endif[95] [96] ⎕wself←"fmMigS21PPF.fSets" ⎕wi "New" "Frame"[97] ⎕wi "scale" 5[98] ⎕wi "∆where" (4 2⍴0 0 0 0 1 ¯45 1 0)[99] ⎕wi "where" (("fmMigS21PPF" ⎕wi "size") Win∆Resize (4 2⍴0 0 0 0 1 ¯45 1 0))[100] ⎕wi "caption" "PPF Sets Selections"[101] ⎕wi "style" 0[102] ⎕wi "onResize" "AutoResize"[103] framelist←framelist OVER "fmMigS21PPF.fSets"[104] [105] ⎕wself←"fmMigS21PPF.fSets.lvPPFSets" ⎕wi "New" "Listview"[106] Fieldlist←Fieldlist OVER "fmMigS21PPF.fSets.lvPPFSets"[107] Fieldcontrol←Fieldcontrol OVER "Listview"[108] ⎕wi "∆name" "PPFSets"[109] ⎕wi "∆type" "ListviewM"[110] ⎕wi "∆mandatory" 1[111] ⎕wi "∆helpid" 3871[112] ⎕wi "tooltip" "Select the Superval/21 PPF Library Files/Sets you wish to be migrated"[113] list←list OVER "fmMigS21PPF.fSets.lvPPFSets"[114] ⎕wi "scale" 5[115] ⎕wi "viewmode" "report"[116] ⎕wi "style" 1 4 0[117] ⎕wi "∆where" (4 2⍴0.05 0 0.01 0 0.9 0 0.98 0)[118] ⎕wi "where" (("fmMigS21PPF.fSets" ⎕wi "size") Win∆Resize (4 2⍴0.05 0 0.01 0 0.9 0 0.98 0))[119] ⎕wi "∆update" "GetPPFSets"[120] (PickList NameList sortorder SortList)←4↑GetPPFSets[121] ⎕wi "list" PickList[122] NameList[;1]←NameList[;1],¨⊂4↑" "[123] ⎕wi "columndisplay" NameList[124] ⎕wi "AutoFit" "header" "all"[125] ⎕wi "∆sortorder" sortorder[126] ⎕wi "∆sortlist" SortList[127] ⎕wi "onColClick" "('fmMigS21PPF.fSets.lvPPFSets' 'Migrate_S21PPF') Win∆SortListview ⎕warg"[128] :if 0=⎕nc "listviewDict"[129] listviewDict←MATRIX keysIn ListviewDict[130] :endif[131] :if ~mt sortorder←DLTB ↑((ListviewDict for "Control" "fmMigS21PPF.fSets.lvPPFSets") for "Parameters" "") at "Sort"[132] ("fmMigS21PPF.fSets.lvPPFSets" "Migrate_S21PPF") Win∆SortListview sortorder[133] :else[134] ("fmMigS21PPF.fSets.lvPPFSets" "Migrate_S21PPF") Win∆SortListview "PPF Folder"[135] :endif[136] ⎕wi "onResize" "Win∆SizeListview ⎕wi 'self'"[137] ⎕wi "onPaint" "0 Sel∆LabelUpdate 'fmMigS21PPF.fSets.lvPPFSets' "[138] ⎕wi "onSelect" "0 Sel∆LabelUpdate 'fmMigS21PPF.fSets.lvPPFSets' ⋄ 0 0⍴(⊂⎕wi 'name') Migrate_S21PPF 'Change' "[139] ⎕wi "onExit" "⍎(0∊⍴,⎕wres←0 List∆CHECK 'fmMigS21PPF.fSets.lvPPFSets')/'0 0⍴(⊂⎕wi ''name'') Migrate_S21PPF ''Change'' ' "[140] ⎕wi "onExitError" "Win∆ExitError ⎕warg"[141] ⎕wi "∆rightlabel" "fmMigS21PPF.fSets.lrPPFSets"[142] [143] ⎕wself←"fmMigS21PPF.fSets.lrPPFSets" ⎕wi "New" "Label"[144] ⎕wi "scale" 5[145] ⎕wi "extent" (CharSize×¯2↑1,19)[146] ⎕wi "style" 32[147] ⎕wi "caption" " "[148] where←4↑,"fmMigS21PPF.fSets.lvPPFSets" ⎕wi "∆where"[149] x←0.5×⍴where←Win∆Calcwhere where+((5+1↑2↓"fmMigS21PPF.fSets.lvPPFSets" ⎕wi "where") CDIV 1↑"fmMigS21PPF.fSets" ⎕wi "size"),0 0 0[150] ⎕wi "∆where" ((x,2)⍴where)[151] ⎕wi "where" (("fmMigS21PPF.fSets" ⎕wi "size") Win∆Resize ⎕wi "∆where")[152] [153] :if 300<fnsize[154]     ((1↑⎕lc) fnsize "FrameV - PPF Library Parameters - Anomalies Report") Win∆ProgressBar "MemberUpdate"[155] :endif[156] [157] ⎕wself←"fmMigS21PPF.fAnomaly" ⎕wi "New" "Frame"[158] ⎕wi "scale" 5[159] ⎕wi "∆where" (4 2⍴0 0 0 0 1 ¯45 1 0)[160] ⎕wi "where" (("fmMigS21PPF" ⎕wi "size") Win∆Resize (4 2⍴0 0 0 0 1 ¯45 1 0))[161] ⎕wi "caption" "PPF Library Parameters - Anomalies Report"[162] ⎕wi "style" 0[163] ⎕wi "onResize" "AutoResize"[164] framelist←framelist OVER "fmMigS21PPF.fAnomaly"[165] [166] ⎕wself←"fmMigS21PPF.fAnomaly.webAnomaly" ⎕wi "New" "Microsoft Web Browser"[167] Fieldlist←Fieldlist OVER "fmMigS21PPF.fAnomaly.webAnomaly"[168] Fieldcontrol←Fieldcontrol OVER "Microsoft Web Browser"[169] ⎕wi "∆name" "Anomaly"[170] ⎕wi "∆type" "Web"[171] ⎕wi "∆helpid" 3872[172] ⎕wi "∆where" (4 2⍴0.05 0 0.01 0 0.9 0 0.98 0)[173] ⎕wi "where" (("fmMigS21PPF.fAnomaly" ⎕wi "size") Win∆Resize (4 2⍴0.05 0 0.01 0 0.9 0 0.98 0))[174] [175] :if 300<fnsize[176]     ((1↑⎕lc) fnsize "FrameV - PPF Library Parameters - Summary Report") Win∆ProgressBar "MemberUpdate"[177] :endif[178] [179] ⎕wself←"fmMigS21PPF.fSummary" ⎕wi "New" "Frame"[180] ⎕wi "scale" 5[181] ⎕wi "∆where" (4 2⍴0 0 0 0 1 ¯45 1 0)[182] ⎕wi "where" (("fmMigS21PPF" ⎕wi "size") Win∆Resize (4 2⍴0 0 0 0 1 ¯45 1 0))[183] ⎕wi "caption" "PPF Library Parameters - Summary Report"[184] ⎕wi "style" 0[185] ⎕wi "onResize" "AutoResize"[186] framelist←framelist OVER "fmMigS21PPF.fSummary"[187] [188] ⎕wself←"fmMigS21PPF.fSummary.webSummary" ⎕wi "New" "Microsoft Web Browser"[189] Fieldlist←Fieldlist OVER "fmMigS21PPF.fSummary.webSummary"[190] Fieldcontrol←Fieldcontrol OVER "Microsoft Web Browser"[191] ⎕wi "∆name" "Summary"[192] ⎕wi "∆type" "Web"[193] ⎕wi "∆helpid" 3873[194] ⎕wi "∆where" (4 2⍴0.05 0 0.01 0 0.9 0 0.98 0)[195] ⎕wi "where" (("fmMigS21PPF.fSummary" ⎕wi "size") Win∆Resize (4 2⍴0.05 0 0.01 0 0.9 0 0.98 0))[196] [197] :if 300<fnsize[198]     ((1↑⎕lc) fnsize "FrameV - Files/Parameters Overwrites Report") Win∆ProgressBar "MemberUpdate"[199] :endif[200] [201] ⎕wself←"fmMigS21PPF.fOverwrite" ⎕wi "New" "Frame"[202] ⎕wi "scale" 5[203] ⎕wi "∆where" (4 2⍴0 0 0 0 1 ¯45 1 0)[204] ⎕wi "where" (("fmMigS21PPF" ⎕wi "size") Win∆Resize (4 2⍴0 0 0 0 1 ¯45 1 0))[205] ⎕wi "caption" "Files/Parameters Overwrites Report"[206] ⎕wi "style" 0[207] ⎕wi "onResize" "AutoResize"[208] framelist←framelist OVER "fmMigS21PPF.fOverwrite"[209] [210] ⎕wself←"fmMigS21PPF.fOverwrite.webOverwrite" ⎕wi "New" "Microsoft Web Browser"[211] Fieldlist←Fieldlist OVER "fmMigS21PPF.fOverwrite.webOverwrite"[212] Fieldcontrol←Fieldcontrol OVER "Microsoft Web Browser"[213] ⎕wi "∆name" "Overwrite"[214] ⎕wi "∆type" "Web"[215] ⎕wi "∆helpid" 3874[216] ⎕wi "∆where" (4 2⍴0.05 0 0.01 0 0.9 0 0.98 0)[217] ⎕wi "where" (("fmMigS21PPF.fOverwrite" ⎕wi "size") Win∆Resize (4 2⍴0.05 0 0.01 0 0.9 0 0.98 0))[218] [219] "fmMigS21PPF" ⎕wi "∆multifile" ""[220] "fmMigS21PPF" ⎕wi "∆singlefile" ""[221] "fmMigS21PPF" ⎕wi "∆format" ""[222] "fmMigS21PPF" ⎕wi "∆financial" 0[223] "fmMigS21PPF" ⎕wi "∆relrules" 0[224] "fmMigS21PPF" ⎕wi "∆parm" 0[225] "fmMigS21PPF" ⎕wi "∆decr" 0[226] "fmMigS21PPF" ⎕wi "∆file" 0[227] "fmMigS21PPF" ⎕wi "∆codefile" CodeFile[228] "fmMigS21PPF" ⎕wi "∆inputstype" ""[229] "fmMigS21PPF" ⎕wi "∆inputsentry" ""[230] "fmMigS21PPF" ⎕wi "∆savecn" (⍳0)[231] "fmMigS21PPF" ⎕wi "∆savedesc" ""[232] list←list OVER "fmMigS21PPF"[233] "fmMigS21PPF" ⎕wi "∆fieldlist" Fieldlist[234] "fmMigS21PPF" ⎕wi "∆fieldcontrol" Fieldcontrol[235] childlist←"fmSV" ⎕wi "∆childlist"[236] list←(⊃¯1↑childlist) OVER list[237] childlist[⍴childlist]←⊂list[238] "fmSV" ⎕wi "∆childlist" childlist[239] list←,⎕split list[240] 0 0⍴((∨/¨(⊂".mMigrate_S21PPF")⍷¨list)/list) MultiWI "enabled" 1[241] :if 300<fnsize[242]     (fnsize fnsize ".") Win∆ProgressBar "MemberUpdate"[243]     Win∆ProgressBar "Hide"[244] :endif[245] "Init" OpenParameters "Migrate_S21PPF"[246] "fmMigS21PPF.bnMigrate_S21PPFHelp" ⎕wi "visible" 1[247] "fmMigS21PPF.bnMigrate_S21PPFQuit" ⎕wi "visible" 1[248] "#" ⎕wi "focus" "fmMigS21PPF.fSets.lvPPFSets"[249] "fmMigS21PPF" ⎕wi "∆framelist" framelist[250] (⎕split 1 0↓framelist) MultiWI "visible" ¯1[251] :if ~0∊⍴,Error←Win∆Initialise "Migrate_S21PPF"[252]     "Quit" EndModule Module[253]     "fmSV" ⎕wi "pointer" 0[254]     0 0⍴"fmMigS21PPF" ⎕wi "Delete"[255]     :return[256] :endif[257] :if bar_open←commandbar^"Multi"≡""[258]     bar_open←0×"fmMigS21PPF.mMigrate_S21PPFFile.m" Win∆CommandBar "CancelHelp"[259] :endif[260] "fmMigS21PPF" ⎕wi "Paint"[261] "fmSV" ⎕wi "pointer" 11[262] "fmMigS21PPF" ⎕wi "onWait" "0 0⍴Migrate_S21PPF 'Wait' ⋄ 'fmMigS21PPF' ⎕wi 'modified' 0"[263] 0 0⍴"fmMigS21PPF" ⎕wi "Wait"[264] 0 0⍴"fmMigS21PPF" ⎕wi "Delete"[265] "fmSV" ⎕wi "pointer" 0 ∇