∇ Container←Form_Make;⎕wself;ControlName;childlist;list;Fieldlist;Fieldcontrol;FrameWidth;Caption;buttonsize;buttonwhere;where;size;alignment;Header;PickList;NameList;value;sortorder;SortList;MaxRow;MaxCol;Parent;level;node;no;nn;NN;x;fnsize;framelist;relTests[1] [2] Fieldlist←Fieldcontrol←list←0 0⍴""[3] "fmSV" ⎕wi "pointer" 13[4] buttonsize←25 65 ⋄ buttonwhere←¯5[5] FormName ⎕wi "caption" ((FormName ⎕wi "caption")," - Display of Financial Assumptions")[6] "fmSV" ⎕wi "∆caption" (("fmSV" ⎕wi "∆caption"),⊂("fmSV" ⎕wi "caption"))[7] :if 300<fnsize←1↑⍴⎕cr "Form_Make"[8]     "Generating Form" Win∆ProgressBar "Open"[9]     ("Menu Items:" "Form Controls:") Win∆ProgressBar "SetLabels"[10]     (1 1 "Help About") Win∆ProgressBar "FileUpdate"[11] :endif[12] [13] Container←"∆Dialog"[14] [15] ⎕wself←"fmFin_Display" ⎕wi "New" "Form" "Hide"[16] ⎕wi "caption" ("fmSV" ⎕wi "caption")[17] ⎕wi "scale" 5[18] ⎕wi "font" ("fmSV" ⎕wi "font")[19] ⎕wi "border" 2 32 64[20] ⎕wi "where" (Win∆CentrePos 1 1 ×768 1024×1⌈CharSize÷13 6)[21] ⎕wi "limitwhere" (0.8×¯2↑⎕wi "where")[22] ⎕wi "tooltipwidth" 200[23] ⎕wi "onResize" "AutoResize"[24] ⎕wi "onClose" "ExitSystem ''"[25] ControlName←"fmFin_Display"[26] relTests←0[27] 0 Menu_Make "fmSV"[28] 0 Menu_Make "fmFin_Display"[29] "fmFin_Display" Win∆CutCopyPaste "Build"[30] "fmFin_Display" ⎕wi "∆helpid" 2148[31] list←list OVER "fmFin_Display.bnFinancials_DisplayHelp"[32] ⎕wself←"fmFin_Display.bnFinancials_DisplayHelp" ⎕wi "New" "Button"[33] ⎕wi "deferexit" 1[34] ⎕wi "extent" (size←1×buttonsize×1⌈CharSize÷13 6)[35] x←0.5×⍴where←Win∆Calcwhere 1,(¯10-size[1]),1,buttonwhere←buttonwhere-5+size[2][36] ⎕wi "∆where" ((x,2)⍴where)[37] ⎕wi "where" (("fmFin_Display" ⎕wi "size") Win∆Resize ⎕wi "∆where")[38] ⎕wi "tooltip" "SuperVal Help"[39] ⎕wi "onClick" ("fmSV.mFinancials_DisplayHelp.mContext"⎕wi "onClick")[40] ⎕wi "caption" "Help"[41] :if buttonimage[42]     ⎕wi "imagelist" "fmSV.iStandard"[43]     ⎕wi "imageindex" 12[44] :endif[45] ⎕wi "visible" ¯1[46] ⎕wi "onMouseDown" "∆HelpField←'#' ⎕wi 'focus' "[47] list←list OVER "fmFin_Display.bnFinancials_DisplayQuit"[48] ⎕wself←"fmFin_Display.bnFinancials_DisplayQuit" ⎕wi "New" "Button"[49] ⎕wi "style" 2[50] ⎕wi "deferexit" 1[51] ⎕wi "extent" (size←1×buttonsize×1⌈CharSize÷13 6)[52] x←0.5×⍴where←Win∆Calcwhere 1,(¯10-size[1]),1,buttonwhere←buttonwhere-5+size[2][53] ⎕wi "∆where" ((x,2)⍴where)[54] ⎕wi "where" (("fmFin_Display" ⎕wi "size") Win∆Resize ⎕wi "∆where")[55] ⎕wi "tooltip" "Quit and Return"[56] ⎕wi "onClick" ("fmSV.mFinancials_DisplayFile.mQuit"⎕wi "onClick")[57] ⎕wi "caption" "Quit"[58] ⎕wi "∆helpid" 4141[59] ⎕wi "order" .5[60] ⎕wi "visible" ¯1[61] ControlName ⎕wi "∆quitbutton" "fmFin_Display.bnFinancials_DisplayQuit"[62] "fmFin_Display" ⎕wi "∆modified" 1[63] "fmFin_Display" ⎕wi "∆audit" 1[64] [65] ⎕wself←"fmFin_Display.trFinancials" ⎕wi "New" "Tree"[66] Fieldlist←Fieldlist OVER "fmFin_Display.trFinancials"[67] Fieldcontrol←Fieldcontrol OVER "Tree"[68] ⎕wi "∆name" "Financials"[69] ⎕wi "∆type" "Tree"[70] ⎕wi "∆helpid" 4142[71] ⎕wi "tooltip" "Browse the Sets of Financial Assumptions
Right-click a Financials Set to open the selected Financials Set
Shift-Right-click a Financials Set to produce an Audit Report on the selected Financials Set
Right-click Top Node to select Sort Order of Financials Sets"[72] ⎕wi "style" 0 8[73] ⎕wi "∆where" (4 2⍴0 0 0 0 1 ¯45 1 0)[74] ⎕wi "where" (("fmFin_Display" ⎕wi "size") Win∆Resize (4 2⍴0 0 0 0 1 ¯45 1 0))[75] PickList←FinancialsIndex[76] Win∆PopulateTree PickList "Financial Assumptions"[77] ⎕wi "onChange" "0 0⍴(⊂⎕wi 'name') Financials_Display 'Change'"[78] ⎕wgive 0[79] list←list OVER "fmFin_Display.bnFinancials_DisplayModify"[80] ⎕wself←"fmFin_Display.bnFinancials_DisplayModify" ⎕wi "New" "Button"[81] ⎕wi "extent" (size←1.4 1×buttonsize×1⌈CharSize÷13 6)[82] x←0.5×⍴where←Win∆Calcwhere 1,(¯10-size[1]),1,buttonwhere←buttonwhere-5+size[2][83] ⎕wi "∆where" ((x,2)⍴where)[84] ⎕wi "where" (("fmFin_Display" ⎕wi "size") Win∆Resize ⎕wi "∆where")[85] ⎕wi "tooltip" "Add a New or Edit an Existing Set of Financial Assumptions"[86] ⎕wi "onClick" ("fmSV.mFinancials_DisplayFile.mModify"⎕wi "onClick")[87] ⎕wi "∆helpid" 4143[88] ⎕wi "caption" (("⍺",⎕tcnl) char_replace "Add/Edit⍺Financials")[89] list←list OVER "fmFin_Display.bnFinancials_DisplaySelect"[90] ⎕wself←"fmFin_Display.bnFinancials_DisplaySelect" ⎕wi "New" "Button"[91] ⎕wi "extent" (size←1.4 1×buttonsize×1⌈CharSize÷13 6)[92] x←0.5×⍴where←Win∆Calcwhere 1,(¯10-size[1]),1,buttonwhere←buttonwhere-5+size[2][93] ⎕wi "∆where" ((x,2)⍴where)[94] ⎕wi "where" (("fmFin_Display" ⎕wi "size") Win∆Resize ⎕wi "∆where")[95] ⎕wi "tooltip" "Select Set of Financial Assumptions that is Currently being used"[96] ⎕wi "onClick" ("fmSV.mFinancials_DisplayFile.mSelect"⎕wi "onClick")[97] ⎕wi "∆helpid" 4144[98] ⎕wi "caption" (("⍺",⎕tcnl) char_replace "Select as⍺Current")[99] list←list OVER "fmFin_Display.bnFinancials_DisplayAudit"[100] ⎕wself←"fmFin_Display.bnFinancials_DisplayAudit" ⎕wi "New" "Button"[101] ⎕wi "extent" (size←1.4 1×buttonsize×1⌈CharSize÷13 6)[102] x←0.5×⍴where←Win∆Calcwhere 1,(¯10-size[1]),1,buttonwhere←buttonwhere-5+size[2][103] ⎕wi "∆where" ((x,2)⍴where)[104] ⎕wi "where" (("fmFin_Display" ⎕wi "size") Win∆Resize ⎕wi "∆where")[105] ⎕wi "tooltip" "Audit Report of Selected Sets of Financial Assumptions being used"[106] ⎕wi "onClick" ("fmSV.mFinancials_DisplayFile.mAudit"⎕wi "onClick")[107] ⎕wi "∆helpid" 4145[108] ⎕wi "caption" (("⍺",⎕tcnl) char_replace "Audit⍺Selections")[109] [110] "fmFin_Display" ⎕wi "∆multifile" ""[111] "fmFin_Display" ⎕wi "∆singlefile" ""[112] "fmFin_Display" ⎕wi "∆format" ""[113] "fmFin_Display" ⎕wi "∆financial" 0[114] "fmFin_Display" ⎕wi "∆relrules" 0[115] "fmFin_Display" ⎕wi "∆parm" 0[116] "fmFin_Display" ⎕wi "∆decr" 0[117] "fmFin_Display" ⎕wi "∆file" 0[118] "fmFin_Display" ⎕wi "∆codefile" CodeFile[119] "fmFin_Display" ⎕wi "∆inputstype" "ClientFile"[120] "fmFin_Display" ⎕wi "∆inputsentry" "Single"[121] "fmFin_Display" ⎕wi "∆savecn" (⍳0)[122] "fmFin_Display" ⎕wi "∆savedesc" ""[123] list←list OVER "fmFin_Display"[124] "fmFin_Display" ⎕wi "∆fieldlist" Fieldlist[125] "fmFin_Display" ⎕wi "∆fieldcontrol" Fieldcontrol[126] childlist←"fmSV" ⎕wi "∆childlist"[127] list←(⊃¯1↑childlist) OVER list[128] childlist[⍴childlist]←⊂list[129] "fmSV" ⎕wi "∆childlist" childlist[130] list←,⎕split list[131] 0 0⍴((∨/¨(⊂".mFinancials_Display")⍷¨list)/list) MultiWI "enabled" 1[132] :if 300<fnsize[133]     (fnsize fnsize ".") Win∆ProgressBar "MemberUpdate"[134]     Win∆ProgressBar "Hide"[135] :endif[136] "Init" OpenParameters "Financials_Display"[137] "fmFin_Display.bnFinancials_DisplayHelp" ⎕wi "visible" 1[138] "fmFin_Display.bnFinancials_DisplayQuit" ⎕wi "visible" 1[139] "#" ⎕wi "focus" "fmFin_Display.trFinancials"[140] :if ~0∊⍴,Error←Win∆Initialise "Financials_Display"[141]     "Quit" EndModule Module[142]     "fmSV" ⎕wi "pointer" 0[143]     0 0⍴"fmFin_Display" ⎕wi "Delete"[144]     :return[145] :endif[146] :if bar_open←commandbar^"Multi"≡"Single"[147]     bar_open←0×"fmFin_Display.mFinancials_DisplayFile.m" Win∆CommandBar "QuitHelp"[148] :endif[149] "fmFin_Display" ⎕wi "Paint"[150] "fmSV" ⎕wi "pointer" 11[151] "fmFin_Display" ⎕wi "onWait" "0 0⍴Financials_Display 'Wait' ⋄ 'fmFin_Display' ⎕wi 'modified' 0"[152] 0 0⍴"fmFin_Display" ⎕wi "Wait"[153] 0 0⍴"fmFin_Display" ⎕wi "Delete"[154] "fmSV" ⎕wi "pointer" 0 ∇