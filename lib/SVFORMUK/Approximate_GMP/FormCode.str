∇ Container←Form_Make;⎕wself;ControlName;childlist;list;Fieldlist;Fieldcontrol;FrameWidth;Caption;buttonsize;buttonwhere;where;size;alignment;Header;PickList;NameList;value;sortorder;SortList;MaxRow;MaxCol;Parent;level;node;no;nn;NN;x;fnsize;framelist;relTests[1] [2] Fieldlist←Fieldcontrol←list←0 0⍴""[3] "fmSV" ⎕wi "pointer" 13[4] buttonsize←25 65 ⋄ buttonwhere←¯5[5] FormName ⎕wi "caption" ((FormName ⎕wi "caption")," - Approximate GMP Calculator")[6] "fmSV" ⎕wi "∆caption" (("fmSV" ⎕wi "∆caption"),⊂("fmSV" ⎕wi "caption"))[7] :if 300<fnsize←1↑⍴⎕cr "Form_Make"[8]     "Generating Form" Win∆ProgressBar "Open"[9]     ("Menu Items:" "Form Controls:") Win∆ProgressBar "SetLabels"[10]     (1 1 "Help About") Win∆ProgressBar "FileUpdate"[11] :endif[12] [13] Container←"∆Dialog"[14] [15] ⎕wself←"fmApproximate_GMP" ⎕wi "New" "Form" "Hide"[16] ⎕wi "caption" ("fmSV" ⎕wi "caption")[17] ⎕wi "scale" 5[18] ⎕wi "font" ("fmSV" ⎕wi "font")[19] ⎕wi "border" 2 32 64[20] ⎕wi "where" (Win∆CentrePos .80 .50×768 1024×1⌈CharSize÷13 6)[21] ⎕wi "limitwhere" (0.8×¯2↑⎕wi "where")[22] ⎕wi "tooltipwidth" 200[23] ⎕wi "onResize" "AutoResize"[24] ⎕wi "onClose" "ExitSystem ''"[25] ControlName←"fmApproximate_GMP"[26] relTests←0[27] 0 Menu_Make "fmSV"[28] 1 Menu_Make "fmApproximate_GMP"[29] "fmApproximate_GMP" Win∆CutCopyPaste "Build"[30] "fmApproximate_GMP" ⎕wi "∆helpid" 2061[31] list←list OVER "fmApproximate_GMP.bnApproximate_GMPHelp"[32] ⎕wself←"fmApproximate_GMP.bnApproximate_GMPHelp" ⎕wi "New" "Button"[33] ⎕wi "deferexit" 1[34] ⎕wi "extent" (size←1×buttonsize×1⌈CharSize÷13 6)[35] x←0.5×⍴where←Win∆Calcwhere 1,(¯10-size[1]),1,buttonwhere←buttonwhere-5+size[2][36] ⎕wi "∆where" ((x,2)⍴where)[37] ⎕wi "where" (("fmApproximate_GMP" ⎕wi "size") Win∆Resize ⎕wi "∆where")[38] ⎕wi "tooltip" "SuperVal Help"[39] ⎕wi "onClick" ("fmSV.mApproximate_GMPHelp.mContext"⎕wi "onClick")[40] ⎕wi "caption" "Help"[41] :if buttonimage[42]     ⎕wi "imagelist" "fmSV.iStandard"[43]     ⎕wi "imageindex" 12[44] :endif[45] ⎕wi "visible" ¯1[46] ⎕wi "onMouseDown" "∆HelpField←'#' ⎕wi 'focus' "[47] list←list OVER "fmApproximate_GMP.bnApproximate_GMPQuit"[48] ⎕wself←"fmApproximate_GMP.bnApproximate_GMPQuit" ⎕wi "New" "Button"[49] ⎕wi "style" 2[50] ⎕wi "deferexit" 1[51] ⎕wi "extent" (size←1×buttonsize×1⌈CharSize÷13 6)[52] x←0.5×⍴where←Win∆Calcwhere 1,(¯10-size[1]),1,buttonwhere←buttonwhere-5+size[2][53] ⎕wi "∆where" ((x,2)⍴where)[54] ⎕wi "where" (("fmApproximate_GMP" ⎕wi "size") Win∆Resize ⎕wi "∆where")[55] ⎕wi "tooltip" "Quit and Return"[56] ⎕wi "onClick" ("fmSV.mApproximate_GMPFile.mQuit"⎕wi "onClick")[57] ⎕wi "caption" "Quit"[58] ⎕wi "∆helpid" 3543[59] ⎕wi "order" .5[60] ⎕wi "visible" ¯1[61] ControlName ⎕wi "∆quitbutton" "fmApproximate_GMP.bnApproximate_GMPQuit"[62] list←list OVER "fmApproximate_GMP.bnApproximate_GMPSave"[63] ⎕wself←"fmApproximate_GMP.bnApproximate_GMPSave" ⎕wi "New" "Button"[64] ⎕wi "extent" (size←1×buttonsize×1⌈CharSize÷13 6)[65] x←0.5×⍴where←Win∆Calcwhere 1,(¯10-size[1]),1,buttonwhere←buttonwhere-5+size[2][66] ⎕wi "∆where" ((x,2)⍴where)[67] ⎕wi "where" (("fmApproximate_GMP" ⎕wi "size") Win∆Resize ⎕wi "∆where")[68] ⎕wi "tooltip" "Save Parameters"[69] ⎕wi "onClick" ("fmSV.mApproximate_GMPFile.mSave"⎕wi "onClick")[70] ⎕wi "caption" "Save"[71] :if buttonimage[72]     ⎕wi "imagelist" "fmSV.iStandard"[73]     ⎕wi "imageindex" 9[74] :endif[75] ⎕wi "∆helpid" 3544[76] ⎕wi "enabled" 0[77] ⎕wi "order" .5[78] ⎕wi "visible" ¯1[79] "fmApproximate_GMP" ⎕wi "onModified" "('Approximate_GMP' 'fmApproximate_GMP.bnApproximate_GMPSave') Win∆SaveEnabled (0≠⎕warg[1])"[80] list←list OVER "fmApproximate_GMP.bnApproximate_GMPSaveAs"[81] ⎕wself←"fmApproximate_GMP.bnApproximate_GMPSaveAs" ⎕wi "New" "Button"[82] ⎕wi "extent" (size←1×buttonsize×1⌈CharSize÷13 6)[83] x←0.5×⍴where←Win∆Calcwhere 1,(¯10-size[1]),1,buttonwhere←buttonwhere-5+size[2][84] ⎕wi "∆where" ((x,2)⍴where)[85] ⎕wi "where" (("fmApproximate_GMP" ⎕wi "size") Win∆Resize ⎕wi "∆where")[86] ⎕wi "tooltip" "Save Parameters As ..."[87] ⎕wi "onClick" ("fmSV.mApproximate_GMPFile.mSaveAs"⎕wi "onClick")[88] ⎕wi "caption" "Save As"[89] ⎕wi "∆helpid" 3545[90] ⎕wi "order" .5[91] ⎕wi "visible" ¯1[92] list←list OVER "fmApproximate_GMP.bnApproximate_GMPRun"[93] ⎕wself←"fmApproximate_GMP.bnApproximate_GMPRun" ⎕wi "New" "Button"[94] ⎕wi "style" 1[95] ⎕wi "extent" (size←1×buttonsize×1⌈CharSize÷13 6)[96] x←0.5×⍴where←Win∆Calcwhere 1,(¯10-size[1]),1,buttonwhere←buttonwhere-5+size[2][97] ⎕wi "∆where" ((x,2)⍴where)[98] ⎕wi "where" (("fmApproximate_GMP" ⎕wi "size") Win∆Resize ⎕wi "∆where")[99] ⎕wi "tooltip" "Save Parameters and Run Approximate GMP Calculator"[100] ⎕wi "onClick" ("fmSV.mApproximate_GMPFile.mRun"⎕wi "onClick")[101] ⎕wi "caption" "Run"[102] :if buttonimage[103]     ⎕wi "imagelist" "fmSV.iStandard"[104]     ⎕wi "imageindex" 33[105] :endif[106] ⎕wi "∆helpid" 3546[107] ⎕wi "order" .5[108] ⎕wi "visible" ¯1[109] [110] ⎕wself←"fmApproximate_GMP.cbCalcDATE" ⎕wi "New" "Combo"[111] Fieldlist←Fieldlist OVER "fmApproximate_GMP.cbCalcDATE"[112] Fieldcontrol←Fieldcontrol OVER "Combo"[113] ⎕wi "∆name" "CalcDATE"[114] ⎕wi "∆type" "Date"[115] ⎕wi "∆mandatory" 1[116] ⎕wi "∆helpid" 3547[117] ⎕wi "tooltip" "Specify the Calculation Date at which GMP is calculated by selecting from the list of Standard Dates or specifying an alternate Date"[118] ⎕wi "limit" 10[119] ⎕wi "onExit" "⍎(mt ,⎕wres←0 INPUT∆CHECK 'fmApproximate_GMP.cbCalcDATE')/'0 0⍴(⊂⎕wi ''name'') Approximate_GMP ''Change'' ' "[120] ⎕wi "onExitError" "Win∆ExitError ⎕warg"[121] ⎕wi "onKeyPress" "⎕wres←¯2×~⎕warg∊8 32 45 46 47 48 49 50 51 52 53 54 55 56 57"[122] ⎕wi "onKeyDown" "(⎕wi 'self') ChangesDates ⎕warg"[123] ⎕wi "style" 16 128 256 0[124] ⎕wi "∆where" (2 2⍴0.02 0 0.3 0)[125] ⎕wi "where" (("fmApproximate_GMP" ⎕wi "size") Win∆Resize (2 2⍴0.02 0 0.3 0))[126] PickList←0 GetAbsDateList 'Fund'[127] ⎕wi "∆update" "0 GetAbsDateList 'Fund'"[128] PickList←⊃m2n 1 0↓PickList[129] PickList←" " OVER PickList[130] ⎕wi "list" PickList[131] ⎕wi "extent" (150,(¯10+6×¯1↑CharSize)+¯1↑(50×CharSize)⌊Win∆TextSize PickList)[132] ⎕wi "onClick" "(⎕wi 'self') Win∆LabelUpdate ⊃¨(AbsDict for 'Type' 'Date' ) at 'Parameter' 'List' ⋄ 0 0⍴(⊂⎕wi 'name') Approximate_GMP 'Change' "[133] ⎕wi "onChange" "Win∆ComboFudge ⎕wi 'self' ⋄ (⎕wi 'self') Win∆LabelUpdate ⊃¨(AbsDict for 'Type' 'Date' ) at 'Parameter' 'List' ⋄ 0 0⍴(⊂⎕wi 'name') Approximate_GMP 'Change' "[134] ⎕wi "∆rightlabel" "fmApproximate_GMP.lrCalcDATE"[135] [136] ⎕wself←"fmApproximate_GMP.lrCalcDATE" ⎕wi "New" "Label"[137] ⎕wi "scale" 5[138] ⎕wi "extent" (CharSize×¯2↑1,10)[139] ⎕wi "style" 32[140] ⎕wi "caption" " "[141] where←4↑,"fmApproximate_GMP.cbCalcDATE" ⎕wi "∆where"[142] x←0.5×⍴where←Win∆Calcwhere where+0,3,0,10+¯1↑"fmApproximate_GMP.cbCalcDATE" ⎕wi "extent"[143] ⎕wi "∆where" ((x,2)⍴where)[144] ⎕wi "where" (("fmApproximate_GMP" ⎕wi "size") Win∆Resize ⎕wi "∆where")[145] [146] ⎕wself←"fmApproximate_GMP.llCalcDATE" ⎕wi "New" "Label"[147] ⎕wi "scale" 5[148] ⎕wi "style" 2[149] ⎕wi "extent" (↑⎕wi "Draw" ("?text" "Calculation Date"))[150] ⎕wi "caption" "Calculation Date"[151] where←4↑,"fmApproximate_GMP.cbCalcDATE" ⎕wi "∆where"[152] x←0.5×⍴where←Win∆Calcwhere where-0 ¯3 0,10+¯1↑⎕wi "extent"[153] ⎕wi "∆where" ((x,2)⍴where)[154] ⎕wi "where" (("fmApproximate_GMP" ⎕wi "size") Win∆Resize ⎕wi "∆where")[155] [156] ⎕wself←"fmApproximate_GMP.edfILENAME" ⎕wi "New" "Edit"[157] Fieldlist←Fieldlist OVER "fmApproximate_GMP.edfILENAME"[158] Fieldcontrol←Fieldcontrol OVER "Edit"[159] ⎕wi "∆name" "fILENAME"[160] ⎕wi "∆type" "File"[161] ⎕wi "∆mandatory" 1[162] ⎕wi "∆valid" ('Data' 'Single')[163] ⎕wi "∆helpid" 3548[164] ⎕wi "tooltip" "Specify the Input Data File
(Double Click for Open File Dialog)"[165] ⎕wi "∆where" (2 2⍴0.12 0 0.3 0)[166] ⎕wi "where" (("fmApproximate_GMP" ⎕wi "size") Win∆Resize (2 2⍴0.12 0 0.3 0))[167] ⎕wi "onExit" "⍎(0∊⍴,⎕wres←0 INPUT∆CHECK 'fmApproximate_GMP.edfILENAME')/'0 0⍴(⊂⎕wi ''name'') Approximate_GMP ''Change'' ' "[168] ⎕wi "onExitError" "Win∆ExitError ⎕warg"[169] ⎕wi "extent" (2+CharSize×1 31)[170] ⎕wi "pointer" ">cur 1001 shell32.dll"[171] ⎕wi "onMouseDouble" "'Data Single' GetFileList 'Single' "[172] ⎕wi "targetformats" "FileName"[173] ⎕wi "onDrop" "'fmApproximate_GMP.edfILENAME' Win∆DropTarget 0 ('Data' 'Single')"[174] ⎕wi "onFocus" "GetAbsFileList 'Fund'"[175] ⎕wi "onMouseDown" "'fmApproximate_GMP.edfILENAME' ⎕wi 'Focus' ⋄ 0 Win∆PopupMenu FilesDesc FilesList"[176] ⎕wi "onChange" "(⎕wi 'self') Win∆LabelUpdate FilesDesc FilesList ⋄ 0 0⍴(⊂⎕wi 'name') Approximate_GMP 'Change' "[177] ⎕wi "∆rightlabel" "fmApproximate_GMP.lrfILENAME"[178] [179] ⎕wself←"fmApproximate_GMP.lrfILENAME" ⎕wi "New" "Label"[180] ⎕wi "scale" 5[181] ⎕wi "extent" (CharSize×¯2↑1,30)[182] ⎕wi "style" 32[183] ⎕wi "caption" " "[184] where←4↑,"fmApproximate_GMP.edfILENAME" ⎕wi "∆where"[185] x←0.5×⍴where←Win∆Calcwhere where+0,3,0,10+¯1↑"fmApproximate_GMP.edfILENAME" ⎕wi "extent"[186] ⎕wi "∆where" ((x,2)⍴where)[187] ⎕wi "where" (("fmApproximate_GMP" ⎕wi "size") Win∆Resize ⎕wi "∆where")[188] [189] ⎕wself←"fmApproximate_GMP.llfILENAME" ⎕wi "New" "Label"[190] ⎕wi "scale" 5[191] ⎕wi "style" 2[192] ⎕wi "extent" (↑⎕wi "Draw" ("?text" "Input Data File"))[193] ⎕wi "caption" "Input Data File"[194] where←4↑,"fmApproximate_GMP.edfILENAME" ⎕wi "∆where"[195] x←0.5×⍴where←Win∆Calcwhere where-0 ¯3 0,10+¯1↑⎕wi "extent"[196] ⎕wi "∆where" ((x,2)⍴where)[197] ⎕wi "where" (("fmApproximate_GMP" ⎕wi "size") Win∆Resize ⎕wi "∆where")[198] [199] ⎕wself←"fmApproximate_GMP.cbFormat" ⎕wi "New" "Combo"[200] Fieldlist←Fieldlist OVER "fmApproximate_GMP.cbFormat"[201] Fieldcontrol←Fieldcontrol OVER "Combo"[202] ⎕wi "∆name" "Format"[203] ⎕wi "∆type" "Format"[204] ⎕wi "∆mandatory" 1[205] ⎕wi "∆valid" ('A')[206] ⎕wi "∆helpid" 3549[207] ⎕wi "tooltip" "Select the Data Format of the Input Data File"[208] ⎕wi "style" 16 128 256 2[209] ⎕wi "∆where" (2 2⍴0.22 0 0.3 0)[210] ⎕wi "where" (("fmApproximate_GMP" ⎕wi "size") Win∆Resize (2 2⍴0.22 0 0.3 0))[211] PickList←Formats 'A'[212] ⎕wi "∆update" "Formats 'A'"[213] PickList←⊃m2n 1 0↓PickList[214] ⎕wi "list" PickList[215] ⎕wi "extent" (150,(¯10+6×¯1↑CharSize)+¯1↑(50×CharSize)⌊Win∆TextSize PickList)[216] ⎕wi "onClick" "(⎕wi 'self') Win∆LabelUpdate ⊃¨(AbsDict for 'Type' 'Format') at 'Description' 'Parameter' ⋄ 0 0⍴(⊂⎕wi 'name') Approximate_GMP 'Change' ⋄ UpdateDataVars"[217] ⎕wi "∆rightlabel" "fmApproximate_GMP.lrFormat"[218] [219] ⎕wself←"fmApproximate_GMP.lrFormat" ⎕wi "New" "Label"[220] ⎕wi "scale" 5[221] ⎕wi "extent" (CharSize×¯2↑1,40)[222] ⎕wi "style" 32[223] ⎕wi "caption" " "[224] where←4↑,"fmApproximate_GMP.cbFormat" ⎕wi "∆where"[225] x←0.5×⍴where←Win∆Calcwhere where+0,3,0,10+¯1↑"fmApproximate_GMP.cbFormat" ⎕wi "extent"[226] ⎕wi "∆where" ((x,2)⍴where)[227] ⎕wi "where" (("fmApproximate_GMP" ⎕wi "size") Win∆Resize ⎕wi "∆where")[228] [229] ⎕wself←"fmApproximate_GMP.llFormat" ⎕wi "New" "Label"[230] ⎕wi "scale" 5[231] ⎕wi "style" 2[232] ⎕wi "extent" (↑⎕wi "Draw" ("?text" "Data Format"))[233] ⎕wi "caption" "Data Format"[234] where←4↑,"fmApproximate_GMP.cbFormat" ⎕wi "∆where"[235] x←0.5×⍴where←Win∆Calcwhere where-0 ¯3 0,10+¯1↑⎕wi "extent"[236] ⎕wi "∆where" ((x,2)⍴where)[237] ⎕wi "where" (("fmApproximate_GMP" ⎕wi "size") Win∆Resize ⎕wi "∆where")[238] [239] ⎕wself←"fmApproximate_GMP.edFILE" ⎕wi "New" "Edit"[240] Fieldlist←Fieldlist OVER "fmApproximate_GMP.edFILE"[241] Fieldcontrol←Fieldcontrol OVER "Edit"[242] ⎕wi "∆name" "FILE"[243] ⎕wi "∆type" "File"[244] ⎕wi "∆mandatory" 1[245] ⎕wi "∆valid" ('New' 'Single')[246] ⎕wi "∆helpid" 3550[247] ⎕wi "tooltip" "Specify the Output Data File
(Double Click for Open File Dialog)"[248] ⎕wi "∆where" (2 2⍴0.32 0 0.3 0)[249] ⎕wi "where" (("fmApproximate_GMP" ⎕wi "size") Win∆Resize (2 2⍴0.32 0 0.3 0))[250] ⎕wi "onExit" "⍎(0∊⍴,⎕wres←0 INPUT∆CHECK 'fmApproximate_GMP.edFILE')/'0 0⍴(⊂⎕wi ''name'') Approximate_GMP ''Change'' ' "[251] ⎕wi "onExitError" "Win∆ExitError ⎕warg"[252] ⎕wi "extent" (2+CharSize×1 31)[253] ⎕wi "pointer" ">cur 1001 shell32.dll"[254] ⎕wi "onMouseDouble" "'New Single' GetFileList 'Single' "[255] ⎕wi "targetformats" "FileName"[256] ⎕wi "onDrop" "'fmApproximate_GMP.edFILE' Win∆DropTarget 0 ('New' 'Single')"[257] ⎕wi "onChange" "0 0⍴(⊂⎕wi 'name') Approximate_GMP 'Change' "[258] [259] ⎕wself←"fmApproximate_GMP.llFILE" ⎕wi "New" "Label"[260] ⎕wi "scale" 5[261] ⎕wi "style" 2[262] ⎕wi "extent" (↑⎕wi "Draw" ("?text" "Output Data File"))[263] ⎕wi "caption" "Output Data File"[264] where←4↑,"fmApproximate_GMP.edFILE" ⎕wi "∆where"[265] x←0.5×⍴where←Win∆Calcwhere where-0 ¯3 0,10+¯1↑⎕wi "extent"[266] ⎕wi "∆where" ((x,2)⍴where)[267] ⎕wi "where" (("fmApproximate_GMP" ⎕wi "size") Win∆Resize ⎕wi "∆where")[268] [269] ⎕wself←"fmApproximate_GMP.cbSAL" ⎕wi "New" "Combo"[270] Fieldlist←Fieldlist OVER "fmApproximate_GMP.cbSAL"[271] Fieldcontrol←Fieldcontrol OVER "Combo"[272] ⎕wi "∆name" "SAL"[273] ⎕wi "∆type" "Char"[274] ⎕wi "∆mandatory" 1[275] ⎕wi "∆helpid" 3551[276] ⎕wi "tooltip" "Select the Salary to be used in the Calculation"[277] ⎕wi "style" 16 128 256 2[278] ⎕wi "∆where" (2 2⍴0.42 0 0.3 0)[279] ⎕wi "where" (("fmApproximate_GMP" ⎕wi "size") Win∆Resize (2 2⍴0.42 0 0.3 0))[280] PickList←GetVarNumList 'Salary'[281] ⎕wi "∆update" "GetVarNumList 'Salary'"[282] PickList←⊃m2n 1 0↓PickList[283] ⎕wi "list" PickList[284] ⎕wi "extent" (150,(¯10+6×¯1↑CharSize)+¯1↑Win∆TextSize ((0,⎕wi "limit")⌈⍴PickList)↑PickList)[285] ⎕wi "onClick" "0 0⍴(⊂⎕wi 'name') Approximate_GMP 'Change' "[286] [287] ⎕wself←"fmApproximate_GMP.llSAL" ⎕wi "New" "Label"[288] ⎕wi "scale" 5[289] ⎕wi "style" 2[290] ⎕wi "extent" (↑⎕wi "Draw" ("?text" "Salary"))[291] ⎕wi "caption" "Salary"[292] where←4↑,"fmApproximate_GMP.cbSAL" ⎕wi "∆where"[293] x←0.5×⍴where←Win∆Calcwhere where-0 ¯3 0,10+¯1↑⎕wi "extent"[294] ⎕wi "∆where" ((x,2)⍴where)[295] ⎕wi "where" (("fmApproximate_GMP" ⎕wi "size") Win∆Resize ⎕wi "∆where")[296] [297] ⎕wself←"fmApproximate_GMP.cblel" ⎕wi "New" "Combo"[298] Fieldlist←Fieldlist OVER "fmApproximate_GMP.cblel"[299] Fieldcontrol←Fieldcontrol OVER "Combo"[300] ⎕wi "∆name" "lel"[301] ⎕wi "∆type" "Num"[302] ⎕wi "∆mandatory" 1[303] ⎕wi "∆valid" ('Int' 'Scalar' '0+')[304] ⎕wi "∆helpid" 3552[305] ⎕wi "tooltip" "Select the Lower Earnings Limit"[306] ⎕wi "∆range" "0 30000"[307] ⎕wi "limit" 5[308] ⎕wi "onExit" "⍎(mt ,⎕wres←0 INPUT∆CHECK 'fmApproximate_GMP.cblel')/'0 0⍴(⊂⎕wi ''name'') Approximate_GMP ''Change'' ' "[309] ⎕wi "onExitError" "Win∆ExitError ⎕warg"[310] ⎕wi "onKeyPress" "⎕wres←¯2×~⎕warg∊8 32 48 49 50 51 52 53 54 55 56 57"[311] ⎕wi "style" 16 128 256 0[312] ⎕wi "∆where" (2 2⍴0.52 0 0.3 0)[313] ⎕wi "where" (("fmApproximate_GMP" ⎕wi "size") Win∆Resize (2 2⍴0.52 0 0.3 0))[314] PickList←GetFactors 'LEL'[315] ⎕wi "∆update" "GetFactors 'LEL'"[316] PickList←⊃m2n 1 0↓PickList[317] PickList←" " OVER PickList[318] ⎕wi "list" PickList[319] ⎕wi "extent" (150,(¯10+8×¯1↑CharSize)+¯1↑Win∆TextSize ((0,⎕wi "limit")⌈⍴PickList)↑PickList)[320] ⎕wi "onClick" "0 0⍴(⊂⎕wi 'name') Approximate_GMP 'Change' "[321] [322] ⎕wself←"fmApproximate_GMP.lllel" ⎕wi "New" "Label"[323] ⎕wi "scale" 5[324] ⎕wi "style" 2[325] ⎕wi "extent" (↑⎕wi "Draw" ("?text" "Lower Earnings Limit"))[326] ⎕wi "caption" "Lower Earnings Limit"[327] where←4↑,"fmApproximate_GMP.cblel" ⎕wi "∆where"[328] x←0.5×⍴where←Win∆Calcwhere where-0 ¯3 0,10+¯1↑⎕wi "extent"[329] ⎕wi "∆where" ((x,2)⍴where)[330] ⎕wi "where" (("fmApproximate_GMP" ⎕wi "size") Win∆Resize ⎕wi "∆where")[331] [332] ⎕wself←"fmApproximate_GMP.cbuel" ⎕wi "New" "Combo"[333] Fieldlist←Fieldlist OVER "fmApproximate_GMP.cbuel"[334] Fieldcontrol←Fieldcontrol OVER "Combo"[335] ⎕wi "∆name" "uel"[336] ⎕wi "∆type" "Num"[337] ⎕wi "∆mandatory" 1[338] ⎕wi "∆valid" ('Int' 'Scalar' '0+')[339] ⎕wi "∆helpid" 3553[340] ⎕wi "tooltip" "Select the Upper Earnings Limit"[341] ⎕wi "∆range" "0 80000"[342] ⎕wi "limit" 5[343] ⎕wi "onExit" "⍎(mt ,⎕wres←0 INPUT∆CHECK 'fmApproximate_GMP.cbuel')/'0 0⍴(⊂⎕wi ''name'') Approximate_GMP ''Change'' ' "[344] ⎕wi "onExitError" "Win∆ExitError ⎕warg"[345] ⎕wi "onKeyPress" "⎕wres←¯2×~⎕warg∊8 32 48 49 50 51 52 53 54 55 56 57"[346] ⎕wi "style" 16 128 256 0[347] ⎕wi "∆where" (2 2⍴0.62 0 0.3 0)[348] ⎕wi "where" (("fmApproximate_GMP" ⎕wi "size") Win∆Resize (2 2⍴0.62 0 0.3 0))[349] PickList←GetFactors 'UEL'[350] ⎕wi "∆update" "GetFactors 'UEL'"[351] PickList←⊃m2n 1 0↓PickList[352] PickList←" " OVER PickList[353] ⎕wi "list" PickList[354] ⎕wi "extent" (150,(¯10+8×¯1↑CharSize)+¯1↑Win∆TextSize ((0,⎕wi "limit")⌈⍴PickList)↑PickList)[355] ⎕wi "onClick" "0 0⍴(⊂⎕wi 'name') Approximate_GMP 'Change' "[356] [357] ⎕wself←"fmApproximate_GMP.lluel" ⎕wi "New" "Label"[358] ⎕wi "scale" 5[359] ⎕wi "style" 2[360] ⎕wi "extent" (↑⎕wi "Draw" ("?text" "Upper Earnings Limit"))[361] ⎕wi "caption" "Upper Earnings Limit"[362] where←4↑,"fmApproximate_GMP.cbuel" ⎕wi "∆where"[363] x←0.5×⍴where←Win∆Calcwhere where-0 ¯3 0,10+¯1↑⎕wi "extent"[364] ⎕wi "∆where" ((x,2)⍴where)[365] ⎕wi "where" (("fmApproximate_GMP" ⎕wi "size") Win∆Resize ⎕wi "∆where")[366] [367] ⎕wself←"fmApproximate_GMP.cbBDATE" ⎕wi "New" "Combo"[368] Fieldlist←Fieldlist OVER "fmApproximate_GMP.cbBDATE"[369] Fieldcontrol←Fieldcontrol OVER "Combo"[370] ⎕wi "∆name" "BDATE"[371] ⎕wi "∆type" "Date"[372] ⎕wi "∆mandatory" 1[373] ⎕wi "∆helpid" 3554[374] ⎕wi "tooltip" "Specify the Minimum Start Date by selecting from the list of Standard Dates or specifying an alternate Date"[375] ⎕wi "limit" 10[376] ⎕wi "onExit" "⍎(mt ,⎕wres←0 INPUT∆CHECK 'fmApproximate_GMP.cbBDATE')/'0 0⍴(⊂⎕wi ''name'') Approximate_GMP ''Change'' ' "[377] ⎕wi "onExitError" "Win∆ExitError ⎕warg"[378] ⎕wi "onKeyPress" "⎕wres←¯2×~⎕warg∊8 32 45 46 47 48 49 50 51 52 53 54 55 56 57"[379] ⎕wi "onKeyDown" "(⎕wi 'self') ChangesDates ⎕warg"[380] ⎕wi "style" 16 128 256 0[381] ⎕wi "∆where" (2 2⍴0.72 0 0.3 0)[382] ⎕wi "where" (("fmApproximate_GMP" ⎕wi "size") Win∆Resize (2 2⍴0.72 0 0.3 0))[383] PickList←0 GetAbsDateList 'Fund'[384] ⎕wi "∆update" "0 GetAbsDateList 'Fund'"[385] PickList←⊃m2n 1 0↓PickList[386] PickList←" " OVER PickList[387] ⎕wi "list" PickList[388] ⎕wi "extent" (150,(¯10+6×¯1↑CharSize)+¯1↑(50×CharSize)⌊Win∆TextSize PickList)[389] ⎕wi "onClick" "(⎕wi 'self') Win∆LabelUpdate ⊃¨(AbsDict for 'Type' 'Date' ) at 'Parameter' 'List' ⋄ 0 0⍴(⊂⎕wi 'name') Approximate_GMP 'Change' "[390] ⎕wi "onChange" "Win∆ComboFudge ⎕wi 'self' ⋄ (⎕wi 'self') Win∆LabelUpdate ⊃¨(AbsDict for 'Type' 'Date' ) at 'Parameter' 'List' ⋄ 0 0⍴(⊂⎕wi 'name') Approximate_GMP 'Change' "[391] ⎕wi "∆rightlabel" "fmApproximate_GMP.lrBDATE"[392] [393] ⎕wself←"fmApproximate_GMP.lrBDATE" ⎕wi "New" "Label"[394] ⎕wi "scale" 5[395] ⎕wi "extent" (CharSize×¯2↑1,10)[396] ⎕wi "style" 32[397] ⎕wi "caption" " "[398] where←4↑,"fmApproximate_GMP.cbBDATE" ⎕wi "∆where"[399] x←0.5×⍴where←Win∆Calcwhere where+0,3,0,10+¯1↑"fmApproximate_GMP.cbBDATE" ⎕wi "extent"[400] ⎕wi "∆where" ((x,2)⍴where)[401] ⎕wi "where" (("fmApproximate_GMP" ⎕wi "size") Win∆Resize ⎕wi "∆where")[402] [403] ⎕wself←"fmApproximate_GMP.llBDATE" ⎕wi "New" "Label"[404] ⎕wi "scale" 5[405] ⎕wi "style" 2[406] ⎕wi "extent" (↑⎕wi "Draw" ("?text" "Minimum Start Date"))[407] ⎕wi "caption" "Minimum Start Date"[408] where←4↑,"fmApproximate_GMP.cbBDATE" ⎕wi "∆where"[409] x←0.5×⍴where←Win∆Calcwhere where-0 ¯3 0,10+¯1↑⎕wi "extent"[410] ⎕wi "∆where" ((x,2)⍴where)[411] ⎕wi "where" (("fmApproximate_GMP" ⎕wi "size") Win∆Resize ⎕wi "∆where")[412] [413] ⎕wself←"fmApproximate_GMP.cbEDATE" ⎕wi "New" "Combo"[414] Fieldlist←Fieldlist OVER "fmApproximate_GMP.cbEDATE"[415] Fieldcontrol←Fieldcontrol OVER "Combo"[416] ⎕wi "∆name" "EDATE"[417] ⎕wi "∆type" "Date"[418] ⎕wi "∆mandatory" 1[419] ⎕wi "∆helpid" 3555[420] ⎕wi "tooltip" "Specify the Maximum Finish Date by selecting from the list of Standard Dates or specifying an alternate Date"[421] ⎕wi "limit" 10[422] ⎕wi "onExit" "⍎(mt ,⎕wres←0 INPUT∆CHECK 'fmApproximate_GMP.cbEDATE')/'0 0⍴(⊂⎕wi ''name'') Approximate_GMP ''Change'' ' "[423] ⎕wi "onExitError" "Win∆ExitError ⎕warg"[424] ⎕wi "onKeyPress" "⎕wres←¯2×~⎕warg∊8 32 45 46 47 48 49 50 51 52 53 54 55 56 57"[425] ⎕wi "onKeyDown" "(⎕wi 'self') ChangesDates ⎕warg"[426] ⎕wi "style" 16 128 256 0[427] ⎕wi "∆where" (2 2⍴0.82 0 0.3 0)[428] ⎕wi "where" (("fmApproximate_GMP" ⎕wi "size") Win∆Resize (2 2⍴0.82 0 0.3 0))[429] PickList←0 GetAbsDateList 'Fund'[430] ⎕wi "∆update" "0 GetAbsDateList 'Fund'"[431] PickList←⊃m2n 1 0↓PickList[432] PickList←" " OVER PickList[433] ⎕wi "list" PickList[434] ⎕wi "extent" (150,(¯10+6×¯1↑CharSize)+¯1↑(50×CharSize)⌊Win∆TextSize PickList)[435] ⎕wi "onClick" "(⎕wi 'self') Win∆LabelUpdate ⊃¨(AbsDict for 'Type' 'Date' ) at 'Parameter' 'List' ⋄ 0 0⍴(⊂⎕wi 'name') Approximate_GMP 'Change' "[436] ⎕wi "onChange" "Win∆ComboFudge ⎕wi 'self' ⋄ (⎕wi 'self') Win∆LabelUpdate ⊃¨(AbsDict for 'Type' 'Date' ) at 'Parameter' 'List' ⋄ 0 0⍴(⊂⎕wi 'name') Approximate_GMP 'Change' "[437] ⎕wi "∆rightlabel" "fmApproximate_GMP.lrEDATE"[438] [439] ⎕wself←"fmApproximate_GMP.lrEDATE" ⎕wi "New" "Label"[440] ⎕wi "scale" 5[441] ⎕wi "extent" (CharSize×¯2↑1,10)[442] ⎕wi "style" 32[443] ⎕wi "caption" " "[444] where←4↑,"fmApproximate_GMP.cbEDATE" ⎕wi "∆where"[445] x←0.5×⍴where←Win∆Calcwhere where+0,3,0,10+¯1↑"fmApproximate_GMP.cbEDATE" ⎕wi "extent"[446] ⎕wi "∆where" ((x,2)⍴where)[447] ⎕wi "where" (("fmApproximate_GMP" ⎕wi "size") Win∆Resize ⎕wi "∆where")[448] [449] ⎕wself←"fmApproximate_GMP.llEDATE" ⎕wi "New" "Label"[450] ⎕wi "scale" 5[451] ⎕wi "style" 2[452] ⎕wi "extent" (↑⎕wi "Draw" ("?text" "Maximum End Date"))[453] ⎕wi "caption" "Maximum End Date"[454] where←4↑,"fmApproximate_GMP.cbEDATE" ⎕wi "∆where"[455] x←0.5×⍴where←Win∆Calcwhere where-0 ¯3 0,10+¯1↑⎕wi "extent"[456] ⎕wi "∆where" ((x,2)⍴where)[457] ⎕wi "where" (("fmApproximate_GMP" ⎕wi "size") Win∆Resize ⎕wi "∆where")[458] [459] ⎕wself←"fmApproximate_GMP.lParmDesc" ⎕wi "New" "Label"[460] ⎕wi "scale" 5[461] ⎕wi "extent" (CharSize×¯2↑1,80)[462] ⎕wi "style" 32[463] ⎕wi "caption" " "[464] ⎕wi "∆where" (2 2⍴0.92 0 0.02 0)[465] ⎕wi "where" (("fmApproximate_GMP" ⎕wi "size") Win∆Resize (2 2⍴0.92 0 0.02 0))[466] [467] "fmApproximate_GMP" ⎕wi "∆multifile" ""[468] "fmApproximate_GMP" ⎕wi "∆singlefile" "fmApproximate_GMP.edfILENAME"[469] "fmApproximate_GMP" ⎕wi "∆format" "fmApproximate_GMP.cbFormat"[470] "fmApproximate_GMP" ⎕wi "∆financial" 0[471] "fmApproximate_GMP" ⎕wi "∆relrules" 0[472] "fmApproximate_GMP" ⎕wi "∆parm" 0[473] "fmApproximate_GMP" ⎕wi "∆decr" 0[474] "fmApproximate_GMP" ⎕wi "∆file" 1[475] "fmApproximate_GMP" ⎕wi "∆codefile" CodeFile[476] "fmApproximate_GMP" ⎕wi "∆inputstype" "ClientFile"[477] "fmApproximate_GMP" ⎕wi "∆inputsentry" "Multi"[478] "fmApproximate_GMP" ⎕wi "∆savecn" (⍳0)[479] "fmApproximate_GMP" ⎕wi "∆savedesc" ""[480] list←list OVER "fmApproximate_GMP"[481] "fmApproximate_GMP" ⎕wi "∆fieldlist" Fieldlist[482] "fmApproximate_GMP" ⎕wi "∆fieldcontrol" Fieldcontrol[483] childlist←"fmSV" ⎕wi "∆childlist"[484] list←(⊃¯1↑childlist) OVER list[485] childlist[⍴childlist]←⊂list[486] "fmSV" ⎕wi "∆childlist" childlist[487] list←,⎕split list[488] 0 0⍴((∨/¨(⊂".mApproximate_GMP")⍷¨list)/list) MultiWI "enabled" 1[489] :if 300<fnsize[490]     (fnsize fnsize ".") Win∆ProgressBar "MemberUpdate"[491]     Win∆ProgressBar "Hide"[492] :endif[493] "Init" OpenParameters "Approximate_GMP"[494] "fmApproximate_GMP.bnApproximate_GMPHelp" ⎕wi "visible" 1[495] "fmApproximate_GMP.bnApproximate_GMPQuit" ⎕wi "visible" 1[496] "fmApproximate_GMP.bnApproximate_GMPSave" ⎕wi "visible" 1[497] "fmApproximate_GMP.bnApproximate_GMPSaveAs" ⎕wi "visible" 1[498] "fmApproximate_GMP.bnApproximate_GMPRun" ⎕wi "visible" 1[499] "#" ⎕wi "focus" "fmApproximate_GMP.cbCalcDATE"[500] :if ~0∊⍴,Error←Win∆Initialise "Approximate_GMP"[501]     "Quit" EndModule Module[502]     "fmSV" ⎕wi "pointer" 0[503]     0 0⍴"fmApproximate_GMP" ⎕wi "Delete"[504]     :return[505] :endif[506] :if bar_open←commandbar^"Multi"≡"Multi"[507]     bar_open←0×"fmApproximate_GMP.mApproximate_GMPFile.m" Win∆CommandBar "RunAsHelp"[508] :endif[509] "fmApproximate_GMP" ⎕wi "Paint"[510] "fmSV" ⎕wi "pointer" 11[511] "fmApproximate_GMP" ⎕wi "onWait" "0 0⍴Approximate_GMP 'Wait' ⋄ 'fmApproximate_GMP' ⎕wi 'modified' 0"[512] 0 0⍴"fmApproximate_GMP" ⎕wi "Wait"[513] 0 0⍴"fmApproximate_GMP" ⎕wi "Delete"[514] "fmSV" ⎕wi "pointer" 0 ∇