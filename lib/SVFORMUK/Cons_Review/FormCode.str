∇ Container←Form_Make;⎕wself;ControlName;childlist;list;Fieldlist;Fieldcontrol;FrameWidth;Caption;buttonsize;buttonwhere;where;size;alignment;Header;PickList;NameList;value;sortorder;SortList;MaxRow;MaxCol;Parent;level;node;no;nn;NN;x;fnsize;framelist;relTests[1] [2] Fieldlist←Fieldcontrol←list←0 0⍴""[3] "fmSV" ⎕wi "pointer" 13[4] buttonsize←25 65 ⋄ buttonwhere←¯5[5] FormName ⎕wi "caption" ((FormName ⎕wi "caption")," - Consolidation Review")[6] "fmSV" ⎕wi "∆caption" (("fmSV" ⎕wi "∆caption"),⊂("fmSV" ⎕wi "caption"))[7] :if 300<fnsize←1↑⍴⎕cr "Form_Make"[8]     "Generating Form" Win∆ProgressBar "Open"[9]     ("Menu Items:" "Form Controls:") Win∆ProgressBar "SetLabels"[10]     (1 1 "Help About") Win∆ProgressBar "FileUpdate"[11] :endif[12] [13] Container←"∆Dialog"[14] [15] ⎕wself←"fmConsReview" ⎕wi "New" "Form" "Hide"[16] ⎕wi "caption" ("fmSV" ⎕wi "caption")[17] ⎕wi "scale" 5[18] ⎕wi "font" ("fmSV" ⎕wi "font")[19] ⎕wi "border" 2 32 64[20] ⎕wi "where" (Win∆CentrePos 1 1 ×768 1024×1⌈CharSize÷13 6)[21] ⎕wi "limitwhere" (0.8×¯2↑⎕wi "where")[22] ⎕wi "tooltipwidth" 200[23] ⎕wi "onResize" "AutoResize"[24] ⎕wi "onClose" "ExitSystem ''"[25] ControlName←"fmConsReview"[26] relTests←0[27] 0 Menu_Make "fmSV"[28] 0 Menu_Make "fmConsReview"[29] "fmConsReview" Win∆CutCopyPaste "Build"[30] "fmConsReview" ⎕wi "∆helpid" 2270[31] list←list OVER "fmConsReview.bnCons_ReviewHelp"[32] ⎕wself←"fmConsReview.bnCons_ReviewHelp" ⎕wi "New" "Button"[33] ⎕wi "deferexit" 1[34] ⎕wi "extent" (size←1×buttonsize×1⌈CharSize÷13 6)[35] x←0.5×⍴where←Win∆Calcwhere 1,(¯10-size[1]),1,buttonwhere←buttonwhere-5+size[2][36] ⎕wi "∆where" ((x,2)⍴where)[37] ⎕wi "where" (("fmConsReview" ⎕wi "size") Win∆Resize ⎕wi "∆where")[38] ⎕wi "tooltip" "SuperVal Help"[39] ⎕wi "onClick" ("fmSV.mCons_ReviewHelp.mContext"⎕wi "onClick")[40] ⎕wi "caption" "Help"[41] :if buttonimage[42]     ⎕wi "imagelist" "fmSV.iStandard"[43]     ⎕wi "imageindex" 12[44] :endif[45] ⎕wi "visible" ¯1[46] ⎕wi "onMouseDown" "∆HelpField←'#' ⎕wi 'focus' "[47] list←list OVER "fmConsReview.bnCons_ReviewQuit"[48] ⎕wself←"fmConsReview.bnCons_ReviewQuit" ⎕wi "New" "Button"[49] ⎕wi "style" 2[50] ⎕wi "deferexit" 1[51] ⎕wi "extent" (size←1×buttonsize×1⌈CharSize÷13 6)[52] x←0.5×⍴where←Win∆Calcwhere 1,(¯10-size[1]),1,buttonwhere←buttonwhere-5+size[2][53] ⎕wi "∆where" ((x,2)⍴where)[54] ⎕wi "where" (("fmConsReview" ⎕wi "size") Win∆Resize ⎕wi "∆where")[55] ⎕wi "tooltip" "Quit and Return"[56] ⎕wi "onClick" ("fmSV.mCons_ReviewFile.mQuit"⎕wi "onClick")[57] ⎕wi "caption" "Quit"[58] ⎕wi "∆helpid" 5507[59] ⎕wi "order" .5[60] ⎕wi "visible" ¯1[61] ControlName ⎕wi "∆quitbutton" "fmConsReview.bnCons_ReviewQuit"[62] "fmConsReview" ⎕wi "∆modified" 1[63] [64] ⎕wself←"fmConsReview.cbGraph" ⎕wi "New" "Combo"[65] Fieldlist←Fieldlist OVER "fmConsReview.cbGraph"[66] Fieldcontrol←Fieldcontrol OVER "Combo"[67] ⎕wi "∆name" "Graph"[68] ⎕wi "∆type" "Char"[69] ⎕wi "∆mandatory" 1[70] ⎕wi "∆helpid" 5508[71] ⎕wi "tooltip" "Select the Graph required"[72] ⎕wi "style" 16 128 256 2[73] ⎕wi "∆where" (2 2⍴0.1 0 0.2 0)[74] ⎕wi "where" (("fmConsReview" ⎕wi "size") Win∆Resize (2 2⍴0.1 0 0.2 0))[75] PickList←⍙POPUPSdict ReadDictFile "ConsGraph"[76] PickList←⊃m2n 1 0↓PickList[77] ⎕wi "list" PickList[78] ⎕wi "extent" (150,(¯10+6×¯1↑CharSize)+¯1↑Win∆TextSize ((0,⎕wi "limit")⌈⍴PickList)↑PickList)[79] ⎕wi "onClick" "0 0⍴(⊂⎕wi 'name') Cons_Review 'Change' "[80] [81] ⎕wself←"fmConsReview.llGraph" ⎕wi "New" "Label"[82] ⎕wi "scale" 5[83] ⎕wi "style" 2[84] ⎕wi "extent" (↑⎕wi "Draw" ("?text" "Graph"))[85] ⎕wi "caption" "Graph"[86] where←4↑,"fmConsReview.cbGraph" ⎕wi "∆where"[87] x←0.5×⍴where←Win∆Calcwhere where-0 ¯3 0,10+¯1↑⎕wi "extent"[88] ⎕wi "∆where" ((x,2)⍴where)[89] ⎕wi "where" (("fmConsReview" ⎕wi "size") Win∆Resize ⎕wi "∆where")[90] [91] ⎕wself←"fmConsReview.edProjPer" ⎕wi "New" "Edit"[92] Fieldlist←Fieldlist OVER "fmConsReview.edProjPer"[93] Fieldcontrol←Fieldcontrol OVER "Edit"[94] ⎕wi "∆name" "ProjPer"[95] ⎕wi "∆type" "Num"[96] ⎕wi "∆mandatory" 1[97] ⎕wi "∆valid" ('Int' 'Scalar' '+')[98] ⎕wi "∆helpid" 5509[99] ⎕wi "tooltip" "Specify the Projection Period"[100] ⎕wi "limit" 2[101] ⎕wi "∆where" (2 2⍴0.1 0 0.7 0)[102] ⎕wi "where" (("fmConsReview" ⎕wi "size") Win∆Resize (2 2⍴0.1 0 0.7 0))[103] ⎕wi "∆range" "1 99"[104] ⎕wi "onExit" "⍎(0∊⍴,⎕wres←0 INPUT∆CHECK 'fmConsReview.edProjPer')/'0 0⍴(⊂⎕wi ''name'') Cons_Review ''Change'' ' "[105] ⎕wi "onExitError" "Win∆ExitError ⎕warg"[106] ⎕wi "onKeyPress" "⎕wres←¯2×~⎕warg∊8 32 48 49 50 51 52 53 54 55 56 57"[107] ⎕wi "extent" (2+CharSize×1 3)[108] [109] ⎕wself←"fmConsReview.lrProjPer" ⎕wi "New" "Label"[110] ⎕wi "scale" 5[111] ⎕wi "extent" (↑⎕wi "Draw" ("?text" "years"))[112] ⎕wi "caption" "years"[113] where←4↑,"fmConsReview.edProjPer" ⎕wi "∆where"[114] x←0.5×⍴where←Win∆Calcwhere where+0,3,0,10+¯1↑"fmConsReview.edProjPer" ⎕wi "extent"[115] ⎕wi "∆where" ((x,2)⍴where)[116] ⎕wi "where" (("fmConsReview" ⎕wi "size") Win∆Resize ⎕wi "∆where")[117] [118] ⎕wself←"fmConsReview.llProjPer" ⎕wi "New" "Label"[119] ⎕wi "scale" 5[120] ⎕wi "style" 2[121] ⎕wi "extent" (↑⎕wi "Draw" ("?text" "Projection Period"))[122] ⎕wi "caption" "Projection Period"[123] where←4↑,"fmConsReview.edProjPer" ⎕wi "∆where"[124] x←0.5×⍴where←Win∆Calcwhere where-0 ¯3 0,10+¯1↑⎕wi "extent"[125] ⎕wi "∆where" ((x,2)⍴where)[126] ⎕wi "where" (("fmConsReview" ⎕wi "size") Win∆Resize ⎕wi "∆where")[127] [128] ⎕wself←"fmConsReview.cbabNO" ⎕wi "New" "Combo"[129] Fieldlist←Fieldlist OVER "fmConsReview.cbabNO"[130] Fieldcontrol←Fieldcontrol OVER "Combo"[131] ⎕wi "∆name" "abNO"[132] ⎕wi "∆type" "Char"[133] ⎕wi "∆mandatory" 1[134] ⎕wi "∆helpid" 5510[135] ⎕wi "tooltip" "Select the Target Accrued Benefit"[136] ⎕wi "style" 16 128 256 2[137] ⎕wi "∆where" (2 2⍴0.2 0 0.2 0)[138] ⎕wi "where" (("fmConsReview" ⎕wi "size") Win∆Resize (2 2⍴0.2 0 0.2 0))[139] PickList←⍙POPUPSdict ReadDictFile "TargetBen"[140] PickList←⊃m2n 1 0↓PickList[141] ⎕wi "list" PickList[142] ⎕wi "extent" (150,(¯10+6×¯1↑CharSize)+¯1↑Win∆TextSize ((0,⎕wi "limit")⌈⍴PickList)↑PickList)[143] ⎕wi "onClick" "0 0⍴(⊂⎕wi 'name') Cons_Review 'Change' "[144] [145] ⎕wself←"fmConsReview.llabNO" ⎕wi "New" "Label"[146] ⎕wi "scale" 5[147] ⎕wi "style" 2[148] ⎕wi "extent" (↑⎕wi "Draw" ("?text" (("⍺",⎕tcnl) char_replace "Target⍺Accrued Benefit")))[149] ⎕wi "caption" (("⍺",⎕tcnl) char_replace "Target⍺Accrued Benefit")[150] where←4↑,"fmConsReview.cbabNO" ⎕wi "∆where"[151] size←1↑"fmConsReview.cbabNO" ⎕wi "extent"[152] size←¯3⌈0.5×(1↑⎕wi "extent")-size[153] x←0.5×⍴where←Win∆Calcwhere where-0,size,0,10+¯1↑⎕wi "extent"[154] ⎕wi "∆where" ((x,2)⍴where)[155] ⎕wi "where" (("fmConsReview" ⎕wi "size") Win∆Resize ⎕wi "∆where")[156] [157] ⎕wself←"fmConsReview.picResults" ⎕wi "New" "Picture"[158] Fieldlist←Fieldlist OVER "fmConsReview.picResults"[159] Fieldcontrol←Fieldcontrol OVER "Picture"[160] ⎕wi "∆name" "Results"[161] ⎕wi "∆type" "Picture"[162] ⎕wi "tooltip" "Double-click to enlarge graph"[163] ⎕wi "scale" 5[164] ⎕wi "style" 4[165] ⎕wi "∆where" (4 2⍴0.3 0 0.05 0 0.7 ¯45 0.9 0)[166] ⎕wi "where" (("fmConsReview" ⎕wi "size") Win∆Resize (4 2⍴0.3 0 0.05 0 0.7 ¯45 0.9 0))[167] ⎕wi "imagesize" (⎕wi "size")[168] ⎕wi "onResize" "⎕wi 'imagesize' (⎕wi 'size')"[169] ⎕wi "onMouseDouble" "EnlargePict PageView"[170] list←list OVER "fmConsReview.bnCons_ReviewExport"[171] ⎕wself←"fmConsReview.bnCons_ReviewExport" ⎕wi "New" "Button"[172] ⎕wi "extent" (size←1×buttonsize×1⌈CharSize÷13 6)[173] x←0.5×⍴where←Win∆Calcwhere 1,(¯10-size[1]),1,buttonwhere←buttonwhere-5+size[2][174] ⎕wi "∆where" ((x,2)⍴where)[175] ⎕wi "where" (("fmConsReview" ⎕wi "size") Win∆Resize ⎕wi "∆where")[176] ⎕wi "tooltip" "Export Results to Spreadsheet Import file"[177] ⎕wi "onClick" ("fmSV.mCons_ReviewFile.mExport"⎕wi "onClick")[178] ⎕wi "∆helpid" 5511[179] ⎕wi "caption" "Export"[180] :if buttonimage[181]     ⎕wi "imagelist" "fmSV.iStandard"[182]     ⎕wi "imageindex" 34[183] :endif[184] [185] "fmConsReview" ⎕wi "∆multifile" ""[186] "fmConsReview" ⎕wi "∆singlefile" ""[187] "fmConsReview" ⎕wi "∆format" ""[188] "fmConsReview" ⎕wi "∆financial" 0[189] "fmConsReview" ⎕wi "∆relrules" 0[190] "fmConsReview" ⎕wi "∆parm" 0[191] "fmConsReview" ⎕wi "∆decr" 0[192] "fmConsReview" ⎕wi "∆file" 0[193] "fmConsReview" ⎕wi "∆codefile" CodeFile[194] "fmConsReview" ⎕wi "∆inputstype" ""[195] "fmConsReview" ⎕wi "∆inputsentry" ""[196] "fmConsReview" ⎕wi "∆savecn" (⍳0)[197] "fmConsReview" ⎕wi "∆savedesc" ""[198] list←list OVER "fmConsReview"[199] "fmConsReview" ⎕wi "∆fieldlist" Fieldlist[200] "fmConsReview" ⎕wi "∆fieldcontrol" Fieldcontrol[201] childlist←"fmSV" ⎕wi "∆childlist"[202] list←(⊃¯1↑childlist) OVER list[203] childlist[⍴childlist]←⊂list[204] "fmSV" ⎕wi "∆childlist" childlist[205] list←,⎕split list[206] 0 0⍴((∨/¨(⊂".mCons_Review")⍷¨list)/list) MultiWI "enabled" 1[207] :if 300<fnsize[208]     (fnsize fnsize ".") Win∆ProgressBar "MemberUpdate"[209]     Win∆ProgressBar "Hide"[210] :endif[211] "Init" OpenParameters "Cons_Review"[212] "fmConsReview.bnCons_ReviewHelp" ⎕wi "visible" 1[213] "fmConsReview.bnCons_ReviewQuit" ⎕wi "visible" 1[214] "#" ⎕wi "focus" "fmConsReview.cbGraph"[215] :if ~0∊⍴,Error←Win∆Initialise "Cons_Review"[216]     "Quit" EndModule Module[217]     "fmSV" ⎕wi "pointer" 0[218]     0 0⍴"fmConsReview" ⎕wi "Delete"[219]     :return[220] :endif[221] :if bar_open←commandbar^"Multi"≡""[222]     bar_open←0×"fmConsReview.mCons_ReviewFile.m" Win∆CommandBar "QuitHelp"[223] :endif[224] "fmConsReview" ⎕wi "Paint"[225] "fmSV" ⎕wi "pointer" 11[226] "fmConsReview" ⎕wi "onWait" "0 0⍴Cons_Review 'Wait' ⋄ 'fmConsReview' ⎕wi 'modified' 0"[227] 0 0⍴"fmConsReview" ⎕wi "Wait"[228] 0 0⍴"fmConsReview" ⎕wi "Delete"[229] "fmSV" ⎕wi "pointer" 0 ∇