∇ Container←Form_Make;⎕wself;ControlName;childlist;list;Fieldlist;Fieldcontrol;FrameWidth;Caption;buttonsize;buttonwhere;where;size;alignment;Header;PickList;NameList;value;sortorder;SortList;MaxRow;MaxCol;Parent;level;node;no;nn;NN;x;fnsize;framelist;relTests[1] [2] Fieldlist←Fieldcontrol←list←0 0⍴""[3] "fmSV" ⎕wi "pointer" 13[4] buttonsize←25 65 ⋄ buttonwhere←¯5[5] FormName ⎕wi "caption" ((FormName ⎕wi "caption")," - Excel Output Comparison")[6] "fmSV" ⎕wi "∆caption" (("fmSV" ⎕wi "∆caption"),⊂("fmSV" ⎕wi "caption"))[7] :if 300<fnsize←1↑⍴⎕cr "Form_Make"[8]     "Generating Form" Win∆ProgressBar "Open"[9]     ("Menu Items:" "Form Controls:") Win∆ProgressBar "SetLabels"[10]     (1 1 "Help About") Win∆ProgressBar "FileUpdate"[11] :endif[12] [13] Container←"∆Dialog"[14] [15] ⎕wself←"fmExcelComp" ⎕wi "New" "Form" "Hide"[16] ⎕wi "caption" ("fmSV" ⎕wi "caption")[17] ⎕wi "scale" 5[18] ⎕wi "font" ("fmSV" ⎕wi "font")[19] ⎕wi "border" 2 32 64[20] ⎕wi "where" (Win∆CentrePos .80 .80×768 1024×1⌈CharSize÷13 6)[21] ⎕wi "limitwhere" (0.8×¯2↑⎕wi "where")[22] ⎕wi "tooltipwidth" 200[23] ⎕wi "onResize" "AutoResize"[24] ⎕wi "onClose" "ExitSystem ''"[25] ControlName←"fmExcelComp"[26] relTests←0[27] 0 Menu_Make "fmSV"[28] 0 Menu_Make "fmExcelComp"[29] "fmExcelComp" Win∆CutCopyPaste "Build"[30] list←list OVER "fmExcelComp.bnExcel_ComparisonQuit"[31] ⎕wself←"fmExcelComp.bnExcel_ComparisonQuit" ⎕wi "New" "Button"[32] ⎕wi "style" 2[33] ⎕wi "deferexit" 1[34] ⎕wi "extent" (size←1×buttonsize×1⌈CharSize÷13 6)[35] x←0.5×⍴where←Win∆Calcwhere 1,(¯10-size[1]),1,buttonwhere←buttonwhere-5+size[2][36] ⎕wi "∆where" ((x,2)⍴where)[37] ⎕wi "where" (("fmExcelComp" ⎕wi "size") Win∆Resize ⎕wi "∆where")[38] ⎕wi "tooltip" "Cancel and Return"[39] ⎕wi "onClick" ("fmSV.mExcel_ComparisonFile.mQuit"⎕wi "onClick")[40] ⎕wi "caption" "Cancel"[41] ⎕wi "order" .5[42] ⎕wi "visible" ¯1[43] list←list OVER "fmExcelComp.bnExcel_ComparisonSave"[44] ⎕wself←"fmExcelComp.bnExcel_ComparisonSave" ⎕wi "New" "Button"[45] ⎕wi "style" 1[46] ⎕wi "extent" (size←1×buttonsize×1⌈CharSize÷13 6)[47] x←0.5×⍴where←Win∆Calcwhere 1,(¯10-size[1]),1,buttonwhere←buttonwhere-5+size[2][48] ⎕wi "∆where" ((x,2)⍴where)[49] ⎕wi "where" (("fmExcelComp" ⎕wi "size") Win∆Resize ⎕wi "∆where")[50] ⎕wi "tooltip" "Save Parameters"[51] ⎕wi "onClick" ("fmSV.mExcel_ComparisonFile.mSave"⎕wi "onClick")[52] ⎕wi "caption" "OK"[53] ⎕wi "order" .5[54] ⎕wi "visible" ¯1[55] "fmExcelComp" ⎕wi "∆modified" 1[56] [57] ⎕wself←"fmExcelComp.cbxlFILE1" ⎕wi "New" "Combo"[58] Fieldlist←Fieldlist OVER "fmExcelComp.cbxlFILE1"[59] Fieldcontrol←Fieldcontrol OVER "Combo"[60] ⎕wi "∆name" "xlFILE1"[61] ⎕wi "∆type" "Combo"[62] ⎕wi "∆mandatory" 1[63] ⎕wi "tooltip" "Select the First Excel Output Filename"[64] ⎕wi "style" 16 128 256 2[65] ⎕wi "∆where" (2 2⍴0.25 0 0.15 0)[66] ⎕wi "where" (("fmExcelComp" ⎕wi "size") Win∆Resize (2 2⍴0.25 0 0.15 0))[67] PickList←GetXLSFiles OutputDir[68] ⎕wi "∆update" "GetXLSFiles OutputDir"[69] PickList←⊃m2n 1 0↓PickList[70] ⎕wi "list" PickList[71] ⎕wi "extent" (150,(¯10+6×¯1↑CharSize)+¯1↑Win∆TextSize ((0,⎕wi "limit")⌈⍴PickList)↑PickList)[72] ⎕wi "onClick" "0 0⍴(⊂⎕wi 'name') Excel_Comparison 'Change' "[73] [74] ⎕wself←"fmExcelComp.llxlFILE1" ⎕wi "New" "Label"[75] ⎕wi "scale" 5[76] ⎕wi "style" 2[77] ⎕wi "extent" (↑⎕wi "Draw" ("?text" (("⍺",⎕tcnl) char_replace "Excel⍺Output File")))[78] ⎕wi "caption" (("⍺",⎕tcnl) char_replace "Excel⍺Output File")[79] where←4↑,"fmExcelComp.cbxlFILE1" ⎕wi "∆where"[80] size←1↑"fmExcelComp.cbxlFILE1" ⎕wi "extent"[81] size←¯3⌈0.5×(1↑⎕wi "extent")-size[82] x←0.5×⍴where←Win∆Calcwhere where-0,size,0,10+¯1↑⎕wi "extent"[83] ⎕wi "∆where" ((x,2)⍴where)[84] ⎕wi "where" (("fmExcelComp" ⎕wi "size") Win∆Resize ⎕wi "∆where")[85] [86] ⎕wself←"fmExcelComp.edxlFILE2" ⎕wi "New" "Edit"[87] Fieldlist←Fieldlist OVER "fmExcelComp.edxlFILE2"[88] Fieldcontrol←Fieldcontrol OVER "Edit"[89] ⎕wi "∆name" "xlFILE2"[90] ⎕wi "∆type" "File"[91] ⎕wi "∆mandatory" 1[92] ⎕wi "∆valid" ('Single' 'Excel' 'Full')[93] ⎕wi "tooltip" "Specify the Comaprison Excel Output Filename
(Double Click for Open File Dialog)"[94] ⎕wi "∆where" (2 2⍴0.5 0 0.15 0)[95] ⎕wi "where" (("fmExcelComp" ⎕wi "size") Win∆Resize (2 2⍴0.5 0 0.15 0))[96] ⎕wi "onExit" "⍎(0∊⍴,⎕wres←0 INPUT∆CHECK 'fmExcelComp.edxlFILE2')/'0 0⍴(⊂⎕wi ''name'') Excel_Comparison ''Change'' ' "[97] ⎕wi "onExitError" "Win∆ExitError ⎕warg"[98] ⎕wi "extent" (2+CharSize×1 101)[99] ⎕wi "pointer" ">cur 1001 shell32.dll"[100] ⎕wi "onMouseDouble" "'Single Excel Full' GetFileList 'Single' "[101] ⎕wi "targetformats" "FileName"[102] ⎕wi "onDrop" "'fmExcelComp.edxlFILE2' Win∆DropTarget 0 ('Single' 'Excel' 'Full')"[103] ⎕wi "onChange" "0 0⍴(⊂⎕wi 'name') Excel_Comparison 'Change' "[104] [105] ⎕wself←"fmExcelComp.llxlFILE2" ⎕wi "New" "Label"[106] ⎕wi "scale" 5[107] ⎕wi "style" 2[108] ⎕wi "extent" (↑⎕wi "Draw" ("?text" (("⍺",⎕tcnl) char_replace "Comparison Excel⍺Output File")))[109] ⎕wi "caption" (("⍺",⎕tcnl) char_replace "Comparison Excel⍺Output File")[110] where←4↑,"fmExcelComp.edxlFILE2" ⎕wi "∆where"[111] size←1↑"fmExcelComp.edxlFILE2" ⎕wi "extent"[112] size←¯3⌈0.5×(1↑⎕wi "extent")-size[113] x←0.5×⍴where←Win∆Calcwhere where-0,size,0,10+¯1↑⎕wi "extent"[114] ⎕wi "∆where" ((x,2)⍴where)[115] ⎕wi "where" (("fmExcelComp" ⎕wi "size") Win∆Resize ⎕wi "∆where")[116] [117] ⎕wself←"fmExcelComp.edMAX" ⎕wi "New" "Edit"[118] Fieldlist←Fieldlist OVER "fmExcelComp.edMAX"[119] Fieldcontrol←Fieldcontrol OVER "Edit"[120] ⎕wi "∆name" "MAX"[121] ⎕wi "∆type" "Num"[122] ⎕wi "∆valid" ('Int' 'Scalar' '+')[123] ⎕wi "tooltip" "Specify the Maximum Differences per Sheet"[124] ⎕wi "limit" 4[125] ⎕wi "∆where" (2 2⍴0.75 0 0.5 0)[126] ⎕wi "where" (("fmExcelComp" ⎕wi "size") Win∆Resize (2 2⍴0.75 0 0.5 0))[127] ⎕wi "onExit" "⍎(0∊⍴,⎕wres←0 INPUT∆CHECK 'fmExcelComp.edMAX')/'0 0⍴(⊂⎕wi ''name'') Excel_Comparison ''Change'' ' "[128] ⎕wi "onExitError" "Win∆ExitError ⎕warg"[129] ⎕wi "onKeyPress" "⎕wres←¯2×~⎕warg∊8 32 48 49 50 51 52 53 54 55 56 57"[130] ⎕wi "extent" (2+CharSize×1 5)[131] [132] ⎕wself←"fmExcelComp.lrMAX" ⎕wi "New" "Label"[133] ⎕wi "scale" 5[134] ⎕wi "extent" (↑⎕wi "Draw" ("?text" "Blank for all"))[135] ⎕wi "caption" "Blank for all"[136] where←4↑,"fmExcelComp.edMAX" ⎕wi "∆where"[137] x←0.5×⍴where←Win∆Calcwhere where+0,3,0,10+¯1↑"fmExcelComp.edMAX" ⎕wi "extent"[138] ⎕wi "∆where" ((x,2)⍴where)[139] ⎕wi "where" (("fmExcelComp" ⎕wi "size") Win∆Resize ⎕wi "∆where")[140] [141] ⎕wself←"fmExcelComp.llMAX" ⎕wi "New" "Label"[142] ⎕wi "scale" 5[143] ⎕wi "style" 2[144] ⎕wi "extent" (↑⎕wi "Draw" ("?text" "Maximum Differences per Sheet"))[145] ⎕wi "caption" "Maximum Differences per Sheet"[146] where←4↑,"fmExcelComp.edMAX" ⎕wi "∆where"[147] x←0.5×⍴where←Win∆Calcwhere where-0 ¯3 0,10+¯1↑⎕wi "extent"[148] ⎕wi "∆where" ((x,2)⍴where)[149] ⎕wi "where" (("fmExcelComp" ⎕wi "size") Win∆Resize ⎕wi "∆where")[150] [151] "fmExcelComp" ⎕wi "∆multifile" ""[152] "fmExcelComp" ⎕wi "∆singlefile" "fmExcelComp.edxlFILE2"[153] "fmExcelComp" ⎕wi "∆format" ""[154] "fmExcelComp" ⎕wi "∆financial" 0[155] "fmExcelComp" ⎕wi "∆relrules" 0[156] "fmExcelComp" ⎕wi "∆parm" 0[157] "fmExcelComp" ⎕wi "∆decr" 0[158] "fmExcelComp" ⎕wi "∆file" 0[159] "fmExcelComp" ⎕wi "∆codefile" CodeFile[160] "fmExcelComp" ⎕wi "∆inputstype" ""[161] "fmExcelComp" ⎕wi "∆inputsentry" ""[162] "fmExcelComp" ⎕wi "∆savecn" (⍳0)[163] "fmExcelComp" ⎕wi "∆savedesc" ""[164] list←list OVER "fmExcelComp"[165] "fmExcelComp" ⎕wi "∆fieldlist" Fieldlist[166] "fmExcelComp" ⎕wi "∆fieldcontrol" Fieldcontrol[167] childlist←"fmSV" ⎕wi "∆childlist"[168] list←(⊃¯1↑childlist) OVER list[169] childlist[⍴childlist]←⊂list[170] "fmSV" ⎕wi "∆childlist" childlist[171] list←,⎕split list[172] 0 0⍴((∨/¨(⊂".mExcel_Comparison")⍷¨list)/list) MultiWI "enabled" 1[173] :if 300<fnsize[174]     (fnsize fnsize ".") Win∆ProgressBar "MemberUpdate"[175]     Win∆ProgressBar "Hide"[176] :endif[177] "Init" OpenParameters "Excel_Comparison"[178] "fmExcelComp.bnExcel_ComparisonQuit" ⎕wi "visible" 1[179] "fmExcelComp.bnExcel_ComparisonSave" ⎕wi "visible" 1[180] "#" ⎕wi "focus" "fmExcelComp.cbxlFILE1"[181] :if ~0∊⍴,Error←Win∆Initialise "Excel_Comparison"[182]     "Quit" EndModule Module[183]     "fmSV" ⎕wi "pointer" 0[184]     0 0⍴"fmExcelComp" ⎕wi "Delete"[185]     :return[186] :endif[187] :if bar_open←commandbar^"Multi"≡""[188]     bar_open←0×"fmExcelComp.mExcel_ComparisonFile.m" Win∆CommandBar "OK"[189] :endif[190] "fmExcelComp" ⎕wi "Paint"[191] "fmSV" ⎕wi "pointer" 11[192] "fmExcelComp" ⎕wi "onWait" "0 0⍴Excel_Comparison 'Wait' ⋄ 'fmExcelComp' ⎕wi 'modified' 0"[193] 0 0⍴"fmExcelComp" ⎕wi "Wait"[194] 0 0⍴"fmExcelComp" ⎕wi "Delete"[195] "fmSV" ⎕wi "pointer" 0 ∇