∇ Container←Form_Make;⎕wself;ControlName;childlist;list;Fieldlist;Fieldcontrol;FrameWidth;Caption;buttonsize;buttonwhere;where;size;alignment;Header;PickList;NameList;value;sortorder;SortList;MaxRow;MaxCol;Parent;level;node;no;nn;NN;x;fnsize;framelist;relTests[1] [2] Fieldlist←Fieldcontrol←list←0 0⍴""[3] "fmSV" ⎕wi "pointer" 13[4] buttonsize←25 65 ⋄ buttonwhere←¯5[5] FormName ⎕wi "caption" ((FormName ⎕wi "caption")," - Configure SQL Server Database Connections")[6] "fmSV" ⎕wi "∆caption" (("fmSV" ⎕wi "∆caption"),⊂("fmSV" ⎕wi "caption"))[7] :if 300<fnsize←1↑⍴⎕cr "Form_Make"[8]     "Generating Form" Win∆ProgressBar "Open"[9]     ("Menu Items:" "Form Controls:") Win∆ProgressBar "SetLabels"[10]     (1 1 "Help About") Win∆ProgressBar "FileUpdate"[11] :endif[12] [13] Container←"∆Dialog"[14] [15] ⎕wself←"fmConfigSQL" ⎕wi "New" "Form" "Hide"[16] ⎕wi "caption" ("fmSV" ⎕wi "caption")[17] ⎕wi "scale" 5[18] ⎕wi "font" ("fmSV" ⎕wi "font")[19] ⎕wi "border" 2 32 64[20] ⎕wi "where" (Win∆CentrePos .80 .60×768 1024×1⌈CharSize÷13 6)[21] ⎕wi "limitwhere" (0.8×¯2↑⎕wi "where")[22] ⎕wi "tooltipwidth" 200[23] ⎕wi "onResize" "AutoResize"[24] ⎕wi "onClose" "ExitSystem ''"[25] ControlName←"fmConfigSQL"[26] relTests←0[27] 0 Menu_Make "fmSV"[28] 1 Menu_Make "fmConfigSQL"[29] "fmConfigSQL" Win∆CutCopyPaste "Build"[30] "fmConfigSQL" ⎕wi "∆helpid" 2293[31] list←list OVER "fmConfigSQL.bnConfigure_SQLHelp"[32] ⎕wself←"fmConfigSQL.bnConfigure_SQLHelp" ⎕wi "New" "Button"[33] ⎕wi "deferexit" 1[34] ⎕wi "extent" (size←1×buttonsize×1⌈CharSize÷13 6)[35] x←0.5×⍴where←Win∆Calcwhere 1,(¯10-size[1]),1,buttonwhere←buttonwhere-5+size[2][36] ⎕wi "∆where" ((x,2)⍴where)[37] ⎕wi "where" (("fmConfigSQL" ⎕wi "size") Win∆Resize ⎕wi "∆where")[38] ⎕wi "tooltip" "SuperVal Help"[39] ⎕wi "onClick" ("fmSV.mConfigure_SQLHelp.mContext"⎕wi "onClick")[40] ⎕wi "caption" "Help"[41] :if buttonimage[42]     ⎕wi "imagelist" "fmSV.iStandard"[43]     ⎕wi "imageindex" 12[44] :endif[45] ⎕wi "visible" ¯1[46] ⎕wi "onMouseDown" "∆HelpField←'#' ⎕wi 'focus' "[47] list←list OVER "fmConfigSQL.bnConfigure_SQLQuit"[48] ⎕wself←"fmConfigSQL.bnConfigure_SQLQuit" ⎕wi "New" "Button"[49] ⎕wi "style" 2[50] ⎕wi "deferexit" 1[51] ⎕wi "extent" (size←1×buttonsize×1⌈CharSize÷13 6)[52] x←0.5×⍴where←Win∆Calcwhere 1,(¯10-size[1]),1,buttonwhere←buttonwhere-5+size[2][53] ⎕wi "∆where" ((x,2)⍴where)[54] ⎕wi "where" (("fmConfigSQL" ⎕wi "size") Win∆Resize ⎕wi "∆where")[55] ⎕wi "tooltip" "Quit and Return"[56] ⎕wi "onClick" ("fmSV.mConfigure_SQLFile.mQuit"⎕wi "onClick")[57] ⎕wi "caption" "Quit"[58] ⎕wi "∆helpid" 5758[59] ⎕wi "order" .5[60] ⎕wi "visible" ¯1[61] ControlName ⎕wi "∆quitbutton" "fmConfigSQL.bnConfigure_SQLQuit"[62] list←list OVER "fmConfigSQL.bnConfigure_SQLSave"[63] ⎕wself←"fmConfigSQL.bnConfigure_SQLSave" ⎕wi "New" "Button"[64] ⎕wi "extent" (size←1×buttonsize×1⌈CharSize÷13 6)[65] x←0.5×⍴where←Win∆Calcwhere 1,(¯10-size[1]),1,buttonwhere←buttonwhere-5+size[2][66] ⎕wi "∆where" ((x,2)⍴where)[67] ⎕wi "where" (("fmConfigSQL" ⎕wi "size") Win∆Resize ⎕wi "∆where")[68] ⎕wi "tooltip" "Save Parameters"[69] ⎕wi "onClick" ("fmSV.mConfigure_SQLFile.mSave"⎕wi "onClick")[70] ⎕wi "caption" "Save"[71] :if buttonimage[72]     ⎕wi "imagelist" "fmSV.iStandard"[73]     ⎕wi "imageindex" 9[74] :endif[75] ⎕wi "∆helpid" 5759[76] ⎕wi "enabled" 0[77] ⎕wi "order" .5[78] ⎕wi "visible" ¯1[79] "fmConfigSQL" ⎕wi "onModified" "('Configure_SQL' 'fmConfigSQL.bnConfigure_SQLSave') Win∆SaveEnabled (0≠⎕warg[1])"[80] list←list OVER "fmConfigSQL.bnConfigure_SQLSaveAs"[81] ⎕wself←"fmConfigSQL.bnConfigure_SQLSaveAs" ⎕wi "New" "Button"[82] ⎕wi "extent" (size←1×buttonsize×1⌈CharSize÷13 6)[83] x←0.5×⍴where←Win∆Calcwhere 1,(¯10-size[1]),1,buttonwhere←buttonwhere-5+size[2][84] ⎕wi "∆where" ((x,2)⍴where)[85] ⎕wi "where" (("fmConfigSQL" ⎕wi "size") Win∆Resize ⎕wi "∆where")[86] ⎕wi "tooltip" "Save Parameters As ..."[87] ⎕wi "onClick" ("fmSV.mConfigure_SQLFile.mSaveAs"⎕wi "onClick")[88] ⎕wi "caption" "Save As"[89] ⎕wi "∆helpid" 5760[90] ⎕wi "order" .5[91] ⎕wi "visible" ¯1[92] [93] ⎕wself←"fmConfigSQL.cbSQLconnect" ⎕wi "New" "Combo"[94] Fieldlist←Fieldlist OVER "fmConfigSQL.cbSQLconnect"[95] Fieldcontrol←Fieldcontrol OVER "Combo"[96] ⎕wi "∆name" "SQLconnect"[97] ⎕wi "∆type" "Combo"[98] ⎕wi "∆mandatory" 1[99] ⎕wi "∆helpid" 5761[100] ⎕wi "tooltip" "Select the mode of connection to the SQL Sever instance"[101] ⎕wi "style" 16 128 256 2[102] ⎕wi "∆where" (2 2⍴0.1 0 0.2 0)[103] ⎕wi "where" (("fmConfigSQL" ⎕wi "size") Win∆Resize (2 2⍴0.1 0 0.2 0))[104] PickList←⍙POPUPSdict ReadDictFile "SQLconnect"[105] PickList←⊃m2n 1 0↓PickList[106] ⎕wi "list" PickList[107] ⎕wi "extent" (150,(¯10+6×¯1↑CharSize)+¯1↑Win∆TextSize ((0,⎕wi "limit")⌈⍴PickList)↑PickList)[108] ⎕wi "onClick" "0 0⍴(⊂⎕wi 'name') Configure_SQL 'Change' "[109] [110] ⎕wself←"fmConfigSQL.llSQLconnect" ⎕wi "New" "Label"[111] ⎕wi "scale" 5[112] ⎕wi "style" 2[113] ⎕wi "extent" (↑⎕wi "Draw" ("?text" (("⍺",⎕tcnl) char_replace "SQL Server⍺Connection Type")))[114] ⎕wi "caption" (("⍺",⎕tcnl) char_replace "SQL Server⍺Connection Type")[115] where←4↑,"fmConfigSQL.cbSQLconnect" ⎕wi "∆where"[116] size←1↑"fmConfigSQL.cbSQLconnect" ⎕wi "extent"[117] size←¯3⌈0.5×(1↑⎕wi "extent")-size[118] x←0.5×⍴where←Win∆Calcwhere where-0,size,0,10+¯1↑⎕wi "extent"[119] ⎕wi "∆where" ((x,2)⍴where)[120] ⎕wi "where" (("fmConfigSQL" ⎕wi "size") Win∆Resize ⎕wi "∆where")[121] [122] ⎕wself←"fmConfigSQL.cbSQLAccess" ⎕wi "New" "Combo"[123] Fieldlist←Fieldlist OVER "fmConfigSQL.cbSQLAccess"[124] Fieldcontrol←Fieldcontrol OVER "Combo"[125] ⎕wi "∆name" "SQLAccess"[126] ⎕wi "∆type" "Num"[127] ⎕wi "∆mandatory" 1[128] ⎕wi "∆helpid" 5762[129] ⎕wi "tooltip" "Specify the Access Level required to use these SQL Connection properties"[130] ⎕wi "style" 16 128 256 2[131] ⎕wi "∆where" (2 2⍴0.1 0 0.8 0)[132] ⎕wi "where" (("fmConfigSQL" ⎕wi "size") Win∆Resize (2 2⍴0.1 0 0.8 0))[133] PickList←⍙POPUPSdict ReadDictFile "AccessLevels"[134] PickList←⊃m2n 1 0↓PickList[135] ⎕wi "list" PickList[136] ⎕wi "extent" (150,(¯10+6×¯1↑CharSize)+¯1↑Win∆TextSize ((0,⎕wi "limit")⌈⍴PickList)↑PickList)[137] ⎕wi "onClick" "0 0⍴(⊂⎕wi 'name') Configure_SQL 'Change' "[138] [139] ⎕wself←"fmConfigSQL.llSQLAccess" ⎕wi "New" "Label"[140] ⎕wi "scale" 5[141] ⎕wi "style" 2[142] ⎕wi "extent" (↑⎕wi "Draw" ("?text" (("⍺",⎕tcnl) char_replace "User Access Level required to use⍺these Connection properties")))[143] ⎕wi "caption" (("⍺",⎕tcnl) char_replace "User Access Level required to use⍺these Connection properties")[144] where←4↑,"fmConfigSQL.cbSQLAccess" ⎕wi "∆where"[145] size←1↑"fmConfigSQL.cbSQLAccess" ⎕wi "extent"[146] size←¯3⌈0.5×(1↑⎕wi "extent")-size[147] x←0.5×⍴where←Win∆Calcwhere where-0,size,0,10+¯1↑⎕wi "extent"[148] ⎕wi "∆where" ((x,2)⍴where)[149] ⎕wi "where" (("fmConfigSQL" ⎕wi "size") Win∆Resize ⎕wi "∆where")[150] [151] ⎕wself←"fmConfigSQL.edSQLTimeout" ⎕wi "New" "Edit"[152] Fieldlist←Fieldlist OVER "fmConfigSQL.edSQLTimeout"[153] Fieldcontrol←Fieldcontrol OVER "Edit"[154] ⎕wi "∆name" "SQLTimeout"[155] ⎕wi "∆type" "Num"[156] ⎕wi "∆mandatory" 1[157] ⎕wi "∆valid" ('Int' 'Scalar' '0+')[158] ⎕wi "∆helpid" 5763[159] ⎕wi "tooltip" "Specify the time before SQL Server tasks are timed out (in seconds)"[160] ⎕wi "limit" 4[161] ⎕wi "∆where" (2 2⍴0.21 0 0.8 0)[162] ⎕wi "where" (("fmConfigSQL" ⎕wi "size") Win∆Resize (2 2⍴0.21 0 0.8 0))[163] ⎕wi "onExit" "⍎(0∊⍴,⎕wres←0 INPUT∆CHECK 'fmConfigSQL.edSQLTimeout')/'0 0⍴(⊂⎕wi ''name'') Configure_SQL ''Change'' ' "[164] ⎕wi "onExitError" "Win∆ExitError ⎕warg"[165] ⎕wi "onKeyPress" "⎕wres←¯2×~⎕warg∊8 32 48 49 50 51 52 53 54 55 56 57"[166] ⎕wi "extent" (2+CharSize×1 5)[167] [168] ⎕wself←"fmConfigSQL.lrSQLTimeout" ⎕wi "New" "Label"[169] ⎕wi "scale" 5[170] ⎕wi "extent" (↑⎕wi "Draw" ("?text" "seconds"))[171] ⎕wi "caption" "seconds"[172] where←4↑,"fmConfigSQL.edSQLTimeout" ⎕wi "∆where"[173] x←0.5×⍴where←Win∆Calcwhere where+0,3,0,10+¯1↑"fmConfigSQL.edSQLTimeout" ⎕wi "extent"[174] ⎕wi "∆where" ((x,2)⍴where)[175] ⎕wi "where" (("fmConfigSQL" ⎕wi "size") Win∆Resize ⎕wi "∆where")[176] [177] ⎕wself←"fmConfigSQL.llSQLTimeout" ⎕wi "New" "Label"[178] ⎕wi "scale" 5[179] ⎕wi "style" 2[180] ⎕wi "extent" (↑⎕wi "Draw" ("?text" "SQL Server Timeout (0 = no timeout)"))[181] ⎕wi "caption" "SQL Server Timeout (0 = no timeout)"[182] where←4↑,"fmConfigSQL.edSQLTimeout" ⎕wi "∆where"[183] x←0.5×⍴where←Win∆Calcwhere where-0 ¯3 0,10+¯1↑⎕wi "extent"[184] ⎕wi "∆where" ((x,2)⍴where)[185] ⎕wi "where" (("fmConfigSQL" ⎕wi "size") Win∆Resize ⎕wi "∆where")[186] [187] ⎕wself←"fmConfigSQL.lSQLTable" ⎕wi "New" "Label"[188] ⎕wi "scale" 5[189] ⎕wi "tooltip" "Right Click Top Left Corner for Grid Options
Right Click Row/Column Headings to Add/Delete Rows/Columns"[190] ⎕wi "extent" (↑⎕wi "Draw" ("?text" "SQL Connection String Properties"))[191] ⎕wi "caption" "SQL Connection String Properties"[192] ⎕wi "∆where" (2 2⍴0.34 ¯20 0.1 0)[193] ⎕wi "where" (("fmConfigSQL" ⎕wi "size") Win∆Resize (2 2⍴0.34 ¯20 0.1 0))[194] ⎕wself←"fmConfigSQL.ssSQLTable" ⎕wi "New" "{13E51003-A52B-11D0-86DA-00608CB9FBFB}6D5ECD55-86B8-11d0-95AD-0020AF1E9EB2"[195] ⎕wi "∆where" (4 2⍴0.34 0 0.1 0 0.66 ¯45 0.8 0)[196] ⎕wi "where" (("fmConfigSQL" ⎕wi "size") Win∆Resize (4 2⍴0.34 0 0.1 0 0.66 ¯45 0.8 0))[197] Fieldlist←Fieldlist OVER "fmConfigSQL.ssSQLTable"[198] Fieldcontrol←Fieldcontrol OVER "F1SS"[199] Win∆F1SSDefaults 0[200] ⎕wi "MaxRow" (MaxRow←1)[201] ⎕wi "MaxCol" (MaxCol←1)[202] ⎕wi "xDoStartEdit" 1[203] ⎕wi "xDoEndEdit" 1[204] ⎕wi "xDoCancelEdit" 1[205] ⎕wi "onClick" "Win∆F1SSClick 'fmConfigSQL.ssSQLTable'"[206] ⎕wi "onXStartEdit" "⎕wi 'AllowArrows' 0"[207] NameList←0 0⍴" "[208] ⎕wi "MaxCol" (MaxCol←MaxCol⌈1)[209] ⎕wi "ColText" 1 (("/⍺/",⎕tcnl,⎕tclf) TEXTREPL "Property")[210] ⎕wi "XSetRowHeight" 1 1 255 1[211] NameList←NameList OVER "property[;]"[212] ⎕wi "MaxCol" (MaxCol←MaxCol⌈2)[213] ⎕wi "ColText" 2 (("/⍺/",⎕tcnl,⎕tclf) TEXTREPL "Value")[214] ⎕wi "XSetRowHeight" 1 1 255 1[215] NameList←NameList OVER "propvalue[;]"[216] ⎕wi "xHdrHeight" (350⌈250×1)[217] ⎕wi "onXRClick" "1 Win∆F1SSRowMenu ('Configure_SQL' 'fmConfigSQL.ssSQLTable')"[218] ⎕wi "∆roworcol" "Col"[219] ⎕wi "∆name" NameList[220] ⎕wi "∆limit" (,0 0)[221] ⎕wi "∆mandatory" 1 1[222] ⎕wi "∆helpid" 5764 5765[223] ⎕wi "∆type" "⍺Char⍺Char"[224] ⎕wi "∆valid" "⍺''⍺''"[225] ⎕wi "∆range" "⍺⍺"[226] ⎕wi "onXEndEdit" "(⎕wi 'xRow') Win∆ValidF1SSCell ⎕wi 'xCol' ⋄ 0 0⍴⎕ex 'F1SSEvent' "[227] ⎕wi "onExit" "Win∆ValidF1SSExit 'Configure_SQL'"[228] ⎕wi "onExitError" "MDISPLAY ⎕warg ⋄ ⎕wi 'XStartEdit' 0 1 1"[229] ⎕wi "onXCancelEdit" "⎕wi 'AllowArrows' 1 ⋄ ⎕wi 'SetColWidthAuto' 1 1 (⎕wi 'MaxRow') (⎕wi 'MaxCol') 0"[230] "fmConfigSQL.ssSQLTable" Win∆F1SSProtectCells "Unlock"[231] ⎕wi "SetSelection" 1 1 1 1[232] list←list OVER "fmConfigSQL.bnConfigure_SQLTest"[233] ⎕wself←"fmConfigSQL.bnConfigure_SQLTest" ⎕wi "New" "Button"[234] ⎕wi "extent" (size←1.4 1×buttonsize×1⌈CharSize÷13 6)[235] x←0.5×⍴where←Win∆Calcwhere 1,(¯10-size[1]),1,buttonwhere←buttonwhere-5+size[2][236] ⎕wi "∆where" ((x,2)⍴where)[237] ⎕wi "where" (("fmConfigSQL" ⎕wi "size") Win∆Resize ⎕wi "∆where")[238] ⎕wi "tooltip" "Test SQL Connection properties"[239] ⎕wi "onClick" ("fmSV.mConfigure_SQLFile.mTest"⎕wi "onClick")[240] ⎕wi "∆helpid" 5766[241] ⎕wi "caption" (("⍺",⎕tcnl) char_replace "Test⍺Connection")[242] list←list OVER "fmConfigSQL.bnConfigure_SQLApply"[243] ⎕wself←"fmConfigSQL.bnConfigure_SQLApply" ⎕wi "New" "Button"[244] ⎕wi "extent" (size←1.4 1×buttonsize×1⌈CharSize÷13 6)[245] x←0.5×⍴where←Win∆Calcwhere 1,(¯10-size[1]),1,buttonwhere←buttonwhere-5+size[2][246] ⎕wi "∆where" ((x,2)⍴where)[247] ⎕wi "where" (("fmConfigSQL" ⎕wi "size") Win∆Resize ⎕wi "∆where")[248] ⎕wi "tooltip" "Apply current SQL Connection properties to Users"[249] ⎕wi "onClick" ("fmSV.mConfigure_SQLFile.mApply"⎕wi "onClick")[250] ⎕wi "∆helpid" 5767[251] ⎕wi "caption" (("⍺",⎕tcnl) char_replace "Apply to⍺Users")[252] [253] ⎕wself←"fmConfigSQL.lParmDesc" ⎕wi "New" "Label"[254] ⎕wi "scale" 5[255] ⎕wi "extent" (CharSize×¯2↑1,50)[256] ⎕wi "style" 32[257] ⎕wi "caption" " "[258] ⎕wi "∆where" (2 2⍴0.96 0 0.02 0)[259] ⎕wi "where" (("fmConfigSQL" ⎕wi "size") Win∆Resize (2 2⍴0.96 0 0.02 0))[260] [261] "fmConfigSQL" ⎕wi "∆multifile" ""[262] "fmConfigSQL" ⎕wi "∆singlefile" ""[263] "fmConfigSQL" ⎕wi "∆format" ""[264] "fmConfigSQL" ⎕wi "∆financial" 0[265] "fmConfigSQL" ⎕wi "∆relrules" 0[266] "fmConfigSQL" ⎕wi "∆parm" 0[267] "fmConfigSQL" ⎕wi "∆decr" 0[268] "fmConfigSQL" ⎕wi "∆file" 0[269] "fmConfigSQL" ⎕wi "∆codefile" CodeFile[270] "fmConfigSQL" ⎕wi "∆inputstype" "ConfigFile"[271] "fmConfigSQL" ⎕wi "∆inputsentry" "Multi"[272] "fmConfigSQL" ⎕wi "∆savecn" (⍳0)[273] "fmConfigSQL" ⎕wi "∆savedesc" ""[274] list←list OVER "fmConfigSQL"[275] "fmConfigSQL" ⎕wi "∆fieldlist" Fieldlist[276] "fmConfigSQL" ⎕wi "∆fieldcontrol" Fieldcontrol[277] childlist←"fmSV" ⎕wi "∆childlist"[278] list←(⊃¯1↑childlist) OVER list[279] childlist[⍴childlist]←⊂list[280] "fmSV" ⎕wi "∆childlist" childlist[281] list←,⎕split list[282] 0 0⍴((∨/¨(⊂".mConfigure_SQL")⍷¨list)/list) MultiWI "enabled" 1[283] :if 300<fnsize[284]     (fnsize fnsize ".") Win∆ProgressBar "MemberUpdate"[285]     Win∆ProgressBar "Hide"[286] :endif[287] "Init" OpenParameters "Configure_SQL"[288] "fmConfigSQL.bnConfigure_SQLHelp" ⎕wi "visible" 1[289] "fmConfigSQL.bnConfigure_SQLQuit" ⎕wi "visible" 1[290] "fmConfigSQL.bnConfigure_SQLSave" ⎕wi "visible" 1[291] "fmConfigSQL.bnConfigure_SQLSaveAs" ⎕wi "visible" 1[292] "#" ⎕wi "focus" "fmConfigSQL.cbSQLconnect"[293] :if ~0∊⍴,Error←Win∆Initialise "Configure_SQL"[294]     "Quit" EndModule Module[295]     "fmSV" ⎕wi "pointer" 0[296]     0 0⍴"fmConfigSQL" ⎕wi "Delete"[297]     :return[298] :endif[299] :if bar_open←commandbar^"Multi"≡"Multi"[300]     bar_open←0×"fmConfigSQL.mConfigure_SQLFile.m" Win∆CommandBar "SaveAsHelp"[301] :endif[302] "fmConfigSQL" ⎕wi "Paint"[303] "fmSV" ⎕wi "pointer" 11[304] "fmConfigSQL" ⎕wi "onWait" "0 0⍴Configure_SQL 'Wait' ⋄ 'fmConfigSQL' ⎕wi 'modified' 0"[305] 0 0⍴"fmConfigSQL" ⎕wi "Wait"[306] 0 0⍴"fmConfigSQL" ⎕wi "Delete"[307] "fmSV" ⎕wi "pointer" 0 ∇