∇ Container←Form_Make;⎕wself;ControlName;childlist;list;Fieldlist;Fieldcontrol;FrameWidth;Caption;buttonsize;buttonwhere;where;size;alignment;Header;PickList;NameList;value;sortorder;SortList;MaxRow;MaxCol;Parent;level;node;no;nn;NN;x;fnsize;framelist;relTests[1] [2] Fieldlist←Fieldcontrol←list←0 0⍴""[3] "fmSV" ⎕wi "pointer" 13[4] buttonsize←25 65 ⋄ buttonwhere←¯5[5] FormName ⎕wi "caption" ((FormName ⎕wi "caption")," - Comparing Bases of Completed Valuation Runs")[6] "fmSV" ⎕wi "∆caption" (("fmSV" ⎕wi "∆caption"),⊂("fmSV" ⎕wi "caption"))[7] :if 300<fnsize←1↑⍴⎕cr "Form_Make"[8]     "Generating Form" Win∆ProgressBar "Open"[9]     ("Menu Items:" "Form Controls:") Win∆ProgressBar "SetLabels"[10]     (1 1 "Help About") Win∆ProgressBar "FileUpdate"[11] :endif[12] [13] Container←"∆Dialog"[14] [15] ⎕wself←"fmBasisCompare" ⎕wi "New" "Form" "Hide"[16] ⎕wi "caption" ("fmSV" ⎕wi "caption")[17] ⎕wi "scale" 5[18] ⎕wi "font" ("fmSV" ⎕wi "font")[19] ⎕wi "border" 2 32 64[20] ⎕wi "where" (Win∆CentrePos 0.8 0.9×768 1024×1⌈CharSize÷13 6)[21] ⎕wi "limitwhere" (0.8×¯2↑⎕wi "where")[22] ⎕wi "tooltipwidth" 200[23] ⎕wi "onResize" "AutoResize"[24] ⎕wi "onClose" "ExitSystem ''"[25] ControlName←"fmBasisCompare"[26] relTests←0[27] 0 Menu_Make "fmSV"[28] 0 Menu_Make "fmBasisCompare"[29] "fmBasisCompare" Win∆CutCopyPaste "Build"[30] "fmBasisCompare" ⎕wi "∆helpid" 2272[31] list←list OVER "fmBasisCompare.bnBasis_CompareHelp"[32] ⎕wself←"fmBasisCompare.bnBasis_CompareHelp" ⎕wi "New" "Button"[33] ⎕wi "deferexit" 1[34] ⎕wi "extent" (size←1×buttonsize×1⌈CharSize÷13 6)[35] x←0.5×⍴where←Win∆Calcwhere 1,(¯10-size[1]),1,buttonwhere←buttonwhere-5+size[2][36] ⎕wi "∆where" ((x,2)⍴where)[37] ⎕wi "where" (("fmBasisCompare" ⎕wi "size") Win∆Resize ⎕wi "∆where")[38] ⎕wi "tooltip" "SuperVal Help"[39] ⎕wi "onClick" ("fmSV.mBasis_CompareHelp.mContext"⎕wi "onClick")[40] ⎕wi "caption" "Help"[41] :if buttonimage[42]     ⎕wi "imagelist" "fmSV.iStandard"[43]     ⎕wi "imageindex" 12[44] :endif[45] ⎕wi "visible" ¯1[46] ⎕wi "onMouseDown" "∆HelpField←'#' ⎕wi 'focus' "[47] list←list OVER "fmBasisCompare.bnBasis_CompareQuit"[48] ⎕wself←"fmBasisCompare.bnBasis_CompareQuit" ⎕wi "New" "Button"[49] ⎕wi "style" 2[50] ⎕wi "deferexit" 1[51] ⎕wi "extent" (size←1×buttonsize×1⌈CharSize÷13 6)[52] x←0.5×⍴where←Win∆Calcwhere 1,(¯10-size[1]),1,buttonwhere←buttonwhere-5+size[2][53] ⎕wi "∆where" ((x,2)⍴where)[54] ⎕wi "where" (("fmBasisCompare" ⎕wi "size") Win∆Resize ⎕wi "∆where")[55] ⎕wi "tooltip" "Cancel and Return"[56] ⎕wi "onClick" ("fmSV.mBasis_CompareFile.mQuit"⎕wi "onClick")[57] ⎕wi "caption" "Cancel"[58] ⎕wi "∆helpid" 5517[59] ⎕wi "order" .5[60] ⎕wi "visible" ¯1[61] list←list OVER "fmBasisCompare.bnBasis_CompareSave"[62] ⎕wself←"fmBasisCompare.bnBasis_CompareSave" ⎕wi "New" "Button"[63] ⎕wi "style" 1[64] ⎕wi "extent" (size←1×buttonsize×1⌈CharSize÷13 6)[65] x←0.5×⍴where←Win∆Calcwhere 1,(¯10-size[1]),1,buttonwhere←buttonwhere-5+size[2][66] ⎕wi "∆where" ((x,2)⍴where)[67] ⎕wi "where" (("fmBasisCompare" ⎕wi "size") Win∆Resize ⎕wi "∆where")[68] ⎕wi "tooltip" "Save Parameters"[69] ⎕wi "onClick" ("fmSV.mBasis_CompareFile.mSave"⎕wi "onClick")[70] ⎕wi "caption" "OK"[71] ⎕wi "∆helpid" 5518[72] ⎕wi "order" .5[73] ⎕wi "visible" ¯1[74] [75] ⎕wself←"fmBasisCompare.cbmdbFile" ⎕wi "New" "Combo"[76] Fieldlist←Fieldlist OVER "fmBasisCompare.cbmdbFile"[77] Fieldcontrol←Fieldcontrol OVER "Combo"[78] ⎕wi "∆name" "mdbFile"[79] ⎕wi "∆type" "Combo"[80] ⎕wi "∆mandatory" 1[81] ⎕wi "visible" (¯1+2×~sqlDatabase)[82] ⎕wi "enabled" (~sqlDatabase)[83] ⎕wi "∆helpid" 5519[84] ⎕wi "tooltip" "Specify the Access Results Database File containing Bases to be Compared"[85] ⎕wi "limit" 30[86] ⎕wi "onExit" "⍎(mt ,⎕wres←0 INPUT∆CHECK 'fmBasisCompare.cbmdbFile')/'0 0⍴(⊂⎕wi ''name'') Basis_Compare ''Change'' ' "[87] ⎕wi "onExitError" "Win∆ExitError ⎕warg"[88] ⎕wi "style" 16 128 256 0[89] ⎕wi "∆where" (2 2⍴0.05 0 0.15 0)[90] ⎕wi "where" (("fmBasisCompare" ⎕wi "size") Win∆Resize (2 2⍴0.05 0 0.15 0))[91] PickList←GetMDBFiles ConsolidDir[92] ⎕wi "∆update" "GetMDBFiles ConsolidDir"[93] PickList←⊃m2n 1 0↓PickList[94] PickList←" " OVER PickList[95] ⎕wi "list" PickList[96] ⎕wi "extent" (150,(¯10+8×¯1↑CharSize)+¯1↑Win∆TextSize ((0,⎕wi "limit")⌈⍴PickList)↑PickList)[97] ⎕wi "onClick" "0 0⍴(⊂⎕wi 'name') Basis_Compare 'Change' "[98] [99] ⎕wself←"fmBasisCompare.llmdbFile" ⎕wi "New" "Label"[100] ⎕wi "scale" 5[101] ⎕wi "style" 2[102] ⎕wi "visible" (¯1+2×~sqlDatabase)[103] ⎕wi "enabled" (~sqlDatabase)[104] ⎕wi "extent" (↑⎕wi "Draw" ("?text" (("⍺",⎕tcnl) char_replace "Database⍺Results File")))[105] ⎕wi "caption" (("⍺",⎕tcnl) char_replace "Database⍺Results File")[106] where←4↑,"fmBasisCompare.cbmdbFile" ⎕wi "∆where"[107] size←1↑"fmBasisCompare.cbmdbFile" ⎕wi "extent"[108] size←¯3⌈0.5×(1↑⎕wi "extent")-size[109] x←0.5×⍴where←Win∆Calcwhere where-0,size,0,10+¯1↑⎕wi "extent"[110] ⎕wi "∆where" ((x,2)⍴where)[111] ⎕wi "where" (("fmBasisCompare" ⎕wi "size") Win∆Resize ⎕wi "∆where")[112] [113] ⎕wself←"fmBasisCompare.cbsqlDBase" ⎕wi "New" "Combo"[114] Fieldlist←Fieldlist OVER "fmBasisCompare.cbsqlDBase"[115] Fieldcontrol←Fieldcontrol OVER "Combo"[116] ⎕wi "∆name" "sqlDBase"[117] ⎕wi "∆type" "Combo"[118] ⎕wi "∆mandatory" 1[119] ⎕wi "visible" (¯1+2×sqlDatabase)[120] ⎕wi "enabled" (sqlDatabase)[121] ⎕wi "∆helpid" 5520[122] ⎕wi "tooltip" "Specify the SQL Results Database containing Bases to be Compared"[123] ⎕wi "limit" 30[124] ⎕wi "onExit" "⍎(mt ,⎕wres←0 INPUT∆CHECK 'fmBasisCompare.cbsqlDBase')/'0 0⍴(⊂⎕wi ''name'') Basis_Compare ''Change'' ' "[125] ⎕wi "onExitError" "Win∆ExitError ⎕warg"[126] ⎕wi "style" 16 128 256 0[127] ⎕wi "∆where" (2 2⍴0.05 0 0.15 0)[128] ⎕wi "where" (("fmBasisCompare" ⎕wi "size") Win∆Resize (2 2⍴0.05 0 0.15 0))[129] PickList←GetSQLDBases 1 1 1[130] ⎕wi "∆update" "GetSQLDBases 1 1 1"[131] PickList←⊃m2n 1 0↓PickList[132] PickList←" " OVER PickList[133] ⎕wi "list" PickList[134] ⎕wi "extent" (150,(¯10+8×¯1↑CharSize)+¯1↑Win∆TextSize ((0,⎕wi "limit")⌈⍴PickList)↑PickList)[135] ⎕wi "onClick" "0 0⍴(⊂⎕wi 'name') Basis_Compare 'Change' "[136] [137] ⎕wself←"fmBasisCompare.llsqlDBase" ⎕wi "New" "Label"[138] ⎕wi "scale" 5[139] ⎕wi "style" 2[140] ⎕wi "visible" (¯1+2×sqlDatabase)[141] ⎕wi "enabled" (sqlDatabase)[142] ⎕wi "extent" (↑⎕wi "Draw" ("?text" (("⍺",⎕tcnl) char_replace "SQL Results⍺Database")))[143] ⎕wi "caption" (("⍺",⎕tcnl) char_replace "SQL Results⍺Database")[144] where←4↑,"fmBasisCompare.cbsqlDBase" ⎕wi "∆where"[145] size←1↑"fmBasisCompare.cbsqlDBase" ⎕wi "extent"[146] size←¯3⌈0.5×(1↑⎕wi "extent")-size[147] x←0.5×⍴where←Win∆Calcwhere where-0,size,0,10+¯1↑⎕wi "extent"[148] ⎕wi "∆where" ((x,2)⍴where)[149] ⎕wi "where" (("fmBasisCompare" ⎕wi "size") Win∆Resize ⎕wi "∆where")[150] [151] ⎕wself←"fmBasisCompare.cbMembClass" ⎕wi "New" "Combo"[152] Fieldlist←Fieldlist OVER "fmBasisCompare.cbMembClass"[153] Fieldcontrol←Fieldcontrol OVER "Combo"[154] ⎕wi "∆name" "MembClass"[155] ⎕wi "∆type" "Char"[156] ⎕wi "∆mandatory" 1[157] ⎕wi "∆helpid" 5521[158] ⎕wi "tooltip" "Select the Membership Class"[159] ⎕wi "style" 16 128 256 2[160] ⎕wi "∆where" (2 2⍴0.05 0 0.6 0)[161] ⎕wi "where" (("fmBasisCompare" ⎕wi "size") Win∆Resize (2 2⍴0.05 0 0.6 0))[162] PickList←⍙POPUPSdict ReadDictFile "InputType"[163] PickList←⊃m2n 1 0↓PickList[164] ⎕wi "list" PickList[165] ⎕wi "extent" (150,(¯10+6×¯1↑CharSize)+¯1↑Win∆TextSize ((0,⎕wi "limit")⌈⍴PickList)↑PickList)[166] ⎕wi "onClick" "0 0⍴(⊂⎕wi 'name') Basis_Compare 'Change' "[167] [168] ⎕wself←"fmBasisCompare.llMembClass" ⎕wi "New" "Label"[169] ⎕wi "scale" 5[170] ⎕wi "style" 2[171] ⎕wi "extent" (↑⎕wi "Draw" ("?text" (("⍺",⎕tcnl) char_replace "Input⍺Data Type")))[172] ⎕wi "caption" (("⍺",⎕tcnl) char_replace "Input⍺Data Type")[173] where←4↑,"fmBasisCompare.cbMembClass" ⎕wi "∆where"[174] size←1↑"fmBasisCompare.cbMembClass" ⎕wi "extent"[175] size←¯3⌈0.5×(1↑⎕wi "extent")-size[176] x←0.5×⍴where←Win∆Calcwhere where-0,size,0,10+¯1↑⎕wi "extent"[177] ⎕wi "∆where" ((x,2)⍴where)[178] ⎕wi "where" (("fmBasisCompare" ⎕wi "size") Win∆Resize ⎕wi "∆where")[179] [180] ⎕wself←"fmBasisCompare.ckPPFbasis" ⎕wi "New" "Check"[181] Fieldlist←Fieldlist OVER "fmBasisCompare.ckPPFbasis"[182] Fieldcontrol←Fieldcontrol OVER "Check"[183] ⎕wi "∆name" "PPFbasis"[184] ⎕wi "∆type" "Check"[185] ⎕wi "∆helpid" 5522[186] ⎕wi "tooltip" "Indicate if you wish to compare PPF Bases"[187] ⎕wi "style" 0[188] ⎕wi "caption" "PPF Bases"[189] ⎕wi "∆where" (2 2⍴0.05 0 0.75 0)[190] ⎕wi "where" (("fmBasisCompare" ⎕wi "size") Win∆Resize (2 2⍴0.05 0 0.75 0))[191] ⎕wi "extent" ((0 5×CharSize)+Win∆TextSize ⎕wi "caption")[192] ⎕wi "onClick" "(0 0⍴(⊂⎕wi 'name') Basis_Compare 'Change' )"[193] [194] ⎕wself←"fmBasisCompare.lvruns" ⎕wi "New" "Listview"[195] Fieldlist←Fieldlist OVER "fmBasisCompare.lvruns"[196] Fieldcontrol←Fieldcontrol OVER "Listview"[197] ⎕wi "∆name" "runs"[198] ⎕wi "∆type" "Spinner"[199] ⎕wi "∆mandatory" 1[200] ⎕wi "∆helpid" 5523[201] ⎕wi "tooltip" "Select the Saved Bases to be Compared"[202] list←list OVER "fmBasisCompare.lvruns"[203] ⎕wi "scale" 5[204] ⎕wi "viewmode" "report"[205] ⎕wi "style" 1 4 0[206] ⎕wi "∆where" (4 2⍴0.14 0 0.03 0 0.7 0 0.94 0)[207] ⎕wi "where" (("fmBasisCompare" ⎕wi "size") Win∆Resize (4 2⍴0.14 0 0.03 0 0.7 0 0.94 0))[208] ⎕wi "∆update" "GetCompare"[209] (PickList NameList sortorder SortList)←4↑GetCompare[210] ⎕wi "list" PickList[211] NameList[;1]←NameList[;1],¨⊂4↑" "[212] ⎕wi "columndisplay" NameList[213] ⎕wi "AutoFit" "header" "all"[214] ⎕wi "∆sortorder" sortorder[215] ⎕wi "∆sortlist" SortList[216] ⎕wi "onColClick" "('fmBasisCompare.lvruns' 'Basis_Compare') Win∆SortListview ⎕warg"[217] :if 0=⎕nc "listviewDict"[218] listviewDict←MATRIX keysIn ListviewDict[219] :endif[220] :if ~mt sortorder←DLTB ↑((ListviewDict for "Control" "fmBasisCompare.lvruns") for "Parameters" "") at "Sort"[221] ("fmBasisCompare.lvruns" "Basis_Compare") Win∆SortListview sortorder[222] :else[223] ("fmBasisCompare.lvruns" "Basis_Compare") Win∆SortListview "Version"[224] :endif[225] ⎕wi "onResize" "Win∆SizeListview ⎕wi 'self'"[226] ⎕wi "∆spinner" "fmBasisCompare.spruns"[227] ⎕wi "onPaint" "1 Sel∆LabelUpdate 'fmBasisCompare.lvruns' "[228] ⎕wi "onSelect" "1 Sel∆LabelUpdate 'fmBasisCompare.lvruns' ⋄ 0 0⍴(⊂⎕wi 'name') Basis_Compare 'Change' "[229] ⎕wi "onExit" "⍎(0∊⍴,⎕wres←0 List∆CHECK 'fmBasisCompare.lvruns')/'0 0⍴(⊂⎕wi ''name'') Basis_Compare ''Change'' ' "[230] ⎕wi "onExitError" "Win∆ExitError ⎕warg"[231] ⎕wi "∆rightlabel" "fmBasisCompare.lrruns"[232] [233] ⎕wself←"fmBasisCompare.lrruns" ⎕wi "New" "Label"[234] ⎕wi "scale" 5[235] ⎕wi "extent" (CharSize×¯2↑1,19)[236] ⎕wi "style" 32[237] ⎕wi "caption" " "[238] where←4↑,"fmBasisCompare.lvruns" ⎕wi "∆where"[239] x←0.5×⍴where←Win∆Calcwhere where+((5+1↑2↓"fmBasisCompare.lvruns" ⎕wi "where") CDIV 1↑"fmBasisCompare" ⎕wi "size"),0 0 0[240] ⎕wi "∆where" ((x,2)⍴where)[241] ⎕wi "where" (("fmBasisCompare" ⎕wi "size") Win∆Resize ⎕wi "∆where")[242] [243] ⎕wself←"fmBasisCompare.spruns" ⎕wi "New" "Spinner"[244] ⎕wi "scale" 5[245] ⎕wi "range" 0 1[246] ⎕wi "wrap" 1[247] where←4↑,"fmBasisCompare.lvruns" ⎕wi "∆where"[248] x←0.5×⍴where←Win∆Calcwhere where+0 20 0 ¯30[249] ⎕wi "∆where" ((x,2)⍴where)[250] ⎕wi "where" (("fmBasisCompare" ⎕wi "size") Win∆Resize ⎕wi "∆where")[251] ⎕wi "extent" 50 25[252] ⎕wi "onSpin" "0 0⍴⎕wres Basis_Compare 'Spin' "[253] ⎕wi "tooltip" "Selections will be processed in the order displayed.
Use Spinners to re-order a single or contiguous set of selections"[254] [255] ⎕wself←"fmBasisCompare.edFilename" ⎕wi "New" "Edit"[256] Fieldlist←Fieldlist OVER "fmBasisCompare.edFilename"[257] Fieldcontrol←Fieldcontrol OVER "Edit"[258] ⎕wi "∆name" "Filename"[259] ⎕wi "∆type" "File"[260] ⎕wi "∆mandatory" 1[261] ⎕wi "∆valid" ('New' 'Single')[262] ⎕wi "∆helpid" 5524[263] ⎕wi "tooltip" "Specify the Excel Output File Name
(Double Click for Open File Dialog)"[264] ⎕wi "∆where" (2 2⍴0.9 0 0.4 0)[265] ⎕wi "where" (("fmBasisCompare" ⎕wi "size") Win∆Resize (2 2⍴0.9 0 0.4 0))[266] ⎕wi "onExit" "⍎(0∊⍴,⎕wres←0 INPUT∆CHECK 'fmBasisCompare.edFilename')/'0 0⍴(⊂⎕wi ''name'') Basis_Compare ''Change'' ' "[267] ⎕wi "onExitError" "Win∆ExitError ⎕warg"[268] ⎕wi "extent" (2+CharSize×1 31)[269] ⎕wi "pointer" ">cur 1001 shell32.dll"[270] ⎕wi "onMouseDouble" "'New Single' GetFileList 'Single' "[271] ⎕wi "targetformats" "FileName"[272] ⎕wi "onDrop" "'fmBasisCompare.edFilename' Win∆DropTarget 0 ('New' 'Single')"[273] ⎕wi "onChange" "0 0⍴(⊂⎕wi 'name') Basis_Compare 'Change' "[274] [275] ⎕wself←"fmBasisCompare.llFilename" ⎕wi "New" "Label"[276] ⎕wi "scale" 5[277] ⎕wi "style" 2[278] ⎕wi "extent" (↑⎕wi "Draw" ("?text" "Excel Output Filename"))[279] ⎕wi "caption" "Excel Output Filename"[280] where←4↑,"fmBasisCompare.edFilename" ⎕wi "∆where"[281] x←0.5×⍴where←Win∆Calcwhere where-0 ¯3 0,10+¯1↑⎕wi "extent"[282] ⎕wi "∆where" ((x,2)⍴where)[283] ⎕wi "where" (("fmBasisCompare" ⎕wi "size") Win∆Resize ⎕wi "∆where")[284] [285] "fmBasisCompare" ⎕wi "∆multifile" ""[286] "fmBasisCompare" ⎕wi "∆singlefile" ""[287] "fmBasisCompare" ⎕wi "∆format" ""[288] "fmBasisCompare" ⎕wi "∆financial" 0[289] "fmBasisCompare" ⎕wi "∆relrules" 0[290] "fmBasisCompare" ⎕wi "∆parm" 0[291] "fmBasisCompare" ⎕wi "∆decr" 0[292] "fmBasisCompare" ⎕wi "∆file" 0[293] "fmBasisCompare" ⎕wi "∆codefile" CodeFile[294] "fmBasisCompare" ⎕wi "∆inputstype" "ClientFile"[295] "fmBasisCompare" ⎕wi "∆inputsentry" "Single"[296] "fmBasisCompare" ⎕wi "∆savecn" (⍳0)[297] "fmBasisCompare" ⎕wi "∆savedesc" ""[298] list←list OVER "fmBasisCompare"[299] "fmBasisCompare" ⎕wi "∆fieldlist" Fieldlist[300] "fmBasisCompare" ⎕wi "∆fieldcontrol" Fieldcontrol[301] childlist←"fmSV" ⎕wi "∆childlist"[302] list←(⊃¯1↑childlist) OVER list[303] childlist[⍴childlist]←⊂list[304] "fmSV" ⎕wi "∆childlist" childlist[305] list←,⎕split list[306] 0 0⍴((∨/¨(⊂".mBasis_Compare")⍷¨list)/list) MultiWI "enabled" 1[307] :if 300<fnsize[308]     (fnsize fnsize ".") Win∆ProgressBar "MemberUpdate"[309]     Win∆ProgressBar "Hide"[310] :endif[311] "Init" OpenParameters "Basis_Compare"[312] "fmBasisCompare.bnBasis_CompareHelp" ⎕wi "visible" 1[313] "fmBasisCompare.bnBasis_CompareQuit" ⎕wi "visible" 1[314] "fmBasisCompare.bnBasis_CompareSave" ⎕wi "visible" 1[315] "#" ⎕wi "focus" "fmBasisCompare.cbmdbFile"[316] :if ~0∊⍴,Error←Win∆Initialise "Basis_Compare"[317]     "Quit" EndModule Module[318]     "fmSV" ⎕wi "pointer" 0[319]     0 0⍴"fmBasisCompare" ⎕wi "Delete"[320]     :return[321] :endif[322] :if bar_open←commandbar^"Multi"≡"Single"[323]     bar_open←0×"fmBasisCompare.mBasis_CompareFile.m" Win∆CommandBar "OKHelp"[324] :endif[325] "fmBasisCompare" ⎕wi "Paint"[326] "fmSV" ⎕wi "pointer" 11[327] "fmBasisCompare" ⎕wi "onWait" "0 0⍴Basis_Compare 'Wait' ⋄ 'fmBasisCompare' ⎕wi 'modified' 0"[328] 0 0⍴"fmBasisCompare" ⎕wi "Wait"[329] 0 0⍴"fmBasisCompare" ⎕wi "Delete"[330] "fmSV" ⎕wi "pointer" 0 ∇