∇ Container←Form_Make;⎕wself;ControlName;childlist;list;Fieldlist;Fieldcontrol;FrameWidth;Caption;buttonsize;buttonwhere;where;size;alignment;Header;PickList;NameList;value;sortorder;SortList;MaxRow;MaxCol;Parent;level;node;no;nn;NN;x;fnsize;framelist;relTests[1] [2] Fieldlist←Fieldcontrol←list←0 0⍴""[3] "fmSV" ⎕wi "pointer" 13[4] buttonsize←25 65 ⋄ buttonwhere←¯5[5] FormName ⎕wi "caption" ((FormName ⎕wi "caption")," - Retirement Age Definition")[6] "fmSV" ⎕wi "∆caption" (("fmSV" ⎕wi "∆caption"),⊂("fmSV" ⎕wi "caption"))[7] :if 300<fnsize←1↑⍴⎕cr "Form_Make"[8]     "Generating Form" Win∆ProgressBar "Open"[9]     ("Menu Items:" "Form Controls:") Win∆ProgressBar "SetLabels"[10]     (1 1 "Help About") Win∆ProgressBar "FileUpdate"[11] :endif[12] [13] Container←"∆Dialog"[14] [15] ⎕wself←"fmRetAge" ⎕wi "New" "Form" "Hide"[16] ⎕wi "caption" ("fmSV" ⎕wi "caption")[17] ⎕wi "scale" 5[18] ⎕wi "font" ("fmSV" ⎕wi "font")[19] ⎕wi "border" 2 32 64[20] ⎕wi "where" (Win∆CentrePos 0.3 0.7×768 1024×1⌈CharSize÷13 6)[21] ⎕wi "limitwhere" (0.8×¯2↑⎕wi "where")[22] ⎕wi "tooltipwidth" 200[23] ⎕wi "onResize" "AutoResize"[24] ⎕wi "onClose" "ExitSystem ''"[25] ControlName←"fmRetAge"[26] relTests←1[27] 0 Menu_Make "fmSV"[28] 1 Menu_Make "fmRetAge"[29] "fmRetAge" Win∆CutCopyPaste "Build"[30] "fmRetAge" ⎕wi "∆helpid" 2163[31] list←list OVER "fmRetAge.bnRetirement_AgeHelp"[32] ⎕wself←"fmRetAge.bnRetirement_AgeHelp" ⎕wi "New" "Button"[33] ⎕wi "deferexit" 1[34] ⎕wi "extent" (size←1×buttonsize×1⌈CharSize÷13 6)[35] x←0.5×⍴where←Win∆Calcwhere 1,(¯10-size[1]),1,buttonwhere←buttonwhere-5+size[2][36] ⎕wi "∆where" ((x,2)⍴where)[37] ⎕wi "where" (("fmRetAge" ⎕wi "size") Win∆Resize ⎕wi "∆where")[38] ⎕wi "tooltip" "SuperVal Help"[39] ⎕wi "onClick" ("fmSV.mRetirement_AgeHelp.mContext"⎕wi "onClick")[40] ⎕wi "caption" "Help"[41] :if buttonimage[42]     ⎕wi "imagelist" "fmSV.iStandard"[43]     ⎕wi "imageindex" 12[44] :endif[45] ⎕wi "visible" ¯1[46] ⎕wi "onMouseDown" "∆HelpField←'#' ⎕wi 'focus' "[47] list←list OVER "fmRetAge.bnRetirement_AgeQuit"[48] ⎕wself←"fmRetAge.bnRetirement_AgeQuit" ⎕wi "New" "Button"[49] ⎕wi "style" 2[50] ⎕wi "deferexit" 1[51] ⎕wi "extent" (size←1×buttonsize×1⌈CharSize÷13 6)[52] x←0.5×⍴where←Win∆Calcwhere 1,(¯10-size[1]),1,buttonwhere←buttonwhere-5+size[2][53] ⎕wi "∆where" ((x,2)⍴where)[54] ⎕wi "where" (("fmRetAge" ⎕wi "size") Win∆Resize ⎕wi "∆where")[55] ⎕wi "tooltip" "Quit and Return"[56] ⎕wi "onClick" ("fmSV.mRetirement_AgeFile.mQuit"⎕wi "onClick")[57] ⎕wi "caption" "Quit"[58] ⎕wi "∆helpid" 4258[59] ⎕wi "order" .5[60] ⎕wi "visible" ¯1[61] ControlName ⎕wi "∆quitbutton" "fmRetAge.bnRetirement_AgeQuit"[62] list←list OVER "fmRetAge.bnRetirement_AgeSave"[63] ⎕wself←"fmRetAge.bnRetirement_AgeSave" ⎕wi "New" "Button"[64] ⎕wi "extent" (size←1×buttonsize×1⌈CharSize÷13 6)[65] x←0.5×⍴where←Win∆Calcwhere 1,(¯10-size[1]),1,buttonwhere←buttonwhere-5+size[2][66] ⎕wi "∆where" ((x,2)⍴where)[67] ⎕wi "where" (("fmRetAge" ⎕wi "size") Win∆Resize ⎕wi "∆where")[68] ⎕wi "tooltip" "Save Parameters"[69] ⎕wi "onClick" ("fmSV.mRetirement_AgeFile.mSave"⎕wi "onClick")[70] ⎕wi "caption" "Save"[71] :if buttonimage[72]     ⎕wi "imagelist" "fmSV.iStandard"[73]     ⎕wi "imageindex" 9[74] :endif[75] ⎕wi "∆helpid" 4259[76] ⎕wi "enabled" 0[77] ⎕wi "order" .5[78] ⎕wi "visible" ¯1[79] "fmRetAge" ⎕wi "onModified" "('Retirement_Age' 'fmRetAge.bnRetirement_AgeSave') Win∆SaveEnabled (0≠⎕warg[1])"[80] list←list OVER "fmRetAge.bnRetirement_AgeSaveAs"[81] ⎕wself←"fmRetAge.bnRetirement_AgeSaveAs" ⎕wi "New" "Button"[82] ⎕wi "extent" (size←1×buttonsize×1⌈CharSize÷13 6)[83] x←0.5×⍴where←Win∆Calcwhere 1,(¯10-size[1]),1,buttonwhere←buttonwhere-5+size[2][84] ⎕wi "∆where" ((x,2)⍴where)[85] ⎕wi "where" (("fmRetAge" ⎕wi "size") Win∆Resize ⎕wi "∆where")[86] ⎕wi "tooltip" "Save Parameters As ..."[87] ⎕wi "onClick" ("fmSV.mRetirement_AgeFile.mSaveAs"⎕wi "onClick")[88] ⎕wi "caption" "Save As"[89] ⎕wi "∆helpid" 4260[90] ⎕wi "order" .5[91] ⎕wi "visible" ¯1[92] "fmRetAge" ⎕wi "∆audit" 1[93] [94] ⎕wself←"fmRetAge.edgraLRA" ⎕wi "New" "Edit"[95] Fieldlist←Fieldlist OVER "fmRetAge.edgraLRA"[96] Fieldcontrol←Fieldcontrol OVER "Edit"[97] ⎕wi "∆name" "graLRA"[98] ⎕wi "∆type" "Num"[99] ⎕wi "∆mandatory" 1[100] ⎕wi "enabled" (bGAD)[101] ⎕wi "∆valid" ('Int' 'Scalar' '+')[102] ⎕wi "∆helpid" 4261[103] ⎕wi "tooltip" "Specify the Late Normal Retirement Age"[104] ⎕wi "limit" 2[105] ⎕wi "∆where" (2 2⍴0.5 0 0.5 0)[106] ⎕wi "where" (("fmRetAge" ⎕wi "size") Win∆Resize (2 2⍴0.5 0 0.5 0))[107] ⎕wi "∆range" "20 99"[108] ⎕wi "onChange" "0 0⍴(⊂⎕wi 'name') Retirement_Age 'Change' "[109] ⎕wi "onExit" "⍎(0∊⍴,⎕wres←0 INPUT∆CHECK 'fmRetAge.edgraLRA')/'0 0⍴(⊂⎕wi ''name'') Retirement_Age ''Change'' ' "[110] ⎕wi "onExitError" "Win∆ExitError ⎕warg"[111] ⎕wi "onKeyPress" "⎕wres←¯2×~⎕warg∊8 32 48 49 50 51 52 53 54 55 56 57"[112] ⎕wi "extent" (2+CharSize×1 3)[113] [114] ⎕wself←"fmRetAge.lrgraLRA" ⎕wi "New" "Label"[115] ⎕wi "scale" 5[116] ⎕wi "enabled" (bGAD)[117] ⎕wi "extent" (↑⎕wi "Draw" ("?text" "years"))[118] ⎕wi "caption" "years"[119] where←4↑,"fmRetAge.edgraLRA" ⎕wi "∆where"[120] x←0.5×⍴where←Win∆Calcwhere where+0,3,0,10+¯1↑"fmRetAge.edgraLRA" ⎕wi "extent"[121] ⎕wi "∆where" ((x,2)⍴where)[122] ⎕wi "where" (("fmRetAge" ⎕wi "size") Win∆Resize ⎕wi "∆where")[123] [124] ⎕wself←"fmRetAge.llgraLRA" ⎕wi "New" "Label"[125] ⎕wi "scale" 5[126] ⎕wi "style" 2[127] ⎕wi "enabled" (bGAD)[128] ⎕wi "extent" (↑⎕wi "Draw" ("?text" "Late Retirement Age"))[129] ⎕wi "caption" "Late Retirement Age"[130] where←4↑,"fmRetAge.edgraLRA" ⎕wi "∆where"[131] x←0.5×⍴where←Win∆Calcwhere where-0 ¯3 0,10+¯1↑⎕wi "extent"[132] ⎕wi "∆where" ((x,2)⍴where)[133] ⎕wi "where" (("fmRetAge" ⎕wi "size") Win∆Resize ⎕wi "∆where")[134] [135] ⎕wself←"fmRetAge.edgraNRA" ⎕wi "New" "Edit"[136] Fieldlist←Fieldlist OVER "fmRetAge.edgraNRA"[137] Fieldcontrol←Fieldcontrol OVER "Edit"[138] ⎕wi "∆name" "graNRA"[139] ⎕wi "∆type" "Num"[140] ⎕wi "∆mandatory" 1[141] ⎕wi "∆valid" ('Int' 'Scalar' '+')[142] ⎕wi "∆helpid" 4262[143] ⎕wi "tooltip" "Specify the Normal Retirement Age"[144] ⎕wi "limit" 2[145] ⎕wi "∆where" (2 2⍴0.2 0 0.5 0)[146] ⎕wi "where" (("fmRetAge" ⎕wi "size") Win∆Resize (2 2⍴0.2 0 0.5 0))[147] ⎕wi "∆range" "20 99"[148] ⎕wi "onChange" "0 0⍴(⊂⎕wi 'name') Retirement_Age 'Change' "[149] ⎕wi "onExit" "⍎(0∊⍴,⎕wres←0 INPUT∆CHECK 'fmRetAge.edgraNRA')/'0 0⍴(⊂⎕wi ''name'') Retirement_Age ''Change'' ' "[150] ⎕wi "onExitError" "Win∆ExitError ⎕warg"[151] ⎕wi "onKeyPress" "⎕wres←¯2×~⎕warg∊8 32 48 49 50 51 52 53 54 55 56 57"[152] ⎕wi "extent" (2+CharSize×1 3)[153] [154] ⎕wself←"fmRetAge.lrgraNRA" ⎕wi "New" "Label"[155] ⎕wi "scale" 5[156] ⎕wi "extent" (↑⎕wi "Draw" ("?text" "years"))[157] ⎕wi "caption" "years"[158] where←4↑,"fmRetAge.edgraNRA" ⎕wi "∆where"[159] x←0.5×⍴where←Win∆Calcwhere where+0,3,0,10+¯1↑"fmRetAge.edgraNRA" ⎕wi "extent"[160] ⎕wi "∆where" ((x,2)⍴where)[161] ⎕wi "where" (("fmRetAge" ⎕wi "size") Win∆Resize ⎕wi "∆where")[162] [163] ⎕wself←"fmRetAge.llgraNRA" ⎕wi "New" "Label"[164] ⎕wi "scale" 5[165] ⎕wi "style" 2[166] ⎕wi "extent" (↑⎕wi "Draw" ("?text" "Normal Retirement Age"))[167] ⎕wi "caption" "Normal Retirement Age"[168] where←4↑,"fmRetAge.edgraNRA" ⎕wi "∆where"[169] x←0.5×⍴where←Win∆Calcwhere where-0 ¯3 0,10+¯1↑⎕wi "extent"[170] ⎕wi "∆where" ((x,2)⍴where)[171] ⎕wi "where" (("fmRetAge" ⎕wi "size") Win∆Resize ⎕wi "∆where")[172] [173] ⎕wself←"fmRetAge.lParmDesc" ⎕wi "New" "Label"[174] ⎕wi "scale" 5[175] ⎕wi "extent" (CharSize×¯2↑1,80)[176] ⎕wi "style" 32[177] ⎕wi "caption" " "[178] ⎕wi "∆where" (2 2⍴0.9 0 0.02 0)[179] ⎕wi "where" (("fmRetAge" ⎕wi "size") Win∆Resize (2 2⍴0.9 0 0.02 0))[180] [181] "fmRetAge" ⎕wi "∆multifile" ""[182] "fmRetAge" ⎕wi "∆singlefile" ""[183] "fmRetAge" ⎕wi "∆format" ""[184] "fmRetAge" ⎕wi "∆financial" 0[185] "fmRetAge" ⎕wi "∆relrules" 1[186] "fmRetAge" ⎕wi "∆parm" 0[187] "fmRetAge" ⎕wi "∆decr" 0[188] "fmRetAge" ⎕wi "∆file" 0[189] "fmRetAge" ⎕wi "∆codefile" CodeFile[190] "fmRetAge" ⎕wi "∆inputstype" "ClientFile"[191] "fmRetAge" ⎕wi "∆inputsentry" "Multi"[192] "fmRetAge" ⎕wi "∆savecn" (⍳0)[193] "fmRetAge" ⎕wi "∆savedesc" ""[194] list←list OVER "fmRetAge"[195] "fmRetAge" ⎕wi "∆fieldlist" Fieldlist[196] "fmRetAge" ⎕wi "∆fieldcontrol" Fieldcontrol[197] childlist←"fmSV" ⎕wi "∆childlist"[198] list←(⊃¯1↑childlist) OVER list[199] childlist[⍴childlist]←⊂list[200] "fmSV" ⎕wi "∆childlist" childlist[201] list←,⎕split list[202] 0 0⍴((∨/¨(⊂".mRetirement_Age")⍷¨list)/list) MultiWI "enabled" 1[203] :if 300<fnsize[204]     (fnsize fnsize ".") Win∆ProgressBar "MemberUpdate"[205]     Win∆ProgressBar "Hide"[206] :endif[207] "Init" OpenParameters "Retirement_Age"[208] "fmRetAge.bnRetirement_AgeHelp" ⎕wi "visible" 1[209] "fmRetAge.bnRetirement_AgeQuit" ⎕wi "visible" 1[210] "fmRetAge.bnRetirement_AgeSave" ⎕wi "visible" 1[211] "fmRetAge.bnRetirement_AgeSaveAs" ⎕wi "visible" 1[212] "#" ⎕wi "focus" "fmRetAge.edgraLRA"[213] :if ~0∊⍴,Error←Win∆Initialise "Retirement_Age"[214]     "Quit" EndModule Module[215]     "fmSV" ⎕wi "pointer" 0[216]     0 0⍴"fmRetAge" ⎕wi "Delete"[217]     :return[218] :endif[219] :if bar_open←commandbar^"Multi"≡"Multi"[220]     bar_open←0×"fmRetAge.mRetirement_AgeFile.m" Win∆CommandBar "SaveAsHelp"[221] :endif[222] "fmRetAge" ⎕wi "Paint"[223] "fmSV" ⎕wi "pointer" 11[224] "fmRetAge" ⎕wi "onWait" "0 0⍴Retirement_Age 'Wait'"[225] 0 0⍴"fmRetAge" ⎕wi "Wait"[226] 0 0⍴"fmRetAge" ⎕wi "Delete"[227] "fmSV" ⎕wi "pointer" 0 ∇