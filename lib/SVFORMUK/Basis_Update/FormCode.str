∇ Container←Form_Make;⎕wself;ControlName;childlist;list;Fieldlist;Fieldcontrol;FrameWidth;Caption;buttonsize;buttonwhere;where;size;alignment;Header;PickList;NameList;value;sortorder;SortList;MaxRow;MaxCol;Parent;level;node;no;nn;NN;x;fnsize;framelist;relTests[1] [2] Fieldlist←Fieldcontrol←list←0 0⍴""[3] "fmSV" ⎕wi "pointer" 13[4] buttonsize←25 65 ⋄ buttonwhere←¯5[5] FormName ⎕wi "caption" ((FormName ⎕wi "caption")," - Update Basis Parameters")[6] "fmSV" ⎕wi "∆caption" (("fmSV" ⎕wi "∆caption"),⊂("fmSV" ⎕wi "caption"))[7] :if 300<fnsize←1↑⍴⎕cr "Form_Make"[8]     "Generating Form" Win∆ProgressBar "Open"[9]     ("Menu Items:" "Form Controls:") Win∆ProgressBar "SetLabels"[10]     (1 1 "Help About") Win∆ProgressBar "FileUpdate"[11] :endif[12] [13] Container←"∆Dialog"[14] [15] ⎕wself←"fmUpdBases" ⎕wi "New" "Form" "Hide"[16] ⎕wi "caption" ("fmSV" ⎕wi "caption")[17] ⎕wi "scale" 5[18] ⎕wi "font" ("fmSV" ⎕wi "font")[19] ⎕wi "border" 2 32 64[20] ⎕wi "where" (Win∆CentrePos 1.2 1 ×768 1024×1⌈CharSize÷13 6)[21] ⎕wi "limitwhere" (0.8×¯2↑⎕wi "where")[22] ⎕wi "tooltipwidth" 200[23] ⎕wi "onResize" "AutoResize"[24] ⎕wi "onClose" "ExitSystem ''"[25] ControlName←"fmUpdBases"[26] relTests←0[27] 0 Menu_Make "fmSV"[28] 1 Menu_Make "fmUpdBases"[29] "fmUpdBases" Win∆CutCopyPaste "Build"[30] "fmUpdBases" ⎕wi "∆helpid" 2250[31] list←list OVER "fmUpdBases.bnBasis_UpdateHelp"[32] ⎕wself←"fmUpdBases.bnBasis_UpdateHelp" ⎕wi "New" "Button"[33] ⎕wi "deferexit" 1[34] ⎕wi "extent" (size←1×buttonsize×1⌈CharSize÷13 6)[35] x←0.5×⍴where←Win∆Calcwhere 1,(¯10-size[1]),1,buttonwhere←buttonwhere-5+size[2][36] ⎕wi "∆where" ((x,2)⍴where)[37] ⎕wi "where" (("fmUpdBases" ⎕wi "size") Win∆Resize ⎕wi "∆where")[38] ⎕wi "tooltip" "SuperVal Help"[39] ⎕wi "onClick" ("fmSV.mBasis_UpdateHelp.mContext"⎕wi "onClick")[40] ⎕wi "caption" "Help"[41] :if buttonimage[42]     ⎕wi "imagelist" "fmSV.iStandard"[43]     ⎕wi "imageindex" 12[44] :endif[45] ⎕wi "visible" ¯1[46] ⎕wi "onMouseDown" "∆HelpField←'#' ⎕wi 'focus' "[47] list←list OVER "fmUpdBases.bnBasis_UpdateQuit"[48] ⎕wself←"fmUpdBases.bnBasis_UpdateQuit" ⎕wi "New" "Button"[49] ⎕wi "style" 2[50] ⎕wi "deferexit" 1[51] ⎕wi "extent" (size←1×buttonsize×1⌈CharSize÷13 6)[52] x←0.5×⍴where←Win∆Calcwhere 1,(¯10-size[1]),1,buttonwhere←buttonwhere-5+size[2][53] ⎕wi "∆where" ((x,2)⍴where)[54] ⎕wi "where" (("fmUpdBases" ⎕wi "size") Win∆Resize ⎕wi "∆where")[55] ⎕wi "tooltip" "Quit and Return"[56] ⎕wi "onClick" ("fmSV.mBasis_UpdateFile.mQuit"⎕wi "onClick")[57] ⎕wi "caption" "Quit"[58] ⎕wi "∆helpid" 5326[59] ⎕wi "order" .5[60] ⎕wi "visible" ¯1[61] ControlName ⎕wi "∆quitbutton" "fmUpdBases.bnBasis_UpdateQuit"[62] list←list OVER "fmUpdBases.bnBasis_UpdateSave"[63] ⎕wself←"fmUpdBases.bnBasis_UpdateSave" ⎕wi "New" "Button"[64] ⎕wi "extent" (size←1×buttonsize×1⌈CharSize÷13 6)[65] x←0.5×⍴where←Win∆Calcwhere 1,(¯10-size[1]),1,buttonwhere←buttonwhere-5+size[2][66] ⎕wi "∆where" ((x,2)⍴where)[67] ⎕wi "where" (("fmUpdBases" ⎕wi "size") Win∆Resize ⎕wi "∆where")[68] ⎕wi "tooltip" "Save Parameters"[69] ⎕wi "onClick" ("fmSV.mBasis_UpdateFile.mSave"⎕wi "onClick")[70] ⎕wi "caption" "Save"[71] :if buttonimage[72]     ⎕wi "imagelist" "fmSV.iStandard"[73]     ⎕wi "imageindex" 9[74] :endif[75] ⎕wi "∆helpid" 5327[76] ⎕wi "enabled" 0[77] ⎕wi "order" .5[78] ⎕wi "visible" ¯1[79] "fmUpdBases" ⎕wi "onModified" "('Basis_Update' 'fmUpdBases.bnBasis_UpdateSave') Win∆SaveEnabled (0≠⎕warg[1])"[80] list←list OVER "fmUpdBases.bnBasis_UpdateSaveAs"[81] ⎕wself←"fmUpdBases.bnBasis_UpdateSaveAs" ⎕wi "New" "Button"[82] ⎕wi "extent" (size←1×buttonsize×1⌈CharSize÷13 6)[83] x←0.5×⍴where←Win∆Calcwhere 1,(¯10-size[1]),1,buttonwhere←buttonwhere-5+size[2][84] ⎕wi "∆where" ((x,2)⍴where)[85] ⎕wi "where" (("fmUpdBases" ⎕wi "size") Win∆Resize ⎕wi "∆where")[86] ⎕wi "tooltip" "Save Parameters As ..."[87] ⎕wi "onClick" ("fmSV.mBasis_UpdateFile.mSaveAs"⎕wi "onClick")[88] ⎕wi "caption" "Save As"[89] ⎕wi "∆helpid" 5328[90] ⎕wi "order" .5[91] ⎕wi "visible" ¯1[92] list←list OVER "fmUpdBases.bnBasis_UpdateRun"[93] ⎕wself←"fmUpdBases.bnBasis_UpdateRun" ⎕wi "New" "Button"[94] ⎕wi "style" 1[95] ⎕wi "extent" (size←1×buttonsize×1⌈CharSize÷13 6)[96] x←0.5×⍴where←Win∆Calcwhere 1,(¯10-size[1]),1,buttonwhere←buttonwhere-5+size[2][97] ⎕wi "∆where" ((x,2)⍴where)[98] ⎕wi "where" (("fmUpdBases" ⎕wi "size") Win∆Resize ⎕wi "∆where")[99] ⎕wi "tooltip" "Save Parameters and Run Update Basis Parameters"[100] ⎕wi "onClick" ("fmSV.mBasis_UpdateFile.mRun"⎕wi "onClick")[101] ⎕wi "caption" "Run"[102] :if buttonimage[103]     ⎕wi "imagelist" "fmSV.iStandard"[104]     ⎕wi "imageindex" 33[105] :endif[106] ⎕wi "∆helpid" 5329[107] ⎕wi "order" .5[108] ⎕wi "visible" ¯1[109] "fmUpdBases" ⎕wi "∆audit" 1[110] [111] ⎕wself←"fmUpdBases.lvSavedScens" ⎕wi "New" "Listview"[112] Fieldlist←Fieldlist OVER "fmUpdBases.lvSavedScens"[113] Fieldcontrol←Fieldcontrol OVER "Listview"[114] ⎕wi "∆name" "SavedScens"[115] ⎕wi "∆type" "Listview"[116] ⎕wi "∆mandatory" 1[117] ⎕wi "∆helpid" 5330[118] ⎕wi "tooltip" "Select the Scenario Parameter Set to be used in Updating Basis Files"[119] list←list OVER "fmUpdBases.lvSavedScens"[120] ⎕wi "scale" 5[121] ⎕wi "viewmode" "report"[122] ⎕wi "style" 1 4 8[123] ⎕wi "∆where" (4 2⍴0.04 0 0.05 0 0.17 0 0.9 0)[124] ⎕wi "where" (("fmUpdBases" ⎕wi "size") Win∆Resize (4 2⍴0.04 0 0.05 0 0.17 0 0.9 0))[125] ⎕wi "∆update" "'Scenarios' GetParmDesc 'ClientFile'"[126] (PickList NameList sortorder SortList)←4↑'Scenarios' GetParmDesc 'ClientFile'[127] ⎕wi "list" PickList[128] NameList[;1]←NameList[;1],¨⊂4↑" "[129] ⎕wi "columndisplay" NameList[130] ⎕wi "AutoFit" "header" "all"[131] ⎕wi "∆sortorder" sortorder[132] ⎕wi "∆sortlist" SortList[133] ⎕wi "onColClick" "('fmUpdBases.lvSavedScens' 'Basis_Update') Win∆SortListview ⎕warg"[134] :if 0=⎕nc "listviewDict"[135] listviewDict←MATRIX keysIn ListviewDict[136] :endif[137] :if ~mt sortorder←DLTB ↑((ListviewDict for "Control" "fmUpdBases.lvSavedScens") for "Parameters" "") at "Sort"[138] ("fmUpdBases.lvSavedScens" "Basis_Update") Win∆SortListview sortorder[139] :else[140] ("fmUpdBases.lvSavedScens" "Basis_Update") Win∆SortListview "Date/Time Saved"[141] :endif[142] ⎕wi "onResize" "Win∆SizeListview ⎕wi 'self'"[143] ⎕wi "onSelect" "0 0⍴(⊂⎕wi 'name') Basis_Update 'Change' "[144] ⎕wi "onExit" "⎕wres←0 List∆CHECK 'fmUpdBases.lvSavedScens'"[145] ⎕wi "onExitError" "Win∆ExitError ⎕warg"[146] [147] ⎕wself←"fmUpdBases.llSavedScens" ⎕wi "New" "Label"[148] ⎕wi "scale" 5[149] ⎕wi "style" 2[150] ⎕wi "extent" (↑⎕wi "Draw" ("?text" "Saved Scenario Parameters"))[151] ⎕wi "caption" "Saved Scenario Parameters"[152] where←4↑,"fmUpdBases.lvSavedScens" ⎕wi "∆where"[153] x←0.5×⍴where←Win∆Calcwhere where-0,(5+1↑⎕wi "extent"),0 0[154] ⎕wi "∆where" ((x,2)⍴where)[155] ⎕wi "where" (("fmUpdBases" ⎕wi "size") Win∆Resize ⎕wi "∆where")[156] [157] ⎕wself←"fmUpdBases.ckupdateScheme" ⎕wi "New" "Check"[158] Fieldlist←Fieldlist OVER "fmUpdBases.ckupdateScheme"[159] Fieldcontrol←Fieldcontrol OVER "Check"[160] ⎕wi "∆name" "updateScheme"[161] ⎕wi "∆type" "Check"[162] ⎕wi "∆helpid" 5331[163] ⎕wi "tooltip" "Check this to update Scheme Details with new Valuation Date/Data Filenames using the settings in the selected Scenario"[164] ⎕wi "style" 0[165] ⎕wi "caption" "Update Scheme Details with new Valuation Date/Data File names"[166] ⎕wi "∆where" (2 2⍴0.23 0 0.35 0)[167] ⎕wi "where" (("fmUpdBases" ⎕wi "size") Win∆Resize (2 2⍴0.23 0 0.35 0))[168] ⎕wi "extent" ((0 5×CharSize)+Win∆TextSize ⎕wi "caption")[169] ⎕wi "onClick" "(0 0⍴(⊂⎕wi 'name') Basis_Update 'Change' )"[170] [171] ⎕wself←"fmUpdBases.lvSavedParms" ⎕wi "New" "Listview"[172] Fieldlist←Fieldlist OVER "fmUpdBases.lvSavedParms"[173] Fieldcontrol←Fieldcontrol OVER "Listview"[174] ⎕wi "∆name" "SavedParms"[175] ⎕wi "∆type" "ListviewM"[176] ⎕wi "∆helpid" 5332[177] ⎕wi "tooltip" "Select the Basis Parameter Set(s) to be Updated"[178] list←list OVER "fmUpdBases.lvSavedParms"[179] ⎕wi "scale" 5[180] ⎕wi "viewmode" "report"[181] ⎕wi "style" 1 4 0[182] ⎕wi "∆where" (4 2⍴0.28 0 0.05 0 0.45 0 0.9 0)[183] ⎕wi "where" (("fmUpdBases" ⎕wi "size") Win∆Resize (4 2⍴0.28 0 0.05 0 0.45 0 0.9 0))[184] ⎕wi "∆update" "('Actives_Basis' 'Deferreds_Basis' 'Pensioners_Basis') GetParmDesc 'BasisFile'"[185] (PickList NameList sortorder SortList)←4↑('Actives_Basis' 'Deferreds_Basis' 'Pensioners_Basis') GetParmDesc 'BasisFile'[186] ⎕wi "list" PickList[187] NameList[;1]←NameList[;1],¨⊂4↑" "[188] ⎕wi "columndisplay" NameList[189] ⎕wi "AutoFit" "header" "all"[190] ⎕wi "∆sortorder" sortorder[191] ⎕wi "∆sortlist" SortList[192] ⎕wi "onColClick" "('fmUpdBases.lvSavedParms' 'Basis_Update') Win∆SortListview ⎕warg"[193] :if 0=⎕nc "listviewDict"[194] listviewDict←MATRIX keysIn ListviewDict[195] :endif[196] :if ~mt sortorder←DLTB ↑((ListviewDict for "Control" "fmUpdBases.lvSavedParms") for "Parameters" "") at "Sort"[197] ("fmUpdBases.lvSavedParms" "Basis_Update") Win∆SortListview sortorder[198] :else[199] ("fmUpdBases.lvSavedParms" "Basis_Update") Win∆SortListview "Date/Time Saved"[200] :endif[201] ⎕wi "onResize" "Win∆SizeListview ⎕wi 'self'"[202] ⎕wi "onPaint" "0 Sel∆LabelUpdate 'fmUpdBases.lvSavedParms' "[203] ⎕wi "onSelect" "0 Sel∆LabelUpdate 'fmUpdBases.lvSavedParms' ⋄ 0 0⍴(⊂⎕wi 'name') Basis_Update 'Change' "[204] ⎕wi "onExit" "⍎(0∊⍴,⎕wres←0 List∆CHECK 'fmUpdBases.lvSavedParms')/'0 0⍴(⊂⎕wi ''name'') Basis_Update ''Change'' ' "[205] ⎕wi "onExitError" "Win∆ExitError ⎕warg"[206] ⎕wi "∆rightlabel" "fmUpdBases.lrSavedParms"[207] [208] ⎕wself←"fmUpdBases.lrSavedParms" ⎕wi "New" "Label"[209] ⎕wi "scale" 5[210] ⎕wi "extent" (CharSize×¯2↑1,19)[211] ⎕wi "style" 32[212] ⎕wi "caption" " "[213] where←4↑,"fmUpdBases.lvSavedParms" ⎕wi "∆where"[214] x←0.5×⍴where←Win∆Calcwhere where+((5+1↑2↓"fmUpdBases.lvSavedParms" ⎕wi "where") CDIV 1↑"fmUpdBases" ⎕wi "size"),0 0 0[215] ⎕wi "∆where" ((x,2)⍴where)[216] ⎕wi "where" (("fmUpdBases" ⎕wi "size") Win∆Resize ⎕wi "∆where")[217] [218] ⎕wself←"fmUpdBases.llSavedParms" ⎕wi "New" "Label"[219] ⎕wi "scale" 5[220] ⎕wi "style" 2[221] ⎕wi "extent" (↑⎕wi "Draw" ("?text" "Saved Basis Parameter Sets"))[222] ⎕wi "caption" "Saved Basis Parameter Sets"[223] where←4↑,"fmUpdBases.lvSavedParms" ⎕wi "∆where"[224] x←0.5×⍴where←Win∆Calcwhere where-0,(5+1↑⎕wi "extent"),0 0[225] ⎕wi "∆where" ((x,2)⍴where)[226] ⎕wi "where" (("fmUpdBases" ⎕wi "size") Win∆Resize ⎕wi "∆where")[227] [228] ⎕wself←"fmUpdBases.cbTargetFile" ⎕wi "New" "Combo"[229] Fieldlist←Fieldlist OVER "fmUpdBases.cbTargetFile"[230] Fieldcontrol←Fieldcontrol OVER "Combo"[231] ⎕wi "∆name" "TargetFile"[232] ⎕wi "∆type" "Char"[233] ⎕wi "∆helpid" 5333[234] ⎕wi "tooltip" "Specify a new or Select an existing Basis Parameters File
Leave Blank to use the Selected Basis File names (and overwrite Bases in those files)"[235] ⎕wi "limit" 40[236] ⎕wi "onExit" "⍎(mt ,⎕wres←0 INPUT∆CHECK 'fmUpdBases.cbTargetFile')/'0 0⍴(⊂⎕wi ''name'') Basis_Update ''Change'' ' "[237] ⎕wi "onExitError" "Win∆ExitError ⎕warg"[238] ⎕wi "style" 16 128 256 0[239] ⎕wi "∆where" (2 2⍴0.78 0 0.35 0)[240] ⎕wi "where" (("fmUpdBases" ⎕wi "size") Win∆Resize (2 2⍴0.78 0 0.35 0))[241] PickList←'BasisFile' GetParmFiles 1[242] ⎕wi "∆update" "'BasisFile' GetParmFiles 1"[243] PickList←⊃m2n 1 0↓PickList[244] PickList←" " OVER PickList[245] ⎕wi "list" PickList[246] ⎕wi "extent" (150,(¯10+8×¯1↑CharSize)+¯1↑Win∆TextSize ((0,⎕wi "limit")⌈⍴PickList)↑PickList)[247] ⎕wi "onClick" "0 0⍴(⊂⎕wi 'name') Basis_Update 'Change' "[248] ⎕wi "∆rightlabel" "fmUpdBases.lrTargetFile"[249] [250] ⎕wself←"fmUpdBases.lrTargetFile" ⎕wi "New" "Label"[251] ⎕wi "scale" 5[252] ⎕wi "extent" (↑⎕wi "Draw" ("?text" (("⍺",⎕tcnl) char_replace "{Leave Blank to update⍺selected Basis Files}")))[253] ⎕wi "caption" (("⍺",⎕tcnl) char_replace "{Leave Blank to update⍺selected Basis Files}")[254] where←4↑,"fmUpdBases.cbTargetFile" ⎕wi "∆where"[255] size←1↑"fmUpdBases.cbTargetFile" ⎕wi "extent"[256] size←¯3⌈0.5×(1↑⎕wi "extent")-size[257] x←0.5×⍴where←Win∆Calcwhere where+0,(-size),0,10+¯1↑"fmUpdBases.cbTargetFile" ⎕wi "extent"[258] ⎕wi "∆where" ((x,2)⍴where)[259] ⎕wi "where" (("fmUpdBases" ⎕wi "size") Win∆Resize ⎕wi "∆where")[260] [261] ⎕wself←"fmUpdBases.llTargetFile" ⎕wi "New" "Label"[262] ⎕wi "scale" 5[263] ⎕wi "style" 2[264] ⎕wi "extent" (↑⎕wi "Draw" ("?text" (("⍺",⎕tcnl) char_replace "Basis Parameter Filename⍺(to store Updated Bases)")))[265] ⎕wi "caption" (("⍺",⎕tcnl) char_replace "Basis Parameter Filename⍺(to store Updated Bases)")[266] where←4↑,"fmUpdBases.cbTargetFile" ⎕wi "∆where"[267] size←1↑"fmUpdBases.cbTargetFile" ⎕wi "extent"[268] size←¯3⌈0.5×(1↑⎕wi "extent")-size[269] x←0.5×⍴where←Win∆Calcwhere where-0,size,0,10+¯1↑⎕wi "extent"[270] ⎕wi "∆where" ((x,2)⍴where)[271] ⎕wi "where" (("fmUpdBases" ⎕wi "size") Win∆Resize ⎕wi "∆where")[272] [273] ⎕wself←"fmUpdBases.edTargetFileDesc" ⎕wi "New" "Edit"[274] Fieldlist←Fieldlist OVER "fmUpdBases.edTargetFileDesc"[275] Fieldcontrol←Fieldcontrol OVER "Edit"[276] ⎕wi "∆name" "TargetFileDesc"[277] ⎕wi "∆type" "Char"[278] ⎕wi "∆mandatory" 1[279] ⎕wi "enabled" (0)[280] ⎕wi "∆helpid" 5334[281] ⎕wi "tooltip" "Specify the Parameters File Description"[282] ⎕wi "∆where" (2 2⍴0.84 0 0.35 0)[283] ⎕wi "where" (("fmUpdBases" ⎕wi "size") Win∆Resize (2 2⍴0.84 0 0.35 0))[284] ⎕wi "onExit" "⍎(0∊⍴,⎕wres←0 INPUT∆CHECK 'fmUpdBases.edTargetFileDesc')/'0 0⍴(⊂⎕wi ''name'') Basis_Update ''Change'' ' "[285] ⎕wi "onExitError" "Win∆ExitError ⎕warg"[286] ⎕wi "extent" (2+CharSize×1 61)[287] [288] ⎕wself←"fmUpdBases.llTargetFileDesc" ⎕wi "New" "Label"[289] ⎕wi "scale" 5[290] ⎕wi "style" 2[291] ⎕wi "enabled" (0)[292] ⎕wi "extent" (↑⎕wi "Draw" ("?text" (("⍺",⎕tcnl) char_replace "New Basis File⍺Description")))[293] ⎕wi "caption" (("⍺",⎕tcnl) char_replace "New Basis File⍺Description")[294] where←4↑,"fmUpdBases.edTargetFileDesc" ⎕wi "∆where"[295] size←1↑"fmUpdBases.edTargetFileDesc" ⎕wi "extent"[296] size←¯3⌈0.5×(1↑⎕wi "extent")-size[297] x←0.5×⍴where←Win∆Calcwhere where-0,size,0,10+¯1↑⎕wi "extent"[298] ⎕wi "∆where" ((x,2)⍴where)[299] ⎕wi "where" (("fmUpdBases" ⎕wi "size") Win∆Resize ⎕wi "∆where")[300] [301] ⎕wself←"fmUpdBases.cbFinSavedDesc" ⎕wi "New" "Combo"[302] Fieldlist←Fieldlist OVER "fmUpdBases.cbFinSavedDesc"[303] Fieldcontrol←Fieldcontrol OVER "Combo"[304] ⎕wi "∆name" "FinSavedDesc"[305] ⎕wi "∆type" "Char"[306] ⎕wi "∆mandatory" 1[307] ⎕wi "∆helpid" 5335[308] ⎕wi "tooltip" "Select the description of the Financial Globals Parameters"[309] ⎕wi "style" 16 128 256 2[310] ⎕wi "∆where" (2 2⍴0.9 0 0.55 0)[311] ⎕wi "where" (("fmUpdBases" ⎕wi "size") Win∆Resize (2 2⍴0.9 0 0.55 0))[312] PickList←GetClientParms 'Financials' 1[313] ⎕wi "∆update" "GetClientParms 'Financials' 1"[314] PickList←⊃m2n 1 0↓PickList[315] ⎕wi "list" PickList[316] ⎕wi "extent" (150,(¯10+6×¯1↑CharSize)+¯1↑Win∆TextSize ((0,⎕wi "limit")⌈⍴PickList)↑PickList)[317] ⎕wi "onClick" "0 0⍴(⊂⎕wi 'name') Basis_Update 'Change' "[318] [319] ⎕wself←"fmUpdBases.llFinSavedDesc" ⎕wi "New" "Label"[320] ⎕wi "scale" 5[321] ⎕wi "style" 2[322] ⎕wi "extent" (↑⎕wi "Draw" ("?text" (("⍺",⎕tcnl) char_replace "Current Financial⍺Parameter Set")))[323] ⎕wi "caption" (("⍺",⎕tcnl) char_replace "Current Financial⍺Parameter Set")[324] where←4↑,"fmUpdBases.cbFinSavedDesc" ⎕wi "∆where"[325] size←1↑"fmUpdBases.cbFinSavedDesc" ⎕wi "extent"[326] size←¯3⌈0.5×(1↑⎕wi "extent")-size[327] x←0.5×⍴where←Win∆Calcwhere where-0,size,0,10+¯1↑⎕wi "extent"[328] ⎕wi "∆where" ((x,2)⍴where)[329] ⎕wi "where" (("fmUpdBases" ⎕wi "size") Win∆Resize ⎕wi "∆where")[330] [331] ⎕wself←"fmUpdBases.edFinNewDesc" ⎕wi "New" "Edit"[332] Fieldlist←Fieldlist OVER "fmUpdBases.edFinNewDesc"[333] Fieldcontrol←Fieldcontrol OVER "Edit"[334] ⎕wi "∆name" "FinNewDesc"[335] ⎕wi "∆type" "Char"[336] ⎕wi "∆mandatory" 1[337] ⎕wi "enabled" (0)[338] ⎕wi "∆helpid" 5335[339] ⎕wi "tooltip" "Specify the Parameter Set Description of the New Financials Set"[340] ⎕wi "∆where" (2 2⍴0.9 0 0.55 0)[341] ⎕wi "where" (("fmUpdBases" ⎕wi "size") Win∆Resize (2 2⍴0.9 0 0.55 0))[342] ⎕wi "onExit" "⍎(0∊⍴,⎕wres←0 INPUT∆CHECK 'fmUpdBases.edFinNewDesc')/'0 0⍴(⊂⎕wi ''name'') Basis_Update ''Change'' ' "[343] ⎕wi "onExitError" "Win∆ExitError ⎕warg"[344] ⎕wi "extent" (2+CharSize×1 61)[345] [346] ⎕wself←"fmUpdBases.llFinNewDesc" ⎕wi "New" "Label"[347] ⎕wi "scale" 5[348] ⎕wi "style" 2[349] ⎕wi "enabled" (0)[350] ⎕wi "extent" (↑⎕wi "Draw" ("?text" (("⍺",⎕tcnl) char_replace "New Financials⍺Parameter Set")))[351] ⎕wi "caption" (("⍺",⎕tcnl) char_replace "New Financials⍺Parameter Set")[352] where←4↑,"fmUpdBases.edFinNewDesc" ⎕wi "∆where"[353] size←1↑"fmUpdBases.edFinNewDesc" ⎕wi "extent"[354] size←¯3⌈0.5×(1↑⎕wi "extent")-size[355] x←0.5×⍴where←Win∆Calcwhere where-0,size,0,10+¯1↑⎕wi "extent"[356] ⎕wi "∆where" ((x,2)⍴where)[357] ⎕wi "where" (("fmUpdBases" ⎕wi "size") Win∆Resize ⎕wi "∆where")[358] [359] ⎕wself←"fmUpdBases.ckCreateFin" ⎕wi "New" "Check"[360] Fieldlist←Fieldlist OVER "fmUpdBases.ckCreateFin"[361] Fieldcontrol←Fieldcontrol OVER "Check"[362] ⎕wi "∆name" "CreateFin"[363] ⎕wi "∆type" "Check"[364] ⎕wi "enabled" (0)[365] ⎕wi "∆helpid" 5336[366] ⎕wi "tooltip" "Check this to create a new Financials Set using the settings in the selected Scenario"[367] ⎕wi "style" 0[368] ⎕wi "caption" "Create a new Financials Set"[369] ⎕wi "∆where" (2 2⍴0.9 0 0.15 0)[370] ⎕wi "where" (("fmUpdBases" ⎕wi "size") Win∆Resize (2 2⍴0.9 0 0.15 0))[371] ⎕wi "extent" ((0 5×CharSize)+Win∆TextSize ⎕wi "caption")[372] ⎕wi "onClick" "(0 0⍴(⊂⎕wi 'name') Basis_Update 'Change' )"[373] [374] ⎕wself←"fmUpdBases.lParmDesc" ⎕wi "New" "Label"[375] ⎕wi "scale" 5[376] ⎕wi "extent" (CharSize×¯2↑1,80)[377] ⎕wi "style" 32[378] ⎕wi "caption" " "[379] ⎕wi "∆where" (2 2⍴0.96 0 0.02 0)[380] ⎕wi "where" (("fmUpdBases" ⎕wi "size") Win∆Resize (2 2⍴0.96 0 0.02 0))[381] [382] "fmUpdBases" ⎕wi "∆multifile" ""[383] "fmUpdBases" ⎕wi "∆singlefile" ""[384] "fmUpdBases" ⎕wi "∆format" ""[385] "fmUpdBases" ⎕wi "∆financial" 0[386] "fmUpdBases" ⎕wi "∆relrules" 0[387] "fmUpdBases" ⎕wi "∆parm" 0[388] "fmUpdBases" ⎕wi "∆decr" 0[389] "fmUpdBases" ⎕wi "∆file" 0[390] "fmUpdBases" ⎕wi "∆codefile" CodeFile[391] "fmUpdBases" ⎕wi "∆inputstype" "ClientFile"[392] "fmUpdBases" ⎕wi "∆inputsentry" "Multi"[393] "fmUpdBases" ⎕wi "∆savecn" (⍳0)[394] "fmUpdBases" ⎕wi "∆savedesc" ""[395] list←list OVER "fmUpdBases"[396] "fmUpdBases" ⎕wi "∆fieldlist" Fieldlist[397] "fmUpdBases" ⎕wi "∆fieldcontrol" Fieldcontrol[398] childlist←"fmSV" ⎕wi "∆childlist"[399] list←(⊃¯1↑childlist) OVER list[400] childlist[⍴childlist]←⊂list[401] "fmSV" ⎕wi "∆childlist" childlist[402] list←,⎕split list[403] 0 0⍴((∨/¨(⊂".mBasis_Update")⍷¨list)/list) MultiWI "enabled" 1[404] :if 300<fnsize[405]     (fnsize fnsize ".") Win∆ProgressBar "MemberUpdate"[406]     Win∆ProgressBar "Hide"[407] :endif[408] "Init" OpenParameters "Basis_Update"[409] "fmUpdBases.bnBasis_UpdateHelp" ⎕wi "visible" 1[410] "fmUpdBases.bnBasis_UpdateQuit" ⎕wi "visible" 1[411] "fmUpdBases.bnBasis_UpdateSave" ⎕wi "visible" 1[412] "fmUpdBases.bnBasis_UpdateSaveAs" ⎕wi "visible" 1[413] "fmUpdBases.bnBasis_UpdateRun" ⎕wi "visible" 1[414] "#" ⎕wi "focus" "fmUpdBases.lvSavedScens"[415] :if ~0∊⍴,Error←Win∆Initialise "Basis_Update"[416]     "Quit" EndModule Module[417]     "fmSV" ⎕wi "pointer" 0[418]     0 0⍴"fmUpdBases" ⎕wi "Delete"[419]     :return[420] :endif[421] :if bar_open←commandbar^"Multi"≡"Multi"[422]     bar_open←0×"fmUpdBases.mBasis_UpdateFile.m" Win∆CommandBar "RunAsHelp"[423] :endif[424] "fmUpdBases" ⎕wi "Paint"[425] "fmSV" ⎕wi "pointer" 11[426] "fmUpdBases" ⎕wi "onWait" "0 0⍴Basis_Update 'Wait' ⋄ 'fmUpdBases' ⎕wi 'modified' 0"[427] 0 0⍴"fmUpdBases" ⎕wi "Wait"[428] 0 0⍴"fmUpdBases" ⎕wi "Delete"[429] "fmSV" ⎕wi "pointer" 0 ∇