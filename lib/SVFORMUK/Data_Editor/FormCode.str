∇ Container←Form_Make;⎕wself;ControlName;childlist;list;Fieldlist;Fieldcontrol;FrameWidth;Caption;buttonsize;buttonwhere;where;size;alignment;Header;PickList;NameList;value;sortorder;SortList;MaxRow;MaxCol;Parent;level;node;no;nn;NN;x;fnsize;framelist;relTests[1] [2] Fieldlist←Fieldcontrol←list←0 0⍴""[3] "fmSV" ⎕wi "pointer" 13[4] buttonsize←25 65 ⋄ buttonwhere←¯5[5] FormName ⎕wi "caption" ((FormName ⎕wi "caption")," - Input Data File Editor")[6] "fmSV" ⎕wi "∆caption" (("fmSV" ⎕wi "∆caption"),⊂("fmSV" ⎕wi "caption"))[7] :if 300<fnsize←1↑⍴⎕cr "Form_Make"[8]     "Generating Form" Win∆ProgressBar "Open"[9]     ("Menu Items:" "Form Controls:") Win∆ProgressBar "SetLabels"[10]     (1 1 "Help About") Win∆ProgressBar "FileUpdate"[11] :endif[12] [13] Container←"∆Dialog"[14] [15] ⎕wself←"fmDataEdit" ⎕wi "New" "Form" "Hide"[16] ⎕wi "caption" ("fmSV" ⎕wi "caption")[17] ⎕wi "scale" 5[18] ⎕wi "font" ("fmSV" ⎕wi "font")[19] ⎕wi "border" 2 32 64[20] ⎕wi "where" (Win∆CentrePos 1.7 1.7×768 1024×1⌈CharSize÷13 6)[21] ⎕wi "limitwhere" (0.8×¯2↑⎕wi "where")[22] ⎕wi "tooltipwidth" 200[23] ⎕wi "onResize" "AutoResize"[24] ⎕wi "onClose" "ExitSystem ''"[25] ControlName←"fmDataEdit"[26] relTests←0[27] 0 Menu_Make "fmSV"[28] 0 Menu_Make "fmDataEdit"[29] "fmDataEdit" Win∆CutCopyPaste "Build"[30] "fmDataEdit" ⎕wi "∆helpid" 2037[31] list←list OVER "fmDataEdit.bnData_EditorHelp"[32] ⎕wself←"fmDataEdit.bnData_EditorHelp" ⎕wi "New" "Button"[33] ⎕wi "deferexit" 1[34] ⎕wi "extent" (size←1×buttonsize×1⌈CharSize÷13 6)[35] x←0.5×⍴where←Win∆Calcwhere 1,(¯10-size[1]),1,buttonwhere←buttonwhere-5+size[2][36] ⎕wi "∆where" ((x,2)⍴where)[37] ⎕wi "where" (("fmDataEdit" ⎕wi "size") Win∆Resize ⎕wi "∆where")[38] ⎕wi "tooltip" "SuperVal Help"[39] ⎕wi "onClick" ("fmSV.mData_EditorHelp.mContext"⎕wi "onClick")[40] ⎕wi "caption" "Help"[41] :if buttonimage[42]     ⎕wi "imagelist" "fmSV.iStandard"[43]     ⎕wi "imageindex" 12[44] :endif[45] ⎕wi "visible" ¯1[46] ⎕wi "onMouseDown" "∆HelpField←'#' ⎕wi 'focus' "[47] list←list OVER "fmDataEdit.bnData_EditorQuit"[48] ⎕wself←"fmDataEdit.bnData_EditorQuit" ⎕wi "New" "Button"[49] ⎕wi "style" 2[50] ⎕wi "deferexit" 1[51] ⎕wi "extent" (size←1×buttonsize×1⌈CharSize÷13 6)[52] x←0.5×⍴where←Win∆Calcwhere 1,(¯10-size[1]),1,buttonwhere←buttonwhere-5+size[2][53] ⎕wi "∆where" ((x,2)⍴where)[54] ⎕wi "where" (("fmDataEdit" ⎕wi "size") Win∆Resize ⎕wi "∆where")[55] ⎕wi "tooltip" "Quit and Return"[56] ⎕wi "onClick" ("fmSV.mData_EditorFile.mQuit"⎕wi "onClick")[57] ⎕wi "caption" "Quit"[58] ⎕wi "∆helpid" 3209[59] ⎕wi "order" .5[60] ⎕wi "visible" ¯1[61] ControlName ⎕wi "∆quitbutton" "fmDataEdit.bnData_EditorQuit"[62] [63] :if 300<fnsize[64]     ((1↑⎕lc) fnsize "FrameV - Data File") Win∆ProgressBar "MemberUpdate"[65] :endif[66] [67] ⎕wself←"fmDataEdit.fFile" ⎕wi "New" "Frame"[68] ⎕wi "scale" 5[69] ⎕wi "∆where" (4 2⍴0 0 0 0 0.1 0 1 0)[70] ⎕wi "where" (("fmDataEdit" ⎕wi "size") Win∆Resize (4 2⍴0 0 0 0 0.1 0 1 0))[71] ⎕wi "caption" "Data File"[72] ⎕wi "style" 0[73] ⎕wi "onResize" "AutoResize"[74] [75] ⎕wself←"fmDataEdit.fFile.edfILENAME" ⎕wi "New" "Edit"[76] Fieldlist←Fieldlist OVER "fmDataEdit.fFile.edfILENAME"[77] Fieldcontrol←Fieldcontrol OVER "Edit"[78] ⎕wi "∆name" "fILENAME"[79] ⎕wi "∆type" "File"[80] ⎕wi "∆mandatory" 1[81] ⎕wi "∆valid" ('Datanew' 'Single')[82] ⎕wi "∆helpid" 3210[83] ⎕wi "tooltip" "Specify the File to be Edited
(Right Click for List of Files or Double Click for Open File Dialog)"[84] ⎕wi "∆where" (2 2⍴0.3 0 0.1 0)[85] ⎕wi "where" (("fmDataEdit.fFile" ⎕wi "size") Win∆Resize (2 2⍴0.3 0 0.1 0))[86] ⎕wi "onExit" "⍎(0∊⍴,⎕wres←0 INPUT∆CHECK 'fmDataEdit.fFile.edfILENAME')/'0 0⍴(⊂⎕wi ''name'') Data_Editor ''Change'' ' "[87] ⎕wi "onExitError" "Win∆ExitError ⎕warg"[88] ⎕wi "extent" (2+CharSize×1 31)[89] ⎕wi "pointer" ">cur 1001 shell32.dll"[90] ⎕wi "onMouseDouble" "'Datanew Single' GetFileList 'Single' "[91] ⎕wi "targetformats" "FileName"[92] ⎕wi "onDrop" "'fmDataEdit.fFile.edfILENAME' Win∆DropTarget 0 ('Datanew' 'Single')"[93] ⎕wi "onFocus" "GetAbsFileList 'Fund'"[94] ⎕wi "onMouseDown" "'fmDataEdit.fFile.edfILENAME' ⎕wi 'Focus' ⋄ 0 Win∆PopupMenu FilesDesc FilesList"[95] ⎕wi "onChange" "(⎕wi 'self') Win∆LabelUpdate FilesDesc FilesList ⋄ 0 0⍴(⊂⎕wi 'name') Data_Editor 'Change' "[96] ⎕wi "∆rightlabel" "fmDataEdit.fFile.lrfILENAME"[97] [98] ⎕wself←"fmDataEdit.fFile.lrfILENAME" ⎕wi "New" "Label"[99] ⎕wi "scale" 5[100] ⎕wi "extent" (CharSize×¯2↑1,30)[101] ⎕wi "style" 32[102] ⎕wi "caption" " "[103] where←4↑,"fmDataEdit.fFile.edfILENAME" ⎕wi "∆where"[104] x←0.5×⍴where←Win∆Calcwhere where+0,3,0,10+¯1↑"fmDataEdit.fFile.edfILENAME" ⎕wi "extent"[105] ⎕wi "∆where" ((x,2)⍴where)[106] ⎕wi "where" (("fmDataEdit.fFile" ⎕wi "size") Win∆Resize ⎕wi "∆where")[107] [108] ⎕wself←"fmDataEdit.fFile.llfILENAME" ⎕wi "New" "Label"[109] ⎕wi "scale" 5[110] ⎕wi "style" 2[111] ⎕wi "extent" (↑⎕wi "Draw" ("?text" (("⍺",⎕tcnl) char_replace "Member⍺Data File")))[112] ⎕wi "caption" (("⍺",⎕tcnl) char_replace "Member⍺Data File")[113] where←4↑,"fmDataEdit.fFile.edfILENAME" ⎕wi "∆where"[114] size←1↑"fmDataEdit.fFile.edfILENAME" ⎕wi "extent"[115] size←¯3⌈0.5×(1↑⎕wi "extent")-size[116] x←0.5×⍴where←Win∆Calcwhere where-0,size,0,10+¯1↑⎕wi "extent"[117] ⎕wi "∆where" ((x,2)⍴where)[118] ⎕wi "where" (("fmDataEdit.fFile" ⎕wi "size") Win∆Resize ⎕wi "∆where")[119] [120] ⎕wself←"fmDataEdit.fFile.lOrigFile" ⎕wi "New" "Label"[121] ⎕wi "scale" 5[122] ⎕wi "extent" (CharSize×¯2↑1,50)[123] ⎕wi "style" 32[124] ⎕wi "caption" " "[125] ⎕wi "∆where" (2 2⍴0.6 0 0.05 0)[126] ⎕wi "where" (("fmDataEdit.fFile" ⎕wi "size") Win∆Resize (2 2⍴0.6 0 0.05 0))[127] [128] ⎕wself←"fmDataEdit.fFile.cbFormat" ⎕wi "New" "Combo"[129] Fieldlist←Fieldlist OVER "fmDataEdit.fFile.cbFormat"[130] Fieldcontrol←Fieldcontrol OVER "Combo"[131] ⎕wi "∆name" "Format"[132] ⎕wi "∆type" "Format"[133] ⎕wi "∆mandatory" 1[134] ⎕wi "∆valid" ('ADP')[135] ⎕wi "∆helpid" 3211[136] ⎕wi "tooltip" "Select the Data Format of File to be Edited"[137] ⎕wi "style" 16 128 256 2[138] ⎕wi "∆where" (2 2⍴0.3 0 0.6 0)[139] ⎕wi "where" (("fmDataEdit.fFile" ⎕wi "size") Win∆Resize (2 2⍴0.3 0 0.6 0))[140] PickList←Formats 'ADP'[141] ⎕wi "∆update" "Formats 'ADP'"[142] PickList←⊃m2n 1 0↓PickList[143] ⎕wi "list" PickList[144] ⎕wi "extent" (150,(¯10+6×¯1↑CharSize)+¯1↑(50×CharSize)⌊Win∆TextSize PickList)[145] ⎕wi "onClick" "(⎕wi 'self') Win∆LabelUpdate ⊃¨(AbsDict for 'Type' 'Format') at 'Description' 'Parameter' ⋄ 0 0⍴(⊂⎕wi 'name') Data_Editor 'Change' ⋄ UpdateDataVars"[146] ⎕wi "∆rightlabel" "fmDataEdit.fFile.lrFormat"[147] [148] ⎕wself←"fmDataEdit.fFile.lrFormat" ⎕wi "New" "Label"[149] ⎕wi "scale" 5[150] ⎕wi "extent" (CharSize×¯2↑1,40)[151] ⎕wi "style" 32[152] ⎕wi "caption" " "[153] where←4↑,"fmDataEdit.fFile.cbFormat" ⎕wi "∆where"[154] x←0.5×⍴where←Win∆Calcwhere where+0,3,0,10+¯1↑"fmDataEdit.fFile.cbFormat" ⎕wi "extent"[155] ⎕wi "∆where" ((x,2)⍴where)[156] ⎕wi "where" (("fmDataEdit.fFile" ⎕wi "size") Win∆Resize ⎕wi "∆where")[157] [158] ⎕wself←"fmDataEdit.fFile.llFormat" ⎕wi "New" "Label"[159] ⎕wi "scale" 5[160] ⎕wi "style" 2[161] ⎕wi "extent" (↑⎕wi "Draw" ("?text" (("⍺",⎕tcnl) char_replace "Data⍺Format")))[162] ⎕wi "caption" (("⍺",⎕tcnl) char_replace "Data⍺Format")[163] where←4↑,"fmDataEdit.fFile.cbFormat" ⎕wi "∆where"[164] size←1↑"fmDataEdit.fFile.cbFormat" ⎕wi "extent"[165] size←¯3⌈0.5×(1↑⎕wi "extent")-size[166] x←0.5×⍴where←Win∆Calcwhere where-0,size,0,10+¯1↑⎕wi "extent"[167] ⎕wi "∆where" ((x,2)⍴where)[168] ⎕wi "where" (("fmDataEdit.fFile" ⎕wi "size") Win∆Resize ⎕wi "∆where")[169] [170] ⎕wself←"fmDataEdit.fData" ⎕wi "New" "Frame"[171] ⎕wi "scale" 5[172] ⎕wi "visible" (¯1+2×0)[173] ⎕wi "∆where" (4 2⍴0.1 0 0 0 0.7 0 1 0)[174] ⎕wi "where" (("fmDataEdit" ⎕wi "size") Win∆Resize (4 2⍴0.1 0 0 0 0.7 0 1 0))[175] ⎕wi "caption" "Data Fields"[176] ⎕wi "style" 0[177] ⎕wi "onResize" "AutoResize"[178] ⎕wself←"fmDataEdit.fData.ssData" ⎕wi "New" "{13E51003-A52B-11D0-86DA-00608CB9FBFB}6D5ECD55-86B8-11d0-95AD-0020AF1E9EB2"[179] ⎕wi "∆where" (4 2⍴0 15 0 10 0.999 ¯25 1 ¯20)[180] ⎕wi "where" (("fmDataEdit.fData" ⎕wi "size") Win∆Resize (4 2⍴0 15 0 10 0.999 ¯25 1 ¯20))[181] Fieldlist←Fieldlist OVER "fmDataEdit.fData.ssData"[182] Fieldcontrol←Fieldcontrol OVER "F1SS"[183] Win∆F1SSDefaults 0[184] ⎕wi "MaxRow" (MaxRow←1)[185] ⎕wi "MaxCol" (MaxCol←1)[186] ⎕wi "xDoStartEdit" 1[187] ⎕wi "xDoEndEdit" 1[188] ⎕wi "xDoCancelEdit" 1[189] ⎕wi "onClick" "Win∆F1SSClick 'fmDataEdit.fData.ssData'"[190] ⎕wi "onXStartEdit" "⎕wi 'AllowArrows' 0"[191] NameList←0 0⍴" "[192] ⎕wi "xHdrHeight" (350⌈250×0)[193] ⎕wi "onXRClick" "0 Win∆F1SSRowMenu ('Data_Editor' 'fmDataEdit.fData.ssData')"[194] ⎕wi "∆roworcol" "Col"[195] ⎕wi "∆name" NameList[196] ⎕wi "∆type" ""[197] ⎕wi "∆valid" ""[198] ⎕wi "∆range" ""[199] ⎕wi "onXEndEdit" "(⎕wi 'xRow') Win∆ValidF1SSCell ⎕wi 'xCol' ⋄ 0 0⍴⎕ex 'F1SSEvent' "[200] ⎕wi "onExit" "Win∆ValidF1SSExit 'Data_Editor'"[201] ⎕wi "onExitError" "MDISPLAY ⎕warg ⋄ ⎕wi 'XStartEdit' 0 1 1"[202] ⎕wi "onXCancelEdit" "⎕wi 'AllowArrows' 1 ⋄ ⎕wi 'SetColWidthAuto' 1 1 (⎕wi 'MaxRow') (⎕wi 'MaxCol') 0"[203] "fmDataEdit.fData.ssData" Win∆F1SSProtectCells "Unlock"[204] ⎕wi "SetSelection" 1 1 1 1[205] [206] :if 300<fnsize[207]     ((1↑⎕lc) fnsize "FrameV - Information") Win∆ProgressBar "MemberUpdate"[208] :endif[209] [210] ⎕wself←"fmDataEdit.fStats" ⎕wi "New" "Frame"[211] ⎕wi "scale" 5[212] ⎕wi "visible" (¯1+2×0)[213] ⎕wi "∆where" (4 2⍴0.8 0 0 0 0.2 ¯45 1 0)[214] ⎕wi "where" (("fmDataEdit" ⎕wi "size") Win∆Resize (4 2⍴0.8 0 0 0 0.2 ¯45 1 0))[215] ⎕wi "caption" "Information"[216] ⎕wi "style" 0[217] ⎕wi "onResize" "AutoResize"[218] [219] ⎕wself←"fmDataEdit.fStats.edfield" ⎕wi "New" "Edit"[220] Fieldlist←Fieldlist OVER "fmDataEdit.fStats.edfield"[221] Fieldcontrol←Fieldcontrol OVER "Edit"[222] ⎕wi "∆name" "field"[223] ⎕wi "∆type" "Char"[224] ⎕wi "style" 4096[225] ⎕wi "∆helpid" 3212[226] ⎕wi "tooltip" "The Current Data Field"[227] ⎕wi "∆where" (2 2⍴0.15 0 0.15 0)[228] ⎕wi "where" (("fmDataEdit.fStats" ⎕wi "size") Win∆Resize (2 2⍴0.15 0 0.15 0))[229] ⎕wi "onExit" "⍎(0∊⍴,⎕wres←0 INPUT∆CHECK 'fmDataEdit.fStats.edfield')/'0 0⍴(⊂⎕wi ''name'') Data_Editor ''Change'' ' "[230] ⎕wi "onExitError" "Win∆ExitError ⎕warg"[231] ⎕wi "extent" (2+CharSize×1 31)[232] [233] ⎕wself←"fmDataEdit.fStats.llfield" ⎕wi "New" "Label"[234] ⎕wi "scale" 5[235] ⎕wi "style" 2[236] ⎕wi "extent" (↑⎕wi "Draw" ("?text" "Current Field"))[237] ⎕wi "caption" "Current Field"[238] where←4↑,"fmDataEdit.fStats.edfield" ⎕wi "∆where"[239] x←0.5×⍴where←Win∆Calcwhere where-0 ¯3 0,10+¯1↑⎕wi "extent"[240] ⎕wi "∆where" ((x,2)⍴where)[241] ⎕wi "where" (("fmDataEdit.fStats" ⎕wi "size") Win∆Resize ⎕wi "∆where")[242] [243] ⎕wself←"fmDataEdit.fStats.edftype" ⎕wi "New" "Edit"[244] Fieldlist←Fieldlist OVER "fmDataEdit.fStats.edftype"[245] Fieldcontrol←Fieldcontrol OVER "Edit"[246] ⎕wi "∆name" "ftype"[247] ⎕wi "∆type" "Char"[248] ⎕wi "style" 4096[249] ⎕wi "∆helpid" 3212[250] ⎕wi "tooltip" "Type of Current Data Field"[251] ⎕wi "∆where" (2 2⍴0.35 0 0.15 0)[252] ⎕wi "where" (("fmDataEdit.fStats" ⎕wi "size") Win∆Resize (2 2⍴0.35 0 0.15 0))[253] ⎕wi "onExit" "⍎(0∊⍴,⎕wres←0 INPUT∆CHECK 'fmDataEdit.fStats.edftype')/'0 0⍴(⊂⎕wi ''name'') Data_Editor ''Change'' ' "[254] ⎕wi "onExitError" "Win∆ExitError ⎕warg"[255] ⎕wi "extent" (2+CharSize×1 19)[256] [257] ⎕wself←"fmDataEdit.fStats.llftype" ⎕wi "New" "Label"[258] ⎕wi "scale" 5[259] ⎕wi "style" 2[260] ⎕wi "extent" (↑⎕wi "Draw" ("?text" "Type of Field"))[261] ⎕wi "caption" "Type of Field"[262] where←4↑,"fmDataEdit.fStats.edftype" ⎕wi "∆where"[263] x←0.5×⍴where←Win∆Calcwhere where-0 ¯3 0,10+¯1↑⎕wi "extent"[264] ⎕wi "∆where" ((x,2)⍴where)[265] ⎕wi "where" (("fmDataEdit.fStats" ⎕wi "size") Win∆Resize ⎕wi "∆where")[266] [267] ⎕wself←"fmDataEdit.fStats.edfwidth" ⎕wi "New" "Edit"[268] Fieldlist←Fieldlist OVER "fmDataEdit.fStats.edfwidth"[269] Fieldcontrol←Fieldcontrol OVER "Edit"[270] ⎕wi "∆name" "fwidth"[271] ⎕wi "∆type" "Char"[272] ⎕wi "style" 4096[273] ⎕wi "∆helpid" 3212[274] ⎕wi "tooltip" "Width of Current Data Field"[275] ⎕wi "limit" 4[276] ⎕wi "∆where" (2 2⍴0.55 0 0.15 0)[277] ⎕wi "where" (("fmDataEdit.fStats" ⎕wi "size") Win∆Resize (2 2⍴0.55 0 0.15 0))[278] ⎕wi "onExit" "⍎(0∊⍴,⎕wres←0 INPUT∆CHECK 'fmDataEdit.fStats.edfwidth')/'0 0⍴(⊂⎕wi ''name'') Data_Editor ''Change'' ' "[279] ⎕wi "onExitError" "Win∆ExitError ⎕warg"[280] ⎕wi "extent" (2+CharSize×1 5)[281] [282] ⎕wself←"fmDataEdit.fStats.llfwidth" ⎕wi "New" "Label"[283] ⎕wi "scale" 5[284] ⎕wi "style" 2[285] ⎕wi "extent" (↑⎕wi "Draw" ("?text" "Width of Field"))[286] ⎕wi "caption" "Width of Field"[287] where←4↑,"fmDataEdit.fStats.edfwidth" ⎕wi "∆where"[288] x←0.5×⍴where←Win∆Calcwhere where-0 ¯3 0,10+¯1↑⎕wi "extent"[289] ⎕wi "∆where" ((x,2)⍴where)[290] ⎕wi "where" (("fmDataEdit.fStats" ⎕wi "size") Win∆Resize ⎕wi "∆where")[291] [292] ⎕wself←"fmDataEdit.fStats.edfpos" ⎕wi "New" "Edit"[293] Fieldlist←Fieldlist OVER "fmDataEdit.fStats.edfpos"[294] Fieldcontrol←Fieldcontrol OVER "Edit"[295] ⎕wi "∆name" "fpos"[296] ⎕wi "∆type" "Char"[297] ⎕wi "style" 4096[298] ⎕wi "∆helpid" 3212[299] ⎕wi "tooltip" "Position of Current Data Field"[300] ⎕wi "limit" 12[301] ⎕wi "∆where" (2 2⍴0.75 0 0.15 0)[302] ⎕wi "where" (("fmDataEdit.fStats" ⎕wi "size") Win∆Resize (2 2⍴0.75 0 0.15 0))[303] ⎕wi "onExit" "⍎(0∊⍴,⎕wres←0 INPUT∆CHECK 'fmDataEdit.fStats.edfpos')/'0 0⍴(⊂⎕wi ''name'') Data_Editor ''Change'' ' "[304] ⎕wi "onExitError" "Win∆ExitError ⎕warg"[305] ⎕wi "extent" (2+CharSize×1 13)[306] [307] ⎕wself←"fmDataEdit.fStats.llfpos" ⎕wi "New" "Label"[308] ⎕wi "scale" 5[309] ⎕wi "style" 2[310] ⎕wi "extent" (↑⎕wi "Draw" ("?text" "Position of Field"))[311] ⎕wi "caption" "Position of Field"[312] where←4↑,"fmDataEdit.fStats.edfpos" ⎕wi "∆where"[313] x←0.5×⍴where←Win∆Calcwhere where-0 ¯3 0,10+¯1↑⎕wi "extent"[314] ⎕wi "∆where" ((x,2)⍴where)[315] ⎕wi "where" (("fmDataEdit.fStats" ⎕wi "size") Win∆Resize ⎕wi "∆where")[316] [317] ⎕wself←"fmDataEdit.fStats.lfmark" ⎕wi "New" "Label"[318] ⎕wi "scale" 5[319] ⎕wi "extent" (CharSize×¯2↑1,40)[320] ⎕wi "style" 32[321] ⎕wi "caption" " "[322] ⎕wi "∆where" (2 2⍴0.18 0 0.45 0)[323] ⎕wi "where" (("fmDataEdit.fStats" ⎕wi "size") Win∆Resize (2 2⍴0.18 0 0.45 0))[324] [325] ⎕wself←"fmDataEdit.fStats.edfrecs" ⎕wi "New" "Edit"[326] Fieldlist←Fieldlist OVER "fmDataEdit.fStats.edfrecs"[327] Fieldcontrol←Fieldcontrol OVER "Edit"[328] ⎕wi "∆name" "frecs"[329] ⎕wi "∆type" "Char"[330] ⎕wi "visible" (¯1+2×0)[331] ⎕wi "style" 4096[332] ⎕wi "∆helpid" 3212[333] ⎕wi "tooltip" "Position of Current Data Field"[334] ⎕wi "limit" 12[335] ⎕wi "∆where" (2 2⍴0.35 0 0.5 0)[336] ⎕wi "where" (("fmDataEdit.fStats" ⎕wi "size") Win∆Resize (2 2⍴0.35 0 0.5 0))[337] ⎕wi "onExit" "⍎(0∊⍴,⎕wres←0 INPUT∆CHECK 'fmDataEdit.fStats.edfrecs')/'0 0⍴(⊂⎕wi ''name'') Data_Editor ''Change'' ' "[338] ⎕wi "onExitError" "Win∆ExitError ⎕warg"[339] ⎕wi "extent" (2+CharSize×1 13)[340] [341] ⎕wself←"fmDataEdit.fStats.llfrecs" ⎕wi "New" "Label"[342] ⎕wi "scale" 5[343] ⎕wi "style" 2[344] ⎕wi "visible" (¯1+2×0)[345] ⎕wi "extent" (↑⎕wi "Draw" ("?text" "Records"))[346] ⎕wi "caption" "Records"[347] where←4↑,"fmDataEdit.fStats.edfrecs" ⎕wi "∆where"[348] x←0.5×⍴where←Win∆Calcwhere where-0 ¯3 0,10+¯1↑⎕wi "extent"[349] ⎕wi "∆where" ((x,2)⍴where)[350] ⎕wi "where" (("fmDataEdit.fStats" ⎕wi "size") Win∆Resize ⎕wi "∆where")[351] [352] ⎕wself←"fmDataEdit.fStats.edfsearch" ⎕wi "New" "Edit"[353] Fieldlist←Fieldlist OVER "fmDataEdit.fStats.edfsearch"[354] Fieldcontrol←Fieldcontrol OVER "Edit"[355] ⎕wi "∆name" "fsearch"[356] ⎕wi "∆type" "Char"[357] ⎕wi "visible" (¯1+2×0)[358] ⎕wi "style" 4096[359] ⎕wi "∆helpid" 3212[360] ⎕wi "tooltip" "Current Search String"[361] ⎕wi "∆where" (2 2⍴0.65 0 0.5 0)[362] ⎕wi "where" (("fmDataEdit.fStats" ⎕wi "size") Win∆Resize (2 2⍴0.65 0 0.5 0))[363] ⎕wi "onExit" "⍎(0∊⍴,⎕wres←0 INPUT∆CHECK 'fmDataEdit.fStats.edfsearch')/'0 0⍴(⊂⎕wi ''name'') Data_Editor ''Change'' ' "[364] ⎕wi "onExitError" "Win∆ExitError ⎕warg"[365] ⎕wi "extent" (2+CharSize×1 21)[366] [367] ⎕wself←"fmDataEdit.fStats.llfsearch" ⎕wi "New" "Label"[368] ⎕wi "scale" 5[369] ⎕wi "style" 2[370] ⎕wi "visible" (¯1+2×0)[371] ⎕wi "extent" (↑⎕wi "Draw" ("?text" "Search String"))[372] ⎕wi "caption" "Search String"[373] where←4↑,"fmDataEdit.fStats.edfsearch" ⎕wi "∆where"[374] x←0.5×⍴where←Win∆Calcwhere where-0 ¯3 0,10+¯1↑⎕wi "extent"[375] ⎕wi "∆where" ((x,2)⍴where)[376] ⎕wi "where" (("fmDataEdit.fStats" ⎕wi "size") Win∆Resize ⎕wi "∆where")[377] [378] ⎕wself←"fmDataEdit.fStats.edfpageno" ⎕wi "New" "Edit"[379] Fieldlist←Fieldlist OVER "fmDataEdit.fStats.edfpageno"[380] Fieldcontrol←Fieldcontrol OVER "Edit"[381] ⎕wi "∆name" "fpageno"[382] ⎕wi "∆type" "Num"[383] ⎕wi "∆mandatory" 1[384] ⎕wi "∆valid" ('Int' 'Scalar' '+')[385] ⎕wi "∆helpid" 3212[386] ⎕wi "tooltip" "Specify the Page Number"[387] ⎕wi "limit" 6[388] ⎕wi "∆where" (2 2⍴0.15 0 0.75 0)[389] ⎕wi "where" (("fmDataEdit.fStats" ⎕wi "size") Win∆Resize (2 2⍴0.15 0 0.75 0))[390] ⎕wi "∆range" "1,MaxPage"[391] ⎕wi "onExit" "⍎(0∊⍴,⎕wres←0 INPUT∆CHECK 'fmDataEdit.fStats.edfpageno')/'0 0⍴(⊂⎕wi ''name'') Data_Editor ''Change'' ' "[392] ⎕wi "onExitError" "Win∆ExitError ⎕warg"[393] ⎕wi "onKeyPress" "⎕wres←¯2×~⎕warg∊8 32 48 49 50 51 52 53 54 55 56 57"[394] ⎕wi "extent" (2+CharSize×1 7)[395] [396] ⎕wself←"fmDataEdit.fStats.lrfpageno" ⎕wi "New" "Label"[397] ⎕wi "scale" 5[398] ⎕wi "extent" (↑⎕wi "Draw" ("?text" "of 99,999 Pages"))[399] ⎕wi "caption" "of 99,999 Pages"[400] where←4↑,"fmDataEdit.fStats.edfpageno" ⎕wi "∆where"[401] x←0.5×⍴where←Win∆Calcwhere where+0,3,0,10+¯1↑"fmDataEdit.fStats.edfpageno" ⎕wi "extent"[402] ⎕wi "∆where" ((x,2)⍴where)[403] ⎕wi "where" (("fmDataEdit.fStats" ⎕wi "size") Win∆Resize ⎕wi "∆where")[404] [405] ⎕wself←"fmDataEdit.fStats.llfpageno" ⎕wi "New" "Label"[406] ⎕wi "scale" 5[407] ⎕wi "style" 2[408] ⎕wi "extent" (↑⎕wi "Draw" ("?text" "Page"))[409] ⎕wi "caption" "Page"[410] where←4↑,"fmDataEdit.fStats.edfpageno" ⎕wi "∆where"[411] x←0.5×⍴where←Win∆Calcwhere where-0 ¯3 0,10+¯1↑⎕wi "extent"[412] ⎕wi "∆where" ((x,2)⍴where)[413] ⎕wi "where" (("fmDataEdit.fStats" ⎕wi "size") Win∆Resize ⎕wi "∆where")[414] [415] ⎕wself←"fmDataEdit.fStats.edfrecno" ⎕wi "New" "Edit"[416] Fieldlist←Fieldlist OVER "fmDataEdit.fStats.edfrecno"[417] Fieldcontrol←Fieldcontrol OVER "Edit"[418] ⎕wi "∆name" "frecno"[419] ⎕wi "∆type" "Num"[420] ⎕wi "∆mandatory" 1[421] ⎕wi "∆valid" ('Int' 'Scalar' '+')[422] ⎕wi "∆helpid" 3212[423] ⎕wi "tooltip" "Specify the Record Number"[424] ⎕wi "limit" 6[425] ⎕wi "∆where" (2 2⍴0.35 0 0.75 0)[426] ⎕wi "where" (("fmDataEdit.fStats" ⎕wi "size") Win∆Resize (2 2⍴0.35 0 0.75 0))[427] ⎕wi "∆range" "1,MaxRec"[428] ⎕wi "onExit" "⍎(0∊⍴,⎕wres←0 INPUT∆CHECK 'fmDataEdit.fStats.edfrecno')/'0 0⍴(⊂⎕wi ''name'') Data_Editor ''Change'' ' "[429] ⎕wi "onExitError" "Win∆ExitError ⎕warg"[430] ⎕wi "onKeyPress" "⎕wres←¯2×~⎕warg∊8 32 48 49 50 51 52 53 54 55 56 57"[431] ⎕wi "extent" (2+CharSize×1 7)[432] [433] ⎕wself←"fmDataEdit.fStats.lrfrecno" ⎕wi "New" "Label"[434] ⎕wi "scale" 5[435] ⎕wi "extent" (↑⎕wi "Draw" ("?text" "of 999,999 Records"))[436] ⎕wi "caption" "of 999,999 Records"[437] where←4↑,"fmDataEdit.fStats.edfrecno" ⎕wi "∆where"[438] x←0.5×⍴where←Win∆Calcwhere where+0,3,0,10+¯1↑"fmDataEdit.fStats.edfrecno" ⎕wi "extent"[439] ⎕wi "∆where" ((x,2)⍴where)[440] ⎕wi "where" (("fmDataEdit.fStats" ⎕wi "size") Win∆Resize ⎕wi "∆where")[441] [442] ⎕wself←"fmDataEdit.fStats.llfrecno" ⎕wi "New" "Label"[443] ⎕wi "scale" 5[444] ⎕wi "style" 2[445] ⎕wi "extent" (↑⎕wi "Draw" ("?text" "Record"))[446] ⎕wi "caption" "Record"[447] where←4↑,"fmDataEdit.fStats.edfrecno" ⎕wi "∆where"[448] x←0.5×⍴where←Win∆Calcwhere where-0 ¯3 0,10+¯1↑⎕wi "extent"[449] ⎕wi "∆where" ((x,2)⍴where)[450] ⎕wi "where" (("fmDataEdit.fStats" ⎕wi "size") Win∆Resize ⎕wi "∆where")[451] [452] ⎕wself←"fmDataEdit.fStats.cbfreq" ⎕wi "New" "Combo"[453] Fieldlist←Fieldlist OVER "fmDataEdit.fStats.cbfreq"[454] Fieldcontrol←Fieldcontrol OVER "Combo"[455] ⎕wi "∆name" "freq"[456] ⎕wi "∆type" "Char"[457] ⎕wi "enabled" (0)[458] ⎕wi "∆helpid" 3212[459] ⎕wi "tooltip" "Pension Frequency"[460] ⎕wi "style" 16 128 256 2[461] ⎕wi "∆where" (2 2⍴0.65 0 0.75 0)[462] ⎕wi "where" (("fmDataEdit.fStats" ⎕wi "size") Win∆Resize (2 2⍴0.65 0 0.75 0))[463] PickList←⍙POPUPSdict ReadDictFile "Freq"[464] PickList←⊃m2n 1 0↓PickList[465] PickList←" " OVER PickList[466] ⎕wi "list" PickList[467] ⎕wi "extent" (150,(¯10+6×¯1↑CharSize)+¯1↑Win∆TextSize ((0,⎕wi "limit")⌈⍴PickList)↑PickList)[468] ⎕wi "onClick" "0 0⍴(⊂⎕wi 'name') Data_Editor 'Change' "[469] [470] ⎕wself←"fmDataEdit.fStats.llfreq" ⎕wi "New" "Label"[471] ⎕wi "scale" 5[472] ⎕wi "style" 2[473] ⎕wi "enabled" (0)[474] ⎕wi "extent" (↑⎕wi "Draw" ("?text" "Pension Frequency"))[475] ⎕wi "caption" "Pension Frequency"[476] where←4↑,"fmDataEdit.fStats.cbfreq" ⎕wi "∆where"[477] x←0.5×⍴where←Win∆Calcwhere where-0 ¯3 0,10+¯1↑⎕wi "extent"[478] ⎕wi "∆where" ((x,2)⍴where)[479] ⎕wi "where" (("fmDataEdit.fStats" ⎕wi "size") Win∆Resize ⎕wi "∆where")[480] [481] ⎕wself←"fmDataEdit.fStats.edfindhits" ⎕wi "New" "Edit"[482] Fieldlist←Fieldlist OVER "fmDataEdit.fStats.edfindhits"[483] Fieldcontrol←Fieldcontrol OVER "Edit"[484] ⎕wi "∆name" "findhits"[485] ⎕wi "∆type" "Char"[486] ⎕wi "visible" (¯1+2×0)[487] ⎕wi "limit" 10[488] ⎕wi "∆where" (2 2⍴1 0 1 0)[489] ⎕wi "where" (("fmDataEdit.fStats" ⎕wi "size") Win∆Resize (2 2⍴1 0 1 0))[490] ⎕wi "onExit" "⍎(0∊⍴,⎕wres←0 INPUT∆CHECK 'fmDataEdit.fStats.edfindhits')/'0 0⍴(⊂⎕wi ''name'') Data_Editor ''Change'' ' "[491] ⎕wi "onExitError" "Win∆ExitError ⎕warg"[492] ⎕wi "extent" (2+CharSize×1 11)[493] list←list OVER "fmDataEdit.bnData_EditorEdit"[494] ⎕wself←"fmDataEdit.bnData_EditorEdit" ⎕wi "New" "Button"[495] ⎕wi "extent" (size←1×buttonsize×1⌈CharSize÷13 6)[496] x←0.5×⍴where←Win∆Calcwhere 1,(¯10-size[1]),1,buttonwhere←buttonwhere-5+size[2][497] ⎕wi "∆where" ((x,2)⍴where)[498] ⎕wi "where" (("fmDataEdit" ⎕wi "size") Win∆Resize ⎕wi "∆where")[499] ⎕wi "tooltip" "Edit Data File"[500] ⎕wi "onClick" ("fmSV.mData_EditorFile.mEdit"⎕wi "onClick")[501] ⎕wi "∆helpid" 3213[502] ⎕wi "caption" "Edit"[503] list←list OVER "fmDataEdit.bnData_EditorSaveAs"[504] ⎕wself←"fmDataEdit.bnData_EditorSaveAs" ⎕wi "New" "Button"[505] ⎕wi "visible" (¯1+2×0)[506] ⎕wi "extent" (size←1×buttonsize×1⌈CharSize÷13 6)[507] x←0.5×⍴where←Win∆Calcwhere 1,(¯10-size[1]),1,buttonwhere←buttonwhere-5+size[2][508] ⎕wi "∆where" ((x,2)⍴where)[509] ⎕wi "where" (("fmDataEdit" ⎕wi "size") Win∆Resize ⎕wi "∆where")[510] ⎕wi "tooltip" "Save Data File Changes in a New File"[511] ⎕wi "onClick" ("fmSV.mData_EditorFile.mSave"⎕wi "onClick")[512] ⎕wi "∆helpid" 3214[513] ⎕wi "caption" "Save As"[514] list←list OVER "fmDataEdit.bnData_EditorDataNote"[515] ⎕wself←"fmDataEdit.bnData_EditorDataNote" ⎕wi "New" "Button"[516] ⎕wi "visible" (¯1+2×0)[517] ⎕wi "extent" (size←1×buttonsize×1⌈CharSize÷13 6)[518] x←0.5×⍴where←Win∆Calcwhere 1,(¯10-size[1]),1,buttonwhere←buttonwhere-5+size[2][519] ⎕wi "∆where" ((x,2)⍴where)[520] ⎕wi "where" (("fmDataEdit" ⎕wi "size") Win∆Resize ⎕wi "∆where")[521] ⎕wi "tooltip" "Notes on Overlapping Data Fields"[522] ⎕wi "onClick" ("fmSV.mData_EditorData.mData"⎕wi "onClick")[523] ⎕wi "∆helpid" 3215[524] ⎕wi "caption" "Data Notes"[525] list←list OVER "fmDataEdit.bnData_EditorNext"[526] ⎕wself←"fmDataEdit.bnData_EditorNext" ⎕wi "New" "Button"[527] ⎕wi "visible" (¯1+2×0)[528] ⎕wi "extent" (size←1×buttonsize×1⌈CharSize÷13 6)[529] x←0.5×⍴where←Win∆Calcwhere 1,(¯10-size[1]),1,buttonwhere←buttonwhere-5+size[2][530] ⎕wi "∆where" ((x,2)⍴where)[531] ⎕wi "where" (("fmDataEdit" ⎕wi "size") Win∆Resize ⎕wi "∆where")[532] ⎕wi "tooltip" "Find Next Occurrence of Search String"[533] ⎕wi "onClick" ("fmSV.mData_EditorData.mNext"⎕wi "onClick")[534] ⎕wi "∆helpid" 3216[535] ⎕wi "caption" "Find Next"[536] :if buttonimage[537]     ⎕wi "imagelist" "fmSV.iStandard"[538]     ⎕wi "imageindex" 29[539] :endif[540] list←list OVER "fmDataEdit.bnData_EditorSave"[541] ⎕wself←"fmDataEdit.bnData_EditorSave" ⎕wi "New" "Button"[542] ⎕wi "visible" (¯1+2×0)[543] ⎕wi "extent" (size←1×buttonsize×1⌈CharSize÷13 6)[544] x←0.5×⍴where←Win∆Calcwhere 1,(¯10-size[1]),1,buttonwhere←buttonwhere-5+size[2][545] ⎕wi "∆where" ((x,2)⍴where)[546] ⎕wi "where" (("fmDataEdit" ⎕wi "size") Win∆Resize ⎕wi "∆where")[547] ⎕wi "tooltip" "Save Data File Changes"[548] ⎕wi "onClick" ("fmSV.mData_EditorFile.mSave"⎕wi "onClick")[549] ⎕wi "∆helpid" 3217[550] ⎕wi "caption" "Save"[551] :if buttonimage[552]     ⎕wi "imagelist" "fmSV.iStandard"[553]     ⎕wi "imageindex" 9[554] :endif[555] list←list OVER "fmDataEdit.bnData_EditorCancel"[556] ⎕wself←"fmDataEdit.bnData_EditorCancel" ⎕wi "New" "Button"[557] ⎕wi "visible" (¯1+2×0)[558] ⎕wi "extent" (size←1×buttonsize×1⌈CharSize÷13 6)[559] x←0.5×⍴where←Win∆Calcwhere 1,(¯10-size[1]),1,buttonwhere←buttonwhere-5+size[2][560] ⎕wi "∆where" ((x,2)⍴where)[561] ⎕wi "where" (("fmDataEdit" ⎕wi "size") Win∆Resize ⎕wi "∆where")[562] ⎕wi "tooltip" "Cancel Data File Changes"[563] ⎕wi "onClick" ("fmSV.mData_EditorFile.mCancel"⎕wi "onClick")[564] ⎕wi "∆helpid" 3218[565] ⎕wi "caption" "Cancel"[566] [567] "fmDataEdit" ⎕wi "∆multifile" ""[568] "fmDataEdit" ⎕wi "∆singlefile" "fmDataEdit.fFile.edfILENAME"[569] "fmDataEdit" ⎕wi "∆format" "fmDataEdit.fFile.cbFormat"[570] "fmDataEdit" ⎕wi "∆financial" 0[571] "fmDataEdit" ⎕wi "∆relrules" 0[572] "fmDataEdit" ⎕wi "∆parm" 0[573] "fmDataEdit" ⎕wi "∆decr" 0[574] "fmDataEdit" ⎕wi "∆file" 1[575] "fmDataEdit" ⎕wi "∆codefile" CodeFile[576] "fmDataEdit" ⎕wi "∆inputstype" "ClientFile"[577] "fmDataEdit" ⎕wi "∆inputsentry" "Single"[578] "fmDataEdit" ⎕wi "∆savecn" (⍳0)[579] "fmDataEdit" ⎕wi "∆savedesc" ""[580] list←list OVER "fmDataEdit"[581] "fmDataEdit" ⎕wi "∆fieldlist" Fieldlist[582] "fmDataEdit" ⎕wi "∆fieldcontrol" Fieldcontrol[583] childlist←"fmSV" ⎕wi "∆childlist"[584] list←(⊃¯1↑childlist) OVER list[585] childlist[⍴childlist]←⊂list[586] "fmSV" ⎕wi "∆childlist" childlist[587] list←,⎕split list[588] 0 0⍴((∨/¨(⊂".mData_Editor")⍷¨list)/list) MultiWI "enabled" 1[589] :if 300<fnsize[590]     (fnsize fnsize ".") Win∆ProgressBar "MemberUpdate"[591]     Win∆ProgressBar "Hide"[592] :endif[593] "Init" OpenParameters "Data_Editor"[594] "fmDataEdit.bnData_EditorHelp" ⎕wi "visible" 1[595] "fmDataEdit.bnData_EditorQuit" ⎕wi "visible" 1[596] "#" ⎕wi "focus" "fmDataEdit.fFile.edfILENAME"[597] :if ~0∊⍴,Error←Win∆Initialise "Data_Editor"[598]     "Quit" EndModule Module[599]     "fmSV" ⎕wi "pointer" 0[600]     0 0⍴"fmDataEdit" ⎕wi "Delete"[601]     :return[602] :endif[603] :if bar_open←commandbar^"Multi"≡"Single"[604]     bar_open←0×"fmDataEdit.mData_EditorFile.m" Win∆CommandBar "QuitHelp"[605] :endif[606] "fmDataEdit" ⎕wi "Paint"[607] "fmSV" ⎕wi "pointer" 11[608] "fmDataEdit" ⎕wi "onWait" "0 0⍴Data_Editor 'Wait' ⋄ 'fmDataEdit' ⎕wi 'modified' 0"[609] 0 0⍴"fmDataEdit" ⎕wi "Wait"[610] 0 0⍴"fmDataEdit" ⎕wi "Delete"[611] "fmSV" ⎕wi "pointer" 0 ∇