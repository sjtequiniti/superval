∇ Container←Form_Make;⎕wself;ControlName;childlist;list;Fieldlist;Fieldcontrol;FrameWidth;Caption;buttonsize;buttonwhere;where;size;alignment;Header;PickList;NameList;value;sortorder;SortList;MaxRow;MaxCol;Parent;level;node;no;nn;NN;x;fnsize;framelist;relTests[1] [2] Fieldlist←Fieldcontrol←list←0 0⍴""[3] "fmSV" ⎕wi "pointer" 13[4] buttonsize←25 65 ⋄ buttonwhere←¯5[5] FormName ⎕wi "caption" ((FormName ⎕wi "caption")," - Workaround for specifying the Name of a Folder")[6] "fmSV" ⎕wi "∆caption" (("fmSV" ⎕wi "∆caption"),⊂("fmSV" ⎕wi "caption"))[7] :if 300<fnsize←1↑⍴⎕cr "Form_Make"[8]     "Generating Form" Win∆ProgressBar "Open"[9]     ("Menu Items:" "Form Controls:") Win∆ProgressBar "SetLabels"[10]     (1 1 "Help About") Win∆ProgressBar "FileUpdate"[11] :endif[12] [13] Container←"∆Dialog"[14] [15] ⎕wself←"fmGetFolder" ⎕wi "New" "Form" "Hide"[16] ⎕wi "caption" ("fmSV" ⎕wi "caption")[17] ⎕wi "scale" 5[18] ⎕wi "font" ("fmSV" ⎕wi "font")[19] ⎕wi "border" 2 32 64[20] ⎕wi "where" (Win∆CentrePos .20 .70×768 1024×1⌈CharSize÷13 6)[21] ⎕wi "limitwhere" (0.8×¯2↑⎕wi "where")[22] ⎕wi "tooltipwidth" 200[23] ⎕wi "onResize" "AutoResize"[24] ⎕wi "onClose" "ExitSystem ''"[25] ControlName←"fmGetFolder"[26] relTests←0[27] 0 Menu_Make "fmSV"[28] 0 Menu_Make "fmGetFolder"[29] "fmGetFolder" Win∆CutCopyPaste "Build"[30] list←list OVER "fmGetFolder.bnGet_FolderHelp"[31] ⎕wself←"fmGetFolder.bnGet_FolderHelp" ⎕wi "New" "Button"[32] ⎕wi "deferexit" 1[33] ⎕wi "extent" (size←1×buttonsize×1⌈CharSize÷13 6)[34] x←0.5×⍴where←Win∆Calcwhere 1,(¯10-size[1]),1,buttonwhere←buttonwhere-5+size[2][35] ⎕wi "∆where" ((x,2)⍴where)[36] ⎕wi "where" (("fmGetFolder" ⎕wi "size") Win∆Resize ⎕wi "∆where")[37] ⎕wi "tooltip" "SuperVal Help"[38] ⎕wi "onClick" ("fmSV.mGet_FolderHelp.mContext"⎕wi "onClick")[39] ⎕wi "caption" "Help"[40] :if buttonimage[41]     ⎕wi "imagelist" "fmSV.iStandard"[42]     ⎕wi "imageindex" 12[43] :endif[44] ⎕wi "visible" ¯1[45] ⎕wi "onMouseDown" "∆HelpField←'#' ⎕wi 'focus' "[46] list←list OVER "fmGetFolder.bnGet_FolderQuit"[47] ⎕wself←"fmGetFolder.bnGet_FolderQuit" ⎕wi "New" "Button"[48] ⎕wi "style" 2[49] ⎕wi "deferexit" 1[50] ⎕wi "extent" (size←1×buttonsize×1⌈CharSize÷13 6)[51] x←0.5×⍴where←Win∆Calcwhere 1,(¯10-size[1]),1,buttonwhere←buttonwhere-5+size[2][52] ⎕wi "∆where" ((x,2)⍴where)[53] ⎕wi "where" (("fmGetFolder" ⎕wi "size") Win∆Resize ⎕wi "∆where")[54] ⎕wi "tooltip" "Cancel and Return"[55] ⎕wi "onClick" ("fmSV.mGet_FolderFile.mQuit"⎕wi "onClick")[56] ⎕wi "caption" "Cancel"[57] ⎕wi "order" .5[58] ⎕wi "visible" ¯1[59] list←list OVER "fmGetFolder.bnGet_FolderSave"[60] ⎕wself←"fmGetFolder.bnGet_FolderSave" ⎕wi "New" "Button"[61] ⎕wi "style" 1[62] ⎕wi "extent" (size←1×buttonsize×1⌈CharSize÷13 6)[63] x←0.5×⍴where←Win∆Calcwhere 1,(¯10-size[1]),1,buttonwhere←buttonwhere-5+size[2][64] ⎕wi "∆where" ((x,2)⍴where)[65] ⎕wi "where" (("fmGetFolder" ⎕wi "size") Win∆Resize ⎕wi "∆where")[66] ⎕wi "tooltip" "Save Parameters"[67] ⎕wi "onClick" ("fmSV.mGet_FolderFile.mSave"⎕wi "onClick")[68] ⎕wi "caption" "OK"[69] ⎕wi "order" .5[70] ⎕wi "visible" ¯1[71] "fmGetFolder" ⎕wi "∆modified" 1[72] [73] ⎕wself←"fmGetFolder.edFolder" ⎕wi "New" "Edit"[74] Fieldlist←Fieldlist OVER "fmGetFolder.edFolder"[75] Fieldcontrol←Fieldcontrol OVER "Edit"[76] ⎕wi "∆name" "Folder"[77] ⎕wi "∆type" "Char"[78] ⎕wi "∆mandatory" 1[79] ⎕wi "tooltip" "Specify the Name of a Folder"[80] ⎕wi "∆where" (2 2⍴0.3 0 0.2 0)[81] ⎕wi "where" (("fmGetFolder" ⎕wi "size") Win∆Resize (2 2⍴0.3 0 0.2 0))[82] ⎕wi "onExit" "⍎(0∊⍴,⎕wres←0 INPUT∆CHECK 'fmGetFolder.edFolder')/'0 0⍴(⊂⎕wi ''name'') Get_Folder ''Change'' ' "[83] ⎕wi "onExitError" "Win∆ExitError ⎕warg"[84] ⎕wi "extent" (2+CharSize×1 71)[85] [86] ⎕wself←"fmGetFolder.llFolder" ⎕wi "New" "Label"[87] ⎕wi "scale" 5[88] ⎕wi "style" 2[89] ⎕wi "extent" (↑⎕wi "Draw" ("?text" "Folder Name"))[90] ⎕wi "caption" "Folder Name"[91] where←4↑,"fmGetFolder.edFolder" ⎕wi "∆where"[92] x←0.5×⍴where←Win∆Calcwhere where-0 ¯3 0,10+¯1↑⎕wi "extent"[93] ⎕wi "∆where" ((x,2)⍴where)[94] ⎕wi "where" (("fmGetFolder" ⎕wi "size") Win∆Resize ⎕wi "∆where")[95] [96] "fmGetFolder" ⎕wi "∆multifile" ""[97] "fmGetFolder" ⎕wi "∆singlefile" ""[98] "fmGetFolder" ⎕wi "∆format" ""[99] "fmGetFolder" ⎕wi "∆financial" 0[100] "fmGetFolder" ⎕wi "∆relrules" 0[101] "fmGetFolder" ⎕wi "∆parm" 0[102] "fmGetFolder" ⎕wi "∆decr" 0[103] "fmGetFolder" ⎕wi "∆file" 0[104] "fmGetFolder" ⎕wi "∆codefile" CodeFile[105] "fmGetFolder" ⎕wi "∆inputstype" ""[106] "fmGetFolder" ⎕wi "∆inputsentry" ""[107] "fmGetFolder" ⎕wi "∆savecn" (⍳0)[108] "fmGetFolder" ⎕wi "∆savedesc" ""[109] list←list OVER "fmGetFolder"[110] "fmGetFolder" ⎕wi "∆fieldlist" Fieldlist[111] "fmGetFolder" ⎕wi "∆fieldcontrol" Fieldcontrol[112] childlist←"fmSV" ⎕wi "∆childlist"[113] list←(⊃¯1↑childlist) OVER list[114] childlist[⍴childlist]←⊂list[115] "fmSV" ⎕wi "∆childlist" childlist[116] list←,⎕split list[117] 0 0⍴((∨/¨(⊂".mGet_Folder")⍷¨list)/list) MultiWI "enabled" 1[118] :if 300<fnsize[119]     (fnsize fnsize ".") Win∆ProgressBar "MemberUpdate"[120]     Win∆ProgressBar "Hide"[121] :endif[122] "Init" OpenParameters "Get_Folder"[123] "fmGetFolder.bnGet_FolderHelp" ⎕wi "visible" 1[124] "fmGetFolder.bnGet_FolderQuit" ⎕wi "visible" 1[125] "fmGetFolder.bnGet_FolderSave" ⎕wi "visible" 1[126] "#" ⎕wi "focus" "fmGetFolder.edFolder"[127] :if ~0∊⍴,Error←Win∆Initialise "Get_Folder"[128]     "Quit" EndModule Module[129]     "fmSV" ⎕wi "pointer" 0[130]     0 0⍴"fmGetFolder" ⎕wi "Delete"[131]     :return[132] :endif[133] :if bar_open←commandbar^"Multi"≡""[134]     bar_open←0×"fmGetFolder.mGet_FolderFile.m" Win∆CommandBar "OKHelp"[135] :endif[136] "fmGetFolder" ⎕wi "Paint"[137] "fmSV" ⎕wi "pointer" 11[138] "fmGetFolder" ⎕wi "onWait" "0 0⍴Get_Folder 'Wait' ⋄ 'fmGetFolder' ⎕wi 'modified' 0"[139] 0 0⍴"fmGetFolder" ⎕wi "Wait"[140] 0 0⍴"fmGetFolder" ⎕wi "Delete"[141] "fmSV" ⎕wi "pointer" 0 ∇