∇ Container←Form_Make;⎕wself;ControlName;childlist;list;Fieldlist;Fieldcontrol;FrameWidth;Caption;buttonsize;buttonwhere;where;size;alignment;Header;PickList;NameList;value;sortorder;SortList;MaxRow;MaxCol;Parent;level;node;no;nn;NN;x;fnsize;framelist;relTests[1] [2] Fieldlist←Fieldcontrol←list←0 0⍴""[3] "fmSV" ⎕wi "pointer" 13[4] buttonsize←25 65 ⋄ buttonwhere←¯5[5] FormName ⎕wi "caption" ((FormName ⎕wi "caption")," - Edit HTML Help Text")[6] "fmSV" ⎕wi "∆caption" (("fmSV" ⎕wi "∆caption"),⊂("fmSV" ⎕wi "caption"))[7] :if 300<fnsize←1↑⍴⎕cr "Form_Make"[8]     "Generating Form" Win∆ProgressBar "Open"[9]     ("Menu Items:" "Form Controls:") Win∆ProgressBar "SetLabels"[10]     (1 1 "Help About") Win∆ProgressBar "FileUpdate"[11] :endif[12] [13] Container←"∆Dialog"[14] [15] ⎕wself←"fmHelpEdit" ⎕wi "New" "Form" "Hide"[16] ⎕wi "caption" ("fmSV" ⎕wi "caption")[17] ⎕wi "scale" 5[18] ⎕wi "font" ("fmSV" ⎕wi "font")[19] ⎕wi "border" 2 32 64[20] ⎕wi "where" (Win∆CentrePos 1 1 ×768 1024×1⌈CharSize÷13 6)[21] ⎕wi "limitwhere" (0.8×¯2↑⎕wi "where")[22] ⎕wi "tooltipwidth" 200[23] ⎕wi "onResize" "AutoResize"[24] ⎕wi "onClose" "ExitSystem ''"[25] ControlName←"fmHelpEdit"[26] relTests←0[27] 0 Menu_Make "fmSV"[28] 0 Menu_Make "fmHelpEdit"[29] "fmHelpEdit" Win∆CutCopyPaste "Build"[30] list←list OVER "fmHelpEdit.bnHelp_EditingQuit"[31] ⎕wself←"fmHelpEdit.bnHelp_EditingQuit" ⎕wi "New" "Button"[32] ⎕wi "style" 2[33] ⎕wi "deferexit" 1[34] ⎕wi "extent" (size←1×buttonsize×1⌈CharSize÷13 6)[35] x←0.5×⍴where←Win∆Calcwhere 1,(¯10-size[1]),1,buttonwhere←buttonwhere-5+size[2][36] ⎕wi "∆where" ((x,2)⍴where)[37] ⎕wi "where" (("fmHelpEdit" ⎕wi "size") Win∆Resize ⎕wi "∆where")[38] ⎕wi "tooltip" "Quit and Return"[39] ⎕wi "onClick" ("fmSV.mHelp_EditingFile.mQuit"⎕wi "onClick")[40] ⎕wi "caption" "Quit"[41] ⎕wi "order" .5[42] ⎕wi "visible" ¯1[43] ControlName ⎕wi "∆quitbutton" "fmHelpEdit.bnHelp_EditingQuit"[44] "fmHelpEdit" ⎕wi "∆modified" 1[45] [46] ⎕wself←"fmHelpEdit.edSearch" ⎕wi "New" "Edit"[47] Fieldlist←Fieldlist OVER "fmHelpEdit.edSearch"[48] Fieldcontrol←Fieldcontrol OVER "Edit"[49] ⎕wi "∆name" "Search"[50] ⎕wi "∆type" "Char"[51] ⎕wi "∆mandatory" 1[52] ⎕wi "tooltip" "Specify a Search String for Help Field"[53] ⎕wi "∆where" (2 2⍴0.02 0 0.35 0)[54] ⎕wi "where" (("fmHelpEdit" ⎕wi "size") Win∆Resize (2 2⍴0.02 0 0.35 0))[55] ⎕wi "onExit" "⍎(0∊⍴,⎕wres←0 INPUT∆CHECK 'fmHelpEdit.edSearch')/'0 0⍴(⊂⎕wi ''name'') Help_Editing ''Change'' ' "[56] ⎕wi "onExitError" "Win∆ExitError ⎕warg"[57] ⎕wi "extent" (2+CharSize×1 51)[58] [59] ⎕wself←"fmHelpEdit.llSearch" ⎕wi "New" "Label"[60] ⎕wi "scale" 5[61] ⎕wi "style" 2[62] ⎕wi "extent" (↑⎕wi "Draw" ("?text" "Search String"))[63] ⎕wi "caption" "Search String"[64] where←4↑,"fmHelpEdit.edSearch" ⎕wi "∆where"[65] x←0.5×⍴where←Win∆Calcwhere where-0 ¯3 0,10+¯1↑⎕wi "extent"[66] ⎕wi "∆where" ((x,2)⍴where)[67] ⎕wi "where" (("fmHelpEdit" ⎕wi "size") Win∆Resize ⎕wi "∆where")[68] [69] ⎕wself←"fmHelpEdit.lsHelpField" ⎕wi "New" "List"[70] Fieldlist←Fieldlist OVER "fmHelpEdit.lsHelpField"[71] Fieldcontrol←Fieldcontrol OVER "List"[72] ⎕wi "∆name" "HelpField"[73] ⎕wi "∆type" "List"[74] ⎕wi "∆mandatory" 1[75] ⎕wi "tooltip" "Select the Help Text File to be edited"[76] ⎕wi "style" 16 0[77] PickList←GetHelpFields''[78] ⎕wi "∆update" "GetHelpFields''"[79] PickList←⊃m2n 1 0↓PickList[80] ⎕wi "list" PickList[81] ⎕wi "∆where" (4 2⍴0.1 0 0.05 0 0.55 0 0.4 0)[82] ⎕wi "where" (("fmHelpEdit" ⎕wi "size") Win∆Resize (4 2⍴0.1 0 0.05 0 0.55 0 0.4 0))[83] ⎕wi "onClick" "0 0⍴(⊂⎕wi 'name') Help_Editing 'Change' "[84] ⎕wi "onExit" "⎕wres←0 List∆CHECK 'fmHelpEdit.lsHelpField'"[85] ⎕wi "onExitError" "Win∆ExitError ⎕warg"[86] [87] ⎕wself←"fmHelpEdit.llHelpField" ⎕wi "New" "Label"[88] ⎕wi "scale" 5[89] ⎕wi "style" 2[90] ⎕wi "extent" (↑⎕wi "Draw" ("?text" "Select Help Text File"))[91] ⎕wi "caption" "Select Help Text File"[92] where←4↑,"fmHelpEdit.lsHelpField" ⎕wi "∆where"[93] x←0.5×⍴where←Win∆Calcwhere where-0,(5+1↑⎕wi "extent"),0 0[94] ⎕wi "∆where" ((x,2)⍴where)[95] ⎕wi "where" (("fmHelpEdit" ⎕wi "size") Win∆Resize ⎕wi "∆where")[96] [97] ⎕wself←"fmHelpEdit.lsParmField" ⎕wi "New" "List"[98] Fieldlist←Fieldlist OVER "fmHelpEdit.lsParmField"[99] Fieldcontrol←Fieldcontrol OVER "List"[100] ⎕wi "∆name" "ParmField"[101] ⎕wi "∆type" "List"[102] ⎕wi "∆mandatory" 1[103] ⎕wi "tooltip" "Select the Parameter Field Help to be edited"[104] ⎕wi "style" 16 0[105] PickList←GetParmFields''[106] ⎕wi "∆update" "GetParmFields''"[107] PickList←⊃m2n 1 0↓PickList[108] ⎕wi "list" PickList[109] ⎕wi "∆where" (4 2⍴0.1 0 0.55 0 0.55 0 0.4 0)[110] ⎕wi "where" (("fmHelpEdit" ⎕wi "size") Win∆Resize (4 2⍴0.1 0 0.55 0 0.55 0 0.4 0))[111] ⎕wi "onClick" "0 0⍴(⊂⎕wi 'name') Help_Editing 'Change' "[112] ⎕wi "onExit" "⎕wres←0 List∆CHECK 'fmHelpEdit.lsParmField'"[113] ⎕wi "onExitError" "Win∆ExitError ⎕warg"[114] [115] ⎕wself←"fmHelpEdit.llParmField" ⎕wi "New" "Label"[116] ⎕wi "scale" 5[117] ⎕wi "style" 2[118] ⎕wi "extent" (↑⎕wi "Draw" ("?text" "OR Select Parameter Field"))[119] ⎕wi "caption" "OR Select Parameter Field"[120] where←4↑,"fmHelpEdit.lsParmField" ⎕wi "∆where"[121] x←0.5×⍴where←Win∆Calcwhere where-0,(5+1↑⎕wi "extent"),0 0[122] ⎕wi "∆where" ((x,2)⍴where)[123] ⎕wi "where" (("fmHelpEdit" ⎕wi "size") Win∆Resize ⎕wi "∆where")[124] [125] ⎕wself←"fmHelpEdit.webHelpText" ⎕wi "New" "Microsoft Web Browser"[126] Fieldlist←Fieldlist OVER "fmHelpEdit.webHelpText"[127] Fieldcontrol←Fieldcontrol OVER "Microsoft Web Browser"[128] ⎕wi "∆name" "HelpText"[129] ⎕wi "∆type" "Web"[130] ⎕wi "∆where" (4 2⍴0.7 0 0.01 0 0.3 ¯45 0.98 0)[131] ⎕wi "where" (("fmHelpEdit" ⎕wi "size") Win∆Resize (4 2⍴0.7 0 0.01 0 0.3 ¯45 0.98 0))[132] [133] ⎕wself←"fmHelpEdit.llHelpText" ⎕wi "New" "Label"[134] ⎕wi "scale" 5[135] ⎕wi "style" 2[136] ⎕wi "extent" (↑⎕wi "Draw" ("?text" "Current Help Text"))[137] ⎕wi "caption" "Current Help Text"[138] where←4↑,"fmHelpEdit.webHelpText" ⎕wi "∆where"[139] x←0.5×⍴where←Win∆Calcwhere where-0,(5+1↑⎕wi "extent"),0 0[140] ⎕wi "∆where" ((x,2)⍴where)[141] ⎕wi "where" (("fmHelpEdit" ⎕wi "size") Win∆Resize ⎕wi "∆where")[142] list←list OVER "fmHelpEdit.bnHelp_EditingEdit"[143] ⎕wself←"fmHelpEdit.bnHelp_EditingEdit" ⎕wi "New" "Button"[144] ⎕wi "extent" (size←1.4 1×buttonsize×1⌈CharSize÷13 6)[145] x←0.5×⍴where←Win∆Calcwhere 1,(¯10-size[1]),1,buttonwhere←buttonwhere-5+size[2][146] ⎕wi "∆where" ((x,2)⍴where)[147] ⎕wi "where" (("fmHelpEdit" ⎕wi "size") Win∆Resize ⎕wi "∆where")[148] ⎕wi "tooltip" "Edit the Help Text"[149] ⎕wi "onClick" ("fmSV.mHelp_EditingFile.mEdit"⎕wi "onClick")[150] ⎕wi "caption" (("⍺",⎕tcnl) char_replace "Edit⍺Help Text")[151] [152] "fmHelpEdit" ⎕wi "∆multifile" ""[153] "fmHelpEdit" ⎕wi "∆singlefile" ""[154] "fmHelpEdit" ⎕wi "∆format" ""[155] "fmHelpEdit" ⎕wi "∆financial" 0[156] "fmHelpEdit" ⎕wi "∆relrules" 0[157] "fmHelpEdit" ⎕wi "∆parm" 0[158] "fmHelpEdit" ⎕wi "∆decr" 0[159] "fmHelpEdit" ⎕wi "∆file" 0[160] "fmHelpEdit" ⎕wi "∆codefile" CodeFile[161] "fmHelpEdit" ⎕wi "∆inputstype" ""[162] "fmHelpEdit" ⎕wi "∆inputsentry" ""[163] "fmHelpEdit" ⎕wi "∆savecn" (⍳0)[164] "fmHelpEdit" ⎕wi "∆savedesc" ""[165] list←list OVER "fmHelpEdit"[166] "fmHelpEdit" ⎕wi "∆fieldlist" Fieldlist[167] "fmHelpEdit" ⎕wi "∆fieldcontrol" Fieldcontrol[168] childlist←"fmSV" ⎕wi "∆childlist"[169] list←(⊃¯1↑childlist) OVER list[170] childlist[⍴childlist]←⊂list[171] "fmSV" ⎕wi "∆childlist" childlist[172] list←,⎕split list[173] 0 0⍴((∨/¨(⊂".mHelp_Editing")⍷¨list)/list) MultiWI "enabled" 1[174] :if 300<fnsize[175]     (fnsize fnsize ".") Win∆ProgressBar "MemberUpdate"[176]     Win∆ProgressBar "Hide"[177] :endif[178] "Init" OpenParameters "Help_Editing"[179] "fmHelpEdit.bnHelp_EditingQuit" ⎕wi "visible" 1[180] "#" ⎕wi "focus" "fmHelpEdit.edSearch"[181] :if ~0∊⍴,Error←Win∆Initialise "Help_Editing"[182]     "Quit" EndModule Module[183]     "fmSV" ⎕wi "pointer" 0[184]     0 0⍴"fmHelpEdit" ⎕wi "Delete"[185]     :return[186] :endif[187] :if bar_open←commandbar^"Multi"≡""[188]     bar_open←0×"fmHelpEdit.mHelp_EditingFile.m" Win∆CommandBar "Quit"[189] :endif[190] "fmHelpEdit" ⎕wi "Paint"[191] "fmSV" ⎕wi "pointer" 11[192] "fmHelpEdit" ⎕wi "onWait" "0 0⍴Help_Editing 'Wait' ⋄ 'fmHelpEdit' ⎕wi 'modified' 0"[193] 0 0⍴"fmHelpEdit" ⎕wi "Wait"[194] 0 0⍴"fmHelpEdit" ⎕wi "Delete"[195] "fmSV" ⎕wi "pointer" 0 ∇