∇ Container←Form_Make;⎕wself;ControlName;childlist;list;Fieldlist;Fieldcontrol;FrameWidth;Caption;buttonsize;buttonwhere;where;size;alignment;Header;PickList;NameList;value;sortorder;SortList;MaxRow;MaxCol;Parent;level;node;no;nn;NN;x;fnsize;framelist;relTests[1] [2] Fieldlist←Fieldcontrol←list←0 0⍴""[3] "fmSV" ⎕wi "pointer" 13[4] buttonsize←25 65 ⋄ buttonwhere←¯5[5] FormName ⎕wi "caption" ((FormName ⎕wi "caption")," - Internal Rate of Return Calculator")[6] "fmSV" ⎕wi "∆caption" (("fmSV" ⎕wi "∆caption"),⊂("fmSV" ⎕wi "caption"))[7] :if 300<fnsize←1↑⍴⎕cr "Form_Make"[8]     "Generating Form" Win∆ProgressBar "Open"[9]     ("Menu Items:" "Form Controls:") Win∆ProgressBar "SetLabels"[10]     (1 1 "Help About") Win∆ProgressBar "FileUpdate"[11] :endif[12] [13] Container←"∆Dialog"[14] [15] ⎕wself←"fmIRR" ⎕wi "New" "Form" "Hide"[16] ⎕wi "caption" ("fmSV" ⎕wi "caption")[17] ⎕wi "scale" 5[18] ⎕wi "font" ("fmSV" ⎕wi "font")[19] ⎕wi "border" 2 32 64[20] ⎕wi "where" (Win∆CentrePos .30 .48×768 1024×1⌈CharSize÷13 6)[21] ⎕wi "limitwhere" (0.8×¯2↑⎕wi "where")[22] ⎕wi "tooltipwidth" 200[23] ⎕wi "onResize" "AutoResize"[24] ⎕wi "onClose" "ExitSystem ''"[25] ControlName←"fmIRR"[26] relTests←0[27] 0 Menu_Make "fmSV"[28] 1 Menu_Make "fmIRR"[29] "fmIRR" Win∆CutCopyPaste "Build"[30] "fmIRR" ⎕wi "∆helpid" 2064[31] list←list OVER "fmIRR.bnIRRHelp"[32] ⎕wself←"fmIRR.bnIRRHelp" ⎕wi "New" "Button"[33] ⎕wi "deferexit" 1[34] ⎕wi "extent" (size←1×buttonsize×1⌈CharSize÷13 6)[35] x←0.5×⍴where←Win∆Calcwhere 1,(¯10-size[1]),1,buttonwhere←buttonwhere-5+size[2][36] ⎕wi "∆where" ((x,2)⍴where)[37] ⎕wi "where" (("fmIRR" ⎕wi "size") Win∆Resize ⎕wi "∆where")[38] ⎕wi "tooltip" "SuperVal Help"[39] ⎕wi "onClick" ("fmSV.mIRRHelp.mContext"⎕wi "onClick")[40] ⎕wi "caption" "Help"[41] :if buttonimage[42]     ⎕wi "imagelist" "fmSV.iStandard"[43]     ⎕wi "imageindex" 12[44] :endif[45] ⎕wi "visible" ¯1[46] ⎕wi "onMouseDown" "∆HelpField←'#' ⎕wi 'focus' "[47] list←list OVER "fmIRR.bnIRRQuit"[48] ⎕wself←"fmIRR.bnIRRQuit" ⎕wi "New" "Button"[49] ⎕wi "style" 2[50] ⎕wi "deferexit" 1[51] ⎕wi "extent" (size←1×buttonsize×1⌈CharSize÷13 6)[52] x←0.5×⍴where←Win∆Calcwhere 1,(¯10-size[1]),1,buttonwhere←buttonwhere-5+size[2][53] ⎕wi "∆where" ((x,2)⍴where)[54] ⎕wi "where" (("fmIRR" ⎕wi "size") Win∆Resize ⎕wi "∆where")[55] ⎕wi "tooltip" "Quit and Return"[56] ⎕wi "onClick" ("fmSV.mIRRFile.mQuit"⎕wi "onClick")[57] ⎕wi "caption" "Quit"[58] ⎕wi "∆helpid" 3581[59] ⎕wi "order" .5[60] ⎕wi "visible" ¯1[61] ControlName ⎕wi "∆quitbutton" "fmIRR.bnIRRQuit"[62] list←list OVER "fmIRR.bnIRRSave"[63] ⎕wself←"fmIRR.bnIRRSave" ⎕wi "New" "Button"[64] ⎕wi "extent" (size←1×buttonsize×1⌈CharSize÷13 6)[65] x←0.5×⍴where←Win∆Calcwhere 1,(¯10-size[1]),1,buttonwhere←buttonwhere-5+size[2][66] ⎕wi "∆where" ((x,2)⍴where)[67] ⎕wi "where" (("fmIRR" ⎕wi "size") Win∆Resize ⎕wi "∆where")[68] ⎕wi "tooltip" "Save Parameters"[69] ⎕wi "onClick" ("fmSV.mIRRFile.mSave"⎕wi "onClick")[70] ⎕wi "caption" "Save"[71] :if buttonimage[72]     ⎕wi "imagelist" "fmSV.iStandard"[73]     ⎕wi "imageindex" 9[74] :endif[75] ⎕wi "∆helpid" 3582[76] ⎕wi "enabled" 0[77] ⎕wi "order" .5[78] ⎕wi "visible" ¯1[79] "fmIRR" ⎕wi "onModified" "('IRR' 'fmIRR.bnIRRSave') Win∆SaveEnabled (0≠⎕warg[1])"[80] list←list OVER "fmIRR.bnIRRSaveAs"[81] ⎕wself←"fmIRR.bnIRRSaveAs" ⎕wi "New" "Button"[82] ⎕wi "extent" (size←1×buttonsize×1⌈CharSize÷13 6)[83] x←0.5×⍴where←Win∆Calcwhere 1,(¯10-size[1]),1,buttonwhere←buttonwhere-5+size[2][84] ⎕wi "∆where" ((x,2)⍴where)[85] ⎕wi "where" (("fmIRR" ⎕wi "size") Win∆Resize ⎕wi "∆where")[86] ⎕wi "tooltip" "Save Parameters As ..."[87] ⎕wi "onClick" ("fmSV.mIRRFile.mSaveAs"⎕wi "onClick")[88] ⎕wi "caption" "Save As"[89] ⎕wi "∆helpid" 3583[90] ⎕wi "order" .5[91] ⎕wi "visible" ¯1[92] list←list OVER "fmIRR.bnIRRRun"[93] ⎕wself←"fmIRR.bnIRRRun" ⎕wi "New" "Button"[94] ⎕wi "style" 1[95] ⎕wi "extent" (size←1×buttonsize×1⌈CharSize÷13 6)[96] x←0.5×⍴where←Win∆Calcwhere 1,(¯10-size[1]),1,buttonwhere←buttonwhere-5+size[2][97] ⎕wi "∆where" ((x,2)⍴where)[98] ⎕wi "where" (("fmIRR" ⎕wi "size") Win∆Resize ⎕wi "∆where")[99] ⎕wi "tooltip" "Save Parameters and Run Internal Rate of Return Calculator"[100] ⎕wi "onClick" ("fmSV.mIRRFile.mRun"⎕wi "onClick")[101] ⎕wi "caption" "Run"[102] :if buttonimage[103]     ⎕wi "imagelist" "fmSV.iStandard"[104]     ⎕wi "imageindex" 33[105] :endif[106] ⎕wi "∆helpid" 3584[107] ⎕wi "order" .5[108] ⎕wi "visible" ¯1[109] [110] ⎕wself←"fmIRR.edfILENAME" ⎕wi "New" "Edit"[111] Fieldlist←Fieldlist OVER "fmIRR.edfILENAME"[112] Fieldcontrol←Fieldcontrol OVER "Edit"[113] ⎕wi "∆name" "fILENAME"[114] ⎕wi "∆type" "File"[115] ⎕wi "∆mandatory" 1[116] ⎕wi "∆valid" ('Input' 'Single')[117] ⎕wi "∆helpid" 3585[118] ⎕wi "tooltip" "Specify the File with Cash Flow Details
(Double Click for Open File Dialog)"[119] ⎕wi "∆where" (2 2⍴0.1 0 0.45 0)[120] ⎕wi "where" (("fmIRR" ⎕wi "size") Win∆Resize (2 2⍴0.1 0 0.45 0))[121] ⎕wi "onExit" "⍎(0∊⍴,⎕wres←0 INPUT∆CHECK 'fmIRR.edfILENAME')/'0 0⍴(⊂⎕wi ''name'') IRR ''Change'' ' "[122] ⎕wi "onExitError" "Win∆ExitError ⎕warg"[123] ⎕wi "extent" (2+CharSize×1 31)[124] ⎕wi "pointer" ">cur 1001 shell32.dll"[125] ⎕wi "onMouseDouble" "'Input Single' GetFileList 'Single' "[126] ⎕wi "targetformats" "FileName"[127] ⎕wi "onDrop" "'fmIRR.edfILENAME' Win∆DropTarget 0 ('Input' 'Single')"[128] ⎕wi "onChange" "0 0⍴(⊂⎕wi 'name') IRR 'Change' "[129] [130] ⎕wself←"fmIRR.llfILENAME" ⎕wi "New" "Label"[131] ⎕wi "scale" 5[132] ⎕wi "style" 2[133] ⎕wi "extent" (↑⎕wi "Draw" ("?text" "Cash Flow File"))[134] ⎕wi "caption" "Cash Flow File"[135] where←4↑,"fmIRR.edfILENAME" ⎕wi "∆where"[136] x←0.5×⍴where←Win∆Calcwhere where-0 ¯3 0,10+¯1↑⎕wi "extent"[137] ⎕wi "∆where" ((x,2)⍴where)[138] ⎕wi "where" (("fmIRR" ⎕wi "size") Win∆Resize ⎕wi "∆where")[139] [140] ⎕wself←"fmIRR.eddf" ⎕wi "New" "Edit"[141] Fieldlist←Fieldlist OVER "fmIRR.eddf"[142] Fieldcontrol←Fieldcontrol OVER "Edit"[143] ⎕wi "∆name" "df"[144] ⎕wi "∆type" "Upper"[145] ⎕wi "∆mandatory" 1[146] ⎕wi "∆valid" ('DateFmt')[147] ⎕wi "∆helpid" 3586[148] ⎕wi "tooltip" "Specify the Date Format of Dates in the File"[149] ⎕wi "limit" 10[150] ⎕wi "∆where" (2 2⍴0.35 0 0.45 0)[151] ⎕wi "where" (("fmIRR" ⎕wi "size") Win∆Resize (2 2⍴0.35 0 0.45 0))[152] ⎕wi "onExit" "⍎(0∊⍴,⎕wres←0 INPUT∆CHECK 'fmIRR.eddf')/'0 0⍴(⊂⎕wi ''name'') IRR ''Change'' ' "[153] ⎕wi "onExitError" "Win∆ExitError ⎕warg"[154] ⎕wi "onKeyPress" "⎕wres←¯2×~⎕warg∊8 32 45 46 47 68 77 89 100 109 121"[155] ⎕wi "style" (512+⎕wi "style")[156] ⎕wi "extent" (2 0+Win∆TextSize "DD/MM/YYYY ")[157] [158] ⎕wself←"fmIRR.lldf" ⎕wi "New" "Label"[159] ⎕wi "scale" 5[160] ⎕wi "style" 2[161] ⎕wi "extent" (↑⎕wi "Draw" ("?text" "Format of Dates in File"))[162] ⎕wi "caption" "Format of Dates in File"[163] where←4↑,"fmIRR.eddf" ⎕wi "∆where"[164] x←0.5×⍴where←Win∆Calcwhere where-0 ¯3 0,10+¯1↑⎕wi "extent"[165] ⎕wi "∆where" ((x,2)⍴where)[166] ⎕wi "where" (("fmIRR" ⎕wi "size") Win∆Resize ⎕wi "∆where")[167] [168] ⎕wself←"fmIRR.edGuess" ⎕wi "New" "Edit"[169] Fieldlist←Fieldlist OVER "fmIRR.edGuess"[170] Fieldcontrol←Fieldcontrol OVER "Edit"[171] ⎕wi "∆name" "Guess"[172] ⎕wi "∆type" "Num"[173] ⎕wi "∆mandatory" 1[174] ⎕wi "∆valid" ('Scalar')[175] ⎕wi "∆helpid" 3587[176] ⎕wi "tooltip" "Specify the estimate of the Internal Rate of Return"[177] ⎕wi "limit" 5[178] ⎕wi "∆where" (2 2⍴0.6 0 0.45 0)[179] ⎕wi "where" (("fmIRR" ⎕wi "size") Win∆Resize (2 2⍴0.6 0 0.45 0))[180] ⎕wi "∆range" "¯20 40"[181] ⎕wi "onExit" "⍎(0∊⍴,⎕wres←0 INPUT∆CHECK 'fmIRR.edGuess')/'0 0⍴(⊂⎕wi ''name'') IRR ''Change'' ' "[182] ⎕wi "onExitError" "Win∆ExitError ⎕warg"[183] ⎕wi "onKeyPress" "⎕wres←¯2×~⎕warg∊45 46 8 32 48 49 50 51 52 53 54 55 56 57"[184] ⎕wi "extent" (2+CharSize×1 6)[185] [186] ⎕wself←"fmIRR.lrGuess" ⎕wi "New" "Label"[187] ⎕wi "scale" 5[188] ⎕wi "extent" (↑⎕wi "Draw" ("?text" "% p.a."))[189] ⎕wi "caption" "% p.a."[190] where←4↑,"fmIRR.edGuess" ⎕wi "∆where"[191] x←0.5×⍴where←Win∆Calcwhere where+0,3,0,10+¯1↑"fmIRR.edGuess" ⎕wi "extent"[192] ⎕wi "∆where" ((x,2)⍴where)[193] ⎕wi "where" (("fmIRR" ⎕wi "size") Win∆Resize ⎕wi "∆where")[194] [195] ⎕wself←"fmIRR.llGuess" ⎕wi "New" "Label"[196] ⎕wi "scale" 5[197] ⎕wi "style" 2[198] ⎕wi "extent" (↑⎕wi "Draw" ("?text" "Estimated Return"))[199] ⎕wi "caption" "Estimated Return"[200] where←4↑,"fmIRR.edGuess" ⎕wi "∆where"[201] x←0.5×⍴where←Win∆Calcwhere where-0 ¯3 0,10+¯1↑⎕wi "extent"[202] ⎕wi "∆where" ((x,2)⍴where)[203] ⎕wi "where" (("fmIRR" ⎕wi "size") Win∆Resize ⎕wi "∆where")[204] [205] ⎕wself←"fmIRR.lParmDesc" ⎕wi "New" "Label"[206] ⎕wi "scale" 5[207] ⎕wi "extent" (CharSize×¯2↑1,20)[208] ⎕wi "style" 32[209] ⎕wi "caption" " "[210] ⎕wi "∆where" (2 2⍴0.86 0 0.02 0)[211] ⎕wi "where" (("fmIRR" ⎕wi "size") Win∆Resize (2 2⍴0.86 0 0.02 0))[212] [213] "fmIRR" ⎕wi "∆multifile" ""[214] "fmIRR" ⎕wi "∆singlefile" "fmIRR.edfILENAME"[215] "fmIRR" ⎕wi "∆format" ""[216] "fmIRR" ⎕wi "∆financial" 0[217] "fmIRR" ⎕wi "∆relrules" 0[218] "fmIRR" ⎕wi "∆parm" 0[219] "fmIRR" ⎕wi "∆decr" 0[220] "fmIRR" ⎕wi "∆file" 0[221] "fmIRR" ⎕wi "∆codefile" CodeFile[222] "fmIRR" ⎕wi "∆inputstype" "ClientFile"[223] "fmIRR" ⎕wi "∆inputsentry" "Multi"[224] "fmIRR" ⎕wi "∆savecn" (⍳0)[225] "fmIRR" ⎕wi "∆savedesc" ""[226] list←list OVER "fmIRR"[227] "fmIRR" ⎕wi "∆fieldlist" Fieldlist[228] "fmIRR" ⎕wi "∆fieldcontrol" Fieldcontrol[229] childlist←"fmSV" ⎕wi "∆childlist"[230] list←(⊃¯1↑childlist) OVER list[231] childlist[⍴childlist]←⊂list[232] "fmSV" ⎕wi "∆childlist" childlist[233] list←,⎕split list[234] 0 0⍴((∨/¨(⊂".mIRR")⍷¨list)/list) MultiWI "enabled" 1[235] :if 300<fnsize[236]     (fnsize fnsize ".") Win∆ProgressBar "MemberUpdate"[237]     Win∆ProgressBar "Hide"[238] :endif[239] "Init" OpenParameters "IRR"[240] "fmIRR.bnIRRHelp" ⎕wi "visible" 1[241] "fmIRR.bnIRRQuit" ⎕wi "visible" 1[242] "fmIRR.bnIRRSave" ⎕wi "visible" 1[243] "fmIRR.bnIRRSaveAs" ⎕wi "visible" 1[244] "fmIRR.bnIRRRun" ⎕wi "visible" 1[245] "#" ⎕wi "focus" "fmIRR.edfILENAME"[246] :if ~0∊⍴,Error←Win∆Initialise "IRR"[247]     "Quit" EndModule Module[248]     "fmSV" ⎕wi "pointer" 0[249]     0 0⍴"fmIRR" ⎕wi "Delete"[250]     :return[251] :endif[252] :if bar_open←commandbar^"Multi"≡"Multi"[253]     bar_open←0×"fmIRR.mIRRFile.m" Win∆CommandBar "RunAsHelp"[254] :endif[255] "fmIRR" ⎕wi "Paint"[256] "fmSV" ⎕wi "pointer" 11[257] "fmIRR" ⎕wi "onWait" "0 0⍴IRR 'Wait' ⋄ 'fmIRR' ⎕wi 'modified' 0"[258] 0 0⍴"fmIRR" ⎕wi "Wait"[259] 0 0⍴"fmIRR" ⎕wi "Delete"[260] "fmSV" ⎕wi "pointer" 0 ∇