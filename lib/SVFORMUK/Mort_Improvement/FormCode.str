∇ Container←Form_Make;⎕wself;ControlName;childlist;list;Fieldlist;Fieldcontrol;FrameWidth;Caption;buttonsize;buttonwhere;where;size;alignment;Header;PickList;NameList;value;sortorder;SortList;MaxRow;MaxCol;Parent;level;node;no;nn;NN;x;fnsize;framelist;relTests[1] [2] Fieldlist←Fieldcontrol←list←0 0⍴""[3] "fmSV" ⎕wi "pointer" 13[4] buttonsize←25 65 ⋄ buttonwhere←¯5[5] FormName ⎕wi "caption" ((FormName ⎕wi "caption")," - Mortality Improvement Definition")[6] "fmSV" ⎕wi "∆caption" (("fmSV" ⎕wi "∆caption"),⊂("fmSV" ⎕wi "caption"))[7] :if 300<fnsize←1↑⍴⎕cr "Form_Make"[8]     "Generating Form" Win∆ProgressBar "Open"[9]     ("Menu Items:" "Form Controls:") Win∆ProgressBar "SetLabels"[10]     (1 1 "Help About") Win∆ProgressBar "FileUpdate"[11] :endif[12] [13] Container←"∆Dialog"[14] [15] ⎕wself←"fmMortImp" ⎕wi "New" "Form" "Hide"[16] ⎕wi "caption" ("fmSV" ⎕wi "caption")[17] ⎕wi "scale" 5[18] ⎕wi "font" ("fmSV" ⎕wi "font")[19] ⎕wi "border" 2 32 64[20] ⎕wi "where" (Win∆CentrePos 0.7 1.0×768 1024×1⌈CharSize÷13 6)[21] ⎕wi "limitwhere" (0.8×¯2↑⎕wi "where")[22] ⎕wi "tooltipwidth" 200[23] ⎕wi "onResize" "AutoResize"[24] ⎕wi "onClose" "ExitSystem ''"[25] ControlName←"fmMortImp"[26] relTests←1[27] 0 Menu_Make "fmSV"[28] 1 Menu_Make "fmMortImp"[29] "fmMortImp" Win∆CutCopyPaste "Build"[30] "fmMortImp" ⎕wi "∆helpid" 2160[31] list←list OVER "fmMortImp.bnMort_ImprovementHelp"[32] ⎕wself←"fmMortImp.bnMort_ImprovementHelp" ⎕wi "New" "Button"[33] ⎕wi "deferexit" 1[34] ⎕wi "extent" (size←1×buttonsize×1⌈CharSize÷13 6)[35] x←0.5×⍴where←Win∆Calcwhere 1,(¯10-size[1]),1,buttonwhere←buttonwhere-5+size[2][36] ⎕wi "∆where" ((x,2)⍴where)[37] ⎕wi "where" (("fmMortImp" ⎕wi "size") Win∆Resize ⎕wi "∆where")[38] ⎕wi "tooltip" "SuperVal Help"[39] ⎕wi "onClick" ("fmSV.mMort_ImprovementHelp.mContext"⎕wi "onClick")[40] ⎕wi "caption" "Help"[41] :if buttonimage[42]     ⎕wi "imagelist" "fmSV.iStandard"[43]     ⎕wi "imageindex" 12[44] :endif[45] ⎕wi "visible" ¯1[46] ⎕wi "onMouseDown" "∆HelpField←'#' ⎕wi 'focus' "[47] list←list OVER "fmMortImp.bnMort_ImprovementQuit"[48] ⎕wself←"fmMortImp.bnMort_ImprovementQuit" ⎕wi "New" "Button"[49] ⎕wi "style" 2[50] ⎕wi "deferexit" 1[51] ⎕wi "extent" (size←1×buttonsize×1⌈CharSize÷13 6)[52] x←0.5×⍴where←Win∆Calcwhere 1,(¯10-size[1]),1,buttonwhere←buttonwhere-5+size[2][53] ⎕wi "∆where" ((x,2)⍴where)[54] ⎕wi "where" (("fmMortImp" ⎕wi "size") Win∆Resize ⎕wi "∆where")[55] ⎕wi "tooltip" "Quit and Return"[56] ⎕wi "onClick" ("fmSV.mMort_ImprovementFile.mQuit"⎕wi "onClick")[57] ⎕wi "caption" "Quit"[58] ⎕wi "∆helpid" 4222[59] ⎕wi "order" .5[60] ⎕wi "visible" ¯1[61] ControlName ⎕wi "∆quitbutton" "fmMortImp.bnMort_ImprovementQuit"[62] list←list OVER "fmMortImp.bnMort_ImprovementSave"[63] ⎕wself←"fmMortImp.bnMort_ImprovementSave" ⎕wi "New" "Button"[64] ⎕wi "extent" (size←1×buttonsize×1⌈CharSize÷13 6)[65] x←0.5×⍴where←Win∆Calcwhere 1,(¯10-size[1]),1,buttonwhere←buttonwhere-5+size[2][66] ⎕wi "∆where" ((x,2)⍴where)[67] ⎕wi "where" (("fmMortImp" ⎕wi "size") Win∆Resize ⎕wi "∆where")[68] ⎕wi "tooltip" "Save Parameters"[69] ⎕wi "onClick" ("fmSV.mMort_ImprovementFile.mSave"⎕wi "onClick")[70] ⎕wi "caption" "Save"[71] :if buttonimage[72]     ⎕wi "imagelist" "fmSV.iStandard"[73]     ⎕wi "imageindex" 9[74] :endif[75] ⎕wi "∆helpid" 4223[76] ⎕wi "enabled" 0[77] ⎕wi "order" .5[78] ⎕wi "visible" ¯1[79] "fmMortImp" ⎕wi "onModified" "('Mort_Improvement' 'fmMortImp.bnMort_ImprovementSave') Win∆SaveEnabled (0≠⎕warg[1])"[80] list←list OVER "fmMortImp.bnMort_ImprovementSaveAs"[81] ⎕wself←"fmMortImp.bnMort_ImprovementSaveAs" ⎕wi "New" "Button"[82] ⎕wi "extent" (size←1×buttonsize×1⌈CharSize÷13 6)[83] x←0.5×⍴where←Win∆Calcwhere 1,(¯10-size[1]),1,buttonwhere←buttonwhere-5+size[2][84] ⎕wi "∆where" ((x,2)⍴where)[85] ⎕wi "where" (("fmMortImp" ⎕wi "size") Win∆Resize ⎕wi "∆where")[86] ⎕wi "tooltip" "Save Parameters As ..."[87] ⎕wi "onClick" ("fmSV.mMort_ImprovementFile.mSaveAs"⎕wi "onClick")[88] ⎕wi "caption" "Save As"[89] ⎕wi "∆helpid" 4224[90] ⎕wi "order" .5[91] ⎕wi "visible" ¯1[92] "fmMortImp" ⎕wi "∆audit" 1[93] [94] :if 300<fnsize[95]     ((1↑⎕lc) fnsize "FrameV - Definition") Win∆ProgressBar "MemberUpdate"[96] :endif[97] [98] ⎕wself←"fmMortImp.fMIDef" ⎕wi "New" "Frame"[99] ⎕wi "scale" 5[100] ⎕wi "∆where" (4 2⍴0 0 0 0 0.2 0 1 0)[101] ⎕wi "where" (("fmMortImp" ⎕wi "size") Win∆Resize (4 2⍴0 0 0 0 0.2 0 1 0))[102] ⎕wi "caption" "Definition"[103] ⎕wi "style" 0[104] ⎕wi "onResize" "AutoResize"[105] [106] ⎕wself←"fmMortImp.fMIDef.cbgmiMORTIMPR" ⎕wi "New" "Combo"[107] Fieldlist←Fieldlist OVER "fmMortImp.fMIDef.cbgmiMORTIMPR"[108] Fieldcontrol←Fieldcontrol OVER "Combo"[109] ⎕wi "∆name" "gmiMORTIMPR"[110] ⎕wi "∆type" "Char"[111] ⎕wi "∆mandatory" 1[112] ⎕wi "∆helpid" 4225[113] ⎕wi "tooltip" "Select the required Mortality Improvement Definition"[114] ⎕wi "style" 16 128 256 2[115] ⎕wi "∆where" (2 2⍴0.3 0 0.3 0)[116] ⎕wi "where" (("fmMortImp.fMIDef" ⎕wi "size") Win∆Resize (2 2⍴0.3 0 0.3 0))[117] PickList←⍙POPUPSdict ReadDictFile "MIType"[118] PickList←⊃m2n 1 0↓PickList[119] ⎕wi "list" PickList[120] ⎕wi "extent" (150,(¯10+6×¯1↑CharSize)+¯1↑Win∆TextSize ((0,⎕wi "limit")⌈⍴PickList)↑PickList)[121] ⎕wi "onClick" "0 0⍴(⊂⎕wi 'name') Mort_Improvement 'Change' "[122] [123] ⎕wself←"fmMortImp.fMIDef.llgmiMORTIMPR" ⎕wi "New" "Label"[124] ⎕wi "scale" 5[125] ⎕wi "style" 2[126] ⎕wi "extent" (↑⎕wi "Draw" ("?text" "Mortality Improvement Definition"))[127] ⎕wi "caption" "Mortality Improvement Definition"[128] where←4↑,"fmMortImp.fMIDef.cbgmiMORTIMPR" ⎕wi "∆where"[129] x←0.5×⍴where←Win∆Calcwhere where-0 ¯3 0,10+¯1↑⎕wi "extent"[130] ⎕wi "∆where" ((x,2)⍴where)[131] ⎕wi "where" (("fmMortImp.fMIDef" ⎕wi "size") Win∆Resize ⎕wi "∆where")[132] [133] ⎕wself←"fmMortImp.fMIDef.ckgmiRATEIMPR" ⎕wi "New" "Check"[134] Fieldlist←Fieldlist OVER "fmMortImp.fMIDef.ckgmiRATEIMPR"[135] Fieldcontrol←Fieldcontrol OVER "Check"[136] ⎕wi "∆name" "gmiRATEIMPR"[137] ⎕wi "∆type" "Check"[138] ⎕wi "∆helpid" 4226[139] ⎕wi "tooltip" "Check this if you want any Age Rating on the Mortality Table applied on the Alpha and Beta Tables"[140] ⎕wi "style" 0[141] ⎕wi "caption" "Apply Mortality Rate Age Rating to Mortality Improvement Table"[142] ⎕wi "∆where" (2 2⍴0.7 0 0.3 0)[143] ⎕wi "where" (("fmMortImp.fMIDef" ⎕wi "size") Win∆Resize (2 2⍴0.7 0 0.3 0))[144] ⎕wi "extent" ((0 5×CharSize)+Win∆TextSize ⎕wi "caption")[145] ⎕wi "onClick" "(0 0⍴(⊂⎕wi 'name') Mort_Improvement 'Change' )"[146] [147] :if 300<fnsize[148]     ((1↑⎕lc) fnsize "FrameV - CMI Mortality Improvement Formula") Win∆ProgressBar "MemberUpdate"[149] :endif[150] [151] ⎕wself←"fmMortImp.fCMI" ⎕wi "New" "Frame"[152] ⎕wi "scale" 5[153] ⎕wi "∆where" (4 2⍴0.2 0 0 0 0.8 ¯45 1 0)[154] ⎕wi "where" (("fmMortImp" ⎕wi "size") Win∆Resize (4 2⍴0.2 0 0 0 0.8 ¯45 1 0))[155] ⎕wi "caption" "CMI Mortality Improvement Formula"[156] ⎕wi "style" 0[157] ⎕wi "onResize" "AutoResize"[158] [159] ⎕wself←"fmMortImp.fCMI.edgmiBASE" ⎕wi "New" "Edit"[160] Fieldlist←Fieldlist OVER "fmMortImp.fCMI.edgmiBASE"[161] Fieldcontrol←Fieldcontrol OVER "Edit"[162] ⎕wi "∆name" "gmiBASE"[163] ⎕wi "∆type" "Num"[164] ⎕wi "∆mandatory" 1[165] ⎕wi "∆valid" ('Int' 'Scalar' '+')[166] ⎕wi "∆helpid" 4227[167] ⎕wi "tooltip" "Specify the Base Year of Mortality Table"[168] ⎕wi "limit" 4[169] ⎕wi "∆where" (2 2⍴0.1 0 0.4 0)[170] ⎕wi "where" (("fmMortImp.fCMI" ⎕wi "size") Win∆Resize (2 2⍴0.1 0 0.4 0))[171] ⎕wi "∆range" "1900 2100"[172] ⎕wi "onChange" "0 0⍴(⊂⎕wi 'name') Mort_Improvement 'Change' "[173] ⎕wi "onExit" "⍎(0∊⍴,⎕wres←0 INPUT∆CHECK 'fmMortImp.fCMI.edgmiBASE')/'0 0⍴(⊂⎕wi ''name'') Mort_Improvement ''Change'' ' "[174] ⎕wi "onExitError" "Win∆ExitError ⎕warg"[175] ⎕wi "onKeyPress" "⎕wres←¯2×~⎕warg∊8 32 48 49 50 51 52 53 54 55 56 57"[176] ⎕wi "extent" (2+CharSize×1 5)[177] [178] ⎕wself←"fmMortImp.fCMI.lrgmiBASE" ⎕wi "New" "Label"[179] ⎕wi "scale" 5[180] ⎕wi "extent" (↑⎕wi "Draw" ("?text" "CCYY"))[181] ⎕wi "caption" "CCYY"[182] where←4↑,"fmMortImp.fCMI.edgmiBASE" ⎕wi "∆where"[183] x←0.5×⍴where←Win∆Calcwhere where+0,3,0,10+¯1↑"fmMortImp.fCMI.edgmiBASE" ⎕wi "extent"[184] ⎕wi "∆where" ((x,2)⍴where)[185] ⎕wi "where" (("fmMortImp.fCMI" ⎕wi "size") Win∆Resize ⎕wi "∆where")[186] [187] ⎕wself←"fmMortImp.fCMI.llgmiBASE" ⎕wi "New" "Label"[188] ⎕wi "scale" 5[189] ⎕wi "style" 2[190] ⎕wi "extent" (↑⎕wi "Draw" ("?text" "Base Year of Mortality Table"))[191] ⎕wi "caption" "Base Year of Mortality Table"[192] where←4↑,"fmMortImp.fCMI.edgmiBASE" ⎕wi "∆where"[193] x←0.5×⍴where←Win∆Calcwhere where-0 ¯3 0,10+¯1↑⎕wi "extent"[194] ⎕wi "∆where" ((x,2)⍴where)[195] ⎕wi "where" (("fmMortImp.fCMI" ⎕wi "size") Win∆Resize ⎕wi "∆where")[196] [197] ⎕wself←"fmMortImp.fCMI.edgmiCMSL" ⎕wi "New" "Edit"[198] Fieldlist←Fieldlist OVER "fmMortImp.fCMI.edgmiCMSL"[199] Fieldcontrol←Fieldcontrol OVER "Edit"[200] ⎕wi "∆name" "gmiCMSL"[201] ⎕wi "∆type" "Num"[202] ⎕wi "∆mandatory" 1[203] ⎕wi "∆valid" ('Int' 'Scalar' '0+')[204] ⎕wi "∆helpid" 4228[205] ⎕wi "tooltip" "Specify the Term from the Base Year for Improved Mortality"[206] ⎕wi "limit" 2[207] ⎕wi "∆where" (2 2⍴0.21 0 0.4 0)[208] ⎕wi "where" (("fmMortImp.fCMI" ⎕wi "size") Win∆Resize (2 2⍴0.21 0 0.4 0))[209] ⎕wi "∆range" "0 99"[210] ⎕wi "onChange" "0 0⍴(⊂⎕wi 'name') Mort_Improvement 'Change' "[211] ⎕wi "onExit" "⍎(0∊⍴,⎕wres←0 INPUT∆CHECK 'fmMortImp.fCMI.edgmiCMSL')/'0 0⍴(⊂⎕wi ''name'') Mort_Improvement ''Change'' ' "[212] ⎕wi "onExitError" "Win∆ExitError ⎕warg"[213] ⎕wi "onKeyPress" "⎕wres←¯2×~⎕warg∊8 32 48 49 50 51 52 53 54 55 56 57"[214] ⎕wi "extent" (2+CharSize×1 3)[215] [216] ⎕wself←"fmMortImp.fCMI.lrgmiCMSL" ⎕wi "New" "Label"[217] ⎕wi "scale" 5[218] ⎕wi "extent" (↑⎕wi "Draw" ("?text" "years"))[219] ⎕wi "caption" "years"[220] where←4↑,"fmMortImp.fCMI.edgmiCMSL" ⎕wi "∆where"[221] x←0.5×⍴where←Win∆Calcwhere where+0,3,0,10+¯1↑"fmMortImp.fCMI.edgmiCMSL" ⎕wi "extent"[222] ⎕wi "∆where" ((x,2)⍴where)[223] ⎕wi "where" (("fmMortImp.fCMI" ⎕wi "size") Win∆Resize ⎕wi "∆where")[224] [225] ⎕wself←"fmMortImp.fCMI.llgmiCMSL" ⎕wi "New" "Label"[226] ⎕wi "scale" 5[227] ⎕wi "style" 2[228] ⎕wi "extent" (↑⎕wi "Draw" ("?text" (("⍺",⎕tcnl) char_replace "Term from Base Year⍺(Member)")))[229] ⎕wi "caption" (("⍺",⎕tcnl) char_replace "Term from Base Year⍺(Member)")[230] where←4↑,"fmMortImp.fCMI.edgmiCMSL" ⎕wi "∆where"[231] size←1↑"fmMortImp.fCMI.edgmiCMSL" ⎕wi "extent"[232] size←¯3⌈0.5×(1↑⎕wi "extent")-size[233] x←0.5×⍴where←Win∆Calcwhere where-0,size,0,10+¯1↑⎕wi "extent"[234] ⎕wi "∆where" ((x,2)⍴where)[235] ⎕wi "where" (("fmMortImp.fCMI" ⎕wi "size") Win∆Resize ⎕wi "∆where")[236] [237] ⎕wself←"fmMortImp.fCMI.edgmiCSSL" ⎕wi "New" "Edit"[238] Fieldlist←Fieldlist OVER "fmMortImp.fCMI.edgmiCSSL"[239] Fieldcontrol←Fieldcontrol OVER "Edit"[240] ⎕wi "∆name" "gmiCSSL"[241] ⎕wi "∆type" "Num"[242] ⎕wi "∆valid" ('Int' 'Scalar' '0+')[243] ⎕wi "∆helpid" 4228[244] ⎕wi "tooltip" "Specify the Term from the Base Year for Improved Mortality"[245] ⎕wi "limit" 2[246] ⎕wi "∆where" (2 2⍴0.21 0 0.9 0)[247] ⎕wi "where" (("fmMortImp.fCMI" ⎕wi "size") Win∆Resize (2 2⍴0.21 0 0.9 0))[248] ⎕wi "∆range" "0 99"[249] ⎕wi "onChange" "0 0⍴(⊂⎕wi 'name') Mort_Improvement 'Change' "[250] ⎕wi "onExit" "⍎(0∊⍴,⎕wres←0 INPUT∆CHECK 'fmMortImp.fCMI.edgmiCSSL')/'0 0⍴(⊂⎕wi ''name'') Mort_Improvement ''Change'' ' "[251] ⎕wi "onExitError" "Win∆ExitError ⎕warg"[252] ⎕wi "onKeyPress" "⎕wres←¯2×~⎕warg∊8 32 48 49 50 51 52 53 54 55 56 57"[253] ⎕wi "extent" (2+CharSize×1 3)[254] [255] ⎕wself←"fmMortImp.fCMI.lrgmiCSSL" ⎕wi "New" "Label"[256] ⎕wi "scale" 5[257] ⎕wi "extent" (↑⎕wi "Draw" ("?text" "years"))[258] ⎕wi "caption" "years"[259] where←4↑,"fmMortImp.fCMI.edgmiCSSL" ⎕wi "∆where"[260] x←0.5×⍴where←Win∆Calcwhere where+0,3,0,10+¯1↑"fmMortImp.fCMI.edgmiCSSL" ⎕wi "extent"[261] ⎕wi "∆where" ((x,2)⍴where)[262] ⎕wi "where" (("fmMortImp.fCMI" ⎕wi "size") Win∆Resize ⎕wi "∆where")[263] [264] ⎕wself←"fmMortImp.fCMI.llgmiCSSL" ⎕wi "New" "Label"[265] ⎕wi "scale" 5[266] ⎕wi "style" 2[267] ⎕wi "extent" (↑⎕wi "Draw" ("?text" (("⍺",⎕tcnl) char_replace "Term from Base Year⍺(Death pre Retirement - Actives/Deferreds)")))[268] ⎕wi "caption" (("⍺",⎕tcnl) char_replace "Term from Base Year⍺(Death pre Retirement - Actives/Deferreds)")[269] where←4↑,"fmMortImp.fCMI.edgmiCSSL" ⎕wi "∆where"[270] size←1↑"fmMortImp.fCMI.edgmiCSSL" ⎕wi "extent"[271] size←¯3⌈0.5×(1↑⎕wi "extent")-size[272] x←0.5×⍴where←Win∆Calcwhere where-0,size,0,10+¯1↑⎕wi "extent"[273] ⎕wi "∆where" ((x,2)⍴where)[274] ⎕wi "where" (("fmMortImp.fCMI" ⎕wi "size") Win∆Resize ⎕wi "∆where")[275] [276] ⎕wself←"fmMortImp.fCMI.edgmiCSC" ⎕wi "New" "Edit"[277] Fieldlist←Fieldlist OVER "fmMortImp.fCMI.edgmiCSC"[278] Fieldcontrol←Fieldcontrol OVER "Edit"[279] ⎕wi "∆name" "gmiCSC"[280] ⎕wi "∆type" "Num"[281] ⎕wi "∆valid" ('Int' 'Scalar' '0+')[282] ⎕wi "∆helpid" 4228[283] ⎕wi "tooltip" "Specify the Term from the Base Year for Improved Mortality"[284] ⎕wi "limit" 2[285] ⎕wi "∆where" (2 2⍴0.32 0 0.9 0)[286] ⎕wi "where" (("fmMortImp.fCMI" ⎕wi "size") Win∆Resize (2 2⍴0.32 0 0.9 0))[287] ⎕wi "∆range" "0 99"[288] ⎕wi "onChange" "0 0⍴(⊂⎕wi 'name') Mort_Improvement 'Change' "[289] ⎕wi "onExit" "⍎(0∊⍴,⎕wres←0 INPUT∆CHECK 'fmMortImp.fCMI.edgmiCSC')/'0 0⍴(⊂⎕wi ''name'') Mort_Improvement ''Change'' ' "[290] ⎕wi "onExitError" "Win∆ExitError ⎕warg"[291] ⎕wi "onKeyPress" "⎕wres←¯2×~⎕warg∊8 32 48 49 50 51 52 53 54 55 56 57"[292] ⎕wi "extent" (2+CharSize×1 3)[293] [294] ⎕wself←"fmMortImp.fCMI.lrgmiCSC" ⎕wi "New" "Label"[295] ⎕wi "scale" 5[296] ⎕wi "extent" (↑⎕wi "Draw" ("?text" "years"))[297] ⎕wi "caption" "years"[298] where←4↑,"fmMortImp.fCMI.edgmiCSC" ⎕wi "∆where"[299] x←0.5×⍴where←Win∆Calcwhere where+0,3,0,10+¯1↑"fmMortImp.fCMI.edgmiCSC" ⎕wi "extent"[300] ⎕wi "∆where" ((x,2)⍴where)[301] ⎕wi "where" (("fmMortImp.fCMI" ⎕wi "size") Win∆Resize ⎕wi "∆where")[302] [303] ⎕wself←"fmMortImp.fCMI.llgmiCSC" ⎕wi "New" "Label"[304] ⎕wi "scale" 5[305] ⎕wi "style" 2[306] ⎕wi "extent" (↑⎕wi "Draw" ("?text" (("⍺",⎕tcnl) char_replace "Term from Base Year⍺(Contingent Spouse - Actives/Deferreds/Pensioner)")))[307] ⎕wi "caption" (("⍺",⎕tcnl) char_replace "Term from Base Year⍺(Contingent Spouse - Actives/Deferreds/Pensioner)")[308] where←4↑,"fmMortImp.fCMI.edgmiCSC" ⎕wi "∆where"[309] size←1↑"fmMortImp.fCMI.edgmiCSC" ⎕wi "extent"[310] size←¯3⌈0.5×(1↑⎕wi "extent")-size[311] x←0.5×⍴where←Win∆Calcwhere where-0,size,0,10+¯1↑⎕wi "extent"[312] ⎕wi "∆where" ((x,2)⍴where)[313] ⎕wi "where" (("fmMortImp.fCMI" ⎕wi "size") Win∆Resize ⎕wi "∆where")[314] [315] ⎕wself←"fmMortImp.fCMI.edgmiSMSL" ⎕wi "New" "Edit"[316] Fieldlist←Fieldlist OVER "fmMortImp.fCMI.edgmiSMSL"[317] Fieldcontrol←Fieldcontrol OVER "Edit"[318] ⎕wi "∆name" "gmiSMSL"[319] ⎕wi "∆type" "Num"[320] ⎕wi "∆mandatory" 1[321] ⎕wi "∆valid" ('Int' 'Scalar' '+')[322] ⎕wi "∆helpid" 4229[323] ⎕wi "tooltip" "Specify the Specified Year of Birth for Improved Mortality"[324] ⎕wi "limit" 4[325] ⎕wi "∆where" (2 2⍴0.43 0 0.4 0)[326] ⎕wi "where" (("fmMortImp.fCMI" ⎕wi "size") Win∆Resize (2 2⍴0.43 0 0.4 0))[327] ⎕wi "∆range" "1900 2100"[328] ⎕wi "onChange" "0 0⍴(⊂⎕wi 'name') Mort_Improvement 'Change' "[329] ⎕wi "onExit" "⍎(0∊⍴,⎕wres←0 INPUT∆CHECK 'fmMortImp.fCMI.edgmiSMSL')/'0 0⍴(⊂⎕wi ''name'') Mort_Improvement ''Change'' ' "[330] ⎕wi "onExitError" "Win∆ExitError ⎕warg"[331] ⎕wi "onKeyPress" "⎕wres←¯2×~⎕warg∊8 32 48 49 50 51 52 53 54 55 56 57"[332] ⎕wi "extent" (2+CharSize×1 5)[333] [334] ⎕wself←"fmMortImp.fCMI.lrgmiSMSL" ⎕wi "New" "Label"[335] ⎕wi "scale" 5[336] ⎕wi "extent" (↑⎕wi "Draw" ("?text" "CCYY"))[337] ⎕wi "caption" "CCYY"[338] where←4↑,"fmMortImp.fCMI.edgmiSMSL" ⎕wi "∆where"[339] x←0.5×⍴where←Win∆Calcwhere where+0,3,0,10+¯1↑"fmMortImp.fCMI.edgmiSMSL" ⎕wi "extent"[340] ⎕wi "∆where" ((x,2)⍴where)[341] ⎕wi "where" (("fmMortImp.fCMI" ⎕wi "size") Win∆Resize ⎕wi "∆where")[342] [343] ⎕wself←"fmMortImp.fCMI.llgmiSMSL" ⎕wi "New" "Label"[344] ⎕wi "scale" 5[345] ⎕wi "style" 2[346] ⎕wi "extent" (↑⎕wi "Draw" ("?text" (("⍺",⎕tcnl) char_replace "Year of Birth⍺(Member)")))[347] ⎕wi "caption" (("⍺",⎕tcnl) char_replace "Year of Birth⍺(Member)")[348] where←4↑,"fmMortImp.fCMI.edgmiSMSL" ⎕wi "∆where"[349] size←1↑"fmMortImp.fCMI.edgmiSMSL" ⎕wi "extent"[350] size←¯3⌈0.5×(1↑⎕wi "extent")-size[351] x←0.5×⍴where←Win∆Calcwhere where-0,size,0,10+¯1↑⎕wi "extent"[352] ⎕wi "∆where" ((x,2)⍴where)[353] ⎕wi "where" (("fmMortImp.fCMI" ⎕wi "size") Win∆Resize ⎕wi "∆where")[354] [355] ⎕wself←"fmMortImp.fCMI.edgmiSSSL" ⎕wi "New" "Edit"[356] Fieldlist←Fieldlist OVER "fmMortImp.fCMI.edgmiSSSL"[357] Fieldcontrol←Fieldcontrol OVER "Edit"[358] ⎕wi "∆name" "gmiSSSL"[359] ⎕wi "∆type" "Num"[360] ⎕wi "∆valid" ('Int' 'Scalar' '+')[361] ⎕wi "∆helpid" 4229[362] ⎕wi "tooltip" "Specify the Specified Year of Birth for Improved Mortality"[363] ⎕wi "limit" 4[364] ⎕wi "∆where" (2 2⍴0.43 0 0.9 0)[365] ⎕wi "where" (("fmMortImp.fCMI" ⎕wi "size") Win∆Resize (2 2⍴0.43 0 0.9 0))[366] ⎕wi "∆range" "1900 2100"[367] ⎕wi "onChange" "0 0⍴(⊂⎕wi 'name') Mort_Improvement 'Change' "[368] ⎕wi "onExit" "⍎(0∊⍴,⎕wres←0 INPUT∆CHECK 'fmMortImp.fCMI.edgmiSSSL')/'0 0⍴(⊂⎕wi ''name'') Mort_Improvement ''Change'' ' "[369] ⎕wi "onExitError" "Win∆ExitError ⎕warg"[370] ⎕wi "onKeyPress" "⎕wres←¯2×~⎕warg∊8 32 48 49 50 51 52 53 54 55 56 57"[371] ⎕wi "extent" (2+CharSize×1 5)[372] [373] ⎕wself←"fmMortImp.fCMI.lrgmiSSSL" ⎕wi "New" "Label"[374] ⎕wi "scale" 5[375] ⎕wi "extent" (↑⎕wi "Draw" ("?text" "CCYY"))[376] ⎕wi "caption" "CCYY"[377] where←4↑,"fmMortImp.fCMI.edgmiSSSL" ⎕wi "∆where"[378] x←0.5×⍴where←Win∆Calcwhere where+0,3,0,10+¯1↑"fmMortImp.fCMI.edgmiSSSL" ⎕wi "extent"[379] ⎕wi "∆where" ((x,2)⍴where)[380] ⎕wi "where" (("fmMortImp.fCMI" ⎕wi "size") Win∆Resize ⎕wi "∆where")[381] [382] ⎕wself←"fmMortImp.fCMI.llgmiSSSL" ⎕wi "New" "Label"[383] ⎕wi "scale" 5[384] ⎕wi "style" 2[385] ⎕wi "extent" (↑⎕wi "Draw" ("?text" (("⍺",⎕tcnl) char_replace "Year of Birth⍺(Death pre Retirement - Actives/Deferreds)")))[386] ⎕wi "caption" (("⍺",⎕tcnl) char_replace "Year of Birth⍺(Death pre Retirement - Actives/Deferreds)")[387] where←4↑,"fmMortImp.fCMI.edgmiSSSL" ⎕wi "∆where"[388] size←1↑"fmMortImp.fCMI.edgmiSSSL" ⎕wi "extent"[389] size←¯3⌈0.5×(1↑⎕wi "extent")-size[390] x←0.5×⍴where←Win∆Calcwhere where-0,size,0,10+¯1↑⎕wi "extent"[391] ⎕wi "∆where" ((x,2)⍴where)[392] ⎕wi "where" (("fmMortImp.fCMI" ⎕wi "size") Win∆Resize ⎕wi "∆where")[393] [394] ⎕wself←"fmMortImp.fCMI.edgmiSSC" ⎕wi "New" "Edit"[395] Fieldlist←Fieldlist OVER "fmMortImp.fCMI.edgmiSSC"[396] Fieldcontrol←Fieldcontrol OVER "Edit"[397] ⎕wi "∆name" "gmiSSC"[398] ⎕wi "∆type" "Num"[399] ⎕wi "∆valid" ('Int' 'Scalar' '+')[400] ⎕wi "∆helpid" 4229[401] ⎕wi "tooltip" "Specify the Specified Year of Birth for Improved Mortality"[402] ⎕wi "limit" 4[403] ⎕wi "∆where" (2 2⍴0.54 0 0.9 0)[404] ⎕wi "where" (("fmMortImp.fCMI" ⎕wi "size") Win∆Resize (2 2⍴0.54 0 0.9 0))[405] ⎕wi "∆range" "1900 2100"[406] ⎕wi "onChange" "0 0⍴(⊂⎕wi 'name') Mort_Improvement 'Change' "[407] ⎕wi "onExit" "⍎(0∊⍴,⎕wres←0 INPUT∆CHECK 'fmMortImp.fCMI.edgmiSSC')/'0 0⍴(⊂⎕wi ''name'') Mort_Improvement ''Change'' ' "[408] ⎕wi "onExitError" "Win∆ExitError ⎕warg"[409] ⎕wi "onKeyPress" "⎕wres←¯2×~⎕warg∊8 32 48 49 50 51 52 53 54 55 56 57"[410] ⎕wi "extent" (2+CharSize×1 5)[411] [412] ⎕wself←"fmMortImp.fCMI.lrgmiSSC" ⎕wi "New" "Label"[413] ⎕wi "scale" 5[414] ⎕wi "extent" (↑⎕wi "Draw" ("?text" "CCYY"))[415] ⎕wi "caption" "CCYY"[416] where←4↑,"fmMortImp.fCMI.edgmiSSC" ⎕wi "∆where"[417] x←0.5×⍴where←Win∆Calcwhere where+0,3,0,10+¯1↑"fmMortImp.fCMI.edgmiSSC" ⎕wi "extent"[418] ⎕wi "∆where" ((x,2)⍴where)[419] ⎕wi "where" (("fmMortImp.fCMI" ⎕wi "size") Win∆Resize ⎕wi "∆where")[420] [421] ⎕wself←"fmMortImp.fCMI.llgmiSSC" ⎕wi "New" "Label"[422] ⎕wi "scale" 5[423] ⎕wi "style" 2[424] ⎕wi "extent" (↑⎕wi "Draw" ("?text" (("⍺",⎕tcnl) char_replace "Year of Birth⍺(Contingent Spouse - Actives/Deferreds/Pensioner)")))[425] ⎕wi "caption" (("⍺",⎕tcnl) char_replace "Year of Birth⍺(Contingent Spouse - Actives/Deferreds/Pensioner)")[426] where←4↑,"fmMortImp.fCMI.edgmiSSC" ⎕wi "∆where"[427] size←1↑"fmMortImp.fCMI.edgmiSSC" ⎕wi "extent"[428] size←¯3⌈0.5×(1↑⎕wi "extent")-size[429] x←0.5×⍴where←Win∆Calcwhere where-0,size,0,10+¯1↑⎕wi "extent"[430] ⎕wi "∆where" ((x,2)⍴where)[431] ⎕wi "where" (("fmMortImp.fCMI" ⎕wi "size") Win∆Resize ⎕wi "∆where")[432] [433] ⎕wself←"fmMortImp.fCMI.edgmiALPHA1" ⎕wi "New" "Edit"[434] Fieldlist←Fieldlist OVER "fmMortImp.fCMI.edgmiALPHA1"[435] Fieldcontrol←Fieldcontrol OVER "Edit"[436] ⎕wi "∆name" "gmiALPHA[1;]"[437] ⎕wi "∆type" "Decr"[438] ⎕wi "∆mandatory" 1[439] ⎕wi "∆valid" ('HX' 'HF')[440] ⎕wi "∆helpid" 4230[441] ⎕wi "tooltip" "Specify the Table Code of the Alpha (Ultimate Improvement) Factors
(Right Click for List, Double Click for Rate Tables Display or '<' or '>' to Scroll through the Rate Tables)"[442] ⎕wi "limit" 5[443] ⎕wi "∆where" (2 2⍴0.65 0 0.17 0)[444] ⎕wi "where" (("fmMortImp.fCMI" ⎕wi "size") Win∆Resize (2 2⍴0.65 0 0.17 0))[445] ⎕wi "onExit" "⍎(0∊⍴,⎕wres←0 INPUT∆CHECK 'fmMortImp.fCMI.edgmiALPHA1')/'0 0⍴(⊂⎕wi ''name'') Mort_Improvement ''Change'' ' "[446] ⎕wi "onExitError" "Win∆ExitError ⎕warg"[447] ⎕wi "extent" (2+CharSize×1 6)[448] ⎕wi "keys" (60 62)[449] ⎕wi "pointer" ">cur 1001 shell32.dll"[450] ⎕wi "onFocus" "0 0⍴GetDecrList 'List' "[451] ⎕wi "onKeyPress" "(⎕wi 'self') Win∆DecrToggle ⎕wi '∆valid' "[452] ⎕wi "onMouseDown" "(⎕wi 'self') Win∆DecrPopup ⎕wi '∆valid' "[453] ⎕wi "onMouseDouble" "(⎕wi '∆valid') RunDecr 'Form'"[454] ⎕wi "onChange" "(⎕wi 'self') Win∆LabelUpdate (FormName ⎕wi '∆decrdesc') (FormName ⎕wi '∆decrlist') ⋄ 0 0⍴(⊂⎕wi 'name') Mort_Improvement 'Change' "[455] ⎕wi "∆rightlabel" "fmMortImp.fCMI.lrgmiALPHA1"[456] [457] ⎕wself←"fmMortImp.fCMI.llgmiALPHA1" ⎕wi "New" "Label"[458] ⎕wi "scale" 5[459] ⎕wi "style" 2[460] ⎕wi "extent" (↑⎕wi "Draw" ("?text" (("⍺",⎕tcnl) char_replace "Alpha Factor -⍺Ultimate Improvement")))[461] ⎕wi "caption" (("⍺",⎕tcnl) char_replace "Alpha Factor -⍺Ultimate Improvement")[462] where←4↑,"fmMortImp.fCMI.edgmiALPHA1" ⎕wi "∆where"[463] size←1↑"fmMortImp.fCMI.edgmiALPHA1" ⎕wi "extent"[464] size←¯3⌈0.5×(1↑⎕wi "extent")-size[465] x←0.5×⍴where←Win∆Calcwhere where-0,size,0,10+¯1↑⎕wi "extent"[466] ⎕wi "∆where" ((x,2)⍴where)[467] ⎕wi "where" (("fmMortImp.fCMI" ⎕wi "size") Win∆Resize ⎕wi "∆where")[468] [469] ⎕wself←"fmMortImp.fCMI.lrgmiALPHA1" ⎕wi "New" "Label"[470] ⎕wi "scale" 5[471] ⎕wi "extent" (CharSize×¯2↑1,50)[472] ⎕wi "style" 32[473] ⎕wi "caption" " "[474] where←4↑,"fmMortImp.fCMI.edgmiALPHA1" ⎕wi "∆where"[475] x←0.5×⍴where←Win∆Calcwhere where+0,3,0,10+¯1↑"fmMortImp.fCMI.edgmiALPHA1" ⎕wi "extent"[476] ⎕wi "∆where" ((x,2)⍴where)[477] ⎕wi "where" (("fmMortImp.fCMI" ⎕wi "size") Win∆Resize ⎕wi "∆where")[478] [479] ⎕wself←"fmMortImp.fCMI.edgmiALPHA3" ⎕wi "New" "Edit"[480] Fieldlist←Fieldlist OVER "fmMortImp.fCMI.edgmiALPHA3"[481] Fieldcontrol←Fieldcontrol OVER "Edit"[482] ⎕wi "∆name" "gmiALPHA[3;]"[483] ⎕wi "∆type" "CharNum"[484] ⎕wi "visible" (¯1+2×0)[485] ⎕wi "∆valid" ('Rating')[486] ⎕wi "tooltip" "Specify the Percentage Rating of the Ultimate Improvement Table"[487] ⎕wi "limit" 7[488] ⎕wi "∆where" (2 2⍴0.65 0 0.9 0)[489] ⎕wi "where" (("fmMortImp.fCMI" ⎕wi "size") Win∆Resize (2 2⍴0.65 0 0.9 0))[490] ⎕wi "∆range" "¯99 1000"[491] ⎕wi "onChange" "0 0⍴(⊂⎕wi 'name') Mort_Improvement 'Change' "[492] ⎕wi "onExit" "⍎(0∊⍴,⎕wres←0 INPUT∆CHECK 'fmMortImp.fCMI.edgmiALPHA3')/'0 0⍴(⊂⎕wi ''name'') Mort_Improvement ''Change'' ' "[493] ⎕wi "onExitError" "Win∆ExitError ⎕warg"[494] ⎕wi "onKeyPress" "⎕wres←¯2×~⎕warg∊43 45 46 8 32 48 49 50 51 52 53 54 55 56 57"[495] ⎕wi "extent" (2+CharSize×1 8)[496] [497] ⎕wself←"fmMortImp.fCMI.lrgmiALPHA3" ⎕wi "New" "Label"[498] ⎕wi "scale" 5[499] ⎕wi "visible" (¯1+2×0)[500] ⎕wi "extent" (↑⎕wi "Draw" ("?text" "%"))[501] ⎕wi "caption" "%"[502] where←4↑,"fmMortImp.fCMI.edgmiALPHA3" ⎕wi "∆where"[503] x←0.5×⍴where←Win∆Calcwhere where+0,3,0,10+¯1↑"fmMortImp.fCMI.edgmiALPHA3" ⎕wi "extent"[504] ⎕wi "∆where" ((x,2)⍴where)[505] ⎕wi "where" (("fmMortImp.fCMI" ⎕wi "size") Win∆Resize ⎕wi "∆where")[506] [507] ⎕wself←"fmMortImp.fCMI.llgmiALPHA3" ⎕wi "New" "Label"[508] ⎕wi "scale" 5[509] ⎕wi "style" 2[510] ⎕wi "visible" (¯1+2×0)[511] ⎕wi "extent" (↑⎕wi "Draw" ("?text" "% Rating"))[512] ⎕wi "caption" "% Rating"[513] where←4↑,"fmMortImp.fCMI.edgmiALPHA3" ⎕wi "∆where"[514] x←0.5×⍴where←Win∆Calcwhere where-0 ¯3 0,10+¯1↑⎕wi "extent"[515] ⎕wi "∆where" ((x,2)⍴where)[516] ⎕wi "where" (("fmMortImp.fCMI" ⎕wi "size") Win∆Resize ⎕wi "∆where")[517] [518] ⎕wself←"fmMortImp.fCMI.edgmiBETA1" ⎕wi "New" "Edit"[519] Fieldlist←Fieldlist OVER "fmMortImp.fCMI.edgmiBETA1"[520] Fieldcontrol←Fieldcontrol OVER "Edit"[521] ⎕wi "∆name" "gmiBETA[1;]"[522] ⎕wi "∆type" "Decr"[523] ⎕wi "∆mandatory" 1[524] ⎕wi "∆valid" ('HX' 'HF')[525] ⎕wi "∆helpid" 4231[526] ⎕wi "tooltip" "Specify the Table Code of the Beta (Mortality Improvement) Factors
(Right Click for List, Double Click for Rate Tables Display or '<' or '>' to Scroll through the Rate Tables)"[527] ⎕wi "limit" 5[528] ⎕wi "∆where" (2 2⍴0.76 0 0.17 0)[529] ⎕wi "where" (("fmMortImp.fCMI" ⎕wi "size") Win∆Resize (2 2⍴0.76 0 0.17 0))[530] ⎕wi "onExit" "⍎(0∊⍴,⎕wres←0 INPUT∆CHECK 'fmMortImp.fCMI.edgmiBETA1')/'0 0⍴(⊂⎕wi ''name'') Mort_Improvement ''Change'' ' "[531] ⎕wi "onExitError" "Win∆ExitError ⎕warg"[532] ⎕wi "extent" (2+CharSize×1 6)[533] ⎕wi "keys" (60 62)[534] ⎕wi "pointer" ">cur 1001 shell32.dll"[535] ⎕wi "onFocus" "0 0⍴GetDecrList 'List' "[536] ⎕wi "onKeyPress" "(⎕wi 'self') Win∆DecrToggle ⎕wi '∆valid' "[537] ⎕wi "onMouseDown" "(⎕wi 'self') Win∆DecrPopup ⎕wi '∆valid' "[538] ⎕wi "onMouseDouble" "(⎕wi '∆valid') RunDecr 'Form'"[539] ⎕wi "onChange" "(⎕wi 'self') Win∆LabelUpdate (FormName ⎕wi '∆decrdesc') (FormName ⎕wi '∆decrlist') ⋄ 0 0⍴(⊂⎕wi 'name') Mort_Improvement 'Change' "[540] ⎕wi "∆rightlabel" "fmMortImp.fCMI.lrgmiBETA1"[541] [542] ⎕wself←"fmMortImp.fCMI.llgmiBETA1" ⎕wi "New" "Label"[543] ⎕wi "scale" 5[544] ⎕wi "style" 2[545] ⎕wi "extent" (↑⎕wi "Draw" ("?text" (("⍺",⎕tcnl) char_replace "Beta Factor -⍺% of Mortality Improvement")))[546] ⎕wi "caption" (("⍺",⎕tcnl) char_replace "Beta Factor -⍺% of Mortality Improvement")[547] where←4↑,"fmMortImp.fCMI.edgmiBETA1" ⎕wi "∆where"[548] size←1↑"fmMortImp.fCMI.edgmiBETA1" ⎕wi "extent"[549] size←¯3⌈0.5×(1↑⎕wi "extent")-size[550] x←0.5×⍴where←Win∆Calcwhere where-0,size,0,10+¯1↑⎕wi "extent"[551] ⎕wi "∆where" ((x,2)⍴where)[552] ⎕wi "where" (("fmMortImp.fCMI" ⎕wi "size") Win∆Resize ⎕wi "∆where")[553] [554] ⎕wself←"fmMortImp.fCMI.lrgmiBETA1" ⎕wi "New" "Label"[555] ⎕wi "scale" 5[556] ⎕wi "extent" (CharSize×¯2↑1,50)[557] ⎕wi "style" 32[558] ⎕wi "caption" " "[559] where←4↑,"fmMortImp.fCMI.edgmiBETA1" ⎕wi "∆where"[560] x←0.5×⍴where←Win∆Calcwhere where+0,3,0,10+¯1↑"fmMortImp.fCMI.edgmiBETA1" ⎕wi "extent"[561] ⎕wi "∆where" ((x,2)⍴where)[562] ⎕wi "where" (("fmMortImp.fCMI" ⎕wi "size") Win∆Resize ⎕wi "∆where")[563] [564] ⎕wself←"fmMortImp.fCMI.edgmiBETA3" ⎕wi "New" "Edit"[565] Fieldlist←Fieldlist OVER "fmMortImp.fCMI.edgmiBETA3"[566] Fieldcontrol←Fieldcontrol OVER "Edit"[567] ⎕wi "∆name" "gmiBETA[3;]"[568] ⎕wi "∆type" "CharNum"[569] ⎕wi "visible" (¯1+2×0)[570] ⎕wi "∆valid" ('Rating')[571] ⎕wi "tooltip" "Specify the Percentage Rating of the Mortality Improvement Table"[572] ⎕wi "limit" 7[573] ⎕wi "∆where" (2 2⍴0.76 0 0.9 0)[574] ⎕wi "where" (("fmMortImp.fCMI" ⎕wi "size") Win∆Resize (2 2⍴0.76 0 0.9 0))[575] ⎕wi "∆range" "¯99 1000"[576] ⎕wi "onChange" "0 0⍴(⊂⎕wi 'name') Mort_Improvement 'Change' "[577] ⎕wi "onExit" "⍎(0∊⍴,⎕wres←0 INPUT∆CHECK 'fmMortImp.fCMI.edgmiBETA3')/'0 0⍴(⊂⎕wi ''name'') Mort_Improvement ''Change'' ' "[578] ⎕wi "onExitError" "Win∆ExitError ⎕warg"[579] ⎕wi "onKeyPress" "⎕wres←¯2×~⎕warg∊43 45 46 8 32 48 49 50 51 52 53 54 55 56 57"[580] ⎕wi "extent" (2+CharSize×1 8)[581] [582] ⎕wself←"fmMortImp.fCMI.lrgmiBETA3" ⎕wi "New" "Label"[583] ⎕wi "scale" 5[584] ⎕wi "visible" (¯1+2×0)[585] ⎕wi "extent" (↑⎕wi "Draw" ("?text" "%"))[586] ⎕wi "caption" "%"[587] where←4↑,"fmMortImp.fCMI.edgmiBETA3" ⎕wi "∆where"[588] x←0.5×⍴where←Win∆Calcwhere where+0,3,0,10+¯1↑"fmMortImp.fCMI.edgmiBETA3" ⎕wi "extent"[589] ⎕wi "∆where" ((x,2)⍴where)[590] ⎕wi "where" (("fmMortImp.fCMI" ⎕wi "size") Win∆Resize ⎕wi "∆where")[591] [592] ⎕wself←"fmMortImp.fCMI.llgmiBETA3" ⎕wi "New" "Label"[593] ⎕wi "scale" 5[594] ⎕wi "style" 2[595] ⎕wi "visible" (¯1+2×0)[596] ⎕wi "extent" (↑⎕wi "Draw" ("?text" "% Rating"))[597] ⎕wi "caption" "% Rating"[598] where←4↑,"fmMortImp.fCMI.edgmiBETA3" ⎕wi "∆where"[599] x←0.5×⍴where←Win∆Calcwhere where-0 ¯3 0,10+¯1↑⎕wi "extent"[600] ⎕wi "∆where" ((x,2)⍴where)[601] ⎕wi "where" (("fmMortImp.fCMI" ⎕wi "size") Win∆Resize ⎕wi "∆where")[602] [603] ⎕wself←"fmMortImp.fCMI.edgmiBETAYRS" ⎕wi "New" "Edit"[604] Fieldlist←Fieldlist OVER "fmMortImp.fCMI.edgmiBETAYRS"[605] Fieldcontrol←Fieldcontrol OVER "Edit"[606] ⎕wi "∆name" "gmiBETAYRS"[607] ⎕wi "∆type" "Num"[608] ⎕wi "∆mandatory" 1[609] ⎕wi "∆valid" ('Int' 'Scalar' '0+')[610] ⎕wi "∆helpid" 4231[611] ⎕wi "tooltip" "Number of Years to reach Beat % of Ultimate Mortality Improvement"[612] ⎕wi "limit" 2[613] ⎕wi "∆where" (2 2⍴0.87 0 0.4 0)[614] ⎕wi "where" (("fmMortImp.fCMI" ⎕wi "size") Win∆Resize (2 2⍴0.87 0 0.4 0))[615] ⎕wi "∆range" "0 99"[616] ⎕wi "onChange" "0 0⍴(⊂⎕wi 'name') Mort_Improvement 'Change' "[617] ⎕wi "onExit" "⍎(0∊⍴,⎕wres←0 INPUT∆CHECK 'fmMortImp.fCMI.edgmiBETAYRS')/'0 0⍴(⊂⎕wi ''name'') Mort_Improvement ''Change'' ' "[618] ⎕wi "onExitError" "Win∆ExitError ⎕warg"[619] ⎕wi "onKeyPress" "⎕wres←¯2×~⎕warg∊8 32 48 49 50 51 52 53 54 55 56 57"[620] ⎕wi "extent" (2+CharSize×1 3)[621] [622] ⎕wself←"fmMortImp.fCMI.lrgmiBETAYRS" ⎕wi "New" "Label"[623] ⎕wi "scale" 5[624] ⎕wi "extent" (↑⎕wi "Draw" ("?text" "years"))[625] ⎕wi "caption" "years"[626] where←4↑,"fmMortImp.fCMI.edgmiBETAYRS" ⎕wi "∆where"[627] x←0.5×⍴where←Win∆Calcwhere where+0,3,0,10+¯1↑"fmMortImp.fCMI.edgmiBETAYRS" ⎕wi "extent"[628] ⎕wi "∆where" ((x,2)⍴where)[629] ⎕wi "where" (("fmMortImp.fCMI" ⎕wi "size") Win∆Resize ⎕wi "∆where")[630] [631] ⎕wself←"fmMortImp.fCMI.llgmiBETAYRS" ⎕wi "New" "Label"[632] ⎕wi "scale" 5[633] ⎕wi "style" 2[634] ⎕wi "extent" (↑⎕wi "Draw" ("?text" "Attained after Period of Years"))[635] ⎕wi "caption" "Attained after Period of Years"[636] where←4↑,"fmMortImp.fCMI.edgmiBETAYRS" ⎕wi "∆where"[637] x←0.5×⍴where←Win∆Calcwhere where-0 ¯3 0,10+¯1↑⎕wi "extent"[638] ⎕wi "∆where" ((x,2)⍴where)[639] ⎕wi "where" (("fmMortImp.fCMI" ⎕wi "size") Win∆Resize ⎕wi "∆where")[640] [641] :if 300<fnsize[642]     ((1↑⎕lc) fnsize "FrameV - Two-Dimensional Table") Win∆ProgressBar "MemberUpdate"[643] :endif[644] [645] ⎕wself←"fmMortImp.fTwoDTab" ⎕wi "New" "Frame"[646] ⎕wi "scale" 5[647] ⎕wi "∆where" (4 2⍴0.2 0 0 0 0.8 ¯45 1 0)[648] ⎕wi "where" (("fmMortImp" ⎕wi "size") Win∆Resize (4 2⍴0.2 0 0 0 0.8 ¯45 1 0))[649] ⎕wi "caption" "Two-Dimensional Table"[650] ⎕wi "style" 0[651] ⎕wi "onResize" "AutoResize"[652] [653] ⎕wself←"fmMortImp.fTwoDTab.cbgmiIMPTBLcsv" ⎕wi "New" "Combo"[654] Fieldlist←Fieldlist OVER "fmMortImp.fTwoDTab.cbgmiIMPTBLcsv"[655] Fieldcontrol←Fieldcontrol OVER "Combo"[656] ⎕wi "∆name" "gmiIMPTBLcsv"[657] ⎕wi "∆type" "File"[658] ⎕wi "∆valid" ('MIcsv')[659] ⎕wi "∆helpid" 4232[660] ⎕wi "tooltip" "Specify the File containing the Two-Dimensional Mortality Improvement Table"[661] ⎕wi "style" 16 128 256 2[662] ⎕wi "∆where" (2 2⍴0.2 0 0.4 0)[663] ⎕wi "where" (("fmMortImp.fTwoDTab" ⎕wi "size") Win∆Resize (2 2⍴0.2 0 0.4 0))[664] PickList←GetCSVFiles MIcsvDir[665] ⎕wi "∆update" "GetCSVFiles MIcsvDir"[666] PickList←⊃m2n 1 0↓PickList[667] PickList←" " OVER PickList[668] ⎕wi "list" PickList[669] ⎕wi "extent" (150,(¯10+6×¯1↑CharSize)+¯1↑Win∆TextSize ((0,⎕wi "limit")⌈⍴PickList)↑PickList)[670] ⎕wi "onClick" "0 0⍴(⊂⎕wi 'name') Mort_Improvement 'Change' "[671] [672] ⎕wself←"fmMortImp.fTwoDTab.llgmiIMPTBLcsv" ⎕wi "New" "Label"[673] ⎕wi "scale" 5[674] ⎕wi "style" 2[675] ⎕wi "extent" (↑⎕wi "Draw" ("?text" (("⍺",⎕tcnl) char_replace "Two-Dimensional ⍺Improvement Table (CSV File)")))[676] ⎕wi "caption" (("⍺",⎕tcnl) char_replace "Two-Dimensional ⍺Improvement Table (CSV File)")[677] where←4↑,"fmMortImp.fTwoDTab.cbgmiIMPTBLcsv" ⎕wi "∆where"[678] size←1↑"fmMortImp.fTwoDTab.cbgmiIMPTBLcsv" ⎕wi "extent"[679] size←¯3⌈0.5×(1↑⎕wi "extent")-size[680] x←0.5×⍴where←Win∆Calcwhere where-0,size,0,10+¯1↑⎕wi "extent"[681] ⎕wi "∆where" ((x,2)⍴where)[682] ⎕wi "where" (("fmMortImp.fTwoDTab" ⎕wi "size") Win∆Resize ⎕wi "∆where")[683] [684] ⎕wself←"fmMortImp.fTwoDTab.edgmiIMPTBL1" ⎕wi "New" "Edit"[685] Fieldlist←Fieldlist OVER "fmMortImp.fTwoDTab.edgmiIMPTBL1"[686] Fieldcontrol←Fieldcontrol OVER "Edit"[687] ⎕wi "∆name" "gmiIMPTBL[1;]"[688] ⎕wi "∆type" "Decr"[689] ⎕wi "∆valid" ('MM')[690] ⎕wi "∆helpid" 4233[691] ⎕wi "tooltip" "Specify the Table Code of the Two-Dimensional Mortality Improvement Table
(Right Click for List, Double Click for Rate Tables Display or '<' or '>' to Scroll through the Rate Tables)"[692] ⎕wi "limit" 5[693] ⎕wi "∆where" (2 2⍴0.45 0 0.17 0)[694] ⎕wi "where" (("fmMortImp.fTwoDTab" ⎕wi "size") Win∆Resize (2 2⍴0.45 0 0.17 0))[695] ⎕wi "onExit" "⍎(0∊⍴,⎕wres←0 INPUT∆CHECK 'fmMortImp.fTwoDTab.edgmiIMPTBL1')/'0 0⍴(⊂⎕wi ''name'') Mort_Improvement ''Change'' ' "[696] ⎕wi "onExitError" "Win∆ExitError ⎕warg"[697] ⎕wi "extent" (2+CharSize×1 6)[698] ⎕wi "keys" (60 62)[699] ⎕wi "pointer" ">cur 1001 shell32.dll"[700] ⎕wi "onFocus" "0 0⍴GetDecrList 'List' "[701] ⎕wi "onKeyPress" "(⎕wi 'self') Win∆DecrToggle ⎕wi '∆valid' "[702] ⎕wi "onMouseDown" "(⎕wi 'self') Win∆DecrPopup ⎕wi '∆valid' "[703] ⎕wi "onMouseDouble" "(⎕wi '∆valid') RunDecr 'Form'"[704] ⎕wi "onChange" "(⎕wi 'self') Win∆LabelUpdate (FormName ⎕wi '∆decrdesc') (FormName ⎕wi '∆decrlist') ⋄ 0 0⍴(⊂⎕wi 'name') Mort_Improvement 'Change' "[705] ⎕wi "∆rightlabel" "fmMortImp.fTwoDTab.lrgmiIMPTBL1"[706] [707] ⎕wself←"fmMortImp.fTwoDTab.llgmiIMPTBL1" ⎕wi "New" "Label"[708] ⎕wi "scale" 5[709] ⎕wi "style" 2[710] ⎕wi "extent" (↑⎕wi "Draw" ("?text" (("⍺",⎕tcnl) char_replace "Two-Dimensional ⍺Improvement Table (Rate Table)")))[711] ⎕wi "caption" (("⍺",⎕tcnl) char_replace "Two-Dimensional ⍺Improvement Table (Rate Table)")[712] where←4↑,"fmMortImp.fTwoDTab.edgmiIMPTBL1" ⎕wi "∆where"[713] size←1↑"fmMortImp.fTwoDTab.edgmiIMPTBL1" ⎕wi "extent"[714] size←¯3⌈0.5×(1↑⎕wi "extent")-size[715] x←0.5×⍴where←Win∆Calcwhere where-0,size,0,10+¯1↑⎕wi "extent"[716] ⎕wi "∆where" ((x,2)⍴where)[717] ⎕wi "where" (("fmMortImp.fTwoDTab" ⎕wi "size") Win∆Resize ⎕wi "∆where")[718] [719] ⎕wself←"fmMortImp.fTwoDTab.lrgmiIMPTBL1" ⎕wi "New" "Label"[720] ⎕wi "scale" 5[721] ⎕wi "extent" (CharSize×¯2↑1,50)[722] ⎕wi "style" 32[723] ⎕wi "caption" " "[724] where←4↑,"fmMortImp.fTwoDTab.edgmiIMPTBL1" ⎕wi "∆where"[725] x←0.5×⍴where←Win∆Calcwhere where+0,3,0,10+¯1↑"fmMortImp.fTwoDTab.edgmiIMPTBL1" ⎕wi "extent"[726] ⎕wi "∆where" ((x,2)⍴where)[727] ⎕wi "where" (("fmMortImp.fTwoDTab" ⎕wi "size") Win∆Resize ⎕wi "∆where")[728] [729] ⎕wself←"fmMortImp.fTwoDTab.edgmiIMPTBL3" ⎕wi "New" "Edit"[730] Fieldlist←Fieldlist OVER "fmMortImp.fTwoDTab.edgmiIMPTBL3"[731] Fieldcontrol←Fieldcontrol OVER "Edit"[732] ⎕wi "∆name" "gmiIMPTBL[3;]"[733] ⎕wi "∆type" "CharNum"[734] ⎕wi "visible" (¯1+2×0)[735] ⎕wi "∆valid" ('Rating')[736] ⎕wi "∆helpid" 4234[737] ⎕wi "tooltip" "Specify the Percentage Rating of the Mortality Improvement Table"[738] ⎕wi "limit" 7[739] ⎕wi "∆where" (2 2⍴0.45 0 0.9 0)[740] ⎕wi "where" (("fmMortImp.fTwoDTab" ⎕wi "size") Win∆Resize (2 2⍴0.45 0 0.9 0))[741] ⎕wi "∆range" "¯99 1000"[742] ⎕wi "onChange" "0 0⍴(⊂⎕wi 'name') Mort_Improvement 'Change' "[743] ⎕wi "onExit" "⍎(0∊⍴,⎕wres←0 INPUT∆CHECK 'fmMortImp.fTwoDTab.edgmiIMPTBL3')/'0 0⍴(⊂⎕wi ''name'') Mort_Improvement ''Change'' ' "[744] ⎕wi "onExitError" "Win∆ExitError ⎕warg"[745] ⎕wi "onKeyPress" "⎕wres←¯2×~⎕warg∊43 45 46 8 32 48 49 50 51 52 53 54 55 56 57"[746] ⎕wi "extent" (2+CharSize×1 8)[747] [748] ⎕wself←"fmMortImp.fTwoDTab.lrgmiIMPTBL3" ⎕wi "New" "Label"[749] ⎕wi "scale" 5[750] ⎕wi "visible" (¯1+2×0)[751] ⎕wi "extent" (↑⎕wi "Draw" ("?text" "%"))[752] ⎕wi "caption" "%"[753] where←4↑,"fmMortImp.fTwoDTab.edgmiIMPTBL3" ⎕wi "∆where"[754] x←0.5×⍴where←Win∆Calcwhere where+0,3,0,10+¯1↑"fmMortImp.fTwoDTab.edgmiIMPTBL3" ⎕wi "extent"[755] ⎕wi "∆where" ((x,2)⍴where)[756] ⎕wi "where" (("fmMortImp.fTwoDTab" ⎕wi "size") Win∆Resize ⎕wi "∆where")[757] [758] ⎕wself←"fmMortImp.fTwoDTab.llgmiIMPTBL3" ⎕wi "New" "Label"[759] ⎕wi "scale" 5[760] ⎕wi "style" 2[761] ⎕wi "visible" (¯1+2×0)[762] ⎕wi "extent" (↑⎕wi "Draw" ("?text" "% Rating"))[763] ⎕wi "caption" "% Rating"[764] where←4↑,"fmMortImp.fTwoDTab.edgmiIMPTBL3" ⎕wi "∆where"[765] x←0.5×⍴where←Win∆Calcwhere where-0 ¯3 0,10+¯1↑⎕wi "extent"[766] ⎕wi "∆where" ((x,2)⍴where)[767] ⎕wi "where" (("fmMortImp.fTwoDTab" ⎕wi "size") Win∆Resize ⎕wi "∆where")[768] [769] ⎕wself←"fmMortImp.fTwoDTab.edgmiIMPORIG" ⎕wi "New" "Edit"[770] Fieldlist←Fieldlist OVER "fmMortImp.fTwoDTab.edgmiIMPORIG"[771] Fieldcontrol←Fieldcontrol OVER "Edit"[772] ⎕wi "∆name" "gmiIMPORIG"[773] ⎕wi "∆type" "Num"[774] ⎕wi "∆mandatory" 1[775] ⎕wi "∆valid" ('Int' 'Scalar' '+')[776] ⎕wi "∆helpid" 4227[777] ⎕wi "tooltip" "Specify the Origin Year of Mortality Improvement Table"[778] ⎕wi "limit" 4[779] ⎕wi "∆where" (2 2⍴0.7 0 0.4 0)[780] ⎕wi "where" (("fmMortImp.fTwoDTab" ⎕wi "size") Win∆Resize (2 2⍴0.7 0 0.4 0))[781] ⎕wi "∆range" "1980 2100"[782] ⎕wi "onChange" "0 0⍴(⊂⎕wi 'name') Mort_Improvement 'Change' "[783] ⎕wi "onExit" "⍎(0∊⍴,⎕wres←0 INPUT∆CHECK 'fmMortImp.fTwoDTab.edgmiIMPORIG')/'0 0⍴(⊂⎕wi ''name'') Mort_Improvement ''Change'' ' "[784] ⎕wi "onExitError" "Win∆ExitError ⎕warg"[785] ⎕wi "onKeyPress" "⎕wres←¯2×~⎕warg∊8 32 48 49 50 51 52 53 54 55 56 57"[786] ⎕wi "extent" (2+CharSize×1 5)[787] [788] ⎕wself←"fmMortImp.fTwoDTab.lrgmiIMPORIG" ⎕wi "New" "Label"[789] ⎕wi "scale" 5[790] ⎕wi "extent" (↑⎕wi "Draw" ("?text" "CCYY"))[791] ⎕wi "caption" "CCYY"[792] where←4↑,"fmMortImp.fTwoDTab.edgmiIMPORIG" ⎕wi "∆where"[793] x←0.5×⍴where←Win∆Calcwhere where+0,3,0,10+¯1↑"fmMortImp.fTwoDTab.edgmiIMPORIG" ⎕wi "extent"[794] ⎕wi "∆where" ((x,2)⍴where)[795] ⎕wi "where" (("fmMortImp.fTwoDTab" ⎕wi "size") Win∆Resize ⎕wi "∆where")[796] [797] ⎕wself←"fmMortImp.fTwoDTab.llgmiIMPORIG" ⎕wi "New" "Label"[798] ⎕wi "scale" 5[799] ⎕wi "style" 2[800] ⎕wi "extent" (↑⎕wi "Draw" ("?text" "Base Year of Mortality Improvement Table"))[801] ⎕wi "caption" "Base Year of Mortality Improvement Table"[802] where←4↑,"fmMortImp.fTwoDTab.edgmiIMPORIG" ⎕wi "∆where"[803] x←0.5×⍴where←Win∆Calcwhere where-0 ¯3 0,10+¯1↑⎕wi "extent"[804] ⎕wi "∆where" ((x,2)⍴where)[805] ⎕wi "where" (("fmMortImp.fTwoDTab" ⎕wi "size") Win∆Resize ⎕wi "∆where")[806] [807] ⎕wself←"fmMortImp.lParmDesc" ⎕wi "New" "Label"[808] ⎕wi "scale" 5[809] ⎕wi "extent" (CharSize×¯2↑1,80)[810] ⎕wi "style" 32[811] ⎕wi "caption" " "[812] ⎕wi "∆where" (2 2⍴0.96 0 0.02 0)[813] ⎕wi "where" (("fmMortImp" ⎕wi "size") Win∆Resize (2 2⍴0.96 0 0.02 0))[814] [815] "fmMortImp" ⎕wi "∆multifile" ""[816] "fmMortImp" ⎕wi "∆singlefile" ""[817] "fmMortImp" ⎕wi "∆format" ""[818] "fmMortImp" ⎕wi "∆financial" 0[819] "fmMortImp" ⎕wi "∆relrules" 1[820] "fmMortImp" ⎕wi "∆parm" 0[821] "fmMortImp" ⎕wi "∆decr" 1[822] "fmMortImp" ⎕wi "∆file" 0[823] "fmMortImp" ⎕wi "∆codefile" CodeFile[824] "fmMortImp" ⎕wi "∆inputstype" "ClientFile"[825] "fmMortImp" ⎕wi "∆inputsentry" "Multi"[826] "fmMortImp" ⎕wi "∆savecn" (⍳0)[827] "fmMortImp" ⎕wi "∆savedesc" ""[828] list←list OVER "fmMortImp"[829] "fmMortImp" ⎕wi "∆fieldlist" Fieldlist[830] "fmMortImp" ⎕wi "∆fieldcontrol" Fieldcontrol[831] childlist←"fmSV" ⎕wi "∆childlist"[832] list←(⊃¯1↑childlist) OVER list[833] childlist[⍴childlist]←⊂list[834] "fmSV" ⎕wi "∆childlist" childlist[835] list←,⎕split list[836] 0 0⍴((∨/¨(⊂".mMort_Improvement")⍷¨list)/list) MultiWI "enabled" 1[837] :if 300<fnsize[838]     (fnsize fnsize ".") Win∆ProgressBar "MemberUpdate"[839]     Win∆ProgressBar "Hide"[840] :endif[841] "Init" OpenParameters "Mort_Improvement"[842] "fmMortImp.bnMort_ImprovementHelp" ⎕wi "visible" 1[843] "fmMortImp.bnMort_ImprovementQuit" ⎕wi "visible" 1[844] "fmMortImp.bnMort_ImprovementSave" ⎕wi "visible" 1[845] "fmMortImp.bnMort_ImprovementSaveAs" ⎕wi "visible" 1[846] "#" ⎕wi "focus" "fmMortImp.fMIDef.cbgmiMORTIMPR"[847] :if ~0∊⍴,Error←Win∆Initialise "Mort_Improvement"[848]     "Quit" EndModule Module[849]     "fmSV" ⎕wi "pointer" 0[850]     0 0⍴"fmMortImp" ⎕wi "Delete"[851]     :return[852] :endif[853] :if bar_open←commandbar^"Multi"≡"Multi"[854]     bar_open←0×"fmMortImp.mMort_ImprovementFile.m" Win∆CommandBar "SaveAsHelp"[855] :endif[856] "fmMortImp" ⎕wi "Paint"[857] "fmSV" ⎕wi "pointer" 11[858] "fmMortImp" ⎕wi "onWait" "0 0⍴Mort_Improvement 'Wait'"[859] 0 0⍴"fmMortImp" ⎕wi "Wait"[860] 0 0⍴"fmMortImp" ⎕wi "Delete"[861] "fmSV" ⎕wi "pointer" 0 ∇