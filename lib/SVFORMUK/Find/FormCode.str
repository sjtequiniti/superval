∇ Container←Form_Make;⎕wself;ControlName;childlist;list;Fieldlist;Fieldcontrol;FrameWidth;Caption;buttonsize;buttonwhere;where;size;alignment;Header;PickList;NameList;value;sortorder;SortList;MaxRow;MaxCol;Parent;level;node;no;nn;NN;x;fnsize;framelist;relTests[1] [2] Fieldlist←Fieldcontrol←list←0 0⍴""[3] "fmSV" ⎕wi "pointer" 13[4] buttonsize←25 65 ⋄ buttonwhere←¯5[5] FormName ⎕wi "caption" ((FormName ⎕wi "caption")," - Find Text")[6] "fmSV" ⎕wi "∆caption" (("fmSV" ⎕wi "∆caption"),⊂("fmSV" ⎕wi "caption"))[7] :if 300<fnsize←1↑⍴⎕cr "Form_Make"[8]     "Generating Form" Win∆ProgressBar "Open"[9]     ("Menu Items:" "Form Controls:") Win∆ProgressBar "SetLabels"[10]     (1 1 "Help About") Win∆ProgressBar "FileUpdate"[11] :endif[12] [13] Container←"∆Dialog"[14] [15] ⎕wself←"fmFind" ⎕wi "New" "Form" "Hide"[16] ⎕wi "caption" ("fmSV" ⎕wi "caption")[17] ⎕wi "scale" 5[18] ⎕wi "font" ("fmSV" ⎕wi "font")[19] ⎕wi "border" 2 32 64[20] ⎕wi "where" (Win∆CentrePos .30 .35×768 1024×1⌈CharSize÷13 6)[21] ⎕wi "limitwhere" (0.8×¯2↑⎕wi "where")[22] ⎕wi "tooltipwidth" 200[23] ⎕wi "onResize" "AutoResize"[24] ⎕wi "onClose" "ExitSystem ''"[25] ControlName←"fmFind"[26] relTests←0[27] 0 Menu_Make "fmSV"[28] 0 Menu_Make "fmFind"[29] "fmFind" Win∆CutCopyPaste "Build"[30] "fmFind" ⎕wi "∆helpid" 2041[31] list←list OVER "fmFind.bnFindHelp"[32] ⎕wself←"fmFind.bnFindHelp" ⎕wi "New" "Button"[33] ⎕wi "deferexit" 1[34] ⎕wi "extent" (size←1×buttonsize×1⌈CharSize÷13 6)[35] x←0.5×⍴where←Win∆Calcwhere 1,(¯10-size[1]),1,buttonwhere←buttonwhere-5+size[2][36] ⎕wi "∆where" ((x,2)⍴where)[37] ⎕wi "where" (("fmFind" ⎕wi "size") Win∆Resize ⎕wi "∆where")[38] ⎕wi "tooltip" "SuperVal Help"[39] ⎕wi "onClick" ("fmSV.mFindHelp.mContext"⎕wi "onClick")[40] ⎕wi "caption" "Help"[41] :if buttonimage[42]     ⎕wi "imagelist" "fmSV.iStandard"[43]     ⎕wi "imageindex" 12[44] :endif[45] ⎕wi "visible" ¯1[46] ⎕wi "onMouseDown" "∆HelpField←'#' ⎕wi 'focus' "[47] list←list OVER "fmFind.bnFindQuit"[48] ⎕wself←"fmFind.bnFindQuit" ⎕wi "New" "Button"[49] ⎕wi "style" 2[50] ⎕wi "deferexit" 1[51] ⎕wi "extent" (size←1×buttonsize×1⌈CharSize÷13 6)[52] x←0.5×⍴where←Win∆Calcwhere 1,(¯10-size[1]),1,buttonwhere←buttonwhere-5+size[2][53] ⎕wi "∆where" ((x,2)⍴where)[54] ⎕wi "where" (("fmFind" ⎕wi "size") Win∆Resize ⎕wi "∆where")[55] ⎕wi "tooltip" "Cancel and Return"[56] ⎕wi "onClick" ("fmSV.mFindFile.mQuit"⎕wi "onClick")[57] ⎕wi "caption" "Cancel"[58] ⎕wi "∆helpid" 3229[59] ⎕wi "order" .5[60] ⎕wi "visible" ¯1[61] list←list OVER "fmFind.bnFindSave"[62] ⎕wself←"fmFind.bnFindSave" ⎕wi "New" "Button"[63] ⎕wi "style" 1[64] ⎕wi "extent" (size←1×buttonsize×1⌈CharSize÷13 6)[65] x←0.5×⍴where←Win∆Calcwhere 1,(¯10-size[1]),1,buttonwhere←buttonwhere-5+size[2][66] ⎕wi "∆where" ((x,2)⍴where)[67] ⎕wi "where" (("fmFind" ⎕wi "size") Win∆Resize ⎕wi "∆where")[68] ⎕wi "tooltip" "Save Parameters"[69] ⎕wi "onClick" ("fmSV.mFindFile.mSave"⎕wi "onClick")[70] ⎕wi "caption" "OK"[71] ⎕wi "∆helpid" 3230[72] ⎕wi "order" .5[73] ⎕wi "visible" ¯1[74] [75] ⎕wself←"fmFind.edSearch" ⎕wi "New" "Edit"[76] Fieldlist←Fieldlist OVER "fmFind.edSearch"[77] Fieldcontrol←Fieldcontrol OVER "Edit"[78] ⎕wi "∆name" "Search"[79] ⎕wi "∆type" "Char"[80] ⎕wi "∆mandatory" 1[81] ⎕wi "∆helpid" 3231[82] ⎕wi "tooltip" "Specify the text that is to be found"[83] ⎕wi "∆where" (2 2⍴0.2 0 0.4 0)[84] ⎕wi "where" (("fmFind" ⎕wi "size") Win∆Resize (2 2⍴0.2 0 0.4 0))[85] ⎕wi "onExit" "⍎(0∊⍴,⎕wres←0 INPUT∆CHECK 'fmFind.edSearch')/'0 0⍴(⊂⎕wi ''name'') Find ''Change'' ' "[86] ⎕wi "onExitError" "Win∆ExitError ⎕warg"[87] ⎕wi "extent" (2+CharSize×1 21)[88] [89] ⎕wself←"fmFind.llSearch" ⎕wi "New" "Label"[90] ⎕wi "scale" 5[91] ⎕wi "style" 2[92] ⎕wi "extent" (↑⎕wi "Draw" ("?text" "Search Text"))[93] ⎕wi "caption" "Search Text"[94] where←4↑,"fmFind.edSearch" ⎕wi "∆where"[95] x←0.5×⍴where←Win∆Calcwhere where-0 ¯3 0,10+¯1↑⎕wi "extent"[96] ⎕wi "∆where" ((x,2)⍴where)[97] ⎕wi "where" (("fmFind" ⎕wi "size") Win∆Resize ⎕wi "∆where")[98] PickList←⍙POPUPSdict ReadDictFile "FindOpt"[99] :if 0∊⍴,Header←"" ⋄ Header←DLTB PickList[1;] ⋄ :endif[100] no←1↑⍴PickList←1 0↓PickList[101] [102] ⎕wself←"fmFind.ffindopt" ⎕wi "New" "Frame"[103] ⎕wi "scale" 5[104] ⎕wi "∆where" (4 2⍴0.35 0 0.15 0 0.2 0 0.2 0)[105] ⎕wi "where" (("fmFind" ⎕wi "size") Win∆Resize (4 2⍴0.35 0 0.15 0 0.2 0 0.2 0))[106] ⎕wi "caption" "Find Text in"[107] ⎕wi "style" 0[108] ⎕wi "onResize" "AutoResize"[109] ⎕wi "tooltip" "Specify the area of the file to be searched"[110] [111] where←(0×1 0 1 0\0.35 0.15)+0 1 0 1\25,10×1[112] alignment←0 1 ⋄ FrameWidth←10+¯1↑Win∆TextSize Header[113] :for nn :in ⍳no[114]     ⎕wself←(Name←"fmFind.ffindopt.opfindopt_",⍕nn) ⎕wi "New" "Option"[115]     :if nn=1 ⋄ ⎕wi "∆lastoption" ("fmFind.ffindopt.opfindopt_",⍕no) ⋄ :endif[116]     size←0.5×⍴x←Win∆Calcwhere where[117]     x←(size,2)⍴x[118]     ⎕wi "∆where" x[119]     ⎕wi "where" (("fmFind.ffindopt" ⎕wi "size") Win∆Resize x)[120]     ⎕wi "caption" (Caption←DLTB PickList[nn;])[121]     FrameWidth←FrameWidth⌈10+¯1↑size←0 25+Win∆TextSize Caption[122]     where←where+0 1 0 1\alignment×10 20+size[123]     ⎕wi "extent" size[124]     ⎕wi "tooltip" "Specify the area of the file to be searched"[125]     ⎕wi "onClick" "(0 0⍴(⊂⎕wi 'name') Find 'Change' )"[126]     ⎕wi "∆helpid" 3232[127] :endfor[128] ⎕wi "∆type" "Option"[129] ⎕wi "∆mandatory" 1[130] ⎕wi "∆name" "findopt"[131] ⎕wi "∆options" "⍺Defined Fields⍺Entire File"[132] Fieldlist←Fieldlist OVER Name[133] Fieldcontrol←Fieldcontrol OVER "Option"[134] :if 1[135]     ⎕wself←"fmFind.ffindopt"[136]     size←0.5×⍴x←Win∆Calcwhere 0.35 0 0.15 0,0 1 0 1×where+(2/⌽alignment)×0 25 0,FrameWidth[137]     x←(size,2)⍴x[138]     ⎕wi "∆where" x[139]     ⎕wi "where" (("fmFind" ⎕wi "size") Win∆Resize x)[140] :endif[141] [142] ⎕wself←"fmFind.ckcaseopt" ⎕wi "New" "Check"[143] Fieldlist←Fieldlist OVER "fmFind.ckcaseopt"[144] Fieldcontrol←Fieldcontrol OVER "Check"[145] ⎕wi "∆name" "caseopt"[146] ⎕wi "∆type" "Check"[147] ⎕wi "∆helpid" 3233[148] ⎕wi "tooltip" "Indicate if both upper and lower case occurrences are to be found"[149] ⎕wi "style" 0[150] ⎕wi "caption" "Ignore Case"[151] ⎕wi "∆where" (2 2⍴0.7 0 0.15 0)[152] ⎕wi "where" (("fmFind" ⎕wi "size") Win∆Resize (2 2⍴0.7 0 0.15 0))[153] ⎕wi "extent" ((0 5×CharSize)+Win∆TextSize ⎕wi "caption")[154] ⎕wi "onClick" "(0 0⍴(⊂⎕wi 'name') Find 'Change' )"[155] [156] "fmFind" ⎕wi "∆multifile" ""[157] "fmFind" ⎕wi "∆singlefile" ""[158] "fmFind" ⎕wi "∆format" ""[159] "fmFind" ⎕wi "∆financial" 0[160] "fmFind" ⎕wi "∆relrules" 0[161] "fmFind" ⎕wi "∆parm" 0[162] "fmFind" ⎕wi "∆decr" 0[163] "fmFind" ⎕wi "∆file" 0[164] "fmFind" ⎕wi "∆codefile" CodeFile[165] "fmFind" ⎕wi "∆inputstype" "ClientFile"[166] "fmFind" ⎕wi "∆inputsentry" "Single"[167] "fmFind" ⎕wi "∆savecn" (⍳0)[168] "fmFind" ⎕wi "∆savedesc" ""[169] list←list OVER "fmFind"[170] "fmFind" ⎕wi "∆fieldlist" Fieldlist[171] "fmFind" ⎕wi "∆fieldcontrol" Fieldcontrol[172] childlist←"fmSV" ⎕wi "∆childlist"[173] list←(⊃¯1↑childlist) OVER list[174] childlist[⍴childlist]←⊂list[175] "fmSV" ⎕wi "∆childlist" childlist[176] list←,⎕split list[177] 0 0⍴((∨/¨(⊂".mFind")⍷¨list)/list) MultiWI "enabled" 1[178] :if 300<fnsize[179]     (fnsize fnsize ".") Win∆ProgressBar "MemberUpdate"[180]     Win∆ProgressBar "Hide"[181] :endif[182] "Init" OpenParameters "Find"[183] "fmFind.bnFindHelp" ⎕wi "visible" 1[184] "fmFind.bnFindQuit" ⎕wi "visible" 1[185] "fmFind.bnFindSave" ⎕wi "visible" 1[186] "#" ⎕wi "focus" "fmFind.edSearch"[187] :if ~0∊⍴,Error←Win∆Initialise "Find"[188]     "Quit" EndModule Module[189]     "fmSV" ⎕wi "pointer" 0[190]     0 0⍴"fmFind" ⎕wi "Delete"[191]     :return[192] :endif[193] :if bar_open←commandbar^"Multi"≡"Single"[194]     bar_open←0×"fmFind.mFindFile.m" Win∆CommandBar "OKHelp"[195] :endif[196] "fmFind" ⎕wi "Paint"[197] "fmSV" ⎕wi "pointer" 11[198] "fmFind" ⎕wi "onWait" "0 0⍴Find 'Wait' ⋄ 'fmFind' ⎕wi 'modified' 0"[199] 0 0⍴"fmFind" ⎕wi "Wait"[200] 0 0⍴"fmFind" ⎕wi "Delete"[201] "fmSV" ⎕wi "pointer" 0 ∇