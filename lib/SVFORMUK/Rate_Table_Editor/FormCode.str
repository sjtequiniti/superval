∇ Container←Form_Make;⎕wself;ControlName;childlist;list;Fieldlist;Fieldcontrol;FrameWidth;Caption;buttonsize;buttonwhere;where;size;alignment;Header;PickList;NameList;value;sortorder;SortList;MaxRow;MaxCol;Parent;level;node;no;nn;NN;x;fnsize;framelist;relTests[1] [2] Fieldlist←Fieldcontrol←list←0 0⍴""[3] "fmSV" ⎕wi "pointer" 13[4] buttonsize←25 65 ⋄ buttonwhere←¯5[5] FormName ⎕wi "caption" ((FormName ⎕wi "caption")," - Add or Edit Rate Tables")[6] "fmSV" ⎕wi "∆caption" (("fmSV" ⎕wi "∆caption"),⊂("fmSV" ⎕wi "caption"))[7] :if 300<fnsize←1↑⍴⎕cr "Form_Make"[8]     "Generating Form" Win∆ProgressBar "Open"[9]     ("Menu Items:" "Form Controls:") Win∆ProgressBar "SetLabels"[10]     (1 1 "Help About") Win∆ProgressBar "FileUpdate"[11] :endif[12] [13] Container←"∆Dialog"[14] [15] ⎕wself←"fmEditRates" ⎕wi "New" "Form" "Hide"[16] ⎕wi "caption" ("fmSV" ⎕wi "caption")[17] ⎕wi "scale" 5[18] ⎕wi "font" ("fmSV" ⎕wi "font")[19] ⎕wi "border" 2 32 64[20] ⎕wi "where" (Win∆CentrePos 1.5 1.5×768 1024×1⌈CharSize÷13 6)[21] ⎕wi "limitwhere" (0.8×¯2↑⎕wi "where")[22] ⎕wi "tooltipwidth" 200[23] ⎕wi "onResize" "AutoResize"[24] ⎕wi "onClose" "ExitSystem ''"[25] ControlName←"fmEditRates"[26] relTests←0[27] 0 Menu_Make "fmSV"[28] 0 Menu_Make "fmEditRates"[29] "fmEditRates" Win∆CutCopyPaste "Build"[30] "fmEditRates" ⎕wi "∆helpid" 2103[31] list←list OVER "fmEditRates.bnRate_Table_EditorHelp"[32] ⎕wself←"fmEditRates.bnRate_Table_EditorHelp" ⎕wi "New" "Button"[33] ⎕wi "deferexit" 1[34] ⎕wi "extent" (size←1×buttonsize×1⌈CharSize÷13 6)[35] x←0.5×⍴where←Win∆Calcwhere 1,(¯10-size[1]),1,buttonwhere←buttonwhere-5+size[2][36] ⎕wi "∆where" ((x,2)⍴where)[37] ⎕wi "where" (("fmEditRates" ⎕wi "size") Win∆Resize ⎕wi "∆where")[38] ⎕wi "tooltip" "SuperVal Help"[39] ⎕wi "onClick" ("fmSV.mRate_Table_EditorHelp.mContext"⎕wi "onClick")[40] ⎕wi "caption" "Help"[41] :if buttonimage[42]     ⎕wi "imagelist" "fmSV.iStandard"[43]     ⎕wi "imageindex" 12[44] :endif[45] ⎕wi "visible" ¯1[46] ⎕wi "onMouseDown" "∆HelpField←'#' ⎕wi 'focus' "[47] list←list OVER "fmEditRates.bnRate_Table_EditorQuit"[48] ⎕wself←"fmEditRates.bnRate_Table_EditorQuit" ⎕wi "New" "Button"[49] ⎕wi "style" 2[50] ⎕wi "deferexit" 1[51] ⎕wi "extent" (size←1×buttonsize×1⌈CharSize÷13 6)[52] x←0.5×⍴where←Win∆Calcwhere 1,(¯10-size[1]),1,buttonwhere←buttonwhere-5+size[2][53] ⎕wi "∆where" ((x,2)⍴where)[54] ⎕wi "where" (("fmEditRates" ⎕wi "size") Win∆Resize ⎕wi "∆where")[55] ⎕wi "tooltip" "Quit and Return"[56] ⎕wi "onClick" ("fmSV.mRate_Table_EditorFile.mQuit"⎕wi "onClick")[57] ⎕wi "caption" "Quit"[58] ⎕wi "∆helpid" 4007[59] ⎕wi "order" .5[60] ⎕wi "visible" ¯1[61] ControlName ⎕wi "∆quitbutton" "fmEditRates.bnRate_Table_EditorQuit"[62] list←list OVER "fmEditRates.bnRate_Table_EditorSave"[63] ⎕wself←"fmEditRates.bnRate_Table_EditorSave" ⎕wi "New" "Button"[64] ⎕wi "extent" (size←1×buttonsize×1⌈CharSize÷13 6)[65] x←0.5×⍴where←Win∆Calcwhere 1,(¯10-size[1]),1,buttonwhere←buttonwhere-5+size[2][66] ⎕wi "∆where" ((x,2)⍴where)[67] ⎕wi "where" (("fmEditRates" ⎕wi "size") Win∆Resize ⎕wi "∆where")[68] ⎕wi "tooltip" "Save Parameters"[69] ⎕wi "onClick" ("fmSV.mRate_Table_EditorFile.mSave"⎕wi "onClick")[70] ⎕wi "caption" "Save"[71] :if buttonimage[72]     ⎕wi "imagelist" "fmSV.iStandard"[73]     ⎕wi "imageindex" 9[74] :endif[75] ⎕wi "∆helpid" 4008[76] ⎕wi "enabled" 0[77] ⎕wi "order" .5[78] ⎕wi "visible" ¯1[79] "fmEditRates" ⎕wi "onModified" "('Rate_Table_Editor' 'fmEditRates.bnRate_Table_EditorSave') Win∆SaveEnabled (0≠⎕warg[1])"[80] [81] ⎕wself←"fmEditRates.cbTableNo" ⎕wi "New" "Combo"[82] Fieldlist←Fieldlist OVER "fmEditRates.cbTableNo"[83] Fieldcontrol←Fieldcontrol OVER "Combo"[84] ⎕wi "∆name" "TableNo"[85] ⎕wi "∆type" "Char"[86] ⎕wi "∆mandatory" 1[87] ⎕wi "∆helpid" 4009[88] ⎕wi "tooltip" "Specify the Table Code used to identify the Rate Table"[89] ⎕wi "style" 16 128 256 2[90] ⎕wi "∆where" (2 2⍴0.05 0 0.1 0)[91] ⎕wi "where" (("fmEditRates" ⎕wi "size") Win∆Resize (2 2⍴0.05 0 0.1 0))[92] PickList←GetDecrList 'Build'[93] ⎕wi "∆update" "GetDecrList 'Build'"[94] PickList←⊃m2n 1 0↓PickList[95] ⎕wi "list" PickList[96] ⎕wi "extent" (150,(¯10+6×¯1↑CharSize)+¯1↑Win∆TextSize ((0,⎕wi "limit")⌈⍴PickList)↑PickList)[97] ⎕wi "onClick" "0 0⍴(⊂⎕wi 'name') Rate_Table_Editor 'Change' "[98] [99] ⎕wself←"fmEditRates.llTableNo" ⎕wi "New" "Label"[100] ⎕wi "scale" 5[101] ⎕wi "style" 2[102] ⎕wi "extent" (↑⎕wi "Draw" ("?text" "Table Code"))[103] ⎕wi "caption" "Table Code"[104] where←4↑,"fmEditRates.cbTableNo" ⎕wi "∆where"[105] x←0.5×⍴where←Win∆Calcwhere where-0 ¯3 0,10+¯1↑⎕wi "extent"[106] ⎕wi "∆where" ((x,2)⍴where)[107] ⎕wi "where" (("fmEditRates" ⎕wi "size") Win∆Resize ⎕wi "∆where")[108] [109] ⎕wself←"fmEditRates.edTableDesc" ⎕wi "New" "Edit"[110] Fieldlist←Fieldlist OVER "fmEditRates.edTableDesc"[111] Fieldcontrol←Fieldcontrol OVER "Edit"[112] ⎕wi "∆name" "TableDesc"[113] ⎕wi "∆type" "Char"[114] ⎕wi "∆mandatory" 1[115] ⎕wi "∆helpid" 4010[116] ⎕wi "tooltip" "Specify a Description of the Rate Table"[117] ⎕wi "∆where" (2 2⍴0.05 0 0.3 0)[118] ⎕wi "where" (("fmEditRates" ⎕wi "size") Win∆Resize (2 2⍴0.05 0 0.3 0))[119] ⎕wi "onExit" "⍎(0∊⍴,⎕wres←0 INPUT∆CHECK 'fmEditRates.edTableDesc')/'0 0⍴(⊂⎕wi ''name'') Rate_Table_Editor ''Change'' ' "[120] ⎕wi "onExitError" "Win∆ExitError ⎕warg"[121] ⎕wi "extent" (2+CharSize×1 81)[122] [123] ⎕wself←"fmEditRates.llTableDesc" ⎕wi "New" "Label"[124] ⎕wi "scale" 5[125] ⎕wi "style" 2[126] ⎕wi "extent" (↑⎕wi "Draw" ("?text" "Table Description"))[127] ⎕wi "caption" "Table Description"[128] where←4↑,"fmEditRates.edTableDesc" ⎕wi "∆where"[129] x←0.5×⍴where←Win∆Calcwhere where-0 ¯3 0,10+¯1↑⎕wi "extent"[130] ⎕wi "∆where" ((x,2)⍴where)[131] ⎕wi "where" (("fmEditRates" ⎕wi "size") Win∆Resize ⎕wi "∆where")[132] [133] ⎕wself←"fmEditRates.ckColEdit" ⎕wi "New" "Check"[134] Fieldlist←Fieldlist OVER "fmEditRates.ckColEdit"[135] Fieldcontrol←Fieldcontrol OVER "Check"[136] ⎕wi "∆name" "ColEdit"[137] ⎕wi "∆type" "Check"[138] ⎕wi "visible" (¯1+2×0)[139] ⎕wi "∆helpid" 4011[140] ⎕wi "tooltip" "Indicate if you want to Edit one-dimensional Rate Tables in a Column format"[141] ⎕wi "style" 0[142] ⎕wi "caption" "Edit 1D Rate Tables in a Column format"[143] ⎕wi "∆where" (2 2⍴0.05 0 0.8 0)[144] ⎕wi "where" (("fmEditRates" ⎕wi "size") Win∆Resize (2 2⍴0.05 0 0.8 0))[145] ⎕wi "extent" ((0 5×CharSize)+Win∆TextSize ⎕wi "caption")[146] ⎕wi "onClick" "(0 0⍴(⊂⎕wi 'name') Rate_Table_Editor 'Change' )"[147] [148] ⎕wself←"fmEditRates.ckReplaceTab" ⎕wi "New" "Check"[149] Fieldlist←Fieldlist OVER "fmEditRates.ckReplaceTab"[150] Fieldcontrol←Fieldcontrol OVER "Check"[151] ⎕wi "∆name" "ReplaceTab"[152] ⎕wi "∆type" "Check"[153] ⎕wi "visible" (¯1+2×0)[154] ⎕wi "∆helpid" 4012[155] ⎕wi "tooltip" "Indicate if existing Rate Table is to be replaced by this Rate Table"[156] ⎕wi "style" 0[157] ⎕wi "caption" "Replace Original Rate Table with New Rate Table"[158] ⎕wi "∆where" (2 2⍴0.1 0 0.1 0)[159] ⎕wi "where" (("fmEditRates" ⎕wi "size") Win∆Resize (2 2⍴0.1 0 0.1 0))[160] ⎕wi "extent" ((0 5×CharSize)+Win∆TextSize ⎕wi "caption")[161] ⎕wi "onClick" "(0 0⍴(⊂⎕wi 'name') Rate_Table_Editor 'Change' )"[162] [163] ⎕wself←"fmEditRates.fAgeRates" ⎕wi "New" "Frame"[164] ⎕wi "scale" 5[165] ⎕wi "visible" (¯1+2×0)[166] ⎕wi "∆where" (4 2⍴0.12 0 0 0 0.8 0 1 0)[167] ⎕wi "where" (("fmEditRates" ⎕wi "size") Win∆Resize (4 2⍴0.12 0 0 0 0.8 0 1 0))[168] ⎕wi "caption" "Age Related Rates"[169] ⎕wi "style" 0[170] ⎕wi "onResize" "AutoResize"[171] ⎕wself←"fmEditRates.fAgeRates.ssAgeRates" ⎕wi "New" "{13E51003-A52B-11D0-86DA-00608CB9FBFB}6D5ECD55-86B8-11d0-95AD-0020AF1E9EB2"[172] ⎕wi "∆where" (4 2⍴0 15 0 10 0.999 ¯25 1 ¯20)[173] ⎕wi "where" (("fmEditRates.fAgeRates" ⎕wi "size") Win∆Resize (4 2⍴0 15 0 10 0.999 ¯25 1 ¯20))[174] Fieldlist←Fieldlist OVER "fmEditRates.fAgeRates.ssAgeRates"[175] Fieldcontrol←Fieldcontrol OVER "F1SS"[176] Win∆F1SSDefaults 0[177] ⎕wi "MaxRow" (MaxRow←1)[178] ⎕wi "MaxCol" (MaxCol←1)[179] ⎕wi "xDoStartEdit" 1[180] ⎕wi "xDoEndEdit" 1[181] ⎕wi "xDoCancelEdit" 1[182] ⎕wi "onClick" "Win∆F1SSClick 'fmEditRates.fAgeRates.ssAgeRates'"[183] ⎕wi "onXStartEdit" "⎕wi 'AllowArrows' 0"[184] NameList←0 0⍴" "[185] ⎕wi "MaxCol" (MaxCol←MaxCol⌈1)[186] ⎕wi "ColText" 1 (("/⍺/",⎕tcnl,⎕tclf) TEXTREPL "Age")[187] ⎕wi "XSetRowHeight" 1 1 255 1[188] NameList←NameList OVER "EditAges[;]"[189] ⎕wi "MaxCol" (MaxCol←MaxCol⌈2)[190] ⎕wi "ColText" 2 (("/⍺/",⎕tcnl,⎕tclf) TEXTREPL "Rate")[191] ⎕wi "XSetRowHeight" 1 1 255 1[192] NameList←NameList OVER "EditRATES[;]"[193] ⎕wi "xHdrHeight" (350⌈250×1)[194] ⎕wi "onXRClick" "0 Win∆F1SSRowMenu ('Rate_Table_Editor' 'fmEditRates.fAgeRates.ssAgeRates')"[195] ⎕wi "∆roworcol" "Col"[196] ⎕wi "∆name" NameList[197] ⎕wi "∆limit" (,3 11)[198] ⎕wi "∆mandatory" 0 0[199] ⎕wi "∆helpid" 4013 4013[200] ⎕wi "∆type" "⍺Num⍺Num"[201] ⎕wi "∆valid" "⍺''⍺''"[202] ⎕wi "∆range" "⍺⍺"[203] ⎕wi "onXEndEdit" "(⎕wi 'xRow') Win∆ValidF1SSCell ⎕wi 'xCol' ⋄ 0 0⍴⎕ex 'F1SSEvent' "[204] ⎕wi "onExit" "Win∆ValidF1SSExit 'Rate_Table_Editor'"[205] ⎕wi "onExitError" "MDISPLAY ⎕warg ⋄ ⎕wi 'XStartEdit' 0 1 1"[206] ⎕wi "onXCancelEdit" "⎕wi 'AllowArrows' 1 ⋄ ⎕wi 'SetColWidthAuto' 1 1 (⎕wi 'MaxRow') (⎕wi 'MaxCol') 0"[207] "fmEditRates.fAgeRates.ssAgeRates" Win∆F1SSProtectCells "Unlock"[208] ⎕wi "SetSelection" 1 1 1 1[209] [210] ⎕wself←"fmEditRates.fColAgeRates" ⎕wi "New" "Frame"[211] ⎕wi "scale" 5[212] ⎕wi "visible" (¯1+2×0)[213] ⎕wi "∆where" (4 2⍴0.12 0 0 0 0.8 0 1 0)[214] ⎕wi "where" (("fmEditRates" ⎕wi "size") Win∆Resize (4 2⍴0.12 0 0 0 0.8 0 1 0))[215] ⎕wi "caption" "Age Related Rates"[216] ⎕wi "style" 0[217] ⎕wi "onResize" "AutoResize"[218] ⎕wself←"fmEditRates.fColAgeRates.ssColAgeRates" ⎕wi "New" "{13E51003-A52B-11D0-86DA-00608CB9FBFB}6D5ECD55-86B8-11d0-95AD-0020AF1E9EB2"[219] ⎕wi "∆where" (4 2⍴0 15 0 10 0.999 ¯25 1 ¯20)[220] ⎕wi "where" (("fmEditRates.fColAgeRates" ⎕wi "size") Win∆Resize (4 2⍴0 15 0 10 0.999 ¯25 1 ¯20))[221] Fieldlist←Fieldlist OVER "fmEditRates.fColAgeRates.ssColAgeRates"[222] Fieldcontrol←Fieldcontrol OVER "F1SS"[223] Win∆F1SSDefaults 0[224] ⎕wi "MaxRow" (MaxRow←1)[225] ⎕wi "MaxCol" (MaxCol←1)[226] ⎕wi "xDoStartEdit" 1[227] ⎕wi "xDoEndEdit" 1[228] ⎕wi "xDoCancelEdit" 1[229] ⎕wi "onClick" "Win∆F1SSClick 'fmEditRates.fColAgeRates.ssColAgeRates'"[230] ⎕wi "onXStartEdit" "⎕wi 'AllowArrows' 0"[231] NameList←0 0⍴" "[232] ⎕wi "MaxCol" (MaxCol←MaxCol⌈1)[233] ⎕wi "ColText" 1 (("/⍺/",⎕tcnl,⎕tclf) TEXTREPL "Rate")[234] ⎕wi "XSetRowHeight" 1 1 255 1[235] NameList←NameList OVER "EditRATES[;]"[236] ⎕wi "xHdrHeight" (350⌈250×1)[237] ⎕wi "onXRClick" "0 Win∆F1SSRowMenu ('Rate_Table_Editor' 'fmEditRates.fColAgeRates.ssColAgeRates')"[238] ⎕wi "∆roworcol" "Col"[239] ⎕wi "∆name" NameList[240] ⎕wi "∆limit" (,11)[241] ⎕wi "∆mandatory" 0[242] ⎕wi "∆helpid" 4013[243] ⎕wi "∆type" "⍺Num"[244] ⎕wi "∆valid" "⍺''"[245] ⎕wi "∆range" "⍺"[246] ⎕wi "onXEndEdit" "(⎕wi 'xRow') Win∆ValidF1SSCell ⎕wi 'xCol' ⋄ 0 0⍴⎕ex 'F1SSEvent' "[247] ⎕wi "onExit" "Win∆ValidF1SSExit 'Rate_Table_Editor'"[248] ⎕wi "onExitError" "MDISPLAY ⎕warg ⋄ ⎕wi 'XStartEdit' 0 1 1"[249] ⎕wi "onXCancelEdit" "⎕wi 'AllowArrows' 1 ⋄ ⎕wi 'SetColWidthAuto' 1 1 (⎕wi 'MaxRow') (⎕wi 'MaxCol') 0"[250] "fmEditRates.fColAgeRates.ssColAgeRates" Win∆F1SSProtectCells "Unlock"[251] ⎕wi "SetSelection" 1 1 1 1[252] [253] ⎕wself←"fmEditRates.fDurnRates" ⎕wi "New" "Frame"[254] ⎕wi "scale" 5[255] ⎕wi "visible" (¯1+2×0)[256] ⎕wi "∆where" (4 2⍴0.12 0 0 0 0.8 0 1 0)[257] ⎕wi "where" (("fmEditRates" ⎕wi "size") Win∆Resize (4 2⍴0.12 0 0 0 0.8 0 1 0))[258] ⎕wi "caption" "Duration Related Rates"[259] ⎕wi "style" 0[260] ⎕wi "onResize" "AutoResize"[261] ⎕wself←"fmEditRates.fDurnRates.ssDurnRates" ⎕wi "New" "{13E51003-A52B-11D0-86DA-00608CB9FBFB}6D5ECD55-86B8-11d0-95AD-0020AF1E9EB2"[262] ⎕wi "∆where" (4 2⍴0 15 0 10 0.999 ¯25 1 ¯20)[263] ⎕wi "where" (("fmEditRates.fDurnRates" ⎕wi "size") Win∆Resize (4 2⍴0 15 0 10 0.999 ¯25 1 ¯20))[264] Fieldlist←Fieldlist OVER "fmEditRates.fDurnRates.ssDurnRates"[265] Fieldcontrol←Fieldcontrol OVER "F1SS"[266] Win∆F1SSDefaults 0[267] ⎕wi "MaxRow" (MaxRow←1)[268] ⎕wi "MaxCol" (MaxCol←1)[269] ⎕wi "xDoStartEdit" 1[270] ⎕wi "xDoEndEdit" 1[271] ⎕wi "xDoCancelEdit" 1[272] ⎕wi "onClick" "Win∆F1SSClick 'fmEditRates.fDurnRates.ssDurnRates'"[273] ⎕wi "onXStartEdit" "⎕wi 'AllowArrows' 0"[274] NameList←0 0⍴" "[275] ⎕wi "MaxCol" (MaxCol←MaxCol⌈1)[276] ⎕wi "ColText" 1 (("/⍺/",⎕tcnl,⎕tclf) TEXTREPL "Duration")[277] ⎕wi "XSetRowHeight" 1 1 255 1[278] NameList←NameList OVER "EditDurns[;]"[279] ⎕wi "MaxCol" (MaxCol←MaxCol⌈2)[280] ⎕wi "ColText" 2 (("/⍺/",⎕tcnl,⎕tclf) TEXTREPL "Rate")[281] ⎕wi "XSetRowHeight" 1 1 255 1[282] NameList←NameList OVER "EditRATES[;]"[283] ⎕wi "xHdrHeight" (350⌈250×1)[284] ⎕wi "onXRClick" "0 Win∆F1SSRowMenu ('Rate_Table_Editor' 'fmEditRates.fDurnRates.ssDurnRates')"[285] ⎕wi "∆roworcol" "Col"[286] ⎕wi "∆name" NameList[287] ⎕wi "∆limit" (,2 11)[288] ⎕wi "∆mandatory" 0 0[289] ⎕wi "∆helpid" 4013 4013[290] ⎕wi "∆type" "⍺Num⍺Num"[291] ⎕wi "∆valid" "⍺''⍺''"[292] ⎕wi "∆range" "⍺⍺"[293] ⎕wi "onXEndEdit" "(⎕wi 'xRow') Win∆ValidF1SSCell ⎕wi 'xCol' ⋄ 0 0⍴⎕ex 'F1SSEvent' "[294] ⎕wi "onExit" "Win∆ValidF1SSExit 'Rate_Table_Editor'"[295] ⎕wi "onExitError" "MDISPLAY ⎕warg ⋄ ⎕wi 'XStartEdit' 0 1 1"[296] ⎕wi "onXCancelEdit" "⎕wi 'AllowArrows' 1 ⋄ ⎕wi 'SetColWidthAuto' 1 1 (⎕wi 'MaxRow') (⎕wi 'MaxCol') 0"[297] "fmEditRates.fDurnRates.ssDurnRates" Win∆F1SSProtectCells "Unlock"[298] ⎕wi "SetSelection" 1 1 1 1[299] [300] ⎕wself←"fmEditRates.fColDurnRates" ⎕wi "New" "Frame"[301] ⎕wi "scale" 5[302] ⎕wi "visible" (¯1+2×0)[303] ⎕wi "∆where" (4 2⍴0.12 0 0 0 0.8 0 1 0)[304] ⎕wi "where" (("fmEditRates" ⎕wi "size") Win∆Resize (4 2⍴0.12 0 0 0 0.8 0 1 0))[305] ⎕wi "caption" "Duration Related Rates"[306] ⎕wi "style" 0[307] ⎕wi "onResize" "AutoResize"[308] ⎕wself←"fmEditRates.fColDurnRates.ssColDurnRates" ⎕wi "New" "{13E51003-A52B-11D0-86DA-00608CB9FBFB}6D5ECD55-86B8-11d0-95AD-0020AF1E9EB2"[309] ⎕wi "∆where" (4 2⍴0 15 0 10 0.999 ¯25 1 ¯20)[310] ⎕wi "where" (("fmEditRates.fColDurnRates" ⎕wi "size") Win∆Resize (4 2⍴0 15 0 10 0.999 ¯25 1 ¯20))[311] Fieldlist←Fieldlist OVER "fmEditRates.fColDurnRates.ssColDurnRates"[312] Fieldcontrol←Fieldcontrol OVER "F1SS"[313] Win∆F1SSDefaults 0[314] ⎕wi "MaxRow" (MaxRow←1)[315] ⎕wi "MaxCol" (MaxCol←1)[316] ⎕wi "xDoStartEdit" 1[317] ⎕wi "xDoEndEdit" 1[318] ⎕wi "xDoCancelEdit" 1[319] ⎕wi "onClick" "Win∆F1SSClick 'fmEditRates.fColDurnRates.ssColDurnRates'"[320] ⎕wi "onXStartEdit" "⎕wi 'AllowArrows' 0"[321] NameList←0 0⍴" "[322] ⎕wi "MaxCol" (MaxCol←MaxCol⌈1)[323] ⎕wi "ColText" 1 (("/⍺/",⎕tcnl,⎕tclf) TEXTREPL "Rate")[324] ⎕wi "XSetRowHeight" 1 1 255 1[325] NameList←NameList OVER "EditRATES[;]"[326] ⎕wi "xHdrHeight" (350⌈250×1)[327] ⎕wi "onXRClick" "0 Win∆F1SSRowMenu ('Rate_Table_Editor' 'fmEditRates.fColDurnRates.ssColDurnRates')"[328] ⎕wi "∆roworcol" "Col"[329] ⎕wi "∆name" NameList[330] ⎕wi "∆limit" (,11)[331] ⎕wi "∆mandatory" 0[332] ⎕wi "∆helpid" 4013[333] ⎕wi "∆type" "⍺Num"[334] ⎕wi "∆valid" "⍺''"[335] ⎕wi "∆range" "⍺"[336] ⎕wi "onXEndEdit" "(⎕wi 'xRow') Win∆ValidF1SSCell ⎕wi 'xCol' ⋄ 0 0⍴⎕ex 'F1SSEvent' "[337] ⎕wi "onExit" "Win∆ValidF1SSExit 'Rate_Table_Editor'"[338] ⎕wi "onExitError" "MDISPLAY ⎕warg ⋄ ⎕wi 'XStartEdit' 0 1 1"[339] ⎕wi "onXCancelEdit" "⎕wi 'AllowArrows' 1 ⋄ ⎕wi 'SetColWidthAuto' 1 1 (⎕wi 'MaxRow') (⎕wi 'MaxCol') 0"[340] "fmEditRates.fColDurnRates.ssColDurnRates" Win∆F1SSProtectCells "Unlock"[341] ⎕wi "SetSelection" 1 1 1 1[342] [343] ⎕wself←"fmEditRates.fTwoDRates" ⎕wi "New" "Frame"[344] ⎕wi "scale" 5[345] ⎕wi "visible" (¯1+2×0)[346] ⎕wi "∆where" (4 2⍴0.12 0 0 0 0.8 0 1 0)[347] ⎕wi "where" (("fmEditRates" ⎕wi "size") Win∆Resize (4 2⍴0.12 0 0 0 0.8 0 1 0))[348] ⎕wi "caption" "2 Dimensional Rates"[349] ⎕wi "style" 0[350] ⎕wi "onResize" "AutoResize"[351] ⎕wself←"fmEditRates.fTwoDRates.ssTwoDRates" ⎕wi "New" "{13E51003-A52B-11D0-86DA-00608CB9FBFB}6D5ECD55-86B8-11d0-95AD-0020AF1E9EB2"[352] ⎕wi "∆where" (4 2⍴0 15 0 10 0.999 ¯25 1 ¯20)[353] ⎕wi "where" (("fmEditRates.fTwoDRates" ⎕wi "size") Win∆Resize (4 2⍴0 15 0 10 0.999 ¯25 1 ¯20))[354] Fieldlist←Fieldlist OVER "fmEditRates.fTwoDRates.ssTwoDRates"[355] Fieldcontrol←Fieldcontrol OVER "F1SS"[356] Win∆F1SSDefaults 0[357] ⎕wi "MaxRow" (MaxRow←1)[358] ⎕wi "MaxCol" (MaxCol←1)[359] ⎕wi "xDoStartEdit" 1[360] ⎕wi "xDoEndEdit" 1[361] ⎕wi "xDoCancelEdit" 1[362] ⎕wi "onClick" "Win∆F1SSClick 'fmEditRates.fTwoDRates.ssTwoDRates'"[363] ⎕wi "onXStartEdit" "⎕wi 'AllowArrows' 0"[364] NameList←0 0⍴" "[365] ⎕wi "MaxCol" (MaxCol←MaxCol⌈1)[366] ⎕wi "ColText" 1 (("/⍺/",⎕tcnl,⎕tclf) TEXTREPL "Rate")[367] ⎕wi "XSetRowHeight" 1 1 255 1[368] NameList←NameList OVER "EditRATES[;]"[369] ⎕wi "xHdrHeight" (350⌈250×1)[370] ⎕wi "onXRClick" "0 Win∆F1SSRowMenu ('Rate_Table_Editor' 'fmEditRates.fTwoDRates.ssTwoDRates')"[371] ⎕wi "∆roworcol" "Col"[372] ⎕wi "∆name" NameList[373] ⎕wi "∆limit" (,11)[374] ⎕wi "∆mandatory" 0[375] ⎕wi "∆helpid" 4013[376] ⎕wi "∆type" "⍺Num"[377] ⎕wi "∆valid" "⍺''"[378] ⎕wi "∆range" "⍺"[379] ⎕wi "onXEndEdit" "(⎕wi 'xRow') Win∆ValidF1SSCell ⎕wi 'xCol' ⋄ 0 0⍴⎕ex 'F1SSEvent' "[380] ⎕wi "onExit" "Win∆ValidF1SSExit 'Rate_Table_Editor'"[381] ⎕wi "onExitError" "MDISPLAY ⎕warg ⋄ ⎕wi 'XStartEdit' 0 1 1"[382] ⎕wi "onXCancelEdit" "⎕wi 'AllowArrows' 1 ⋄ ⎕wi 'SetColWidthAuto' 1 1 (⎕wi 'MaxRow') (⎕wi 'MaxCol') 0"[383] "fmEditRates.fTwoDRates.ssTwoDRates" Win∆F1SSProtectCells "Unlock"[384] ⎕wi "SetSelection" 1 1 1 1[385] list←list OVER "fmEditRates.bnRate_Table_EditorImportLib"[386] ⎕wself←"fmEditRates.bnRate_Table_EditorImportLib" ⎕wi "New" "Button"[387] ⎕wi "deferexit" 1[388] ⎕wi "extent" (size←1.4 1×buttonsize×1⌈CharSize÷13 6)[389] x←0.5×⍴where←Win∆Calcwhere 1,(¯10-size[1]),1,buttonwhere←buttonwhere-5+size[2][390] ⎕wi "∆where" ((x,2)⍴where)[391] ⎕wi "where" (("fmEditRates" ⎕wi "size") Win∆Resize ⎕wi "∆where")[392] ⎕wi "tooltip" "Import Rate Tables from File in Library Folder"[393] ⎕wi "onClick" ("fmSV.mRate_Table_EditorEdit.mImport.mLib"⎕wi "onClick")[394] ⎕wi "∆helpid" 4014[395] ⎕wi "caption" (("⍺",⎕tcnl) char_replace "Import Rates⍺(Library)")[396] :if buttonimage[397]     ⎕wi "imagelist" "fmSV.iStandard"[398]     ⎕wi "imageindex" 34[399] :endif[400] list←list OVER "fmEditRates.bnRate_Table_EditorImportInp"[401] ⎕wself←"fmEditRates.bnRate_Table_EditorImportInp" ⎕wi "New" "Button"[402] ⎕wi "deferexit" 1[403] ⎕wi "extent" (size←1.4 1×buttonsize×1⌈CharSize÷13 6)[404] x←0.5×⍴where←Win∆Calcwhere 1,(¯10-size[1]),1,buttonwhere←buttonwhere-5+size[2][405] ⎕wi "∆where" ((x,2)⍴where)[406] ⎕wi "where" (("fmEditRates" ⎕wi "size") Win∆Resize ⎕wi "∆where")[407] ⎕wi "tooltip" "Import Rate Tables from File in Scheme Folder"[408] ⎕wi "onClick" ("fmSV.mRate_Table_EditorEdit.mImport.mInp"⎕wi "onClick")[409] ⎕wi "∆helpid" 4015[410] ⎕wi "caption" (("⍺",⎕tcnl) char_replace "Import Rates⍺(Scheme)")[411] list←list OVER "fmEditRates.bnRate_Table_EditorInsert"[412] ⎕wself←"fmEditRates.bnRate_Table_EditorInsert" ⎕wi "New" "Button"[413] ⎕wi "deferexit" 1[414] ⎕wi "extent" (size←1.4 1×buttonsize×1⌈CharSize÷13 6)[415] x←0.5×⍴where←Win∆Calcwhere 1,(¯10-size[1]),1,buttonwhere←buttonwhere-5+size[2][416] ⎕wi "∆where" ((x,2)⍴where)[417] ⎕wi "where" (("fmEditRates" ⎕wi "size") Win∆Resize ⎕wi "∆where")[418] ⎕wi "tooltip" "Insert Rates into Table"[419] ⎕wi "onClick" ("fmSV.mRate_Table_EditorEdit.mInsert"⎕wi "onClick")[420] ⎕wi "∆helpid" 4016[421] ⎕wi "caption" (("⍺",⎕tcnl) char_replace "Insert⍺Rates")[422] list←list OVER "fmEditRates.bnRate_Table_EditorDelete"[423] ⎕wself←"fmEditRates.bnRate_Table_EditorDelete" ⎕wi "New" "Button"[424] ⎕wi "deferexit" 1[425] ⎕wi "extent" (size←1.4 1×buttonsize×1⌈CharSize÷13 6)[426] x←0.5×⍴where←Win∆Calcwhere 1,(¯10-size[1]),1,buttonwhere←buttonwhere-5+size[2][427] ⎕wi "∆where" ((x,2)⍴where)[428] ⎕wi "where" (("fmEditRates" ⎕wi "size") Win∆Resize ⎕wi "∆where")[429] ⎕wi "tooltip" "Delete specified Rates from Table"[430] ⎕wi "onClick" ("fmSV.mRate_Table_EditorEdit.mDelete"⎕wi "onClick")[431] ⎕wi "∆helpid" 4017[432] ⎕wi "caption" (("⍺",⎕tcnl) char_replace "Delete⍺Rates")[433] :if buttonimage[434]     ⎕wi "imagelist" "fmSV.iStandard"[435]     ⎕wi "imageindex" 6[436] :endif[437] list←list OVER "fmEditRates.bnRate_Table_EditorAnnuities"[438] ⎕wself←"fmEditRates.bnRate_Table_EditorAnnuities" ⎕wi "New" "Button"[439] ⎕wi "enabled" (0)[440] ⎕wi "deferexit" 1[441] ⎕wi "extent" (size←1.4 1×buttonsize×1⌈CharSize÷13 6)[442] x←0.5×⍴where←Win∆Calcwhere 1,(¯10-size[1]),1,buttonwhere←buttonwhere-5+size[2][443] ⎕wi "∆where" ((x,2)⍴where)[444] ⎕wi "where" (("fmEditRates" ⎕wi "size") Win∆Resize ⎕wi "∆where")[445] ⎕wi "tooltip" "Calculate Annuity Factors"[446] ⎕wi "onClick" ("fmSV.mRate_Table_EditorEdit.mAnnuities"⎕wi "onClick")[447] ⎕wi "∆helpid" 4018[448] ⎕wi "caption" (("⍺",⎕tcnl) char_replace "Insert⍺Annuities")[449] list←list OVER "fmEditRates.bnRate_Table_EditorInterpolate"[450] ⎕wself←"fmEditRates.bnRate_Table_EditorInterpolate" ⎕wi "New" "Button"[451] ⎕wi "enabled" (0)[452] ⎕wi "deferexit" 1[453] ⎕wi "extent" (size←1.4 1×buttonsize×1⌈CharSize÷13 6)[454] x←0.5×⍴where←Win∆Calcwhere 1,(¯10-size[1]),1,buttonwhere←buttonwhere-5+size[2][455] ⎕wi "∆where" ((x,2)⍴where)[456] ⎕wi "where" (("fmEditRates" ⎕wi "size") Win∆Resize ⎕wi "∆where")[457] ⎕wi "tooltip" "De-Interpolate Rates to Create Exact Age Rates equivalent to mid-Year Rates"[458] ⎕wi "onClick" ("fmSV.mRate_Table_EditorEdit.mInterpolate"⎕wi "onClick")[459] ⎕wi "∆helpid" 4019[460] ⎕wi "caption" (("⍺",⎕tcnl) char_replace "De-Interpolate⍺Rates")[461] [462] "fmEditRates" ⎕wi "∆multifile" ""[463] "fmEditRates" ⎕wi "∆singlefile" ""[464] "fmEditRates" ⎕wi "∆format" ""[465] "fmEditRates" ⎕wi "∆financial" 0[466] "fmEditRates" ⎕wi "∆relrules" 0[467] "fmEditRates" ⎕wi "∆parm" 0[468] "fmEditRates" ⎕wi "∆decr" 0[469] "fmEditRates" ⎕wi "∆file" 0[470] "fmEditRates" ⎕wi "∆codefile" CodeFile[471] "fmEditRates" ⎕wi "∆inputstype" ""[472] "fmEditRates" ⎕wi "∆inputsentry" ""[473] "fmEditRates" ⎕wi "∆savecn" (⍳0)[474] "fmEditRates" ⎕wi "∆savedesc" ""[475] list←list OVER "fmEditRates"[476] "fmEditRates" ⎕wi "∆fieldlist" Fieldlist[477] "fmEditRates" ⎕wi "∆fieldcontrol" Fieldcontrol[478] childlist←"fmSV" ⎕wi "∆childlist"[479] list←(⊃¯1↑childlist) OVER list[480] childlist[⍴childlist]←⊂list[481] "fmSV" ⎕wi "∆childlist" childlist[482] list←,⎕split list[483] 0 0⍴((∨/¨(⊂".mRate_Table_Editor")⍷¨list)/list) MultiWI "enabled" 1[484] :if 300<fnsize[485]     (fnsize fnsize ".") Win∆ProgressBar "MemberUpdate"[486]     Win∆ProgressBar "Hide"[487] :endif[488] "Init" OpenParameters "Rate_Table_Editor"[489] "fmEditRates.bnRate_Table_EditorHelp" ⎕wi "visible" 1[490] "fmEditRates.bnRate_Table_EditorQuit" ⎕wi "visible" 1[491] "fmEditRates.bnRate_Table_EditorSave" ⎕wi "visible" 1[492] "#" ⎕wi "focus" "fmEditRates.cbTableNo"[493] :if ~0∊⍴,Error←Win∆Initialise "Rate_Table_Editor"[494]     "Quit" EndModule Module[495]     "fmSV" ⎕wi "pointer" 0[496]     0 0⍴"fmEditRates" ⎕wi "Delete"[497]     :return[498] :endif[499] :if bar_open←commandbar^"Multi"≡""[500]     bar_open←0×"fmEditRates.mRate_Table_EditorFile.m" Win∆CommandBar "SaveHelp"[501] :endif[502] "fmEditRates" ⎕wi "Paint"[503] "fmSV" ⎕wi "pointer" 11[504] "fmEditRates" ⎕wi "onWait" "0 0⍴Rate_Table_Editor 'Wait' ⋄ 'fmEditRates' ⎕wi 'modified' 0"[505] 0 0⍴"fmEditRates" ⎕wi "Wait"[506] 0 0⍴"fmEditRates" ⎕wi "Delete"[507] "fmSV" ⎕wi "pointer" 0 ∇