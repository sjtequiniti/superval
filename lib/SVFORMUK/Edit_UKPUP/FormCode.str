∇ Container←Form_Make;⎕wself;ControlName;childlist;list;Fieldlist;Fieldcontrol;FrameWidth;Caption;buttonsize;buttonwhere;where;size;alignment;Header;PickList;NameList;value;sortorder;SortList;MaxRow;MaxCol;Parent;level;node;no;nn;NN;x;fnsize;framelist;relTests[1] [2] Fieldlist←Fieldcontrol←list←0 0⍴""[3] "fmSV" ⎕wi "pointer" 13[4] buttonsize←25 65 ⋄ buttonwhere←¯5[5] FormName ⎕wi "caption" ((FormName ⎕wi "caption")," - Edit PUPs")[6] "fmSV" ⎕wi "∆caption" (("fmSV" ⎕wi "∆caption"),⊂("fmSV" ⎕wi "caption"))[7] :if 300<fnsize←1↑⍴⎕cr "Form_Make"[8]     "Generating Form" Win∆ProgressBar "Open"[9]     ("Menu Items:" "Form Controls:") Win∆ProgressBar "SetLabels"[10]     (1 1 "Help About") Win∆ProgressBar "FileUpdate"[11] :endif[12] [13] Container←"∆Dialog"[14] [15] ⎕wself←"fmEditUKPUP" ⎕wi "New" "Form" "Hide"[16] ⎕wi "caption" ("fmSV" ⎕wi "caption")[17] ⎕wi "scale" 5[18] ⎕wi "font" ("fmSV" ⎕wi "font")[19] ⎕wi "border" 2 32 64[20] ⎕wi "where" (Win∆CentrePos 1.2 1.2 ×768 1024×1⌈CharSize÷13 6)[21] ⎕wi "limitwhere" (0.8×¯2↑⎕wi "where")[22] ⎕wi "tooltipwidth" 200[23] ⎕wi "onResize" "AutoResize"[24] ⎕wi "onClose" "ExitSystem ''"[25] ControlName←"fmEditUKPUP"[26] relTests←2[27] 0 Menu_Make "fmSV"[28] 1 Menu_Make "fmEditUKPUP"[29] "fmEditUKPUP" Win∆CutCopyPaste "Build"[30] "fmEditUKPUP" ⎕wi "∆helpid" 2226[31] list←list OVER "fmEditUKPUP.bnEdit_UKPUPHelp"[32] ⎕wself←"fmEditUKPUP.bnEdit_UKPUPHelp" ⎕wi "New" "Button"[33] ⎕wi "deferexit" 1[34] ⎕wi "extent" (size←1×buttonsize×1⌈CharSize÷13 6)[35] x←0.5×⍴where←Win∆Calcwhere 1,(¯10-size[1]),1,buttonwhere←buttonwhere-5+size[2][36] ⎕wi "∆where" ((x,2)⍴where)[37] ⎕wi "where" (("fmEditUKPUP" ⎕wi "size") Win∆Resize ⎕wi "∆where")[38] ⎕wi "tooltip" "SuperVal Help"[39] ⎕wi "onClick" ("fmSV.mEdit_UKPUPHelp.mContext"⎕wi "onClick")[40] ⎕wi "caption" "Help"[41] :if buttonimage[42]     ⎕wi "imagelist" "fmSV.iStandard"[43]     ⎕wi "imageindex" 12[44] :endif[45] ⎕wi "visible" ¯1[46] ⎕wi "onMouseDown" "∆HelpField←'#' ⎕wi 'focus' "[47] list←list OVER "fmEditUKPUP.bnEdit_UKPUPQuit"[48] ⎕wself←"fmEditUKPUP.bnEdit_UKPUPQuit" ⎕wi "New" "Button"[49] ⎕wi "style" 2[50] ⎕wi "deferexit" 1[51] ⎕wi "extent" (size←1×buttonsize×1⌈CharSize÷13 6)[52] x←0.5×⍴where←Win∆Calcwhere 1,(¯10-size[1]),1,buttonwhere←buttonwhere-5+size[2][53] ⎕wi "∆where" ((x,2)⍴where)[54] ⎕wi "where" (("fmEditUKPUP" ⎕wi "size") Win∆Resize ⎕wi "∆where")[55] ⎕wi "tooltip" "Cancel and Return"[56] ⎕wi "onClick" ("fmSV.mEdit_UKPUPFile.mQuit"⎕wi "onClick")[57] ⎕wi "caption" "Cancel"[58] ⎕wi "∆helpid" 5134[59] ⎕wi "order" .5[60] ⎕wi "visible" ¯1[61] list←list OVER "fmEditUKPUP.bnEdit_UKPUPSave"[62] ⎕wself←"fmEditUKPUP.bnEdit_UKPUPSave" ⎕wi "New" "Button"[63] ⎕wi "style" 1[64] ⎕wi "extent" (size←1×buttonsize×1⌈CharSize÷13 6)[65] x←0.5×⍴where←Win∆Calcwhere 1,(¯10-size[1]),1,buttonwhere←buttonwhere-5+size[2][66] ⎕wi "∆where" ((x,2)⍴where)[67] ⎕wi "where" (("fmEditUKPUP" ⎕wi "size") Win∆Resize ⎕wi "∆where")[68] ⎕wi "tooltip" "Save Parameters"[69] ⎕wi "onClick" ("fmSV.mEdit_UKPUPFile.mSave"⎕wi "onClick")[70] ⎕wi "caption" "OK"[71] ⎕wi "∆helpid" 5135[72] ⎕wi "order" .5[73] ⎕wi "visible" ¯1[74] [75] ⎕wself←"fmEditUKPUP.cbFormattrick" ⎕wi "New" "Combo"[76] Fieldlist←Fieldlist OVER "fmEditUKPUP.cbFormattrick"[77] Fieldcontrol←Fieldcontrol OVER "Combo"[78] ⎕wi "∆name" "Formattrick"[79] ⎕wi "∆type" "Format"[80] ⎕wi "enabled" (0)[81] ⎕wi "∆valid" ('D')[82] ⎕wi "tooltip" "Select the Data Format of File"[83] ⎕wi "style" 16 128 256 2[84] ⎕wi "∆where" (2 2⍴1 0 1 0)[85] ⎕wi "where" (("fmEditUKPUP" ⎕wi "size") Win∆Resize (2 2⍴1 0 1 0))[86] PickList←Formats 'D'[87] ⎕wi "∆update" "Formats 'D'"[88] PickList←⊃m2n 1 0↓PickList[89] PickList←" " OVER PickList[90] ⎕wi "list" PickList[91] ⎕wi "extent" (150,(¯10+6×¯1↑CharSize)+¯1↑(50×CharSize)⌊Win∆TextSize PickList)[92] ⎕wi "onClick" "0 0⍴(⊂⎕wi 'name') Edit_UKPUP 'Change' ⋄ UpdateDataVars"[93] [94] ⎕wself←"fmEditUKPUP.edPUPDESC" ⎕wi "New" "Edit"[95] Fieldlist←Fieldlist OVER "fmEditUKPUP.edPUPDESC"[96] Fieldcontrol←Fieldcontrol OVER "Edit"[97] ⎕wi "∆name" "PUPDESC"[98] ⎕wi "∆type" "Char"[99] ⎕wi "∆helpid" 5136[100] ⎕wi "∆where" (2 2⍴0.02 0 0.45 0)[101] ⎕wi "where" (("fmEditUKPUP" ⎕wi "size") Win∆Resize (2 2⍴0.02 0 0.45 0))[102] ⎕wi "onChange" "0 0⍴(⊂⎕wi 'name') Edit_UKPUP 'Change' "[103] ⎕wi "onExit" "⍎(0∊⍴,⎕wres←0 INPUT∆CHECK 'fmEditUKPUP.edPUPDESC')/'0 0⍴(⊂⎕wi ''name'') Edit_UKPUP ''Change'' ' "[104] ⎕wi "onExitError" "Win∆ExitError ⎕warg"[105] ⎕wi "extent" (2+CharSize×1 31)[106] [107] ⎕wself←"fmEditUKPUP.llPUPDESC" ⎕wi "New" "Label"[108] ⎕wi "scale" 5[109] ⎕wi "style" 2[110] ⎕wi "extent" (↑⎕wi "Draw" ("?text" "PUP Description"))[111] ⎕wi "caption" "PUP Description"[112] where←4↑,"fmEditUKPUP.edPUPDESC" ⎕wi "∆where"[113] x←0.5×⍴where←Win∆Calcwhere where-0 ¯3 0,10+¯1↑⎕wi "extent"[114] ⎕wi "∆where" ((x,2)⍴where)[115] ⎕wi "where" (("fmEditUKPUP" ⎕wi "size") Win∆Resize ⎕wi "∆where")[116] [117] :if 300<fnsize[118]     ((1↑⎕lc) fnsize "FrameV - PUP Payment Parameters") Win∆ProgressBar "MemberUpdate"[119] :endif[120] [121] ⎕wself←"fmEditUKPUP.fPUPPay" ⎕wi "New" "Frame"[122] ⎕wi "scale" 5[123] ⎕wi "∆where" (4 2⍴0.06 0 0 0 0.38 0 1 0)[124] ⎕wi "where" (("fmEditUKPUP" ⎕wi "size") Win∆Resize (4 2⍴0.06 0 0 0 0.38 0 1 0))[125] ⎕wi "caption" "PUP Payment Parameters"[126] ⎕wi "style" 0[127] ⎕wi "onResize" "AutoResize"[128] [129] ⎕wself←"fmEditUKPUP.fPUPPay.cbpup" ⎕wi "New" "Combo"[130] Fieldlist←Fieldlist OVER "fmEditUKPUP.fPUPPay.cbpup"[131] Fieldcontrol←Fieldcontrol OVER "Combo"[132] ⎕wi "∆name" "pup"[133] ⎕wi "∆type" "Char"[134] ⎕wi "∆mandatory" 1[135] ⎕wi "∆valid" ('Scalar' '+')[136] ⎕wi "∆helpid" 5137[137] ⎕wi "style" 16 128 256 2[138] ⎕wi "∆where" (2 2⍴0.1 0 0.2 0)[139] ⎕wi "where" (("fmEditUKPUP.fPUPPay" ⎕wi "size") Win∆Resize (2 2⍴0.1 0 0.2 0))[140] PickList←GetVarNumList 'All'[141] ⎕wi "∆update" "GetVarNumList 'All'"[142] PickList←⊃m2n 1 0↓PickList[143] ⎕wi "list" PickList[144] ⎕wi "extent" (150,(¯10+6×¯1↑CharSize)+¯1↑Win∆TextSize ((0,⎕wi "limit")⌈⍴PickList)↑PickList)[145] ⎕wi "onClick" "0 0⍴(⊂⎕wi 'name') Edit_UKPUP 'Change' "[146] [147] ⎕wself←"fmEditUKPUP.fPUPPay.llpup" ⎕wi "New" "Label"[148] ⎕wi "scale" 5[149] ⎕wi "style" 2[150] ⎕wi "extent" (↑⎕wi "Draw" ("?text" "PUP Amount"))[151] ⎕wi "caption" "PUP Amount"[152] where←4↑,"fmEditUKPUP.fPUPPay.cbpup" ⎕wi "∆where"[153] x←0.5×⍴where←Win∆Calcwhere where-0 ¯3 0,10+¯1↑⎕wi "extent"[154] ⎕wi "∆where" ((x,2)⍴where)[155] ⎕wi "where" (("fmEditUKPUP.fPUPPay" ⎕wi "size") Win∆Resize ⎕wi "∆where")[156] [157] ⎕wself←"fmEditUKPUP.fPUPPay.cbindrev" ⎕wi "New" "Combo"[158] Fieldlist←Fieldlist OVER "fmEditUKPUP.fPUPPay.cbindrev"[159] Fieldcontrol←Fieldcontrol OVER "Combo"[160] ⎕wi "∆name" "indrev"[161] ⎕wi "∆type" "Char"[162] ⎕wi "∆helpid" 5138[163] ⎕wi "style" 16 128 256 2[164] ⎕wi "∆where" (2 2⍴0.25 0 0.2 0)[165] ⎕wi "where" (("fmEditUKPUP.fPUPPay" ⎕wi "size") Win∆Resize (2 2⍴0.25 0 0.2 0))[166] PickList←GetFinList 'Rev'[167] ⎕wi "∆update" "GetFinList 'Rev'"[168] PickList←⊃m2n 1 0↓PickList[169] PickList←" " OVER PickList[170] ⎕wi "list" PickList[171] ⎕wi "extent" (150,(¯10+6×¯1↑CharSize)+¯1↑Win∆TextSize ((0,⎕wi "limit")⌈⍴PickList)↑PickList)[172] ⎕wi "onClick" "(⎕wi 'self') Win∆FinLabelUpdate ⊃¨(⊂⍙FinAssdict) at¨'List' 'Label' ⋄ 0 0⍴(⊂⎕wi 'name') Edit_UKPUP 'Change' "[173] ⎕wi "∆rightlabel" "fmEditUKPUP.fPUPPay.lrindrev"[174] [175] ⎕wself←"fmEditUKPUP.fPUPPay.lrindrev" ⎕wi "New" "Label"[176] ⎕wi "scale" 5[177] ⎕wi "extent" (CharSize×¯2↑1,2 45)[178] ⎕wi "caption" " "[179] where←4↑,"fmEditUKPUP.fPUPPay.cbindrev" ⎕wi "∆where"[180] x←0.5×⍴where←Win∆Calcwhere where+0,¯3,0,10+¯1↑"fmEditUKPUP.fPUPPay.cbindrev" ⎕wi "extent"[181] ⎕wi "∆where" ((x,2)⍴where)[182] ⎕wi "where" (("fmEditUKPUP.fPUPPay" ⎕wi "size") Win∆Resize ⎕wi "∆where")[183] [184] ⎕wself←"fmEditUKPUP.fPUPPay.llindrev" ⎕wi "New" "Label"[185] ⎕wi "scale" 5[186] ⎕wi "style" 2[187] ⎕wi "extent" (↑⎕wi "Draw" ("?text" "Revaluation Rate Override"))[188] ⎕wi "caption" "Revaluation Rate Override"[189] where←4↑,"fmEditUKPUP.fPUPPay.cbindrev" ⎕wi "∆where"[190] x←0.5×⍴where←Win∆Calcwhere where-0 ¯3 0,10+¯1↑⎕wi "extent"[191] ⎕wi "∆where" ((x,2)⍴where)[192] ⎕wi "where" (("fmEditUKPUP.fPUPPay" ⎕wi "size") Win∆Resize ⎕wi "∆where")[193] [194] ⎕wself←"fmEditUKPUP.fPUPPay.cbindwarfrac" ⎕wi "New" "Combo"[195] Fieldlist←Fieldlist OVER "fmEditUKPUP.fPUPPay.cbindwarfrac"[196] Fieldcontrol←Fieldcontrol OVER "Combo"[197] ⎕wi "∆name" "indwarfrac"[198] ⎕wi "∆type" "Num"[199] ⎕wi "enabled" (ClntCode=3)[200] ⎕wi "∆valid" ('Scalar' '0+')[201] ⎕wi "∆helpid" 5139[202] ⎕wi "limit" 8[203] ⎕wi "onExit" "⍎(mt ,⎕wres←0 INPUT∆CHECK 'fmEditUKPUP.fPUPPay.cbindwarfrac')/'0 0⍴(⊂⎕wi ''name'') Edit_UKPUP ''Change'' ' "[204] ⎕wi "onExitError" "Win∆ExitError ⎕warg"[205] ⎕wi "onKeyPress" "⎕wres←¯2×~⎕warg∊46 8 32 48 49 50 51 52 53 54 55 56 57"[206] ⎕wi "style" 16 128 256 0[207] ⎕wi "∆where" (2 2⍴0.4 0 0.2 0)[208] ⎕wi "where" (("fmEditUKPUP.fPUPPay" ⎕wi "size") Win∆Resize (2 2⍴0.4 0 0.2 0))[209] PickList←GetVarNumList 'All'[210] ⎕wi "∆update" "GetVarNumList 'All'"[211] PickList←⊃m2n 1 0↓PickList[212] PickList←" " OVER PickList[213] ⎕wi "list" PickList[214] ⎕wi "extent" (150,(¯10+8×¯1↑CharSize)+¯1↑Win∆TextSize ((0,⎕wi "limit")⌈⍴PickList)↑PickList)[215] ⎕wi "onClick" "0 0⍴(⊂⎕wi 'name') Edit_UKPUP 'Change' "[216] ⎕wi "onChange" "Win∆ComboFudge ⎕wi 'self' ⋄ 0 0⍴(⊂⎕wi 'name') Edit_UKPUP 'Change' "[217] ⎕wi "∆rightlabel" "fmEditUKPUP.fPUPPay.lrindwarfrac"[218] [219] ⎕wself←"fmEditUKPUP.fPUPPay.lrindwarfrac" ⎕wi "New" "Label"[220] ⎕wi "scale" 5[221] ⎕wi "enabled" (ClntCode=3)[222] ⎕wi "extent" (↑⎕wi "Draw" ("?text" "%"))[223] ⎕wi "caption" "%"[224] where←4↑,"fmEditUKPUP.fPUPPay.cbindwarfrac" ⎕wi "∆where"[225] x←0.5×⍴where←Win∆Calcwhere where+0,3,0,10+¯1↑"fmEditUKPUP.fPUPPay.cbindwarfrac" ⎕wi "extent"[226] ⎕wi "∆where" ((x,2)⍴where)[227] ⎕wi "where" (("fmEditUKPUP.fPUPPay" ⎕wi "size") Win∆Resize ⎕wi "∆where")[228] [229] ⎕wself←"fmEditUKPUP.fPUPPay.llindwarfrac" ⎕wi "New" "Label"[230] ⎕wi "scale" 5[231] ⎕wi "style" 2[232] ⎕wi "enabled" (ClntCode=3)[233] ⎕wi "extent" (↑⎕wi "Draw" ("?text" "Spouses DAR Override"))[234] ⎕wi "caption" "Spouses DAR Override"[235] where←4↑,"fmEditUKPUP.fPUPPay.cbindwarfrac" ⎕wi "∆where"[236] x←0.5×⍴where←Win∆Calcwhere where-0 ¯3 0,10+¯1↑⎕wi "extent"[237] ⎕wi "∆where" ((x,2)⍴where)[238] ⎕wi "where" (("fmEditUKPUP.fPUPPay" ⎕wi "size") Win∆Resize ⎕wi "∆where")[239] [240] ⎕wself←"fmEditUKPUP.fPUPPay.cbinddbrfrac" ⎕wi "New" "Combo"[241] Fieldlist←Fieldlist OVER "fmEditUKPUP.fPUPPay.cbinddbrfrac"[242] Fieldcontrol←Fieldcontrol OVER "Combo"[243] ⎕wi "∆name" "inddbrfrac"[244] ⎕wi "∆type" "Num"[245] ⎕wi "enabled" (ClntCode=3)[246] ⎕wi "∆valid" ('Scalar' '0+')[247] ⎕wi "∆helpid" 5140[248] ⎕wi "limit" 8[249] ⎕wi "onExit" "⍎(mt ,⎕wres←0 INPUT∆CHECK 'fmEditUKPUP.fPUPPay.cbinddbrfrac')/'0 0⍴(⊂⎕wi ''name'') Edit_UKPUP ''Change'' ' "[250] ⎕wi "onExitError" "Win∆ExitError ⎕warg"[251] ⎕wi "onKeyPress" "⎕wres←¯2×~⎕warg∊46 8 32 48 49 50 51 52 53 54 55 56 57"[252] ⎕wi "style" 16 128 256 0[253] ⎕wi "∆where" (2 2⍴0.4 0 0.6 0)[254] ⎕wi "where" (("fmEditUKPUP.fPUPPay" ⎕wi "size") Win∆Resize (2 2⍴0.4 0 0.6 0))[255] PickList←GetVarNumList 'All'[256] ⎕wi "∆update" "GetVarNumList 'All'"[257] PickList←⊃m2n 1 0↓PickList[258] PickList←" " OVER PickList[259] ⎕wi "list" PickList[260] ⎕wi "extent" (150,(¯10+8×¯1↑CharSize)+¯1↑Win∆TextSize ((0,⎕wi "limit")⌈⍴PickList)↑PickList)[261] ⎕wi "onClick" "0 0⍴(⊂⎕wi 'name') Edit_UKPUP 'Change' "[262] ⎕wi "onChange" "Win∆ComboFudge ⎕wi 'self' ⋄ 0 0⍴(⊂⎕wi 'name') Edit_UKPUP 'Change' "[263] ⎕wi "∆rightlabel" "fmEditUKPUP.fPUPPay.lrinddbrfrac"[264] [265] ⎕wself←"fmEditUKPUP.fPUPPay.lrinddbrfrac" ⎕wi "New" "Label"[266] ⎕wi "scale" 5[267] ⎕wi "enabled" (ClntCode=3)[268] ⎕wi "extent" (↑⎕wi "Draw" ("?text" "%"))[269] ⎕wi "caption" "%"[270] where←4↑,"fmEditUKPUP.fPUPPay.cbinddbrfrac" ⎕wi "∆where"[271] x←0.5×⍴where←Win∆Calcwhere where+0,3,0,10+¯1↑"fmEditUKPUP.fPUPPay.cbinddbrfrac" ⎕wi "extent"[272] ⎕wi "∆where" ((x,2)⍴where)[273] ⎕wi "where" (("fmEditUKPUP.fPUPPay" ⎕wi "size") Win∆Resize ⎕wi "∆where")[274] [275] ⎕wself←"fmEditUKPUP.fPUPPay.llinddbrfrac" ⎕wi "New" "Label"[276] ⎕wi "scale" 5[277] ⎕wi "style" 2[278] ⎕wi "enabled" (ClntCode=3)[279] ⎕wi "extent" (↑⎕wi "Draw" ("?text" "Override % for DBR Pension"))[280] ⎕wi "caption" "Override % for DBR Pension"[281] where←4↑,"fmEditUKPUP.fPUPPay.cbinddbrfrac" ⎕wi "∆where"[282] x←0.5×⍴where←Win∆Calcwhere where-0 ¯3 0,10+¯1↑⎕wi "extent"[283] ⎕wi "∆where" ((x,2)⍴where)[284] ⎕wi "where" (("fmEditUKPUP.fPUPPay" ⎕wi "size") Win∆Resize ⎕wi "∆where")[285] [286] ⎕wself←"fmEditUKPUP.fPUPPay.cbindrevyrs" ⎕wi "New" "Combo"[287] Fieldlist←Fieldlist OVER "fmEditUKPUP.fPUPPay.cbindrevyrs"[288] Fieldcontrol←Fieldcontrol OVER "Combo"[289] ⎕wi "∆name" "indrevyrs"[290] ⎕wi "∆type" "Char"[291] ⎕wi "∆helpid" 5141[292] ⎕wi "style" 16 128 256 2[293] ⎕wi "∆where" (2 2⍴0.55 0 0.2 0)[294] ⎕wi "where" (("fmEditUKPUP.fPUPPay" ⎕wi "size") Win∆Resize (2 2⍴0.55 0 0.2 0))[295] PickList←⍙POPUPSdict ReadDictFile "YesNo"[296] PickList←⊃m2n 1 0↓PickList[297] PickList←" " OVER PickList[298] ⎕wi "list" PickList[299] ⎕wi "extent" (150,(¯10+6×¯1↑CharSize)+¯1↑Win∆TextSize ((0,⎕wi "limit")⌈⍴PickList)↑PickList)[300] ⎕wi "onClick" "0 0⍴(⊂⎕wi 'name') Edit_UKPUP 'Change' "[301] [302] ⎕wself←"fmEditUKPUP.fPUPPay.llindrevyrs" ⎕wi "New" "Label"[303] ⎕wi "scale" 5[304] ⎕wi "style" 2[305] ⎕wi "extent" (↑⎕wi "Draw" ("?text" "Complete Years Only Override"))[306] ⎕wi "caption" "Complete Years Only Override"[307] where←4↑,"fmEditUKPUP.fPUPPay.cbindrevyrs" ⎕wi "∆where"[308] x←0.5×⍴where←Win∆Calcwhere where-0 ¯3 0,10+¯1↑⎕wi "extent"[309] ⎕wi "∆where" ((x,2)⍴where)[310] ⎕wi "where" (("fmEditUKPUP.fPUPPay" ⎕wi "size") Win∆Resize ⎕wi "∆where")[311] [312] ⎕wself←"fmEditUKPUP.fPUPPay.cbindnrarnd" ⎕wi "New" "Combo"[313] Fieldlist←Fieldlist OVER "fmEditUKPUP.fPUPPay.cbindnrarnd"[314] Fieldcontrol←Fieldcontrol OVER "Combo"[315] ⎕wi "∆name" "indnrarnd"[316] ⎕wi "∆type" "Char"[317] ⎕wi "∆helpid" 5142[318] ⎕wi "tooltip" "Select the Service Rounding Override (if any)"[319] ⎕wi "style" 16 128 256 2[320] ⎕wi "∆where" (2 2⍴0.55 0 0.6 0)[321] ⎕wi "where" (("fmEditUKPUP.fPUPPay" ⎕wi "size") Win∆Resize (2 2⍴0.55 0 0.6 0))[322] PickList←⍙POPUPSdict ReadDictFile "ServRound"[323] PickList←⊃m2n 1 0↓PickList[324] PickList←" " OVER PickList[325] ⎕wi "list" PickList[326] ⎕wi "extent" (150,(¯10+6×¯1↑CharSize)+¯1↑Win∆TextSize ((0,⎕wi "limit")⌈⍴PickList)↑PickList)[327] ⎕wi "onClick" "0 0⍴(⊂⎕wi 'name') Edit_UKPUP 'Change' "[328] [329] ⎕wself←"fmEditUKPUP.fPUPPay.llindnrarnd" ⎕wi "New" "Label"[330] ⎕wi "scale" 5[331] ⎕wi "style" 2[332] ⎕wi "extent" (↑⎕wi "Draw" ("?text" "NRA Exits Rounding Override"))[333] ⎕wi "caption" "NRA Exits Rounding Override"[334] where←4↑,"fmEditUKPUP.fPUPPay.cbindnrarnd" ⎕wi "∆where"[335] x←0.5×⍴where←Win∆Calcwhere where-0 ¯3 0,10+¯1↑⎕wi "extent"[336] ⎕wi "∆where" ((x,2)⍴where)[337] ⎕wi "where" (("fmEditUKPUP.fPUPPay" ⎕wi "size") Win∆Resize ⎕wi "∆where")[338] [339] ⎕wself←"fmEditUKPUP.fPUPPay.cbindstart" ⎕wi "New" "Combo"[340] Fieldlist←Fieldlist OVER "fmEditUKPUP.fPUPPay.cbindstart"[341] Fieldcontrol←Fieldcontrol OVER "Combo"[342] ⎕wi "∆name" "indstart"[343] ⎕wi "∆type" "Date"[344] ⎕wi "∆helpid" 5143[345] ⎕wi "tooltip" "Select or specify the Start Date of the PUP"[346] ⎕wi "limit" 10[347] ⎕wi "onExit" "⍎(mt ,⎕wres←0 INPUT∆CHECK 'fmEditUKPUP.fPUPPay.cbindstart')/'0 0⍴(⊂⎕wi ''name'') Edit_UKPUP ''Change'' ' "[348] ⎕wi "onExitError" "Win∆ExitError ⎕warg"[349] ⎕wi "onKeyPress" "⎕wres←¯2×~⎕warg∊8 32 45 46 47 48 49 50 51 52 53 54 55 56 57"[350] ⎕wi "onKeyDown" "(⎕wi 'self') ChangesDates ⎕warg"[351] ⎕wi "style" 16 128 256 0[352] ⎕wi "∆where" (2 2⍴0.7 0 0.2 0)[353] ⎕wi "where" (("fmEditUKPUP.fPUPPay" ⎕wi "size") Win∆Resize (2 2⍴0.7 0 0.2 0))[354] PickList←GetAllDateList 0[355] ⎕wi "∆update" "GetAllDateList 0"[356] PickList←⊃m2n 1 0↓PickList[357] PickList←" " OVER PickList[358] ⎕wi "list" PickList[359] ⎕wi "extent" (150,(¯10+6×¯1↑CharSize)+¯1↑(50×CharSize)⌊Win∆TextSize PickList)[360] ⎕wi "onClick" "(⎕wi 'self') Win∆LabelUpdate ⊃¨(AbsDict for 'Type' 'Date' ) at 'Parameter' 'List' ⋄ 0 0⍴(⊂⎕wi 'name') Edit_UKPUP 'Change' "[361] ⎕wi "onChange" "Win∆ComboFudge ⎕wi 'self' ⋄ (⎕wi 'self') Win∆LabelUpdate ⊃¨(AbsDict for 'Type' 'Date' ) at 'Parameter' 'List' ⋄ 0 0⍴(⊂⎕wi 'name') Edit_UKPUP 'Change' "[362] ⎕wi "∆rightlabel" "fmEditUKPUP.fPUPPay.lrindstart"[363] [364] ⎕wself←"fmEditUKPUP.fPUPPay.lrindstart" ⎕wi "New" "Label"[365] ⎕wi "scale" 5[366] ⎕wi "extent" (CharSize×¯2↑1,10)[367] ⎕wi "style" 32[368] ⎕wi "caption" " "[369] where←4↑,"fmEditUKPUP.fPUPPay.cbindstart" ⎕wi "∆where"[370] x←0.5×⍴where←Win∆Calcwhere where+0,3,0,10+¯1↑"fmEditUKPUP.fPUPPay.cbindstart" ⎕wi "extent"[371] ⎕wi "∆where" ((x,2)⍴where)[372] ⎕wi "where" (("fmEditUKPUP.fPUPPay" ⎕wi "size") Win∆Resize ⎕wi "∆where")[373] [374] ⎕wself←"fmEditUKPUP.fPUPPay.llindstart" ⎕wi "New" "Label"[375] ⎕wi "scale" 5[376] ⎕wi "style" 2[377] ⎕wi "extent" (↑⎕wi "Draw" ("?text" "Start Date"))[378] ⎕wi "caption" "Start Date"[379] where←4↑,"fmEditUKPUP.fPUPPay.cbindstart" ⎕wi "∆where"[380] x←0.5×⍴where←Win∆Calcwhere where-0 ¯3 0,10+¯1↑⎕wi "extent"[381] ⎕wi "∆where" ((x,2)⍴where)[382] ⎕wi "where" (("fmEditUKPUP.fPUPPay" ⎕wi "size") Win∆Resize ⎕wi "∆where")[383] [384] ⎕wself←"fmEditUKPUP.fPUPPay.cbindfinish" ⎕wi "New" "Combo"[385] Fieldlist←Fieldlist OVER "fmEditUKPUP.fPUPPay.cbindfinish"[386] Fieldcontrol←Fieldcontrol OVER "Combo"[387] ⎕wi "∆name" "indfinish"[388] ⎕wi "∆type" "Date"[389] ⎕wi "∆helpid" 5144[390] ⎕wi "tooltip" "Select or specify the Finish Date of the PUP"[391] ⎕wi "limit" 10[392] ⎕wi "onExit" "⍎(mt ,⎕wres←0 INPUT∆CHECK 'fmEditUKPUP.fPUPPay.cbindfinish')/'0 0⍴(⊂⎕wi ''name'') Edit_UKPUP ''Change'' ' "[393] ⎕wi "onExitError" "Win∆ExitError ⎕warg"[394] ⎕wi "onKeyPress" "⎕wres←¯2×~⎕warg∊8 32 45 46 47 48 49 50 51 52 53 54 55 56 57"[395] ⎕wi "onKeyDown" "(⎕wi 'self') ChangesDates ⎕warg"[396] ⎕wi "style" 16 128 256 0[397] ⎕wi "∆where" (2 2⍴0.7 0 0.6 0)[398] ⎕wi "where" (("fmEditUKPUP.fPUPPay" ⎕wi "size") Win∆Resize (2 2⍴0.7 0 0.6 0))[399] PickList←GetAllDateList 0[400] ⎕wi "∆update" "GetAllDateList 0"[401] PickList←⊃m2n 1 0↓PickList[402] PickList←" " OVER PickList[403] ⎕wi "list" PickList[404] ⎕wi "extent" (150,(¯10+6×¯1↑CharSize)+¯1↑(50×CharSize)⌊Win∆TextSize PickList)[405] ⎕wi "onClick" "(⎕wi 'self') Win∆LabelUpdate ⊃¨(AbsDict for 'Type' 'Date' ) at 'Parameter' 'List' ⋄ 0 0⍴(⊂⎕wi 'name') Edit_UKPUP 'Change' "[406] ⎕wi "onChange" "Win∆ComboFudge ⎕wi 'self' ⋄ (⎕wi 'self') Win∆LabelUpdate ⊃¨(AbsDict for 'Type' 'Date' ) at 'Parameter' 'List' ⋄ 0 0⍴(⊂⎕wi 'name') Edit_UKPUP 'Change' "[407] ⎕wi "∆rightlabel" "fmEditUKPUP.fPUPPay.lrindfinish"[408] [409] ⎕wself←"fmEditUKPUP.fPUPPay.lrindfinish" ⎕wi "New" "Label"[410] ⎕wi "scale" 5[411] ⎕wi "extent" (CharSize×¯2↑1,10)[412] ⎕wi "style" 32[413] ⎕wi "caption" " "[414] where←4↑,"fmEditUKPUP.fPUPPay.cbindfinish" ⎕wi "∆where"[415] x←0.5×⍴where←Win∆Calcwhere where+0,3,0,10+¯1↑"fmEditUKPUP.fPUPPay.cbindfinish" ⎕wi "extent"[416] ⎕wi "∆where" ((x,2)⍴where)[417] ⎕wi "where" (("fmEditUKPUP.fPUPPay" ⎕wi "size") Win∆Resize ⎕wi "∆where")[418] [419] ⎕wself←"fmEditUKPUP.fPUPPay.llindfinish" ⎕wi "New" "Label"[420] ⎕wi "scale" 5[421] ⎕wi "style" 2[422] ⎕wi "extent" (↑⎕wi "Draw" ("?text" "Finish Date"))[423] ⎕wi "caption" "Finish Date"[424] where←4↑,"fmEditUKPUP.fPUPPay.cbindfinish" ⎕wi "∆where"[425] x←0.5×⍴where←Win∆Calcwhere where-0 ¯3 0,10+¯1↑⎕wi "extent"[426] ⎕wi "∆where" ((x,2)⍴where)[427] ⎕wi "where" (("fmEditUKPUP.fPUPPay" ⎕wi "size") Win∆Resize ⎕wi "∆where")[428] [429] ⎕wself←"fmEditUKPUP.fPUPPay.cbpupadj" ⎕wi "New" "Combo"[430] Fieldlist←Fieldlist OVER "fmEditUKPUP.fPUPPay.cbpupadj"[431] Fieldcontrol←Fieldcontrol OVER "Combo"[432] ⎕wi "∆name" "pupadj"[433] ⎕wi "∆type" "Num"[434] ⎕wi "∆mandatory" 1[435] ⎕wi "∆valid" ('Scalar')[436] ⎕wi "∆helpid" 5145[437] ⎕wi "limit" 8[438] ⎕wi "onExit" "⍎(mt ,⎕wres←0 INPUT∆CHECK 'fmEditUKPUP.fPUPPay.cbpupadj')/'0 0⍴(⊂⎕wi ''name'') Edit_UKPUP ''Change'' ' "[439] ⎕wi "onExitError" "Win∆ExitError ⎕warg"[440] ⎕wi "onKeyPress" "⎕wres←¯2×~⎕warg∊45 46 8 32 48 49 50 51 52 53 54 55 56 57"[441] ⎕wi "style" 16 128 256 0[442] ⎕wi "∆where" (2 2⍴0.85 0 0.2 0)[443] ⎕wi "where" (("fmEditUKPUP.fPUPPay" ⎕wi "size") Win∆Resize (2 2⍴0.85 0 0.2 0))[444] PickList←('Scalar') GetAbsNumList 'Fund'[445] ⎕wi "∆update" "('Scalar') GetAbsNumList 'Fund'"[446] PickList←⊃m2n 1 0↓PickList[447] PickList←" " OVER PickList[448] ⎕wi "list" PickList[449] ⎕wi "extent" (150,(¯10+6×¯1↑CharSize)+¯1↑(50×CharSize)⌊Win∆TextSize PickList)[450] ⎕wi "onClick" "(⎕wi 'self') Win∆LabelUpdate ⊃¨(AbsDict for 'Type' 'Number') at 'Parameter' 'List' ⋄ 0 0⍴(⊂⎕wi 'name') Edit_UKPUP 'Change' "[451] ⎕wi "onChange" "Win∆ComboFudge ⎕wi 'self' ⋄ (⎕wi 'self') Win∆LabelUpdate ⊃¨(AbsDict for 'Type' 'Number') at 'Parameter' 'List' ⋄ 0 0⍴(⊂⎕wi 'name') Edit_UKPUP 'Change' "[452] ⎕wi "∆rightlabel" "fmEditUKPUP.fPUPPay.lrpupadj"[453] [454] ⎕wself←"fmEditUKPUP.fPUPPay.lrpupadj" ⎕wi "New" "Label"[455] ⎕wi "scale" 5[456] ⎕wi "extent" (CharSize×¯2↑1,15)[457] ⎕wi "style" 32[458] ⎕wi "caption" " "[459] where←4↑,"fmEditUKPUP.fPUPPay.cbpupadj" ⎕wi "∆where"[460] x←0.5×⍴where←Win∆Calcwhere where+0,3,0,10+¯1↑"fmEditUKPUP.fPUPPay.cbpupadj" ⎕wi "extent"[461] ⎕wi "∆where" ((x,2)⍴where)[462] ⎕wi "where" (("fmEditUKPUP.fPUPPay" ⎕wi "size") Win∆Resize ⎕wi "∆where")[463] [464] ⎕wself←"fmEditUKPUP.fPUPPay.llpupadj" ⎕wi "New" "Label"[465] ⎕wi "scale" 5[466] ⎕wi "style" 2[467] ⎕wi "extent" (↑⎕wi "Draw" ("?text" "PUP Adjustment Factor"))[468] ⎕wi "caption" "PUP Adjustment Factor"[469] where←4↑,"fmEditUKPUP.fPUPPay.cbpupadj" ⎕wi "∆where"[470] x←0.5×⍴where←Win∆Calcwhere where-0 ¯3 0,10+¯1↑⎕wi "extent"[471] ⎕wi "∆where" ((x,2)⍴where)[472] ⎕wi "where" (("fmEditUKPUP.fPUPPay" ⎕wi "size") Win∆Resize ⎕wi "∆where")[473] [474] :if 300<fnsize[475]     ((1↑⎕lc) fnsize "FrameV - PUP Indicators") Win∆ProgressBar "MemberUpdate"[476] :endif[477] [478] ⎕wself←"fmEditUKPUP.fPUPInd" ⎕wi "New" "Frame"[479] ⎕wi "scale" 5[480] ⎕wi "∆where" (4 2⍴0.44 0 0 0 0.22 0 1 0)[481] ⎕wi "where" (("fmEditUKPUP" ⎕wi "size") Win∆Resize (4 2⍴0.44 0 0 0 0.22 0 1 0))[482] ⎕wi "caption" "PUP Indicators"[483] ⎕wi "style" 0[484] ⎕wi "onResize" "AutoResize"[485] [486] ⎕wself←"fmEditUKPUP.fPUPInd.ckcoo" ⎕wi "New" "Check"[487] Fieldlist←Fieldlist OVER "fmEditUKPUP.fPUPInd.ckcoo"[488] Fieldcontrol←Fieldcontrol OVER "Check"[489] ⎕wi "∆name" "coo"[490] ⎕wi "∆type" "Check"[491] ⎕wi "∆helpid" 5146[492] ⎕wi "style" 0[493] ⎕wi "caption" "Ignore for Cash"[494] ⎕wi "∆where" (2 2⍴0.2 0 0.2 0)[495] ⎕wi "where" (("fmEditUKPUP.fPUPInd" ⎕wi "size") Win∆Resize (2 2⍴0.2 0 0.2 0))[496] ⎕wi "extent" ((0 5×CharSize)+Win∆TextSize ⎕wi "caption")[497] ⎕wi "onClick" "(0 0⍴(⊂⎕wi 'name') Edit_UKPUP 'Change' )"[498] [499] ⎕wself←"fmEditUKPUP.fPUPInd.ckmoo" ⎕wi "New" "Check"[500] Fieldlist←Fieldlist OVER "fmEditUKPUP.fPUPInd.ckmoo"[501] Fieldcontrol←Fieldcontrol OVER "Check"[502] ⎕wi "∆name" "moo"[503] ⎕wi "∆type" "Check"[504] ⎕wi "∆helpid" 5147[505] ⎕wi "style" 0[506] ⎕wi "caption" "Ignore for DBR"[507] ⎕wi "∆where" (2 2⍴0.2 0 0.6 0)[508] ⎕wi "where" (("fmEditUKPUP.fPUPInd" ⎕wi "size") Win∆Resize (2 2⍴0.2 0 0.6 0))[509] ⎕wi "extent" ((0 5×CharSize)+Win∆TextSize ⎕wi "caption")[510] ⎕wi "onClick" "(0 0⍴(⊂⎕wi 'name') Edit_UKPUP 'Change' )"[511] [512] ⎕wself←"fmEditUKPUP.fPUPInd.cbbarbind" ⎕wi "New" "Combo"[513] Fieldlist←Fieldlist OVER "fmEditUKPUP.fPUPInd.cbbarbind"[514] Fieldcontrol←Fieldcontrol OVER "Combo"[515] ⎕wi "∆name" "barbind"[516] ⎕wi "∆type" "Char"[517] ⎕wi "∆mandatory" 1[518] ⎕wi "∆helpid" 5148[519] ⎕wi "style" 16 128 256 2[520] ⎕wi "∆where" (2 2⍴0.45 0 0.2 0)[521] ⎕wi "where" (("fmEditUKPUP.fPUPInd" ⎕wi "size") Win∆Resize (2 2⍴0.45 0 0.2 0))[522] PickList←⍙POPUPSdict ReadDictFile "ERF2NDF"[523] PickList←⊃m2n 1 0↓PickList[524] ⎕wi "list" PickList[525] ⎕wi "extent" (150,(¯10+6×¯1↑CharSize)+¯1↑Win∆TextSize ((0,⎕wi "limit")⌈⍴PickList)↑PickList)[526] ⎕wi "onClick" "0 0⍴(⊂⎕wi 'name') Edit_UKPUP 'Change' "[527] [528] ⎕wself←"fmEditUKPUP.fPUPInd.llbarbind" ⎕wi "New" "Label"[529] ⎕wi "scale" 5[530] ⎕wi "style" 2[531] ⎕wi "extent" (↑⎕wi "Draw" ("?text" "ERF Indicator"))[532] ⎕wi "caption" "ERF Indicator"[533] where←4↑,"fmEditUKPUP.fPUPInd.cbbarbind" ⎕wi "∆where"[534] x←0.5×⍴where←Win∆Calcwhere where-0 ¯3 0,10+¯1↑⎕wi "extent"[535] ⎕wi "∆where" ((x,2)⍴where)[536] ⎕wi "where" (("fmEditUKPUP.fPUPInd" ⎕wi "size") Win∆Resize ⎕wi "∆where")[537] [538] ⎕wself←"fmEditUKPUP.fPUPInd.cbdynind" ⎕wi "New" "Combo"[539] Fieldlist←Fieldlist OVER "fmEditUKPUP.fPUPInd.cbdynind"[540] Fieldcontrol←Fieldcontrol OVER "Combo"[541] ⎕wi "∆name" "dynind"[542] ⎕wi "∆type" "Char"[543] ⎕wi "∆mandatory" 1[544] ⎕wi "∆helpid" 5149[545] ⎕wi "tooltip" "Select the Escalation Rate"[546] ⎕wi "style" 16 128 256 2[547] ⎕wi "∆where" (2 2⍴0.45 0 0.6 0)[548] ⎕wi "where" (("fmEditUKPUP.fPUPInd" ⎕wi "size") Win∆Resize (2 2⍴0.45 0 0.6 0))[549] PickList←⍙POPUPSdict ReadDictFile "EscRate"[550] PickList←⊃m2n 1 0↓PickList[551] ⎕wi "list" PickList[552] ⎕wi "extent" (150,(¯10+6×¯1↑CharSize)+¯1↑Win∆TextSize ((0,⎕wi "limit")⌈⍴PickList)↑PickList)[553] ⎕wi "onClick" "0 0⍴(⊂⎕wi 'name') Edit_UKPUP 'Change' "[554] [555] ⎕wself←"fmEditUKPUP.fPUPInd.lldynind" ⎕wi "New" "Label"[556] ⎕wi "scale" 5[557] ⎕wi "style" 2[558] ⎕wi "extent" (↑⎕wi "Draw" ("?text" (("⍺",⎕tcnl) char_replace "Pension Increases⍺in Payment")))[559] ⎕wi "caption" (("⍺",⎕tcnl) char_replace "Pension Increases⍺in Payment")[560] where←4↑,"fmEditUKPUP.fPUPInd.cbdynind" ⎕wi "∆where"[561] size←1↑"fmEditUKPUP.fPUPInd.cbdynind" ⎕wi "extent"[562] size←¯3⌈0.5×(1↑⎕wi "extent")-size[563] x←0.5×⍴where←Win∆Calcwhere where-0,size,0,10+¯1↑⎕wi "extent"[564] ⎕wi "∆where" ((x,2)⍴where)[565] ⎕wi "where" (("fmEditUKPUP.fPUPInd" ⎕wi "size") Win∆Resize ⎕wi "∆where")[566] [567] ⎕wself←"fmEditUKPUP.fPUPInd.cbundind" ⎕wi "New" "Combo"[568] Fieldlist←Fieldlist OVER "fmEditUKPUP.fPUPInd.cbundind"[569] Fieldcontrol←Fieldcontrol OVER "Combo"[570] ⎕wi "∆name" "undind"[571] ⎕wi "∆type" "Char"[572] ⎕wi "∆mandatory" 1[573] ⎕wi "∆helpid" 5150[574] ⎕wi "style" 16 128 256 2[575] ⎕wi "∆where" (2 2⍴0.7 0 0.2 0)[576] ⎕wi "where" (("fmEditUKPUP.fPUPInd" ⎕wi "size") Win∆Resize (2 2⍴0.7 0 0.2 0))[577] PickList←⍙POPUPSdict ReadDictFile "Underpin"[578] PickList←⊃m2n 1 0↓PickList[579] ⎕wi "list" PickList[580] ⎕wi "extent" (150,(¯10+6×¯1↑CharSize)+¯1↑Win∆TextSize ((0,⎕wi "limit")⌈⍴PickList)↑PickList)[581] ⎕wi "onClick" "0 0⍴(⊂⎕wi 'name') Edit_UKPUP 'Change' "[582] [583] ⎕wself←"fmEditUKPUP.fPUPInd.llundind" ⎕wi "New" "Label"[584] ⎕wi "scale" 5[585] ⎕wi "style" 2[586] ⎕wi "extent" (↑⎕wi "Draw" ("?text" "Include In Underpin"))[587] ⎕wi "caption" "Include In Underpin"[588] where←4↑,"fmEditUKPUP.fPUPInd.cbundind" ⎕wi "∆where"[589] x←0.5×⍴where←Win∆Calcwhere where-0 ¯3 0,10+¯1↑⎕wi "extent"[590] ⎕wi "∆where" ((x,2)⍴where)[591] ⎕wi "where" (("fmEditUKPUP.fPUPInd" ⎕wi "size") Win∆Resize ⎕wi "∆where")[592] [593] :if 300<fnsize[594]     ((1↑⎕lc) fnsize "FrameV - PUP PPF Parameters") Win∆ProgressBar "MemberUpdate"[595] :endif[596] [597] ⎕wself←"fmEditUKPUP.fPPF" ⎕wi "New" "Frame"[598] ⎕wi "scale" 5[599] ⎕wi "∆where" (4 2⍴0.66 0 0 0 0.22 0 1 0)[600] ⎕wi "where" (("fmEditUKPUP" ⎕wi "size") Win∆Resize (4 2⍴0.66 0 0 0 0.22 0 1 0))[601] ⎕wi "caption" "PUP PPF Parameters"[602] ⎕wi "style" 0[603] ⎕wi "onResize" "AutoResize"[604] [605] ⎕wself←"fmEditUKPUP.fPPF.cbm_ppfnra" ⎕wi "New" "Combo"[606] Fieldlist←Fieldlist OVER "fmEditUKPUP.fPPF.cbm_ppfnra"[607] Fieldcontrol←Fieldcontrol OVER "Combo"[608] ⎕wi "∆name" "m_ppfnra"[609] ⎕wi "∆type" "Num"[610] ⎕wi "enabled" (ppfenabled)[611] ⎕wi "∆valid" ('Int' 'Scalar' '+')[612] ⎕wi "∆helpid" 5151[613] ⎕wi "∆range" "50 80"[614] ⎕wi "style" 16 128 256 2[615] ⎕wi "∆where" (2 2⍴0.4 0 0.2 0)[616] ⎕wi "where" (("fmEditUKPUP.fPPF" ⎕wi "size") Win∆Resize (2 2⍴0.4 0 0.2 0))[617] PickList←GetPPFNRA 'M'[618] ⎕wi "∆update" "GetPPFNRA 'M'"[619] PickList←⊃m2n 1 0↓PickList[620] PickList←" " OVER PickList[621] ⎕wi "list" PickList[622] ⎕wi "extent" (150,(¯10+6×¯1↑CharSize)+¯1↑Win∆TextSize ((0,⎕wi "limit")⌈⍴PickList)↑PickList)[623] ⎕wi "onClick" "0 0⍴(⊂⎕wi 'name') Edit_UKPUP 'Change' "[624] [625] ⎕wself←"fmEditUKPUP.fPPF.llm_ppfnra" ⎕wi "New" "Label"[626] ⎕wi "scale" 5[627] ⎕wi "style" 2[628] ⎕wi "enabled" (ppfenabled)[629] ⎕wi "extent" (↑⎕wi "Draw" ("?text" (("⍺",⎕tcnl) char_replace "Male PPF NRA⍺(Levy Valuations)")))[630] ⎕wi "caption" (("⍺",⎕tcnl) char_replace "Male PPF NRA⍺(Levy Valuations)")[631] where←4↑,"fmEditUKPUP.fPPF.cbm_ppfnra" ⎕wi "∆where"[632] size←1↑"fmEditUKPUP.fPPF.cbm_ppfnra" ⎕wi "extent"[633] size←¯3⌈0.5×(1↑⎕wi "extent")-size[634] x←0.5×⍴where←Win∆Calcwhere where-0,size,0,10+¯1↑⎕wi "extent"[635] ⎕wi "∆where" ((x,2)⍴where)[636] ⎕wi "where" (("fmEditUKPUP.fPPF" ⎕wi "size") Win∆Resize ⎕wi "∆where")[637] [638] ⎕wself←"fmEditUKPUP.fPPF.cbf_ppfnra" ⎕wi "New" "Combo"[639] Fieldlist←Fieldlist OVER "fmEditUKPUP.fPPF.cbf_ppfnra"[640] Fieldcontrol←Fieldcontrol OVER "Combo"[641] ⎕wi "∆name" "f_ppfnra"[642] ⎕wi "∆type" "Num"[643] ⎕wi "enabled" (ppfenabled)[644] ⎕wi "∆valid" ('Int' 'Scalar' '+')[645] ⎕wi "∆helpid" 5151[646] ⎕wi "∆range" "50 80"[647] ⎕wi "style" 16 128 256 2[648] ⎕wi "∆where" (2 2⍴0.4 0 0.45 0)[649] ⎕wi "where" (("fmEditUKPUP.fPPF" ⎕wi "size") Win∆Resize (2 2⍴0.4 0 0.45 0))[650] PickList←GetPPFNRA 'F'[651] ⎕wi "∆update" "GetPPFNRA 'F'"[652] PickList←⊃m2n 1 0↓PickList[653] PickList←" " OVER PickList[654] ⎕wi "list" PickList[655] ⎕wi "extent" (150,(¯10+6×¯1↑CharSize)+¯1↑Win∆TextSize ((0,⎕wi "limit")⌈⍴PickList)↑PickList)[656] ⎕wi "onClick" "0 0⍴(⊂⎕wi 'name') Edit_UKPUP 'Change' "[657] [658] ⎕wself←"fmEditUKPUP.fPPF.llf_ppfnra" ⎕wi "New" "Label"[659] ⎕wi "scale" 5[660] ⎕wi "style" 2[661] ⎕wi "enabled" (ppfenabled)[662] ⎕wi "extent" (↑⎕wi "Draw" ("?text" (("⍺",⎕tcnl) char_replace "Female PPF NRA⍺(Levy Valuations)")))[663] ⎕wi "caption" (("⍺",⎕tcnl) char_replace "Female PPF NRA⍺(Levy Valuations)")[664] where←4↑,"fmEditUKPUP.fPPF.cbf_ppfnra" ⎕wi "∆where"[665] size←1↑"fmEditUKPUP.fPPF.cbf_ppfnra" ⎕wi "extent"[666] size←¯3⌈0.5×(1↑⎕wi "extent")-size[667] x←0.5×⍴where←Win∆Calcwhere where-0,size,0,10+¯1↑⎕wi "extent"[668] ⎕wi "∆where" ((x,2)⍴where)[669] ⎕wi "where" (("fmEditUKPUP.fPPF" ⎕wi "size") Win∆Resize ⎕wi "∆where")[670] [671] ⎕wself←"fmEditUKPUP.fPPF.cbppfpayinc" ⎕wi "New" "Combo"[672] Fieldlist←Fieldlist OVER "fmEditUKPUP.fPPF.cbppfpayinc"[673] Fieldcontrol←Fieldcontrol OVER "Combo"[674] ⎕wi "∆name" "ppfpayinc"[675] ⎕wi "∆type" "Char"[676] ⎕wi "∆helpid" 5152[677] ⎕wi "tooltip" "Select the PPF Service
Period"[678] ⎕wi "style" 16 128 256 2[679] ⎕wi "∆where" (2 2⍴0.4 0 0.7 0)[680] ⎕wi "where" (("fmEditUKPUP.fPPF" ⎕wi "size") Win∆Resize (2 2⍴0.4 0 0.7 0))[681] PickList←⍙POPUPSdict ReadDictFile "ServPeriods"[682] PickList←⊃m2n 1 0↓PickList[683] PickList←" " OVER PickList[684] ⎕wi "list" PickList[685] ⎕wi "extent" (150,(¯10+6×¯1↑CharSize)+¯1↑Win∆TextSize ((0,⎕wi "limit")⌈⍴PickList)↑PickList)[686] ⎕wi "onClick" "0 0⍴(⊂⎕wi 'name') Edit_UKPUP 'Change' "[687] [688] ⎕wself←"fmEditUKPUP.fPPF.llppfpayinc" ⎕wi "New" "Label"[689] ⎕wi "scale" 5[690] ⎕wi "style" 2[691] ⎕wi "extent" (↑⎕wi "Draw" ("?text" (("⍺",⎕tcnl) char_replace "PPF Service⍺Period")))[692] ⎕wi "caption" (("⍺",⎕tcnl) char_replace "PPF Service⍺Period")[693] where←4↑,"fmEditUKPUP.fPPF.cbppfpayinc" ⎕wi "∆where"[694] size←1↑"fmEditUKPUP.fPPF.cbppfpayinc" ⎕wi "extent"[695] size←¯3⌈0.5×(1↑⎕wi "extent")-size[696] x←0.5×⍴where←Win∆Calcwhere where-0,size,0,10+¯1↑⎕wi "extent"[697] ⎕wi "∆where" ((x,2)⍴where)[698] ⎕wi "where" (("fmEditUKPUP.fPPF" ⎕wi "size") Win∆Resize ⎕wi "∆where")[699] [700] :if 300<fnsize[701]     ((1↑⎕lc) fnsize "Frame - Buttons") Win∆ProgressBar "MemberUpdate"[702] :endif[703] [704] ⎕wself←"fmEditUKPUP.fButtons" ⎕wi "New" "Frame"[705] ⎕wi "scale" 5[706] ⎕wi "∆where" (4 2⍴0.88 0 0 0 0.12 ¯45 1 0)[707] ⎕wi "where" (("fmEditUKPUP" ⎕wi "size") Win∆Resize (4 2⍴0.88 0 0 0 0.12 ¯45 1 0))[708] ⎕wi "style" 7[709] ⎕wi "onResize" "AutoResize"[710] list←list OVER "fmEditUKPUP.fButtons.bnEdit_UKPUPEditFin"[711] ⎕wself←"fmEditUKPUP.fButtons.bnEdit_UKPUPEditFin" ⎕wi "New" "Button"[712] ⎕wi "deferexit" 1[713] ⎕wi "extent" (size←1.4 1.384615385×buttonsize×1⌈CharSize÷13 6)[714] ⎕wi "∆where" (2 2⍴0.1 0 0.44 0)[715] ⎕wi "where" (("fmEditUKPUP.fButtons" ⎕wi "size") Win∆Resize (2 2⍴0.1 0 0.44 0))[716] ⎕wi "tooltip" "Edit/Add the Scheme Financial Assumptions"[717] ⎕wi "onClick" ("fmSV.mEdit_UKPUPFile.mEditFin"⎕wi "onClick")[718] ⎕wi "∆helpid" 5153[719] ⎕wi "caption" (("⍺",⎕tcnl) char_replace "Edit Scheme⍺Financials")[720] list←list OVER "fmEditUKPUP.fButtons.bnEdit_UKPUPPrevious"[721] ⎕wself←"fmEditUKPUP.fButtons.bnEdit_UKPUPPrevious" ⎕wi "New" "Button"[722] ⎕wi "enabled" (0 )[723] ⎕wi "extent" (size←1.28 1×buttonsize×1⌈CharSize÷13 6)[724] ⎕wi "∆where" (2 2⍴0.15 0 0.82 0)[725] ⎕wi "where" (("fmEditUKPUP.fButtons" ⎕wi "size") Win∆Resize (2 2⍴0.15 0 0.82 0))[726] ⎕wi "tooltip" "Move back to the Previous PUP"[727] ⎕wi "onClick" ("fmSV.mEdit_UKPUPFile.mPrevious"⎕wi "onClick")[728] ⎕wi "∆helpid" 5154[729] ⎕wi "caption" (("⍺",⎕tcnl) char_replace "Previous⍺PUP")[730] list←list OVER "fmEditUKPUP.fButtons.bnEdit_UKPUPNext"[731] ⎕wself←"fmEditUKPUP.fButtons.bnEdit_UKPUPNext" ⎕wi "New" "Button"[732] ⎕wi "enabled" (0 )[733] ⎕wi "extent" (size←1.28 1×buttonsize×1⌈CharSize÷13 6)[734] ⎕wi "∆where" (2 2⍴0.15 0 0.9 0)[735] ⎕wi "where" (("fmEditUKPUP.fButtons" ⎕wi "size") Win∆Resize (2 2⍴0.15 0 0.9 0))[736] ⎕wi "tooltip" "Move on to the Next PUP"[737] ⎕wi "onClick" ("fmSV.mEdit_UKPUPFile.mNext"⎕wi "onClick")[738] ⎕wi "∆helpid" 5155[739] ⎕wi "caption" (("⍺",⎕tcnl) char_replace "Next⍺PUP")[740] [741] "fmEditUKPUP" ⎕wi "∆multifile" ""[742] "fmEditUKPUP" ⎕wi "∆singlefile" ""[743] "fmEditUKPUP" ⎕wi "∆format" "fmEditUKPUP.cbFormattrick"[744] "fmEditUKPUP" ⎕wi "∆financial" 1[745] "fmEditUKPUP" ⎕wi "∆relrules" 2[746] "fmEditUKPUP" ⎕wi "∆parm" 0[747] "fmEditUKPUP" ⎕wi "∆decr" 0[748] "fmEditUKPUP" ⎕wi "∆file" 0[749] "fmEditUKPUP" ⎕wi "∆codefile" CodeFile[750] "fmEditUKPUP" ⎕wi "∆inputstype" ""[751] "fmEditUKPUP" ⎕wi "∆inputsentry" ""[752] "fmEditUKPUP" ⎕wi "∆savecn" (⍳0)[753] "fmEditUKPUP" ⎕wi "∆savedesc" ""[754] list←list OVER "fmEditUKPUP"[755] "fmEditUKPUP" ⎕wi "∆fieldlist" Fieldlist[756] "fmEditUKPUP" ⎕wi "∆fieldcontrol" Fieldcontrol[757] childlist←"fmSV" ⎕wi "∆childlist"[758] list←(⊃¯1↑childlist) OVER list[759] childlist[⍴childlist]←⊂list[760] "fmSV" ⎕wi "∆childlist" childlist[761] list←,⎕split list[762] 0 0⍴((∨/¨(⊂".mEdit_UKPUP")⍷¨list)/list) MultiWI "enabled" 1[763] :if 300<fnsize[764]     (fnsize fnsize ".") Win∆ProgressBar "MemberUpdate"[765]     Win∆ProgressBar "Hide"[766] :endif[767] "Init" OpenParameters "Edit_UKPUP"[768] "fmEditUKPUP.bnEdit_UKPUPHelp" ⎕wi "visible" 1[769] "fmEditUKPUP.bnEdit_UKPUPQuit" ⎕wi "visible" 1[770] "fmEditUKPUP.bnEdit_UKPUPSave" ⎕wi "visible" 1[771] "#" ⎕wi "focus" "fmEditUKPUP.cbFormattrick"[772] :if ~0∊⍴,Error←Win∆Initialise "Edit_UKPUP"[773]     "Quit" EndModule Module[774]     "fmSV" ⎕wi "pointer" 0[775]     0 0⍴"fmEditUKPUP" ⎕wi "Delete"[776]     :return[777] :endif[778] :if bar_open←commandbar^"Multi"≡""[779]     bar_open←0×"fmEditUKPUP.mEdit_UKPUPFile.m" Win∆CommandBar "OKHelp"[780] :endif[781] "fmEditUKPUP" ⎕wi "Paint"[782] "fmSV" ⎕wi "pointer" 11[783] "fmEditUKPUP" ⎕wi "onWait" "0 0⍴Edit_UKPUP 'Wait'"[784] 0 0⍴"fmEditUKPUP" ⎕wi "Wait"[785] 0 0⍴"fmEditUKPUP" ⎕wi "Delete"[786] "fmSV" ⎕wi "pointer" 0 ∇