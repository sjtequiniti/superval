∇ Container←Form_Make;⎕wself;ControlName;childlist;list;Fieldlist;Fieldcontrol;FrameWidth;Caption;buttonsize;buttonwhere;where;size;alignment;Header;PickList;NameList;value;sortorder;SortList;MaxRow;MaxCol;Parent;level;node;no;nn;NN;x;fnsize;framelist;relTests[1] [2] Fieldlist←Fieldcontrol←list←0 0⍴""[3] "fmSV" ⎕wi "pointer" 13[4] buttonsize←25 65 ⋄ buttonwhere←¯5[5] FormName ⎕wi "caption" ((FormName ⎕wi "caption")," - Printing Parameters")[6] "fmSV" ⎕wi "∆caption" (("fmSV" ⎕wi "∆caption"),⊂("fmSV" ⎕wi "caption"))[7] :if 300<fnsize←1↑⍴⎕cr "Form_Make"[8]     "Generating Form" Win∆ProgressBar "Open"[9]     ("Menu Items:" "Form Controls:") Win∆ProgressBar "SetLabels"[10]     (1 1 "Help About") Win∆ProgressBar "FileUpdate"[11] :endif[12] [13] Container←"∆Dialog"[14] [15] ⎕wself←"fmPrint" ⎕wi "New" "Form" "Hide"[16] ⎕wi "caption" ("fmSV" ⎕wi "caption")[17] ⎕wi "scale" 5[18] ⎕wi "font" ("fmSV" ⎕wi "font")[19] ⎕wi "border" 2 32 64[20] ⎕wi "where" (Win∆CentrePos .50 .60×768 1024×1⌈CharSize÷13 6)[21] ⎕wi "limitwhere" (0.8×¯2↑⎕wi "where")[22] ⎕wi "tooltipwidth" 200[23] ⎕wi "onResize" "AutoResize"[24] ⎕wi "onClose" "ExitSystem ''"[25] ControlName←"fmPrint"[26] relTests←0[27] 0 Menu_Make "fmSV"[28] 0 Menu_Make "fmPrint"[29] "fmPrint" Win∆CutCopyPaste "Build"[30] "fmPrint" ⎕wi "∆helpid" 2007[31] list←list OVER "fmPrint.bnPrint_DialogHelp"[32] ⎕wself←"fmPrint.bnPrint_DialogHelp" ⎕wi "New" "Button"[33] ⎕wi "deferexit" 1[34] ⎕wi "extent" (size←1×buttonsize×1⌈CharSize÷13 6)[35] x←0.5×⍴where←Win∆Calcwhere 1,(¯10-size[1]),1,buttonwhere←buttonwhere-5+size[2][36] ⎕wi "∆where" ((x,2)⍴where)[37] ⎕wi "where" (("fmPrint" ⎕wi "size") Win∆Resize ⎕wi "∆where")[38] ⎕wi "tooltip" "SuperVal Help"[39] ⎕wi "onClick" ("fmSV.mPrint_DialogHelp.mContext"⎕wi "onClick")[40] ⎕wi "caption" "Help"[41] :if buttonimage[42]     ⎕wi "imagelist" "fmSV.iStandard"[43]     ⎕wi "imageindex" 12[44] :endif[45] ⎕wi "visible" ¯1[46] ⎕wi "onMouseDown" "∆HelpField←'#' ⎕wi 'focus' "[47] list←list OVER "fmPrint.bnPrint_DialogQuit"[48] ⎕wself←"fmPrint.bnPrint_DialogQuit" ⎕wi "New" "Button"[49] ⎕wi "style" 2[50] ⎕wi "deferexit" 1[51] ⎕wi "extent" (size←1×buttonsize×1⌈CharSize÷13 6)[52] x←0.5×⍴where←Win∆Calcwhere 1,(¯10-size[1]),1,buttonwhere←buttonwhere-5+size[2][53] ⎕wi "∆where" ((x,2)⍴where)[54] ⎕wi "where" (("fmPrint" ⎕wi "size") Win∆Resize ⎕wi "∆where")[55] ⎕wi "tooltip" "Quit and Return"[56] ⎕wi "onClick" ("fmSV.mPrint_DialogFile.mQuit"⎕wi "onClick")[57] ⎕wi "caption" "Quit"[58] ⎕wi "∆helpid" 3040[59] ⎕wi "order" .5[60] ⎕wi "visible" ¯1[61] ControlName ⎕wi "∆quitbutton" "fmPrint.bnPrint_DialogQuit"[62] "fmPrint" ⎕wi "∆modified" 1[63] [64] ⎕wself←"fmPrint.cbPrinter" ⎕wi "New" "Combo"[65] Fieldlist←Fieldlist OVER "fmPrint.cbPrinter"[66] Fieldcontrol←Fieldcontrol OVER "Combo"[67] ⎕wi "∆name" "Printer"[68] ⎕wi "∆type" "Char"[69] ⎕wi "∆mandatory" 1[70] ⎕wi "∆helpid" 3041[71] ⎕wi "tooltip" "Select the Printer"[72] ⎕wi "style" 16 128 256 2[73] ⎕wi "∆where" (2 2⍴0.1 0 0.2 0)[74] ⎕wi "where" (("fmPrint" ⎕wi "size") Win∆Resize (2 2⍴0.1 0 0.2 0))[75] PickList←PrinterList[76] ⎕wi "∆update" "PrinterList"[77] PickList←⊃m2n 1 0↓PickList[78] ⎕wi "list" PickList[79] ⎕wi "extent" (150,(¯10+6×¯1↑CharSize)+¯1↑Win∆TextSize ((0,⎕wi "limit")⌈⍴PickList)↑PickList)[80] ⎕wi "onClick" "0 0⍴(⊂⎕wi 'name') Print_Dialog 'Change' "[81] [82] ⎕wself←"fmPrint.llPrinter" ⎕wi "New" "Label"[83] ⎕wi "scale" 5[84] ⎕wi "style" 2[85] ⎕wi "extent" (↑⎕wi "Draw" ("?text" "Select Printer"))[86] ⎕wi "caption" "Select Printer"[87] where←4↑,"fmPrint.cbPrinter" ⎕wi "∆where"[88] x←0.5×⍴where←Win∆Calcwhere where-0 ¯3 0,10+¯1↑⎕wi "extent"[89] ⎕wi "∆where" ((x,2)⍴where)[90] ⎕wi "where" (("fmPrint" ⎕wi "size") Win∆Resize ⎕wi "∆where")[91] PickList←⍙POPUPSdict ReadDictFile "PrintOpt"[92] :if 0∊⍴,Header←"" ⋄ Header←DLTB PickList[1;] ⋄ :endif[93] no←1↑⍴PickList←1 0↓PickList[94] [95] ⎕wself←"fmPrint.lPrintOpt" ⎕wi "New" "Label"[96] ⎕wi "scale" 5[97] ⎕wi "tooltip" "Select the portion of File to be printed"[98] ⎕wi "extent" (↑⎕wi "Draw" ("?text" "Printout Options"))[99] ⎕wi "caption" "Printout Options"[100] ⎕wi "∆where" (2 2⍴0.2 0 0.1 0)[101] ⎕wi "where" (("fmPrint" ⎕wi "size") Win∆Resize (2 2⍴0.2 0 0.1 0))[102] [103] where←(1×1 0 1 0\0.2 0.1 )+0 1 0 1\25,10×0[104] alignment←1 0 ⋄ FrameWidth←10+¯1↑Win∆TextSize Header[105] :for nn :in ⍳no[106]     ⎕wself←(Name←"fmPrint.opPrintOpt_",⍕nn) ⎕wi "New" "Option"[107]     :if nn=1 ⋄ ⎕wi "∆lastoption" ("fmPrint.opPrintOpt_",⍕no) ⋄ :endif[108]     size←0.5×⍴x←Win∆Calcwhere where[109]     x←(size,2)⍴x[110]     ⎕wi "∆where" x[111]     ⎕wi "where" (("fmPrint" ⎕wi "size") Win∆Resize x)[112]     ⎕wi "caption" (Caption←DLTB PickList[nn;])[113]     FrameWidth←FrameWidth⌈10+¯1↑size←0 25+Win∆TextSize Caption[114]     where←where+0 1 0 1\alignment×10 20+size[115]     ⎕wi "extent" size[116]     ⎕wi "tooltip" "Select the portion of File to be printed"[117]     ⎕wi "onClick" "(0 0⍴(⊂⎕wi 'name') Print_Dialog 'Change' )"[118]     ⎕wi "∆helpid" 3042[119] :endfor[120] ⎕wi "∆type" "Option"[121] ⎕wi "∆mandatory" 1[122] ⎕wi "∆name" "PrintOpt"[123] ⎕wi "∆options" "⍺Entire File ⍺Current Page ⍺Multiple Pages ⍺Selected Text"[124] Fieldlist←Fieldlist OVER Name[125] Fieldcontrol←Fieldcontrol OVER "Option"[126] :if 0[127]     ⎕wself←"fmPrint"[128]     size←0.5×⍴x←Win∆Calcwhere 0.2 0 0.1 0,0 1 0 1×where+(2/⌽alignment)×0 25 0,FrameWidth[129]     x←(size,2)⍴x[130]     ⎕wi "∆where" x[131]     ⎕wi "where" (("#" ⎕wi "size") Win∆Resize x)[132] :endif[133] [134] :if 300<fnsize[135]     ((1↑⎕lc) fnsize "FrameV - Page Selections") Win∆ProgressBar "MemberUpdate"[136] :endif[137] [138] ⎕wself←"fmPrint.fPages" ⎕wi "New" "Frame"[139] ⎕wi "scale" 5[140] ⎕wi "∆where" (4 2⍴0.2 0 0.3 0 0.3 0 0.25 0)[141] ⎕wi "where" (("fmPrint" ⎕wi "size") Win∆Resize (4 2⍴0.2 0 0.3 0 0.3 0 0.25 0))[142] ⎕wi "caption" "Page Selections"[143] ⎕wi "style" 0[144] ⎕wi "onResize" "AutoResize"[145] [146] ⎕wself←"fmPrint.fPages.edStartPage" ⎕wi "New" "Edit"[147] Fieldlist←Fieldlist OVER "fmPrint.fPages.edStartPage"[148] Fieldcontrol←Fieldcontrol OVER "Edit"[149] ⎕wi "∆name" "StartPage"[150] ⎕wi "∆type" "Num"[151] ⎕wi "∆mandatory" 1[152] ⎕wi "∆valid" ('Int' 'Scalar' '+')[153] ⎕wi "∆helpid" 3043[154] ⎕wi "tooltip" "Specify the Start Page Number"[155] ⎕wi "limit" 5[156] ⎕wi "∆where" (2 2⍴0.25 0 0.45 0)[157] ⎕wi "where" (("fmPrint.fPages" ⎕wi "size") Win∆Resize (2 2⍴0.25 0 0.45 0))[158] ⎕wi "∆range" "1,MaxPage"[159] ⎕wi "onExit" "⍎(0∊⍴,⎕wres←0 INPUT∆CHECK 'fmPrint.fPages.edStartPage')/'0 0⍴(⊂⎕wi ''name'') Print_Dialog ''Change'' ' "[160] ⎕wi "onExitError" "Win∆ExitError ⎕warg"[161] ⎕wi "onKeyPress" "⎕wres←¯2×~⎕warg∊8 32 48 49 50 51 52 53 54 55 56 57"[162] ⎕wi "extent" (2+CharSize×1 6)[163] [164] ⎕wself←"fmPrint.fPages.llStartPage" ⎕wi "New" "Label"[165] ⎕wi "scale" 5[166] ⎕wi "style" 2[167] ⎕wi "extent" (↑⎕wi "Draw" ("?text" "from"))[168] ⎕wi "caption" "from"[169] where←4↑,"fmPrint.fPages.edStartPage" ⎕wi "∆where"[170] x←0.5×⍴where←Win∆Calcwhere where-0 ¯3 0,10+¯1↑⎕wi "extent"[171] ⎕wi "∆where" ((x,2)⍴where)[172] ⎕wi "where" (("fmPrint.fPages" ⎕wi "size") Win∆Resize ⎕wi "∆where")[173] [174] ⎕wself←"fmPrint.fPages.edEndPage" ⎕wi "New" "Edit"[175] Fieldlist←Fieldlist OVER "fmPrint.fPages.edEndPage"[176] Fieldcontrol←Fieldcontrol OVER "Edit"[177] ⎕wi "∆name" "EndPage"[178] ⎕wi "∆type" "Num"[179] ⎕wi "∆mandatory" 1[180] ⎕wi "∆valid" ('Int' 'Scalar' '+')[181] ⎕wi "∆helpid" 3043[182] ⎕wi "tooltip" "Specify the End Page Number"[183] ⎕wi "limit" 5[184] ⎕wi "∆where" (2 2⍴0.65 0 0.45 0)[185] ⎕wi "where" (("fmPrint.fPages" ⎕wi "size") Win∆Resize (2 2⍴0.65 0 0.45 0))[186] ⎕wi "∆range" "1,MaxPage"[187] ⎕wi "onExit" "⍎(0∊⍴,⎕wres←0 INPUT∆CHECK 'fmPrint.fPages.edEndPage')/'0 0⍴(⊂⎕wi ''name'') Print_Dialog ''Change'' ' "[188] ⎕wi "onExitError" "Win∆ExitError ⎕warg"[189] ⎕wi "onKeyPress" "⎕wres←¯2×~⎕warg∊8 32 48 49 50 51 52 53 54 55 56 57"[190] ⎕wi "extent" (2+CharSize×1 6)[191] [192] ⎕wself←"fmPrint.fPages.llEndPage" ⎕wi "New" "Label"[193] ⎕wi "scale" 5[194] ⎕wi "style" 2[195] ⎕wi "extent" (↑⎕wi "Draw" ("?text" "to"))[196] ⎕wi "caption" "to"[197] where←4↑,"fmPrint.fPages.edEndPage" ⎕wi "∆where"[198] x←0.5×⍴where←Win∆Calcwhere where-0 ¯3 0,10+¯1↑⎕wi "extent"[199] ⎕wi "∆where" ((x,2)⍴where)[200] ⎕wi "where" (("fmPrint.fPages" ⎕wi "size") Win∆Resize ⎕wi "∆where")[201] PickList←⍙POPUPSdict ReadDictFile "Orientation"[202] :if 0∊⍴,Header←"" ⋄ Header←DLTB PickList[1;] ⋄ :endif[203] no←1↑⍴PickList←1 0↓PickList[204] [205] ⎕wself←"fmPrint.forientation" ⎕wi "New" "Frame"[206] ⎕wi "scale" 5[207] ⎕wi "∆where" (4 2⍴0.2 0 0.6 0 0.2 0 0.2 0)[208] ⎕wi "where" (("fmPrint" ⎕wi "size") Win∆Resize (4 2⍴0.2 0 0.6 0 0.2 0 0.2 0))[209] ⎕wi "caption" "Printer Orientation"[210] ⎕wi "style" 0[211] ⎕wi "onResize" "AutoResize"[212] ⎕wi "tooltip" "Select the Printing Orientation"[213] [214] where←(0×1 0 1 0\0.2 0.6 )+0 1 0 1\25,10×1[215] alignment←0 1 ⋄ FrameWidth←10+¯1↑Win∆TextSize Header[216] :for nn :in ⍳no[217]     ⎕wself←(Name←"fmPrint.forientation.oporientation_",⍕nn) ⎕wi "New" "Option"[218]     :if nn=1 ⋄ ⎕wi "∆lastoption" ("fmPrint.forientation.oporientation_",⍕no) ⋄ :endif[219]     size←0.5×⍴x←Win∆Calcwhere where[220]     x←(size,2)⍴x[221]     ⎕wi "∆where" x[222]     ⎕wi "where" (("fmPrint.forientation" ⎕wi "size") Win∆Resize x)[223]     ⎕wi "caption" (Caption←DLTB PickList[nn;])[224]     FrameWidth←FrameWidth⌈10+¯1↑size←0 25+Win∆TextSize Caption[225]     where←where+0 1 0 1\alignment×10 20+size[226]     ⎕wi "extent" size[227]     ⎕wi "tooltip" "Select the Printing Orientation"[228]     ⎕wi "onClick" "(0 0⍴(⊂⎕wi 'name') Print_Dialog 'Change' )"[229]     ⎕wi "∆helpid" 3044[230] :endfor[231] ⎕wi "∆type" "Option"[232] ⎕wi "∆mandatory" 1[233] ⎕wi "∆name" "orientation"[234] ⎕wi "∆options" "⍺Portrait ⍺Landscape"[235] Fieldlist←Fieldlist OVER Name[236] Fieldcontrol←Fieldcontrol OVER "Option"[237] :if 1[238]     ⎕wself←"fmPrint.forientation"[239]     size←0.5×⍴x←Win∆Calcwhere 0.2 0 0.6 0,0 1 0 1×where+(2/⌽alignment)×0 25 0,FrameWidth[240]     x←(size,2)⍴x[241]     ⎕wi "∆where" x[242]     ⎕wi "where" (("fmPrint" ⎕wi "size") Win∆Resize x)[243] :endif[244] [245] :if 300<fnsize[246]     ((1↑⎕lc) fnsize "FrameV - Margins") Win∆ProgressBar "MemberUpdate"[247] :endif[248] [249] ⎕wself←"fmPrint.fMargins" ⎕wi "New" "Frame"[250] ⎕wi "scale" 5[251] ⎕wi "∆where" (4 2⍴0.55 0 0.1 0 0.45 ¯45 0.35 0)[252] ⎕wi "where" (("fmPrint" ⎕wi "size") Win∆Resize (4 2⍴0.55 0 0.1 0 0.45 ¯45 0.35 0))[253] ⎕wi "caption" "Margins"[254] ⎕wi "style" 0[255] ⎕wi "onResize" "AutoResize"[256] [257] ⎕wself←"fmPrint.fMargins.edtopmargin" ⎕wi "New" "Edit"[258] Fieldlist←Fieldlist OVER "fmPrint.fMargins.edtopmargin"[259] Fieldcontrol←Fieldcontrol OVER "Edit"[260] ⎕wi "∆name" "topmargin"[261] ⎕wi "∆type" "Num"[262] ⎕wi "∆mandatory" 1[263] ⎕wi "∆valid" ('Scalar' '0+')[264] ⎕wi "∆helpid" 3045[265] ⎕wi "tooltip" "Specify the Top Margin (in inches)"[266] ⎕wi "limit" 4[267] ⎕wi "∆where" (2 2⍴0.25 0 0.45 0)[268] ⎕wi "where" (("fmPrint.fMargins" ⎕wi "size") Win∆Resize (2 2⍴0.25 0 0.45 0))[269] ⎕wi "∆range" "0,3"[270] ⎕wi "onExit" "⍎(0∊⍴,⎕wres←0 INPUT∆CHECK 'fmPrint.fMargins.edtopmargin')/'0 0⍴(⊂⎕wi ''name'') Print_Dialog ''Change'' ' "[271] ⎕wi "onExitError" "Win∆ExitError ⎕warg"[272] ⎕wi "onKeyPress" "⎕wres←¯2×~⎕warg∊46 8 32 48 49 50 51 52 53 54 55 56 57"[273] ⎕wi "extent" (2+CharSize×1 5)[274] [275] ⎕wself←"fmPrint.fMargins.lrtopmargin" ⎕wi "New" "Label"[276] ⎕wi "scale" 5[277] ⎕wi "extent" (↑⎕wi "Draw" ("?text" "inches"))[278] ⎕wi "caption" "inches"[279] where←4↑,"fmPrint.fMargins.edtopmargin" ⎕wi "∆where"[280] x←0.5×⍴where←Win∆Calcwhere where+0,3,0,10+¯1↑"fmPrint.fMargins.edtopmargin" ⎕wi "extent"[281] ⎕wi "∆where" ((x,2)⍴where)[282] ⎕wi "where" (("fmPrint.fMargins" ⎕wi "size") Win∆Resize ⎕wi "∆where")[283] [284] ⎕wself←"fmPrint.fMargins.lltopmargin" ⎕wi "New" "Label"[285] ⎕wi "scale" 5[286] ⎕wi "style" 2[287] ⎕wi "extent" (↑⎕wi "Draw" ("?text" "Top Margin"))[288] ⎕wi "caption" "Top Margin"[289] where←4↑,"fmPrint.fMargins.edtopmargin" ⎕wi "∆where"[290] x←0.5×⍴where←Win∆Calcwhere where-0 ¯3 0,10+¯1↑⎕wi "extent"[291] ⎕wi "∆where" ((x,2)⍴where)[292] ⎕wi "where" (("fmPrint.fMargins" ⎕wi "size") Win∆Resize ⎕wi "∆where")[293] [294] ⎕wself←"fmPrint.fMargins.edleftmargin" ⎕wi "New" "Edit"[295] Fieldlist←Fieldlist OVER "fmPrint.fMargins.edleftmargin"[296] Fieldcontrol←Fieldcontrol OVER "Edit"[297] ⎕wi "∆name" "leftmargin"[298] ⎕wi "∆type" "Num"[299] ⎕wi "∆mandatory" 1[300] ⎕wi "∆valid" ('Scalar' '0+')[301] ⎕wi "∆helpid" 3045[302] ⎕wi "tooltip" "Specify the Left Margin (in inches)"[303] ⎕wi "limit" 4[304] ⎕wi "∆where" (2 2⍴0.65 0 0.45 0)[305] ⎕wi "where" (("fmPrint.fMargins" ⎕wi "size") Win∆Resize (2 2⍴0.65 0 0.45 0))[306] ⎕wi "∆range" "0,3"[307] ⎕wi "onExit" "⍎(0∊⍴,⎕wres←0 INPUT∆CHECK 'fmPrint.fMargins.edleftmargin')/'0 0⍴(⊂⎕wi ''name'') Print_Dialog ''Change'' ' "[308] ⎕wi "onExitError" "Win∆ExitError ⎕warg"[309] ⎕wi "onKeyPress" "⎕wres←¯2×~⎕warg∊46 8 32 48 49 50 51 52 53 54 55 56 57"[310] ⎕wi "extent" (2+CharSize×1 5)[311] [312] ⎕wself←"fmPrint.fMargins.lrleftmargin" ⎕wi "New" "Label"[313] ⎕wi "scale" 5[314] ⎕wi "extent" (↑⎕wi "Draw" ("?text" "inches"))[315] ⎕wi "caption" "inches"[316] where←4↑,"fmPrint.fMargins.edleftmargin" ⎕wi "∆where"[317] x←0.5×⍴where←Win∆Calcwhere where+0,3,0,10+¯1↑"fmPrint.fMargins.edleftmargin" ⎕wi "extent"[318] ⎕wi "∆where" ((x,2)⍴where)[319] ⎕wi "where" (("fmPrint.fMargins" ⎕wi "size") Win∆Resize ⎕wi "∆where")[320] [321] ⎕wself←"fmPrint.fMargins.llleftmargin" ⎕wi "New" "Label"[322] ⎕wi "scale" 5[323] ⎕wi "style" 2[324] ⎕wi "extent" (↑⎕wi "Draw" ("?text" "Left Margin"))[325] ⎕wi "caption" "Left Margin"[326] where←4↑,"fmPrint.fMargins.edleftmargin" ⎕wi "∆where"[327] x←0.5×⍴where←Win∆Calcwhere where-0 ¯3 0,10+¯1↑⎕wi "extent"[328] ⎕wi "∆where" ((x,2)⍴where)[329] ⎕wi "where" (("fmPrint.fMargins" ⎕wi "size") Win∆Resize ⎕wi "∆where")[330] PickList←⍙POPUPSdict ReadDictFile "FontStyle"[331] :if 0∊⍴,Header←"" ⋄ Header←DLTB PickList[1;] ⋄ :endif[332] no←1↑⍴PickList←1 0↓PickList[333] [334] ⎕wself←"fmPrint.fFontStyle" ⎕wi "New" "Frame"[335] ⎕wi "scale" 5[336] ⎕wi "∆where" (4 2⍴0.4 0 0.6 0 0.2 0 0.2 0)[337] ⎕wi "where" (("fmPrint" ⎕wi "size") Win∆Resize (4 2⍴0.4 0 0.6 0 0.2 0 0.2 0))[338] ⎕wi "caption" "Font Style"[339] ⎕wi "style" 0[340] ⎕wi "onResize" "AutoResize"[341] ⎕wi "tooltip" "Select the Font Style"[342] [343] where←(0×1 0 1 0\0.4 0.6 )+0 1 0 1\25,10×1[344] alignment←1 0 ⋄ FrameWidth←10+¯1↑Win∆TextSize Header[345] :for nn :in ⍳no[346]     ⎕wself←(Name←"fmPrint.fFontStyle.opFontStyle_",⍕nn) ⎕wi "New" "Option"[347]     :if nn=1 ⋄ ⎕wi "∆lastoption" ("fmPrint.fFontStyle.opFontStyle_",⍕no) ⋄ :endif[348]     size←0.5×⍴x←Win∆Calcwhere where[349]     x←(size,2)⍴x[350]     ⎕wi "∆where" x[351]     ⎕wi "where" (("fmPrint.fFontStyle" ⎕wi "size") Win∆Resize x)[352]     ⎕wi "caption" (Caption←DLTB PickList[nn;])[353]     FrameWidth←FrameWidth⌈10+¯1↑size←0 25+Win∆TextSize Caption[354]     where←where+0 1 0 1\alignment×10 20+size[355]     ⎕wi "extent" size[356]     ⎕wi "tooltip" "Select the Font Style"[357]     ⎕wi "onClick" "(0 0⍴(⊂⎕wi 'name') Print_Dialog 'Change' )"[358]     ⎕wi "∆helpid" 3046[359] :endfor[360] ⎕wi "∆type" "Option"[361] ⎕wi "∆mandatory" 1[362] ⎕wi "∆name" "FontStyle"[363] ⎕wi "∆options" "⍺APL ⍺Roman ⍺Swiss ⍺Modern ⍺Script ⍺Decorative"[364] Fieldlist←Fieldlist OVER Name[365] Fieldcontrol←Fieldcontrol OVER "Option"[366] :if 1[367]     ⎕wself←"fmPrint.fFontStyle"[368]     size←0.5×⍴x←Win∆Calcwhere 0.4 0 0.6 0,0 1 0 1×where+(2/⌽alignment)×0 25 0,FrameWidth[369]     x←(size,2)⍴x[370]     ⎕wi "∆where" x[371]     ⎕wi "where" (("fmPrint" ⎕wi "size") Win∆Resize x)[372] :endif[373] PickList←⍙POPUPSdict ReadDictFile "FontSize"[374] :if 0∊⍴,Header←"" ⋄ Header←DLTB PickList[1;] ⋄ :endif[375] no←1↑⍴PickList←1 0↓PickList[376] [377] ⎕wself←"fmPrint.fFontSize" ⎕wi "New" "Frame"[378] ⎕wi "scale" 5[379] ⎕wi "∆where" (4 2⍴0.4 0 0.8 0 0.2 0 0.2 0)[380] ⎕wi "where" (("fmPrint" ⎕wi "size") Win∆Resize (4 2⍴0.4 0 0.8 0 0.2 0 0.2 0))[381] ⎕wi "caption" "Font Size"[382] ⎕wi "style" 0[383] ⎕wi "onResize" "AutoResize"[384] ⎕wi "tooltip" "Select the Font Size"[385] [386] where←(0×1 0 1 0\0.4 0.8 )+0 1 0 1\25,10×1[387] alignment←1 0 ⋄ FrameWidth←10+¯1↑Win∆TextSize Header[388] :for nn :in ⍳no[389]     ⎕wself←(Name←"fmPrint.fFontSize.opFontSize_",⍕nn) ⎕wi "New" "Option"[390]     :if nn=1 ⋄ ⎕wi "∆lastoption" ("fmPrint.fFontSize.opFontSize_",⍕no) ⋄ :endif[391]     size←0.5×⍴x←Win∆Calcwhere where[392]     x←(size,2)⍴x[393]     ⎕wi "∆where" x[394]     ⎕wi "where" (("fmPrint.fFontSize" ⎕wi "size") Win∆Resize x)[395]     ⎕wi "caption" (Caption←DLTB PickList[nn;])[396]     FrameWidth←FrameWidth⌈10+¯1↑size←0 25+Win∆TextSize Caption[397]     where←where+0 1 0 1\alignment×10 20+size[398]     ⎕wi "extent" size[399]     ⎕wi "tooltip" "Select the Font Size"[400]     ⎕wi "onClick" "(0 0⍴(⊂⎕wi 'name') Print_Dialog 'Change' )"[401]     ⎕wi "∆helpid" 3047[402] :endfor[403] ⎕wi "∆type" "Option"[404] ⎕wi "∆mandatory" 1[405] ⎕wi "∆name" "FontSize"[406] ⎕wi "∆options" "⍺Fine ⍺Small ⍺Normal ⍺Large ⍺Very Large"[407] Fieldlist←Fieldlist OVER Name[408] Fieldcontrol←Fieldcontrol OVER "Option"[409] :if 1[410]     ⎕wself←"fmPrint.fFontSize"[411]     size←0.5×⍴x←Win∆Calcwhere 0.4 0 0.8 0,0 1 0 1×where+(2/⌽alignment)×0 25 0,FrameWidth[412]     x←(size,2)⍴x[413]     ⎕wi "∆where" x[414]     ⎕wi "where" (("fmPrint" ⎕wi "size") Win∆Resize x)[415] :endif[416] list←list OVER "fmPrint.bnPrint_DialogPrint"[417] ⎕wself←"fmPrint.bnPrint_DialogPrint" ⎕wi "New" "Button"[418] ⎕wi "extent" (size←1×buttonsize×1⌈CharSize÷13 6)[419] x←0.5×⍴where←Win∆Calcwhere 1,(¯10-size[1]),1,buttonwhere←buttonwhere-5+size[2][420] ⎕wi "∆where" ((x,2)⍴where)[421] ⎕wi "where" (("fmPrint" ⎕wi "size") Win∆Resize ⎕wi "∆where")[422] ⎕wi "tooltip" "Print Selection of File"[423] ⎕wi "onClick" ("fmSV.mPrint_DialogFile.mPrint"⎕wi "onClick")[424] ⎕wi "∆helpid" 3048[425] ⎕wi "caption" "Print"[426] :if buttonimage[427]     ⎕wi "imagelist" "fmSV.iStandard"[428]     ⎕wi "imageindex" 15[429] :endif[430] [431] "fmPrint" ⎕wi "∆multifile" ""[432] "fmPrint" ⎕wi "∆singlefile" ""[433] "fmPrint" ⎕wi "∆format" ""[434] "fmPrint" ⎕wi "∆financial" 0[435] "fmPrint" ⎕wi "∆relrules" 0[436] "fmPrint" ⎕wi "∆parm" 0[437] "fmPrint" ⎕wi "∆decr" 0[438] "fmPrint" ⎕wi "∆file" 0[439] "fmPrint" ⎕wi "∆codefile" CodeFile[440] "fmPrint" ⎕wi "∆inputstype" ""[441] "fmPrint" ⎕wi "∆inputsentry" ""[442] "fmPrint" ⎕wi "∆savecn" (⍳0)[443] "fmPrint" ⎕wi "∆savedesc" ""[444] list←list OVER "fmPrint"[445] "fmPrint" ⎕wi "∆fieldlist" Fieldlist[446] "fmPrint" ⎕wi "∆fieldcontrol" Fieldcontrol[447] childlist←"fmSV" ⎕wi "∆childlist"[448] list←(⊃¯1↑childlist) OVER list[449] childlist[⍴childlist]←⊂list[450] "fmSV" ⎕wi "∆childlist" childlist[451] list←,⎕split list[452] 0 0⍴((∨/¨(⊂".mPrint_Dialog")⍷¨list)/list) MultiWI "enabled" 1[453] :if 300<fnsize[454]     (fnsize fnsize ".") Win∆ProgressBar "MemberUpdate"[455]     Win∆ProgressBar "Hide"[456] :endif[457] "Init" OpenParameters "Print_Dialog"[458] "fmPrint.bnPrint_DialogHelp" ⎕wi "visible" 1[459] "fmPrint.bnPrint_DialogQuit" ⎕wi "visible" 1[460] "#" ⎕wi "focus" "fmPrint.cbPrinter"[461] :if ~0∊⍴,Error←Win∆Initialise "Print_Dialog"[462]     "Quit" EndModule Module[463]     "fmSV" ⎕wi "pointer" 0[464]     0 0⍴"fmPrint" ⎕wi "Delete"[465]     :return[466] :endif[467] :if bar_open←commandbar^"Multi"≡""[468]     bar_open←0×"fmPrint.mPrint_DialogFile.m" Win∆CommandBar "QuitHelp"[469] :endif[470] "fmPrint" ⎕wi "Paint"[471] "fmSV" ⎕wi "pointer" 11[472] "fmPrint" ⎕wi "onWait" "0 0⍴Print_Dialog 'Wait' ⋄ 'fmPrint' ⎕wi 'modified' 0"[473] 0 0⍴"fmPrint" ⎕wi "Wait"[474] 0 0⍴"fmPrint" ⎕wi "Delete"[475] "fmSV" ⎕wi "pointer" 0 ∇