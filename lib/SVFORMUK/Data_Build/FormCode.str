∇ Container←Form_Make;⎕wself;ControlName;childlist;list;Fieldlist;Fieldcontrol;FrameWidth;Caption;buttonsize;buttonwhere;where;size;alignment;Header;PickList;NameList;value;sortorder;SortList;MaxRow;MaxCol;Parent;level;node;no;nn;NN;x;fnsize;framelist;relTests[1] [2] Fieldlist←Fieldcontrol←list←0 0⍴""[3] "fmSV" ⎕wi "pointer" 13[4] buttonsize←25 65 ⋄ buttonwhere←¯5[5] FormName ⎕wi "caption" ((FormName ⎕wi "caption")," - Data Build Wizard")[6] "fmSV" ⎕wi "∆caption" (("fmSV" ⎕wi "∆caption"),⊂("fmSV" ⎕wi "caption"))[7] :if 300<fnsize←1↑⍴⎕cr "Form_Make"[8]     "Generating Form" Win∆ProgressBar "Open"[9]     ("Menu Items:" "Form Controls:") Win∆ProgressBar "SetLabels"[10]     (1 1 "Help About") Win∆ProgressBar "FileUpdate"[11] :endif[12] [13] Container←"∆Wizard"[14] [15] ⎕wself←"fmDataBuild" ⎕wi "New" "Form" "Hide"[16] ⎕wi "caption" ("fmSV" ⎕wi "caption")[17] ⎕wi "scale" 5[18] ⎕wi "font" ("fmSV" ⎕wi "font")[19] ⎕wi "border" 2 32 64[20] ⎕wi "where" (Win∆CentrePos 1.2 1.2 ×768 1024×1⌈CharSize÷13 6)[21] ⎕wi "limitwhere" (0.8×¯2↑⎕wi "where")[22] ⎕wi "tooltipwidth" 200[23] ⎕wi "onResize" "AutoResize"[24] ⎕wi "onClose" "ExitSystem ''"[25] ControlName←"fmDataBuild"[26] relTests←0[27] 0 Menu_Make "fmSV"[28] 0 Menu_Make "fmDataBuild"[29] "fmDataBuild" Win∆CutCopyPaste "Build"[30] list←list OVER "fmDataBuild.bnData_BuildHelp"[31] ⎕wself←"fmDataBuild.bnData_BuildHelp" ⎕wi "New" "Button"[32] ⎕wi "deferexit" 1[33] ⎕wi "extent" (size←1×buttonsize×1⌈CharSize÷13 6)[34] x←0.5×⍴where←Win∆Calcwhere 1,(¯10-size[1]),1,buttonwhere←buttonwhere-5+size[2][35] ⎕wi "∆where" ((x,2)⍴where)[36] ⎕wi "where" (("fmDataBuild" ⎕wi "size") Win∆Resize ⎕wi "∆where")[37] ⎕wi "tooltip" "SuperVal Help"[38] ⎕wi "onClick" ("fmSV.mData_BuildHelp.mContext"⎕wi "onClick")[39] ⎕wi "caption" "Help"[40] :if buttonimage[41]     ⎕wi "imagelist" "fmSV.iStandard"[42]     ⎕wi "imageindex" 12[43] :endif[44] ⎕wi "visible" ¯1[45] ⎕wi "onMouseDown" "∆HelpField←'#' ⎕wi 'focus' "[46] list←list OVER "fmDataBuild.bnData_BuildQuit"[47] ⎕wself←"fmDataBuild.bnData_BuildQuit" ⎕wi "New" "Button"[48] ⎕wi "style" 2[49] ⎕wi "deferexit" 1[50] ⎕wi "extent" (size←1×buttonsize×1⌈CharSize÷13 6)[51] x←0.5×⍴where←Win∆Calcwhere 1,(¯10-size[1]),1,buttonwhere←buttonwhere-5+size[2][52] ⎕wi "∆where" ((x,2)⍴where)[53] ⎕wi "where" (("fmDataBuild" ⎕wi "size") Win∆Resize ⎕wi "∆where")[54] ⎕wi "tooltip" "Cancel and Return"[55] ⎕wi "onClick" ("fmSV.mData_BuildFile.mQuit"⎕wi "onClick")[56] ⎕wi "caption" "Cancel"[57] ⎕wi "∆helpid" 3112[58] ⎕wi "order" .5[59] ⎕wi "visible" ¯1[60] list←list OVER "fmDataBuild.bnData_BuildNext"[61] ⎕wself←"fmDataBuild.bnData_BuildNext" ⎕wi "New" "Button"[62] ⎕wi "style" 1[63] ⎕wi "extent" (size←1×buttonsize×1⌈CharSize÷13 6)[64] x←0.5×⍴where←Win∆Calcwhere 1,(¯10-size[1]),1,buttonwhere←buttonwhere-5+size[2][65] ⎕wi "∆where" ((x,2)⍴where)[66] ⎕wi "where" (("fmDataBuild" ⎕wi "size") Win∆Resize ⎕wi "∆where")[67] ⎕wi "tooltip" "Move on to Next Form"[68] ⎕wi "onClick" ("fmSV.mData_BuildFile.mNext"⎕wi "onClick")[69] ⎕wi "caption" "Next"[70] :if buttonimage[71]     ⎕wi "imagelist" "fmSV.iStandard"[72]     ⎕wi "imageindex" 29[73] :endif[74] ⎕wi "∆helpid" 3113[75] list←list OVER "fmDataBuild.bnData_BuildBack"[76] ⎕wself←"fmDataBuild.bnData_BuildBack" ⎕wi "New" "Button"[77] ⎕wi "enabled" (0)[78] ⎕wi "extent" (size←1×buttonsize×1⌈CharSize÷13 6)[79] x←0.5×⍴where←Win∆Calcwhere 1,(¯10-size[1]),1,buttonwhere←buttonwhere-5+size[2][80] ⎕wi "∆where" ((x,2)⍴where)[81] ⎕wi "where" (("fmDataBuild" ⎕wi "size") Win∆Resize ⎕wi "∆where")[82] ⎕wi "tooltip" "Move back to Previous Form"[83] ⎕wi "onClick" ("fmSV.mData_BuildFile.mBack"⎕wi "onClick")[84] ⎕wi "caption" "Back"[85] :if buttonimage[86]     ⎕wi "imagelist" "fmSV.iStandard"[87]     ⎕wi "imageindex" 28[88] :endif[89] ⎕wi "∆helpid" 3114[90] framelist←0 0⍴""[91] [92] :if 300<fnsize[93]     ((1↑⎕lc) fnsize "Frame - Type of Member") Win∆ProgressBar "MemberUpdate"[94] :endif[95] [96] ⎕wself←"fmDataBuild.fData" ⎕wi "New" "Frame"[97] ⎕wi "scale" 5[98] ⎕wi "∆where" (4 2⍴0 0 0 0 1 ¯45 1 0)[99] ⎕wi "where" (("fmDataBuild" ⎕wi "size") Win∆Resize (4 2⍴0 0 0 0 1 ¯45 1 0))[100] ⎕wi "caption" "Type of Member"[101] ⎕wi "style" 7[102] ⎕wi "onResize" "AutoResize"[103] framelist←framelist OVER "fmDataBuild.fData"[104] [105] ⎕wself←"fmDataBuild.fData.cbFILE" ⎕wi "New" "Combo"[106] Fieldlist←Fieldlist OVER "fmDataBuild.fData.cbFILE"[107] Fieldcontrol←Fieldcontrol OVER "Combo"[108] ⎕wi "∆name" "FILE"[109] ⎕wi "∆type" "File"[110] ⎕wi "∆mandatory" 1[111] ⎕wi "∆helpid" 3115[112] ⎕wi "tooltip" "Specify the CSV File containing Data to be Built"[113] ⎕wi "style" 16 128 256 2[114] ⎕wi "∆where" (2 2⍴0.25 0 0.4 0)[115] ⎕wi "where" (("fmDataBuild.fData" ⎕wi "size") Win∆Resize (2 2⍴0.25 0 0.4 0))[116] PickList←GetCSVFiles InputDir[117] ⎕wi "∆update" "GetCSVFiles InputDir"[118] PickList←⊃m2n 1 0↓PickList[119] ⎕wi "list" PickList[120] ⎕wi "extent" (150,(¯10+6×¯1↑CharSize)+¯1↑Win∆TextSize ((0,⎕wi "limit")⌈⍴PickList)↑PickList)[121] ⎕wi "onClick" "0 0⍴(⊂⎕wi 'name') Data_Build 'Change' "[122] [123] ⎕wself←"fmDataBuild.fData.llFILE" ⎕wi "New" "Label"[124] ⎕wi "scale" 5[125] ⎕wi "style" 2[126] ⎕wi "extent" (↑⎕wi "Draw" ("?text" (("⍺",⎕tcnl) char_replace "Data Build⍺Source File")))[127] ⎕wi "caption" (("⍺",⎕tcnl) char_replace "Data Build⍺Source File")[128] where←4↑,"fmDataBuild.fData.cbFILE" ⎕wi "∆where"[129] size←1↑"fmDataBuild.fData.cbFILE" ⎕wi "extent"[130] size←¯3⌈0.5×(1↑⎕wi "extent")-size[131] x←0.5×⍴where←Win∆Calcwhere where-0,size,0,10+¯1↑⎕wi "extent"[132] ⎕wi "∆where" ((x,2)⍴where)[133] ⎕wi "where" (("fmDataBuild.fData" ⎕wi "size") Win∆Resize ⎕wi "∆where")[134] [135] ⎕wself←"fmDataBuild.fData.lsize" ⎕wi "New" "Label"[136] ⎕wi "scale" 5[137] ⎕wi "extent" (CharSize×¯2↑1,20)[138] ⎕wi "style" 32[139] ⎕wi "caption" " "[140] ⎕wi "∆where" (2 2⍴0.3 0 0.4 0)[141] ⎕wi "where" (("fmDataBuild.fData" ⎕wi "size") Win∆Resize (2 2⍴0.3 0 0.4 0))[142] [143] ⎕wself←"fmDataBuild.fData.cbxlFILE" ⎕wi "New" "Combo"[144] Fieldlist←Fieldlist OVER "fmDataBuild.fData.cbxlFILE"[145] Fieldcontrol←Fieldcontrol OVER "Combo"[146] ⎕wi "∆name" "xlFILE"[147] ⎕wi "∆type" "Combo"[148] ⎕wi "∆mandatory" 1[149] ⎕wi "∆helpid" 3116[150] ⎕wi "tooltip" "Select the Data Build Source Excel Filename"[151] ⎕wi "style" 16 128 256 2[152] ⎕wi "∆where" (2 2⍴0.25 0 0.4 0)[153] ⎕wi "where" (("fmDataBuild.fData" ⎕wi "size") Win∆Resize (2 2⍴0.25 0 0.4 0))[154] PickList←GetXLSFiles InputDir[155] ⎕wi "∆update" "GetXLSFiles InputDir"[156] PickList←⊃m2n 1 0↓PickList[157] ⎕wi "list" PickList[158] ⎕wi "extent" (150,(¯10+6×¯1↑CharSize)+¯1↑Win∆TextSize ((0,⎕wi "limit")⌈⍴PickList)↑PickList)[159] ⎕wi "onClick" "0 0⍴(⊂⎕wi 'name') Data_Build 'Change' "[160] [161] ⎕wself←"fmDataBuild.fData.llxlFILE" ⎕wi "New" "Label"[162] ⎕wi "scale" 5[163] ⎕wi "style" 2[164] ⎕wi "extent" (↑⎕wi "Draw" ("?text" (("⍺",⎕tcnl) char_replace "Data Build⍺Source File")))[165] ⎕wi "caption" (("⍺",⎕tcnl) char_replace "Data Build⍺Source File")[166] where←4↑,"fmDataBuild.fData.cbxlFILE" ⎕wi "∆where"[167] size←1↑"fmDataBuild.fData.cbxlFILE" ⎕wi "extent"[168] size←¯3⌈0.5×(1↑⎕wi "extent")-size[169] x←0.5×⍴where←Win∆Calcwhere where-0,size,0,10+¯1↑⎕wi "extent"[170] ⎕wi "∆where" ((x,2)⍴where)[171] ⎕wi "where" (("fmDataBuild.fData" ⎕wi "size") Win∆Resize ⎕wi "∆where")[172] [173] ⎕wself←"fmDataBuild.fData.cbxlSHEET" ⎕wi "New" "Combo"[174] Fieldlist←Fieldlist OVER "fmDataBuild.fData.cbxlSHEET"[175] Fieldcontrol←Fieldcontrol OVER "Combo"[176] ⎕wi "∆name" "xlSHEET"[177] ⎕wi "∆type" "Combo"[178] ⎕wi "∆mandatory" 1[179] ⎕wi "∆helpid" 3117[180] ⎕wi "tooltip" "Select the Excel Sheet containing Member Data"[181] ⎕wi "style" 16 128 256 2[182] ⎕wi "∆where" (2 2⍴0.25 0 0.7 0)[183] ⎕wi "where" (("fmDataBuild.fData" ⎕wi "size") Win∆Resize (2 2⍴0.25 0 0.7 0))[184] PickList←GetSheetNames[185] ⎕wi "∆update" "GetSheetNames"[186] PickList←⊃m2n 1 0↓PickList[187] ⎕wi "list" PickList[188] ⎕wi "extent" (150,(¯10+6×¯1↑CharSize)+¯1↑Win∆TextSize ((0,⎕wi "limit")⌈⍴PickList)↑PickList)[189] ⎕wi "onClick" "0 0⍴(⊂⎕wi 'name') Data_Build 'Change' "[190] [191] ⎕wself←"fmDataBuild.fData.llxlSHEET" ⎕wi "New" "Label"[192] ⎕wi "scale" 5[193] ⎕wi "style" 2[194] ⎕wi "extent" (↑⎕wi "Draw" ("?text" (("⍺",⎕tcnl) char_replace "Excel⍺Sheet Name")))[195] ⎕wi "caption" (("⍺",⎕tcnl) char_replace "Excel⍺Sheet Name")[196] where←4↑,"fmDataBuild.fData.cbxlSHEET" ⎕wi "∆where"[197] size←1↑"fmDataBuild.fData.cbxlSHEET" ⎕wi "extent"[198] size←¯3⌈0.5×(1↑⎕wi "extent")-size[199] x←0.5×⍴where←Win∆Calcwhere where-0,size,0,10+¯1↑⎕wi "extent"[200] ⎕wi "∆where" ((x,2)⍴where)[201] ⎕wi "where" (("fmDataBuild.fData" ⎕wi "size") Win∆Resize ⎕wi "∆where")[202] [203] ⎕wself←"fmDataBuild.fData.cbExpFormat" ⎕wi "New" "Combo"[204] Fieldlist←Fieldlist OVER "fmDataBuild.fData.cbExpFormat"[205] Fieldcontrol←Fieldcontrol OVER "Combo"[206] ⎕wi "∆name" "ExpFormat"[207] ⎕wi "∆type" "Combo"[208] ⎕wi "∆mandatory" 1[209] ⎕wi "∆helpid" 3118[210] ⎕wi "tooltip" "Specify the Format of the Data Build Source File"[211] ⎕wi "style" 16 128 256 2[212] ⎕wi "∆where" (2 2⍴0.15 0 0.4 0)[213] ⎕wi "where" (("fmDataBuild.fData" ⎕wi "size") Win∆Resize (2 2⍴0.15 0 0.4 0))[214] PickList←⍙POPUPSdict ReadDictFile "ExportFormat"[215] PickList←⊃m2n 1 0↓PickList[216] ⎕wi "list" PickList[217] ⎕wi "extent" (150,(¯10+6×¯1↑CharSize)+¯1↑Win∆TextSize ((0,⎕wi "limit")⌈⍴PickList)↑PickList)[218] ⎕wi "onClick" "0 0⍴(⊂⎕wi 'name') Data_Build 'Change' "[219] [220] ⎕wself←"fmDataBuild.fData.llExpFormat" ⎕wi "New" "Label"[221] ⎕wi "scale" 5[222] ⎕wi "style" 2[223] ⎕wi "extent" (↑⎕wi "Draw" ("?text" "Format of Source File"))[224] ⎕wi "caption" "Format of Source File"[225] where←4↑,"fmDataBuild.fData.cbExpFormat" ⎕wi "∆where"[226] x←0.5×⍴where←Win∆Calcwhere where-0 ¯3 0,10+¯1↑⎕wi "extent"[227] ⎕wi "∆where" ((x,2)⍴where)[228] ⎕wi "where" (("fmDataBuild.fData" ⎕wi "size") Win∆Resize ⎕wi "∆where")[229] PickList←⍙POPUPSdict ReadDictFile "InputType"[230] :if 0∊⍴,Header←"" ⋄ Header←DLTB PickList[1;] ⋄ :endif[231] no←1↑⍴PickList←1 0↓PickList[232] [233] ⎕wself←"fmDataBuild.fData.fmembtype" ⎕wi "New" "Frame"[234] ⎕wi "scale" 5[235] ⎕wi "∆where" (4 2⍴0.4 0 0.4 0 0.2 0 0.2 0)[236] ⎕wi "where" (("fmDataBuild.fData" ⎕wi "size") Win∆Resize (4 2⍴0.4 0 0.4 0 0.2 0 0.2 0))[237] ⎕wi "caption" "Input Type"[238] ⎕wi "style" 0[239] ⎕wi "onResize" "AutoResize"[240] ⎕wi "tooltip" "Select the Member Type"[241] [242] where←(0×1 0 1 0\0.4 0.4 )+0 1 0 1\25,10×1[243] alignment←1 0 ⋄ FrameWidth←10+¯1↑Win∆TextSize Header[244] :for nn :in ⍳no[245]     ⎕wself←(Name←"fmDataBuild.fData.fmembtype.opmembtype_",⍕nn) ⎕wi "New" "Option"[246]     :if nn=1 ⋄ ⎕wi "∆lastoption" ("fmDataBuild.fData.fmembtype.opmembtype_",⍕no) ⋄ :endif[247]     size←0.5×⍴x←Win∆Calcwhere where[248]     x←(size,2)⍴x[249]     ⎕wi "∆where" x[250]     ⎕wi "where" (("fmDataBuild.fData.fmembtype" ⎕wi "size") Win∆Resize x)[251]     ⎕wi "caption" (Caption←DLTB PickList[nn;])[252]     FrameWidth←FrameWidth⌈10+¯1↑size←0 25+Win∆TextSize Caption[253]     where←where+0 1 0 1\alignment×10 20+size[254]     ⎕wi "extent" size[255]     ⎕wi "tooltip" "Select the Member Type"[256]     ⎕wi "onClick" "(0 0⍴(⊂⎕wi 'name') Data_Build 'Change' )"[257]     ⎕wi "∆helpid" 3119[258] :endfor[259] ⎕wi "∆type" "Option"[260] ⎕wi "∆mandatory" 1[261] ⎕wi "∆name" "membtype"[262] ⎕wi "∆options" "⍺Actives ⍺Deferreds ⍺Pensioners"[263] Fieldlist←Fieldlist OVER Name[264] Fieldcontrol←Fieldcontrol OVER "Option"[265] :if 1[266]     ⎕wself←"fmDataBuild.fData.fmembtype"[267]     size←0.5×⍴x←Win∆Calcwhere 0.4 0 0.4 0,0 1 0 1×where+(2/⌽alignment)×0 25 0,FrameWidth[268]     x←(size,2)⍴x[269]     ⎕wi "∆where" x[270]     ⎕wi "where" (("fmDataBuild.fData" ⎕wi "size") Win∆Resize x)[271] :endif[272] [273] ⎕wself←"fmDataBuild.fData.picStandard" ⎕wi "New" "Picture"[274] Fieldlist←Fieldlist OVER "fmDataBuild.fData.picStandard"[275] Fieldcontrol←Fieldcontrol OVER "Picture"[276] ⎕wi "∆name" "Standard"[277] ⎕wi "∆type" "Picture"[278] ⎕wi "scale" 5[279] ⎕wi "style" 4[280] ⎕wi "∆where" (4 2⍴0.3 0 0.05 0 0.45 0 0.1 0)[281] ⎕wi "where" (("fmDataBuild.fData" ⎕wi "size") Win∆Resize (4 2⍴0.3 0 0.05 0 0.45 0 0.1 0))[282] ⎕wi "imagesize" (⎕wi "size")[283] ⎕wi "onResize" "⎕wi 'imagesize' (⎕wi 'size')"[284] ⎕wi "bitmap" (StyleDir,"dbw_std.bmp")[285] [286] ⎕wself←"fmDataBuild.fData.picWarn" ⎕wi "New" "Picture"[287] Fieldlist←Fieldlist OVER "fmDataBuild.fData.picWarn"[288] Fieldcontrol←Fieldcontrol OVER "Picture"[289] ⎕wi "∆name" "Warn"[290] ⎕wi "∆type" "Picture"[291] ⎕wi "scale" 5[292] ⎕wi "style" 4[293] ⎕wi "∆where" (4 2⍴0.3 0 0.05 0 0.45 0 0.1 0)[294] ⎕wi "where" (("fmDataBuild.fData" ⎕wi "size") Win∆Resize (4 2⍴0.3 0 0.05 0 0.45 0 0.1 0))[295] ⎕wi "imagesize" (⎕wi "size")[296] ⎕wi "onResize" "⎕wi 'imagesize' (⎕wi 'size')"[297] ⎕wi "bitmap" (StyleDir,"dbw_wrn.bmp")[298] [299] ⎕wself←"fmDataBuild.fData.picError" ⎕wi "New" "Picture"[300] Fieldlist←Fieldlist OVER "fmDataBuild.fData.picError"[301] Fieldcontrol←Fieldcontrol OVER "Picture"[302] ⎕wi "∆name" "Error"[303] ⎕wi "∆type" "Picture"[304] ⎕wi "scale" 5[305] ⎕wi "style" 4[306] ⎕wi "∆where" (4 2⍴0.3 0 0.05 0 0.45 0 0.1 0)[307] ⎕wi "where" (("fmDataBuild.fData" ⎕wi "size") Win∆Resize (4 2⍴0.3 0 0.05 0 0.45 0 0.1 0))[308] ⎕wi "imagesize" (⎕wi "size")[309] ⎕wi "onResize" "⎕wi 'imagesize' (⎕wi 'size')"[310] ⎕wi "bitmap" (StyleDir,"dbw_err.bmp")[311] [312] ⎕wself←"fmDataBuild.fData.ckgrouped" ⎕wi "New" "Check"[313] Fieldlist←Fieldlist OVER "fmDataBuild.fData.ckgrouped"[314] Fieldcontrol←Fieldcontrol OVER "Check"[315] ⎕wi "∆name" "grouped"[316] ⎕wi "∆type" "Check"[317] ⎕wi "∆helpid" 3120[318] ⎕wi "tooltip" "Indicate if you are using Grouped Data or will use the New Entrant Replacement Model"[319] ⎕wi "style" 0[320] ⎕wi "caption" "Using Grouped Data or will use the New Entrant Replacement Model"[321] ⎕wi "∆where" (2 2⍴0.65 0 0.4 0)[322] ⎕wi "where" (("fmDataBuild.fData" ⎕wi "size") Win∆Resize (2 2⍴0.65 0 0.4 0))[323] ⎕wi "extent" ((0 5×CharSize)+Win∆TextSize ⎕wi "caption")[324] ⎕wi "onClick" "(0 0⍴(⊂⎕wi 'name') Data_Build 'Change' )"[325] [326] ⎕wself←"fmDataBuild.fData.ckuseguess" ⎕wi "New" "Check"[327] Fieldlist←Fieldlist OVER "fmDataBuild.fData.ckuseguess"[328] Fieldcontrol←Fieldcontrol OVER "Check"[329] ⎕wi "∆name" "useguess"[330] ⎕wi "∆type" "Check"[331] ⎕wi "∆helpid" 3121[332] ⎕wi "tooltip" "Indicate if you want SuperVal to 'guess' some Standard Field mappings based on words in the Field Names"[333] ⎕wi "style" 0[334] ⎕wi "caption" "Allow SuperVal to 'guess' some suggested Standard Field mappings"[335] ⎕wi "∆where" (2 2⍴0.8 0 0.4 0)[336] ⎕wi "where" (("fmDataBuild.fData" ⎕wi "size") Win∆Resize (2 2⍴0.8 0 0.4 0))[337] ⎕wi "extent" ((0 5×CharSize)+Win∆TextSize ⎕wi "caption")[338] ⎕wi "onClick" "(0 0⍴(⊂⎕wi 'name') Data_Build 'Change' )"[339] list←list OVER "fmDataBuild.fData.bnData_BuildEdit"[340] ⎕wself←"fmDataBuild.fData.bnData_BuildEdit" ⎕wi "New" "Button"[341] ⎕wi "enabled" (0 )[342] ⎕wi "extent" (size←1.4 1.107692308×buttonsize×1⌈CharSize÷13 6)[343] ⎕wi "∆where" (2 2⍴0.9 0 0.05 0)[344] ⎕wi "where" (("fmDataBuild.fData" ⎕wi "size") Win∆Resize (2 2⍴0.9 0 0.05 0))[345] ⎕wi "tooltip" "Edit Data Source in Excel"[346] ⎕wi "onClick" ("fmSV.mData_BuildFile.mEdit"⎕wi "onClick")[347] ⎕wi "∆helpid" 3122[348] ⎕wi "caption" (("⍺",⎕tcnl) char_replace "Edit Source⍺File")[349] :if buttonimage[350]     ⎕wi "imagelist" "fmSV.iStandard"[351]     ⎕wi "imageindex" 34[352] :endif[353] list←list OVER "fmDataBuild.fData.bnData_BuildImport"[354] ⎕wself←"fmDataBuild.fData.bnData_BuildImport" ⎕wi "New" "Button"[355] ⎕wi "extent" (size←1.4 1.107692308×buttonsize×1⌈CharSize÷13 6)[356] ⎕wi "∆where" (2 2⍴0.9 0 0.4 0)[357] ⎕wi "where" (("fmDataBuild.fData" ⎕wi "size") Win∆Resize (2 2⍴0.9 0 0.4 0))[358] ⎕wi "tooltip" "Import Field Mappings from another Scheme"[359] ⎕wi "onClick" ("fmSV.mData_BuildFile.mImport"⎕wi "onClick")[360] ⎕wi "∆helpid" 3123[361] ⎕wi "caption" (("⍺",⎕tcnl) char_replace "Import Field⍺Mappings")[362] [363] :if 300<fnsize[364]     ((1↑⎕lc) fnsize "Frame - File Name") Win∆ProgressBar "MemberUpdate"[365] :endif[366] [367] ⎕wself←"fmDataBuild.fFields" ⎕wi "New" "Frame"[368] ⎕wi "scale" 5[369] ⎕wi "∆where" (4 2⍴0 0 0 0 1 ¯45 1 0)[370] ⎕wi "where" (("fmDataBuild" ⎕wi "size") Win∆Resize (4 2⍴0 0 0 0 1 ¯45 1 0))[371] ⎕wi "caption" "File Name"[372] ⎕wi "style" 7[373] ⎕wi "onResize" "AutoResize"[374] framelist←framelist OVER "fmDataBuild.fFields"[375] [376] ⎕wself←"fmDataBuild.fFields.lvStandard" ⎕wi "New" "Listview"[377] Fieldlist←Fieldlist OVER "fmDataBuild.fFields.lvStandard"[378] Fieldcontrol←Fieldcontrol OVER "Listview"[379] ⎕wi "∆name" "Standard"[380] ⎕wi "∆type" "Listview"[381] ⎕wi "∆helpid" 3124[382] ⎕wi "tooltip" "List of Standard Data Fields contained in Data Source"[383] list←list OVER "fmDataBuild.fFields.lvStandard"[384] ⎕wi "scale" 5[385] ⎕wi "viewmode" "report"[386] ⎕wi "style" 1 4 8[387] ⎕wi "∆where" (4 2⍴0.05 0 0.2 0 0.3 0 0.45 0)[388] ⎕wi "where" (("fmDataBuild.fFields" ⎕wi "size") Win∆Resize (4 2⍴0.05 0 0.2 0 0.3 0 0.45 0))[389] ⎕wi "∆update" "'' GetFieldNames 'Standard'"[390] (PickList NameList sortorder SortList)←4↑'' GetFieldNames 'Standard'[391] ⎕wi "list" PickList[392] NameList[;1]←NameList[;1],¨⊂4↑" "[393] ⎕wi "columndisplay" NameList[394] ⎕wi "AutoFit" "header" "all"[395] ⎕wi "∆sortorder" sortorder[396] ⎕wi "∆sortlist" SortList[397] ⎕wi "onColClick" "('fmDataBuild.fFields.lvStandard' 'Data_Build') Win∆SortListview ⎕warg"[398] :if 0=⎕nc "listviewDict"[399] listviewDict←MATRIX keysIn ListviewDict[400] :endif[401] :if ~mt sortorder←DLTB ↑((ListviewDict for "Control" "fmDataBuild.fFields.lvStandard") for "Parameters" "") at "Sort"[402] ("fmDataBuild.fFields.lvStandard" "Data_Build") Win∆SortListview sortorder[403] :else[404] ("fmDataBuild.fFields.lvStandard" "Data_Build") Win∆SortListview "SuperVal Field Name"[405] :endif[406] ⎕wi "onResize" "Win∆SizeListview ⎕wi 'self'"[407] ⎕wi "onSelect" "0 0⍴(⊂⎕wi 'name') Data_Build 'Change' "[408] ⎕wi "onExit" "⎕wres←0 List∆CHECK 'fmDataBuild.fFields.lvStandard'"[409] ⎕wi "onExitError" "Win∆ExitError ⎕warg"[410] [411] ⎕wself←"fmDataBuild.fFields.llStandard" ⎕wi "New" "Label"[412] ⎕wi "scale" 5[413] ⎕wi "style" 2[414] ⎕wi "extent" (↑⎕wi "Draw" ("?text" "Standard Fields in Data Source"))[415] ⎕wi "caption" "Standard Fields in Data Source"[416] where←4↑,"fmDataBuild.fFields.lvStandard" ⎕wi "∆where"[417] x←0.5×⍴where←Win∆Calcwhere where-0,(5+1↑⎕wi "extent"),0 0[418] ⎕wi "∆where" ((x,2)⍴where)[419] ⎕wi "where" (("fmDataBuild.fFields" ⎕wi "size") Win∆Resize ⎕wi "∆where")[420] list←list OVER "fmDataBuild.fFields.bnData_BuildRemove"[421] ⎕wself←"fmDataBuild.fFields.bnData_BuildRemove" ⎕wi "New" "Button"[422] ⎕wi "enabled" (0 )[423] ⎕wi "extent" (size←1.4 1.107692308×buttonsize×1⌈CharSize÷13 6)[424] ⎕wi "∆where" (2 2⍴0.3 0 0.67 0)[425] ⎕wi "where" (("fmDataBuild.fFields" ⎕wi "size") Win∆Resize (2 2⍴0.3 0 0.67 0))[426] ⎕wi "tooltip" "Remove the Selected Mapped Field from the list of Standard Fields"[427] ⎕wi "onClick" ("fmSV.mData_BuildFile.mRemove"⎕wi "onClick")[428] ⎕wi "∆helpid" 3125[429] ⎕wi "caption" (("⍺",⎕tcnl) char_replace "Remove⍺Mapped Field")[430] [431] ⎕wself←"fmDataBuild.fFields.lvUserDefined" ⎕wi "New" "Listview"[432] Fieldlist←Fieldlist OVER "fmDataBuild.fFields.lvUserDefined"[433] Fieldcontrol←Fieldcontrol OVER "Listview"[434] ⎕wi "∆name" "UserDefined"[435] ⎕wi "∆type" "Listview"[436] ⎕wi "∆helpid" 3126[437] ⎕wi "tooltip" "List of User-Defined Data Fields contained in Data Source"[438] list←list OVER "fmDataBuild.fFields.lvUserDefined"[439] ⎕wi "scale" 5[440] ⎕wi "viewmode" "report"[441] ⎕wi "style" 1 4 8[442] ⎕wi "∆where" (4 2⍴0.4 0 0.2 0 0.6 ¯45 0.25 0)[443] ⎕wi "where" (("fmDataBuild.fFields" ⎕wi "size") Win∆Resize (4 2⍴0.4 0 0.2 0 0.6 ¯45 0.25 0))[444] ⎕wi "∆update" "'' GetFieldNames 'UserDefined'"[445] (PickList NameList sortorder SortList)←4↑'' GetFieldNames 'UserDefined'[446] ⎕wi "list" PickList[447] NameList[;1]←NameList[;1],¨⊂4↑" "[448] ⎕wi "columndisplay" NameList[449] ⎕wi "AutoFit" "header" "all"[450] ⎕wi "∆sortorder" sortorder[451] ⎕wi "∆sortlist" SortList[452] ⎕wi "onColClick" "('fmDataBuild.fFields.lvUserDefined' 'Data_Build') Win∆SortListview ⎕warg"[453] :if 0=⎕nc "listviewDict"[454] listviewDict←MATRIX keysIn ListviewDict[455] :endif[456] :if ~mt sortorder←DLTB ↑((ListviewDict for "Control" "fmDataBuild.fFields.lvUserDefined") for "Parameters" "") at "Sort"[457] ("fmDataBuild.fFields.lvUserDefined" "Data_Build") Win∆SortListview sortorder[458] :else[459] ("fmDataBuild.fFields.lvUserDefined" "Data_Build") Win∆SortListview "Data Field Name"[460] :endif[461] ⎕wi "onResize" "Win∆SizeListview ⎕wi 'self'"[462] ⎕wi "onSelect" "0 0⍴(⊂⎕wi 'name') Data_Build 'Change' "[463] ⎕wi "onExit" "⎕wres←0 List∆CHECK 'fmDataBuild.fFields.lvUserDefined'"[464] ⎕wi "onExitError" "Win∆ExitError ⎕warg"[465] [466] ⎕wself←"fmDataBuild.fFields.llUserDefined" ⎕wi "New" "Label"[467] ⎕wi "scale" 5[468] ⎕wi "style" 2[469] ⎕wi "extent" (↑⎕wi "Draw" ("?text" "User-Defined Fields in Data Source"))[470] ⎕wi "caption" "User-Defined Fields in Data Source"[471] where←4↑,"fmDataBuild.fFields.lvUserDefined" ⎕wi "∆where"[472] x←0.5×⍴where←Win∆Calcwhere where-0,(5+1↑⎕wi "extent"),0 0[473] ⎕wi "∆where" ((x,2)⍴where)[474] ⎕wi "where" (("fmDataBuild.fFields" ⎕wi "size") Win∆Resize ⎕wi "∆where")[475] [476] ⎕wself←"fmDataBuild.fFields.lvExcluded" ⎕wi "New" "Listview"[477] Fieldlist←Fieldlist OVER "fmDataBuild.fFields.lvExcluded"[478] Fieldcontrol←Fieldcontrol OVER "Listview"[479] ⎕wi "∆name" "Excluded"[480] ⎕wi "∆type" "Listview"[481] ⎕wi "∆helpid" 3127[482] ⎕wi "tooltip" "List of Standard Data Fields not in Data Source"[483] list←list OVER "fmDataBuild.fFields.lvExcluded"[484] ⎕wi "scale" 5[485] ⎕wi "viewmode" "report"[486] ⎕wi "style" 1 4 8[487] ⎕wi "∆where" (4 2⍴0.4 0 0.6 0 0.6 ¯45 0.35 0)[488] ⎕wi "where" (("fmDataBuild.fFields" ⎕wi "size") Win∆Resize (4 2⍴0.4 0 0.6 0 0.6 ¯45 0.35 0))[489] ⎕wi "∆update" "'' GetFieldNames 'Excluded'"[490] (PickList NameList sortorder SortList)←4↑'' GetFieldNames 'Excluded'[491] ⎕wi "list" PickList[492] NameList[;1]←NameList[;1],¨⊂4↑" "[493] ⎕wi "columndisplay" NameList[494] ⎕wi "AutoFit" "header" "all"[495] ⎕wi "∆sortorder" sortorder[496] ⎕wi "∆sortlist" SortList[497] ⎕wi "onColClick" "('fmDataBuild.fFields.lvExcluded' 'Data_Build') Win∆SortListview ⎕warg"[498] :if 0=⎕nc "listviewDict"[499] listviewDict←MATRIX keysIn ListviewDict[500] :endif[501] :if ~mt sortorder←DLTB ↑((ListviewDict for "Control" "fmDataBuild.fFields.lvExcluded") for "Parameters" "") at "Sort"[502] ("fmDataBuild.fFields.lvExcluded" "Data_Build") Win∆SortListview sortorder[503] :else[504] ("fmDataBuild.fFields.lvExcluded" "Data_Build") Win∆SortListview "SuperVal Field Name"[505] :endif[506] ⎕wi "onResize" "Win∆SizeListview ⎕wi 'self'"[507] ⎕wi "onSelect" "0 0⍴(⊂⎕wi 'name') Data_Build 'Change' "[508] ⎕wi "onExit" "⎕wres←0 List∆CHECK 'fmDataBuild.fFields.lvExcluded'"[509] ⎕wi "onExitError" "Win∆ExitError ⎕warg"[510] [511] ⎕wself←"fmDataBuild.fFields.llExcluded" ⎕wi "New" "Label"[512] ⎕wi "scale" 5[513] ⎕wi "style" 2[514] ⎕wi "extent" (↑⎕wi "Draw" ("?text" "Standard Fields Not Present"))[515] ⎕wi "caption" "Standard Fields Not Present"[516] where←4↑,"fmDataBuild.fFields.lvExcluded" ⎕wi "∆where"[517] x←0.5×⍴where←Win∆Calcwhere where-0,(5+1↑⎕wi "extent"),0 0[518] ⎕wi "∆where" ((x,2)⍴where)[519] ⎕wi "where" (("fmDataBuild.fFields" ⎕wi "size") Win∆Resize ⎕wi "∆where")[520] list←list OVER "fmDataBuild.fFields.bnData_BuildChange"[521] ⎕wself←"fmDataBuild.fFields.bnData_BuildChange" ⎕wi "New" "Button"[522] ⎕wi "enabled" (0 )[523] ⎕wi "extent" (size←1.4 1.107692308×buttonsize×1⌈CharSize÷13 6)[524] ⎕wi "∆where" (2 2⍴0.37 0 0.5 0)[525] ⎕wi "where" (("fmDataBuild.fFields" ⎕wi "size") Win∆Resize (2 2⍴0.37 0 0.5 0))[526] ⎕wi "tooltip" "Change the Data Field Type of the Selected Standard or User-Defined Field"[527] ⎕wi "onClick" ("fmSV.mData_BuildFile.mChange"⎕wi "onClick")[528] ⎕wi "∆helpid" 3128[529] ⎕wi "caption" (("⍺",⎕tcnl) char_replace "Change Data⍺Field Type")[530] list←list OVER "fmDataBuild.fFields.bnData_BuildAdd"[531] ⎕wself←"fmDataBuild.fFields.bnData_BuildAdd" ⎕wi "New" "Button"[532] ⎕wi "enabled" (0 )[533] ⎕wi "extent" (size←1.4 1.107692308×buttonsize×1⌈CharSize÷13 6)[534] ⎕wi "∆where" (2 2⍴0.6 0 0.5 0)[535] ⎕wi "where" (("fmDataBuild.fFields" ⎕wi "size") Win∆Resize (2 2⍴0.6 0 0.5 0))[536] ⎕wi "tooltip" "Add the Selected User-Defined Field as the Selected Standard Field"[537] ⎕wi "onClick" ("fmSV.mData_BuildFile.mAdd"⎕wi "onClick")[538] ⎕wi "∆helpid" 3129[539] ⎕wi "caption" (("⍺",⎕tcnl) char_replace "Map Field⍺as Standard")[540] PickList←⍙POPUPSdict ReadDictFile "Freq"[541] :if 0∊⍴,Header←"Payment Frequency" ⋄ Header←DLTB PickList[1;] ⋄ :endif[542] no←1↑⍴PickList←1 0↓PickList[543] [544] ⎕wself←"fmDataBuild.fFields.ffreq" ⎕wi "New" "Frame"[545] ⎕wi "scale" 5[546] ⎕wi "∆where" (4 2⍴0.05 0 0.82 0 0.2 0 0.2 0)[547] ⎕wi "where" (("fmDataBuild.fFields" ⎕wi "size") Win∆Resize (4 2⍴0.05 0 0.82 0 0.2 0 0.2 0))[548] ⎕wi "caption" "Payment Frequency"[549] ⎕wi "style" 0[550] ⎕wi "onResize" "AutoResize"[551] ⎕wi "tooltip" "Select the Payment Frequency (of Salaries, PUPs or Pensions)"[552] [553] where←(0×1 0 1 0\0.05 0.82)+0 1 0 1\25,10×1[554] alignment←1 0 ⋄ FrameWidth←10+¯1↑Win∆TextSize Header[555] :for nn :in ⍳no[556]     ⎕wself←(Name←"fmDataBuild.fFields.ffreq.opfreq_",⍕nn) ⎕wi "New" "Option"[557]     :if nn=1 ⋄ ⎕wi "∆lastoption" ("fmDataBuild.fFields.ffreq.opfreq_",⍕no) ⋄ :endif[558]     size←0.5×⍴x←Win∆Calcwhere where[559]     x←(size,2)⍴x[560]     ⎕wi "∆where" x[561]     ⎕wi "where" (("fmDataBuild.fFields.ffreq" ⎕wi "size") Win∆Resize x)[562]     ⎕wi "caption" (Caption←DLTB PickList[nn;])[563]     FrameWidth←FrameWidth⌈10+¯1↑size←0 25+Win∆TextSize Caption[564]     where←where+0 1 0 1\alignment×10 20+size[565]     ⎕wi "extent" size[566]     ⎕wi "tooltip" "Select the Payment Frequency (of Salaries, PUPs or Pensions)"[567]     ⎕wi "onClick" "(0 0⍴(⊂⎕wi 'name') Data_Build 'Change' )"[568]     ⎕wi "∆helpid" 3130[569] :endfor[570] ⎕wi "∆type" "Option"[571] ⎕wi "∆mandatory" 1[572] ⎕wi "∆name" "freq"[573] ⎕wi "∆options" "⍺Annual ⍺Semi-Annual ⍺Quarterly ⍺Monthly ⍺Lunar-Monthly⍺Fortnightly ⍺Weekly"[574] Fieldlist←Fieldlist OVER Name[575] Fieldcontrol←Fieldcontrol OVER "Option"[576] :if 1[577]     ⎕wself←"fmDataBuild.fFields.ffreq"[578]     size←0.5×⍴x←Win∆Calcwhere 0.05 0 0.82 0,0 1 0 1×where+(2/⌽alignment)×0 25 0,FrameWidth[579]     x←(size,2)⍴x[580]     ⎕wi "∆where" x[581]     ⎕wi "where" (("fmDataBuild.fFields" ⎕wi "size") Win∆Resize x)[582] :endif[583] [584] ⎕wself←"fmDataBuild.fFields.ckblankwarning" ⎕wi "New" "Check"[585] Fieldlist←Fieldlist OVER "fmDataBuild.fFields.ckblankwarning"[586] Fieldcontrol←Fieldcontrol OVER "Check"[587] ⎕wi "∆name" "blankwarning"[588] ⎕wi "∆type" "Check"[589] ⎕wi "∆helpid" 3131[590] ⎕wi "tooltip" "Indicate if you want to include Warnings of Blank Numeric Fields"[591] ⎕wi "style" 0[592] ⎕wi "caption" "Include Warnings of Blank Numeric Fields"[593] ⎕wi "∆where" (2 2⍴0.98 0 0.5 0)[594] ⎕wi "where" (("fmDataBuild.fFields" ⎕wi "size") Win∆Resize (2 2⍴0.98 0 0.5 0))[595] ⎕wi "extent" ((0 5×CharSize)+Win∆TextSize ⎕wi "caption")[596] ⎕wi "onClick" "(0 0⍴(⊂⎕wi 'name') Data_Build 'Change' )"[597] [598] ⎕wself←"fmDataBuild.fFields.picStandard" ⎕wi "New" "Picture"[599] Fieldlist←Fieldlist OVER "fmDataBuild.fFields.picStandard"[600] Fieldcontrol←Fieldcontrol OVER "Picture"[601] ⎕wi "∆name" "Standard"[602] ⎕wi "∆type" "Picture"[603] ⎕wi "scale" 5[604] ⎕wi "style" 4[605] ⎕wi "∆where" (4 2⍴0.3 0 0.05 0 0.45 0 0.1 0)[606] ⎕wi "where" (("fmDataBuild.fFields" ⎕wi "size") Win∆Resize (4 2⍴0.3 0 0.05 0 0.45 0 0.1 0))[607] ⎕wi "imagesize" (⎕wi "size")[608] ⎕wi "onResize" "⎕wi 'imagesize' (⎕wi 'size')"[609] ⎕wi "bitmap" (StyleDir,"dbw_std.bmp")[610] [611] ⎕wself←"fmDataBuild.fFields.picWarn" ⎕wi "New" "Picture"[612] Fieldlist←Fieldlist OVER "fmDataBuild.fFields.picWarn"[613] Fieldcontrol←Fieldcontrol OVER "Picture"[614] ⎕wi "∆name" "Warn"[615] ⎕wi "∆type" "Picture"[616] ⎕wi "scale" 5[617] ⎕wi "style" 4[618] ⎕wi "∆where" (4 2⍴0.3 0 0.05 0 0.45 0 0.1 0)[619] ⎕wi "where" (("fmDataBuild.fFields" ⎕wi "size") Win∆Resize (4 2⍴0.3 0 0.05 0 0.45 0 0.1 0))[620] ⎕wi "imagesize" (⎕wi "size")[621] ⎕wi "onResize" "⎕wi 'imagesize' (⎕wi 'size')"[622] ⎕wi "bitmap" (StyleDir,"dbw_wrn.bmp")[623] [624] ⎕wself←"fmDataBuild.fFields.picError" ⎕wi "New" "Picture"[625] Fieldlist←Fieldlist OVER "fmDataBuild.fFields.picError"[626] Fieldcontrol←Fieldcontrol OVER "Picture"[627] ⎕wi "∆name" "Error"[628] ⎕wi "∆type" "Picture"[629] ⎕wi "scale" 5[630] ⎕wi "style" 4[631] ⎕wi "∆where" (4 2⍴0.3 0 0.05 0 0.45 0 0.1 0)[632] ⎕wi "where" (("fmDataBuild.fFields" ⎕wi "size") Win∆Resize (4 2⍴0.3 0 0.05 0 0.45 0 0.1 0))[633] ⎕wi "imagesize" (⎕wi "size")[634] ⎕wi "onResize" "⎕wi 'imagesize' (⎕wi 'size')"[635] ⎕wi "bitmap" (StyleDir,"dbw_err.bmp")[636] list←list OVER "fmDataBuild.fFields.bnData_BuildEdit"[637] ⎕wself←"fmDataBuild.fFields.bnData_BuildEdit" ⎕wi "New" "Button"[638] ⎕wi "extent" (size←1.4 1.107692308×buttonsize×1⌈CharSize÷13 6)[639] ⎕wi "∆where" (2 2⍴0.9 0 0.05 0)[640] ⎕wi "where" (("fmDataBuild.fFields" ⎕wi "size") Win∆Resize (2 2⍴0.9 0 0.05 0))[641] ⎕wi "tooltip" "Edit Data Source in Excel"[642] ⎕wi "onClick" ("fmSV.mData_BuildFile.mEdit"⎕wi "onClick")[643] ⎕wi "∆helpid" 3122[644] ⎕wi "caption" (("⍺",⎕tcnl) char_replace "Edit Source⍺File")[645] :if buttonimage[646]     ⎕wi "imagelist" "fmSV.iStandard"[647]     ⎕wi "imageindex" 34[648] :endif[649] [650] :if 300<fnsize[651]     ((1↑⎕lc) fnsize "Frame - Error Report on Data") Win∆ProgressBar "MemberUpdate"[652] :endif[653] [654] ⎕wself←"fmDataBuild.fReport" ⎕wi "New" "Frame"[655] ⎕wi "scale" 5[656] ⎕wi "∆where" (4 2⍴0 0 0 0 1 ¯45 1 0)[657] ⎕wi "where" (("fmDataBuild" ⎕wi "size") Win∆Resize (4 2⍴0 0 0 0 1 ¯45 1 0))[658] ⎕wi "caption" "Error Report on Data"[659] ⎕wi "style" 7[660] ⎕wi "onResize" "AutoResize"[661] framelist←framelist OVER "fmDataBuild.fReport"[662] [663] ⎕wself←"fmDataBuild.fReport.edResults" ⎕wi "New" "Edit"[664] Fieldlist←Fieldlist OVER "fmDataBuild.fReport.edResults"[665] Fieldcontrol←Fieldcontrol OVER "Edit"[666] ⎕wi "∆name" "Results"[667] ⎕wi "∆type" "Multi"[668] ⎕wi "style" 4096[669] ⎕wi "∆helpid" 3132[670] ⎕wi "tooltip" "Report on the Data Validation"[671] ⎕wi "∆name" "Results"[672] ⎕wi "scale" 5[673] ⎕wi "style" ((⎕wi "style"),4 16 2048 8192 64 )[674] ⎕wi "∆where" (4 2⍴0.05 0 0.25 0 0.9 0 0.7 0)[675] ⎕wi "where" (("fmDataBuild.fReport" ⎕wi "size") Win∆Resize (4 2⍴0.05 0 0.25 0 0.9 0 0.7 0))[676] [677] ⎕wself←"fmDataBuild.fReport.llResults" ⎕wi "New" "Label"[678] ⎕wi "scale" 5[679] ⎕wi "style" 2[680] ⎕wi "extent" (↑⎕wi "Draw" ("?text" "Validation Report"))[681] ⎕wi "caption" "Validation Report"[682] where←4↑,"fmDataBuild.fReport.edResults" ⎕wi "∆where"[683] x←0.5×⍴where←Win∆Calcwhere where-0,(5+1↑⎕wi "extent"),0 0[684] ⎕wi "∆where" ((x,2)⍴where)[685] ⎕wi "where" (("fmDataBuild.fReport" ⎕wi "size") Win∆Resize ⎕wi "∆where")[686] [687] ⎕wself←"fmDataBuild.fReport.picStandard" ⎕wi "New" "Picture"[688] Fieldlist←Fieldlist OVER "fmDataBuild.fReport.picStandard"[689] Fieldcontrol←Fieldcontrol OVER "Picture"[690] ⎕wi "∆name" "Standard"[691] ⎕wi "∆type" "Picture"[692] ⎕wi "scale" 5[693] ⎕wi "style" 4[694] ⎕wi "∆where" (4 2⍴0.3 0 0.05 0 0.45 0 0.1 0)[695] ⎕wi "where" (("fmDataBuild.fReport" ⎕wi "size") Win∆Resize (4 2⍴0.3 0 0.05 0 0.45 0 0.1 0))[696] ⎕wi "imagesize" (⎕wi "size")[697] ⎕wi "onResize" "⎕wi 'imagesize' (⎕wi 'size')"[698] ⎕wi "bitmap" (StyleDir,"dbw_std.bmp")[699] [700] ⎕wself←"fmDataBuild.fReport.picWarn" ⎕wi "New" "Picture"[701] Fieldlist←Fieldlist OVER "fmDataBuild.fReport.picWarn"[702] Fieldcontrol←Fieldcontrol OVER "Picture"[703] ⎕wi "∆name" "Warn"[704] ⎕wi "∆type" "Picture"[705] ⎕wi "scale" 5[706] ⎕wi "style" 4[707] ⎕wi "∆where" (4 2⍴0.3 0 0.05 0 0.45 0 0.1 0)[708] ⎕wi "where" (("fmDataBuild.fReport" ⎕wi "size") Win∆Resize (4 2⍴0.3 0 0.05 0 0.45 0 0.1 0))[709] ⎕wi "imagesize" (⎕wi "size")[710] ⎕wi "onResize" "⎕wi 'imagesize' (⎕wi 'size')"[711] ⎕wi "bitmap" (StyleDir,"dbw_wrn.bmp")[712] [713] ⎕wself←"fmDataBuild.fReport.picError" ⎕wi "New" "Picture"[714] Fieldlist←Fieldlist OVER "fmDataBuild.fReport.picError"[715] Fieldcontrol←Fieldcontrol OVER "Picture"[716] ⎕wi "∆name" "Error"[717] ⎕wi "∆type" "Picture"[718] ⎕wi "scale" 5[719] ⎕wi "style" 4[720] ⎕wi "∆where" (4 2⍴0.3 0 0.05 0 0.45 0 0.1 0)[721] ⎕wi "where" (("fmDataBuild.fReport" ⎕wi "size") Win∆Resize (4 2⍴0.3 0 0.05 0 0.45 0 0.1 0))[722] ⎕wi "imagesize" (⎕wi "size")[723] ⎕wi "onResize" "⎕wi 'imagesize' (⎕wi 'size')"[724] ⎕wi "bitmap" (StyleDir,"dbw_err.bmp")[725] list←list OVER "fmDataBuild.fReport.bnData_BuildEdit"[726] ⎕wself←"fmDataBuild.fReport.bnData_BuildEdit" ⎕wi "New" "Button"[727] ⎕wi "extent" (size←1.4 1.107692308×buttonsize×1⌈CharSize÷13 6)[728] ⎕wi "∆where" (2 2⍴0.9 0 0.05 0)[729] ⎕wi "where" (("fmDataBuild.fReport" ⎕wi "size") Win∆Resize (2 2⍴0.9 0 0.05 0))[730] ⎕wi "tooltip" "Edit Data Source in Excel"[731] ⎕wi "onClick" ("fmSV.mData_BuildFile.mEdit"⎕wi "onClick")[732] ⎕wi "∆helpid" 3122[733] ⎕wi "caption" (("⍺",⎕tcnl) char_replace "Edit Source⍺File")[734] :if buttonimage[735]     ⎕wi "imagelist" "fmSV.iStandard"[736]     ⎕wi "imageindex" 34[737] :endif[738] [739] :if 300<fnsize[740]     ((1↑⎕lc) fnsize "Frame - Numeric Field Checksums") Win∆ProgressBar "MemberUpdate"[741] :endif[742] [743] ⎕wself←"fmDataBuild.fCheckSum" ⎕wi "New" "Frame"[744] ⎕wi "scale" 5[745] ⎕wi "∆where" (4 2⍴0 0 0 0 1 ¯45 1 0)[746] ⎕wi "where" (("fmDataBuild" ⎕wi "size") Win∆Resize (4 2⍴0 0 0 0 1 ¯45 1 0))[747] ⎕wi "caption" "Numeric Field Checksums"[748] ⎕wi "style" 7[749] ⎕wi "onResize" "AutoResize"[750] framelist←framelist OVER "fmDataBuild.fCheckSum"[751] [752] ⎕wself←"fmDataBuild.fCheckSum.lvSums" ⎕wi "New" "Listview"[753] Fieldlist←Fieldlist OVER "fmDataBuild.fCheckSum.lvSums"[754] Fieldcontrol←Fieldcontrol OVER "Listview"[755] ⎕wi "∆name" "Sums"[756] ⎕wi "∆type" "Listview"[757] ⎕wi "∆helpid" 3133[758] ⎕wi "tooltip" "Sums of all Numeric Fields by Sex and Category"[759] list←list OVER "fmDataBuild.fCheckSum.lvSums"[760] ⎕wi "scale" 5[761] ⎕wi "viewmode" "report"[762] ⎕wi "style" 1 4 8[763] ⎕wi "∆where" (4 2⍴0.05 0 0.05 0 0.85 0 0.9 0)[764] ⎕wi "where" (("fmDataBuild.fCheckSum" ⎕wi "size") Win∆Resize (4 2⍴0.05 0 0.05 0 0.85 0 0.9 0))[765] ⎕wi "∆update" "GetCheckSums ''"[766] (PickList NameList sortorder SortList)←4↑GetCheckSums ''[767] ⎕wi "list" PickList[768] NameList[;1]←NameList[;1],¨⊂4↑" "[769] ⎕wi "columndisplay" NameList[770] ⎕wi "AutoFit" "header" "all"[771] ⎕wi "∆sortorder" sortorder[772] ⎕wi "∆sortlist" SortList[773] ⎕wi "onColClick" "('fmDataBuild.fCheckSum.lvSums' 'Data_Build') Win∆SortListview ⎕warg"[774] :if 0=⎕nc "listviewDict"[775] listviewDict←MATRIX keysIn ListviewDict[776] :endif[777] :if ~mt sortorder←DLTB ↑((ListviewDict for "Control" "fmDataBuild.fCheckSum.lvSums") for "Parameters" "") at "Sort"[778] ("fmDataBuild.fCheckSum.lvSums" "Data_Build") Win∆SortListview sortorder[779] :else[780] ("fmDataBuild.fCheckSum.lvSums" "Data_Build") Win∆SortListview "Category/Sex"[781] :endif[782] ⎕wi "onResize" "Win∆SizeListview ⎕wi 'self'"[783] ⎕wi "onSelect" "0 0⍴(⊂⎕wi 'name') Data_Build 'Change' "[784] ⎕wi "onExit" "⎕wres←0 List∆CHECK 'fmDataBuild.fCheckSum.lvSums'"[785] ⎕wi "onExitError" "Win∆ExitError ⎕warg"[786] [787] ⎕wself←"fmDataBuild.fCheckSum.llSums" ⎕wi "New" "Label"[788] ⎕wi "scale" 5[789] ⎕wi "style" 2[790] ⎕wi "extent" (↑⎕wi "Draw" ("?text" "Checksums of Numeric Fields"))[791] ⎕wi "caption" "Checksums of Numeric Fields"[792] where←4↑,"fmDataBuild.fCheckSum.lvSums" ⎕wi "∆where"[793] x←0.5×⍴where←Win∆Calcwhere where-0,(5+1↑⎕wi "extent"),0 0[794] ⎕wi "∆where" ((x,2)⍴where)[795] ⎕wi "where" (("fmDataBuild.fCheckSum" ⎕wi "size") Win∆Resize ⎕wi "∆where")[796] list←list OVER "fmDataBuild.fCheckSum.bnData_BuildSave"[797] ⎕wself←"fmDataBuild.fCheckSum.bnData_BuildSave" ⎕wi "New" "Button"[798] ⎕wi "extent" (size←1.4 1.107692308×buttonsize×1⌈CharSize÷13 6)[799] ⎕wi "∆where" (2 2⍴0.92 0 0.05 0)[800] ⎕wi "where" (("fmDataBuild.fCheckSum" ⎕wi "size") Win∆Resize (2 2⍴0.92 0 0.05 0))[801] ⎕wi "tooltip" "Save Checksums to a File"[802] ⎕wi "onClick" ("fmSV.mData_BuildFile.mChecksum"⎕wi "onClick")[803] ⎕wi "∆helpid" 3134[804] ⎕wi "caption" (("⍺",⎕tcnl) char_replace "Save⍺Checksums")[805] [806] ⎕wself←"fmDataBuild.fCheckSum.lSummary" ⎕wi "New" "Label"[807] ⎕wi "scale" 5[808] ⎕wi "extent" (CharSize×¯2↑1,120)[809] ⎕wi "style" 32[810] ⎕wi "caption" " "[811] ⎕wi "∆where" (2 2⍴0.94 0 0.25 0)[812] ⎕wi "where" (("fmDataBuild.fCheckSum" ⎕wi "size") Win∆Resize (2 2⍴0.94 0 0.25 0))[813] [814] "fmDataBuild" ⎕wi "∆multifile" ""[815] "fmDataBuild" ⎕wi "∆singlefile" ""[816] "fmDataBuild" ⎕wi "∆format" ""[817] "fmDataBuild" ⎕wi "∆financial" 0[818] "fmDataBuild" ⎕wi "∆relrules" 0[819] "fmDataBuild" ⎕wi "∆parm" 0[820] "fmDataBuild" ⎕wi "∆decr" 0[821] "fmDataBuild" ⎕wi "∆file" 0[822] "fmDataBuild" ⎕wi "∆codefile" CodeFile[823] "fmDataBuild" ⎕wi "∆inputstype" "ClientFile"[824] "fmDataBuild" ⎕wi "∆inputsentry" "Single"[825] "fmDataBuild" ⎕wi "∆savecn" (⍳0)[826] "fmDataBuild" ⎕wi "∆savedesc" ""[827] list←list OVER "fmDataBuild"[828] "fmDataBuild" ⎕wi "∆fieldlist" Fieldlist[829] "fmDataBuild" ⎕wi "∆fieldcontrol" Fieldcontrol[830] childlist←"fmSV" ⎕wi "∆childlist"[831] list←(⊃¯1↑childlist) OVER list[832] childlist[⍴childlist]←⊂list[833] "fmSV" ⎕wi "∆childlist" childlist[834] list←,⎕split list[835] 0 0⍴((∨/¨(⊂".mData_Build")⍷¨list)/list) MultiWI "enabled" 1[836] :if 300<fnsize[837]     (fnsize fnsize ".") Win∆ProgressBar "MemberUpdate"[838]     Win∆ProgressBar "Hide"[839] :endif[840] "Init" OpenParameters "Data_Build"[841] "fmDataBuild.bnData_BuildHelp" ⎕wi "visible" 1[842] "fmDataBuild.bnData_BuildQuit" ⎕wi "visible" 1[843] "#" ⎕wi "focus" "fmDataBuild.fData.cbFILE"[844] "fmDataBuild" ⎕wi "∆framelist" framelist[845] (⎕split 1 0↓framelist) MultiWI "visible" ¯1[846] :if ~0∊⍴,Error←Win∆Initialise "Data_Build"[847]     "Quit" EndModule Module[848]     "fmSV" ⎕wi "pointer" 0[849]     0 0⍴"fmDataBuild" ⎕wi "Delete"[850]     :return[851] :endif[852] :if bar_open←commandbar^"Multi"≡"Single"[853]     bar_open←0×"fmDataBuild.mData_BuildFile.m" Win∆CommandBar "CancelHelp"[854] :endif[855] "fmDataBuild" ⎕wi "Paint"[856] "fmSV" ⎕wi "pointer" 11[857] "fmDataBuild" ⎕wi "onWait" "0 0⍴Data_Build 'Wait' ⋄ 'fmDataBuild' ⎕wi 'modified' 0"[858] 0 0⍴"fmDataBuild" ⎕wi "Wait"[859] 0 0⍴"fmDataBuild" ⎕wi "Delete"[860] "fmSV" ⎕wi "pointer" 0 ∇