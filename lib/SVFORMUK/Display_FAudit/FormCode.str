∇ Container←Form_Make;⎕wself;ControlName;childlist;list;Fieldlist;Fieldcontrol;FrameWidth;Caption;buttonsize;buttonwhere;where;size;alignment;Header;PickList;NameList;value;sortorder;SortList;MaxRow;MaxCol;Parent;level;node;no;nn;NN;x;fnsize;framelist;relTests[1] [2] Fieldlist←Fieldcontrol←list←0 0⍴""[3] "fmSV" ⎕wi "pointer" 13[4] buttonsize←25 65 ⋄ buttonwhere←¯5[5] FormName ⎕wi "caption" ((FormName ⎕wi "caption")," - Display Audit of Factors")[6] "fmSV" ⎕wi "∆caption" (("fmSV" ⎕wi "∆caption"),⊂("fmSV" ⎕wi "caption"))[7] :if 300<fnsize←1↑⍴⎕cr "Form_Make"[8]     "Generating Form" Win∆ProgressBar "Open"[9]     ("Menu Items:" "Form Controls:") Win∆ProgressBar "SetLabels"[10]     (1 1 "Help About") Win∆ProgressBar "FileUpdate"[11] :endif[12] [13] Container←"∆Dialog"[14] [15] ⎕wself←"fmDispFAudit" ⎕wi "New" "Form" "Hide"[16] ⎕wi "caption" ("fmSV" ⎕wi "caption")[17] ⎕wi "scale" 5[18] ⎕wi "font" ("fmSV" ⎕wi "font")[19] ⎕wi "border" 2 32 64[20] ⎕wi "where" (Win∆CentrePos 1 1 ×768 1024×1⌈CharSize÷13 6)[21] ⎕wi "limitwhere" (0.8×¯2↑⎕wi "where")[22] ⎕wi "tooltipwidth" 200[23] ⎕wi "onResize" "AutoResize"[24] ⎕wi "onClose" "ExitSystem ''"[25] ControlName←"fmDispFAudit"[26] relTests←0[27] 0 Menu_Make "fmSV"[28] 0 Menu_Make "fmDispFAudit"[29] "fmDispFAudit" Win∆CutCopyPaste "Build"[30] "fmDispFAudit" ⎕wi "∆helpid" 2093[31] list←list OVER "fmDispFAudit.bnDisplay_FAuditHelp"[32] ⎕wself←"fmDispFAudit.bnDisplay_FAuditHelp" ⎕wi "New" "Button"[33] ⎕wi "deferexit" 1[34] ⎕wi "extent" (size←1×buttonsize×1⌈CharSize÷13 6)[35] x←0.5×⍴where←Win∆Calcwhere 1,(¯10-size[1]),1,buttonwhere←buttonwhere-5+size[2][36] ⎕wi "∆where" ((x,2)⍴where)[37] ⎕wi "where" (("fmDispFAudit" ⎕wi "size") Win∆Resize ⎕wi "∆where")[38] ⎕wi "tooltip" "SuperVal Help"[39] ⎕wi "onClick" ("fmSV.mDisplay_FAuditHelp.mContext"⎕wi "onClick")[40] ⎕wi "caption" "Help"[41] :if buttonimage[42]     ⎕wi "imagelist" "fmSV.iStandard"[43]     ⎕wi "imageindex" 12[44] :endif[45] ⎕wi "visible" ¯1[46] ⎕wi "onMouseDown" "∆HelpField←'#' ⎕wi 'focus' "[47] list←list OVER "fmDispFAudit.bnDisplay_FAuditQuit"[48] ⎕wself←"fmDispFAudit.bnDisplay_FAuditQuit" ⎕wi "New" "Button"[49] ⎕wi "style" 2[50] ⎕wi "deferexit" 1[51] ⎕wi "extent" (size←1×buttonsize×1⌈CharSize÷13 6)[52] x←0.5×⍴where←Win∆Calcwhere 1,(¯10-size[1]),1,buttonwhere←buttonwhere-5+size[2][53] ⎕wi "∆where" ((x,2)⍴where)[54] ⎕wi "where" (("fmDispFAudit" ⎕wi "size") Win∆Resize ⎕wi "∆where")[55] ⎕wi "tooltip" "Quit and Return"[56] ⎕wi "onClick" ("fmSV.mDisplay_FAuditFile.mQuit"⎕wi "onClick")[57] ⎕wi "caption" "Quit"[58] ⎕wi "∆helpid" 3898[59] ⎕wi "order" .5[60] ⎕wi "visible" ¯1[61] ControlName ⎕wi "∆quitbutton" "fmDispFAudit.bnDisplay_FAuditQuit"[62] "fmDispFAudit" ⎕wi "∆modified" 1[63] [64] ⎕wself←"fmDispFAudit.edChangeType" ⎕wi "New" "Edit"[65] Fieldlist←Fieldlist OVER "fmDispFAudit.edChangeType"[66] Fieldcontrol←Fieldcontrol OVER "Edit"[67] ⎕wi "∆name" "ChangeType"[68] ⎕wi "∆type" "Char"[69] ⎕wi "∆mandatory" 1[70] ⎕wi "enabled" (0)[71] ⎕wi "∆helpid" 3899[72] ⎕wi "tooltip" "The Change made to the Factors"[73] ⎕wi "∆where" (2 2⍴0.03 0 0.1 0)[74] ⎕wi "where" (("fmDispFAudit" ⎕wi "size") Win∆Resize (2 2⍴0.03 0 0.1 0))[75] ⎕wi "onExit" "⍎(0∊⍴,⎕wres←0 INPUT∆CHECK 'fmDispFAudit.edChangeType')/'0 0⍴(⊂⎕wi ''name'') Display_FAudit ''Change'' ' "[76] ⎕wi "onExitError" "Win∆ExitError ⎕warg"[77] ⎕wi "extent" (2+CharSize×1 14)[78] [79] ⎕wself←"fmDispFAudit.llChangeType" ⎕wi "New" "Label"[80] ⎕wi "scale" 5[81] ⎕wi "style" 2[82] ⎕wi "enabled" (0)[83] ⎕wi "extent" (↑⎕wi "Draw" ("?text" "Change"))[84] ⎕wi "caption" "Change"[85] where←4↑,"fmDispFAudit.edChangeType" ⎕wi "∆where"[86] x←0.5×⍴where←Win∆Calcwhere where-0 ¯3 0,10+¯1↑⎕wi "extent"[87] ⎕wi "∆where" ((x,2)⍴where)[88] ⎕wi "where" (("fmDispFAudit" ⎕wi "size") Win∆Resize ⎕wi "∆where")[89] [90] ⎕wself←"fmDispFAudit.lDiff" ⎕wi "New" "Label"[91] ⎕wi "scale" 5[92] ⎕wi "extent" (↑⎕wi "Draw" ("?text" "Changed values are coloured Red"))[93] ⎕wi "caption" "Changed values are coloured Red"[94] ⎕wi "∆where" (2 2⍴0.13 0 0.42 0)[95] ⎕wi "where" (("fmDispFAudit" ⎕wi "size") Win∆Resize (2 2⍴0.13 0 0.42 0))[96] [97] ⎕wself←"fmDispFAudit.edOldDesc" ⎕wi "New" "Edit"[98] Fieldlist←Fieldlist OVER "fmDispFAudit.edOldDesc"[99] Fieldcontrol←Fieldcontrol OVER "Edit"[100] ⎕wi "∆name" "OldDesc"[101] ⎕wi "∆type" "Char"[102] ⎕wi "∆mandatory" 1[103] ⎕wi "visible" (¯1+2×0)[104] ⎕wi "enabled" (0)[105] ⎕wi "∆helpid" 3899[106] ⎕wi "tooltip" "The Old Description of the Factors"[107] ⎕wi "∆where" (2 2⍴0.1 0 0.1 0)[108] ⎕wi "where" (("fmDispFAudit" ⎕wi "size") Win∆Resize (2 2⍴0.1 0 0.1 0))[109] ⎕wi "onExit" "⍎(0∊⍴,⎕wres←0 INPUT∆CHECK 'fmDispFAudit.edOldDesc')/'0 0⍴(⊂⎕wi ''name'') Display_FAudit ''Change'' ' "[110] ⎕wi "onExitError" "Win∆ExitError ⎕warg"[111] ⎕wi "extent" (2+CharSize×1 51)[112] [113] ⎕wself←"fmDispFAudit.llOldDesc" ⎕wi "New" "Label"[114] ⎕wi "scale" 5[115] ⎕wi "style" 2[116] ⎕wi "visible" (¯1+2×0)[117] ⎕wi "enabled" (0)[118] ⎕wi "extent" (↑⎕wi "Draw" ("?text" "Old Description"))[119] ⎕wi "caption" "Old Description"[120] where←4↑,"fmDispFAudit.edOldDesc" ⎕wi "∆where"[121] x←0.5×⍴where←Win∆Calcwhere where-0 ¯3 0,10+¯1↑⎕wi "extent"[122] ⎕wi "∆where" ((x,2)⍴where)[123] ⎕wi "where" (("fmDispFAudit" ⎕wi "size") Win∆Resize ⎕wi "∆where")[124] [125] ⎕wself←"fmDispFAudit.fOldFactors" ⎕wi "New" "Frame"[126] ⎕wi "scale" 5[127] ⎕wi "visible" (¯1+2×0)[128] ⎕wi "∆where" (4 2⍴0.17 0 0 0 0.83 ¯45 0.5 0)[129] ⎕wi "where" (("fmDispFAudit" ⎕wi "size") Win∆Resize (4 2⍴0.17 0 0 0 0.83 ¯45 0.5 0))[130] ⎕wi "caption" "Old Date Related Factors"[131] ⎕wi "style" 0[132] ⎕wi "onResize" "AutoResize"[133] ⎕wself←"fmDispFAudit.fOldFactors.ssOldFactors" ⎕wi "New" "{13E51003-A52B-11D0-86DA-00608CB9FBFB}6D5ECD55-86B8-11d0-95AD-0020AF1E9EB2"[134] ⎕wi "∆where" (4 2⍴0 15 0 10 0.999 ¯25 1 ¯20)[135] ⎕wi "where" (("fmDispFAudit.fOldFactors" ⎕wi "size") Win∆Resize (4 2⍴0 15 0 10 0.999 ¯25 1 ¯20))[136] Fieldlist←Fieldlist OVER "fmDispFAudit.fOldFactors.ssOldFactors"[137] Fieldcontrol←Fieldcontrol OVER "F1SS"[138] Win∆F1SSDefaults 0[139] ⎕wi "MaxRow" (MaxRow←1)[140] ⎕wi "MaxCol" (MaxCol←1)[141] ⎕wi "xDoStartEdit" 1[142] ⎕wi "xDoEndEdit" 1[143] ⎕wi "xDoCancelEdit" 1[144] ⎕wi "onClick" "Win∆F1SSClick 'fmDispFAudit.fOldFactors.ssOldFactors'"[145] ⎕wi "onXStartEdit" "⎕wi 'AllowArrows' 0"[146] NameList←0 0⍴" "[147] ⎕wi "MaxCol" (MaxCol←MaxCol⌈1)[148] ⎕wi "ColText" 1 (("/⍺/",⎕tcnl,⎕tclf) TEXTREPL "Date")[149] ⎕wi "XSetRowHeight" 1 1 255 1[150] NameList←NameList OVER "OldDates[;]"[151] ⎕wi "MaxCol" (MaxCol←MaxCol⌈2)[152] ⎕wi "ColText" 2 (("/⍺/",⎕tcnl,⎕tclf) TEXTREPL "Factor")[153] ⎕wi "XSetRowHeight" 1 1 255 1[154] NameList←NameList OVER "OldRates[;]"[155] ⎕wi "xHdrHeight" (350⌈250×1)[156] ⎕wi "onXRClick" "0 Win∆F1SSRowMenu ('Display_FAudit' 'fmDispFAudit.fOldFactors.ssOldFactors')"[157] ⎕wi "∆roworcol" "Col"[158] ⎕wi "∆name" NameList[159] ⎕wi "∆limit" (,3 10)[160] ⎕wi "∆mandatory" 0 0[161] ⎕wi "∆helpid" 3899 3899[162] ⎕wi "∆type" "⍺Num⍺Num"[163] ⎕wi "∆valid" "⍺''⍺''"[164] ⎕wi "∆range" "⍺⍺"[165] ⎕wi "onXEndEdit" "(⎕wi 'xRow') Win∆ValidF1SSCell ⎕wi 'xCol' ⋄ 0 0⍴⎕ex 'F1SSEvent' "[166] ⎕wi "onExit" "Win∆ValidF1SSExit 'Display_FAudit'"[167] ⎕wi "onExitError" "MDISPLAY ⎕warg ⋄ ⎕wi 'XStartEdit' 0 1 1"[168] ⎕wi "onXCancelEdit" "⎕wi 'AllowArrows' 1 ⋄ ⎕wi 'SetColWidthAuto' 1 1 (⎕wi 'MaxRow') (⎕wi 'MaxCol') 0"[169] "fmDispFAudit.fOldFactors.ssOldFactors" Win∆F1SSProtectCells "Unlock"[170] ⎕wi "SetSelection" 1 1 1 1[171] [172] ⎕wself←"fmDispFAudit.edNewDesc" ⎕wi "New" "Edit"[173] Fieldlist←Fieldlist OVER "fmDispFAudit.edNewDesc"[174] Fieldcontrol←Fieldcontrol OVER "Edit"[175] ⎕wi "∆name" "NewDesc"[176] ⎕wi "∆type" "Char"[177] ⎕wi "∆mandatory" 1[178] ⎕wi "visible" (¯1+2×0)[179] ⎕wi "enabled" (0)[180] ⎕wi "∆helpid" 3899[181] ⎕wi "tooltip" "The New Description of the Factors"[182] ⎕wi "∆where" (2 2⍴0.1 0 0.6 0)[183] ⎕wi "where" (("fmDispFAudit" ⎕wi "size") Win∆Resize (2 2⍴0.1 0 0.6 0))[184] ⎕wi "onExit" "⍎(0∊⍴,⎕wres←0 INPUT∆CHECK 'fmDispFAudit.edNewDesc')/'0 0⍴(⊂⎕wi ''name'') Display_FAudit ''Change'' ' "[185] ⎕wi "onExitError" "Win∆ExitError ⎕warg"[186] ⎕wi "extent" (2+CharSize×1 51)[187] [188] ⎕wself←"fmDispFAudit.llNewDesc" ⎕wi "New" "Label"[189] ⎕wi "scale" 5[190] ⎕wi "style" 2[191] ⎕wi "visible" (¯1+2×0)[192] ⎕wi "enabled" (0)[193] ⎕wi "extent" (↑⎕wi "Draw" ("?text" "New Description"))[194] ⎕wi "caption" "New Description"[195] where←4↑,"fmDispFAudit.edNewDesc" ⎕wi "∆where"[196] x←0.5×⍴where←Win∆Calcwhere where-0 ¯3 0,10+¯1↑⎕wi "extent"[197] ⎕wi "∆where" ((x,2)⍴where)[198] ⎕wi "where" (("fmDispFAudit" ⎕wi "size") Win∆Resize ⎕wi "∆where")[199] [200] ⎕wself←"fmDispFAudit.fNewFactors" ⎕wi "New" "Frame"[201] ⎕wi "scale" 5[202] ⎕wi "visible" (¯1+2×0)[203] ⎕wi "∆where" (4 2⍴0.17 0 0.5 0 0.83 ¯45 0.5 0)[204] ⎕wi "where" (("fmDispFAudit" ⎕wi "size") Win∆Resize (4 2⍴0.17 0 0.5 0 0.83 ¯45 0.5 0))[205] ⎕wi "caption" "New Date Related Factors"[206] ⎕wi "style" 0[207] ⎕wi "onResize" "AutoResize"[208] ⎕wself←"fmDispFAudit.fNewFactors.ssNewFactors" ⎕wi "New" "{13E51003-A52B-11D0-86DA-00608CB9FBFB}6D5ECD55-86B8-11d0-95AD-0020AF1E9EB2"[209] ⎕wi "∆where" (4 2⍴0 15 0 10 0.999 ¯25 1 ¯20)[210] ⎕wi "where" (("fmDispFAudit.fNewFactors" ⎕wi "size") Win∆Resize (4 2⍴0 15 0 10 0.999 ¯25 1 ¯20))[211] Fieldlist←Fieldlist OVER "fmDispFAudit.fNewFactors.ssNewFactors"[212] Fieldcontrol←Fieldcontrol OVER "F1SS"[213] Win∆F1SSDefaults 0[214] ⎕wi "MaxRow" (MaxRow←1)[215] ⎕wi "MaxCol" (MaxCol←1)[216] ⎕wi "xDoStartEdit" 1[217] ⎕wi "xDoEndEdit" 1[218] ⎕wi "xDoCancelEdit" 1[219] ⎕wi "onClick" "Win∆F1SSClick 'fmDispFAudit.fNewFactors.ssNewFactors'"[220] ⎕wi "onXStartEdit" "⎕wi 'AllowArrows' 0"[221] NameList←0 0⍴" "[222] ⎕wi "MaxCol" (MaxCol←MaxCol⌈1)[223] ⎕wi "ColText" 1 (("/⍺/",⎕tcnl,⎕tclf) TEXTREPL "Date")[224] ⎕wi "XSetRowHeight" 1 1 255 1[225] NameList←NameList OVER "NewDates[;]"[226] ⎕wi "MaxCol" (MaxCol←MaxCol⌈2)[227] ⎕wi "ColText" 2 (("/⍺/",⎕tcnl,⎕tclf) TEXTREPL "Factor")[228] ⎕wi "XSetRowHeight" 1 1 255 1[229] NameList←NameList OVER "NewRates[;]"[230] ⎕wi "xHdrHeight" (350⌈250×1)[231] ⎕wi "onXRClick" "0 Win∆F1SSRowMenu ('Display_FAudit' 'fmDispFAudit.fNewFactors.ssNewFactors')"[232] ⎕wi "∆roworcol" "Col"[233] ⎕wi "∆name" NameList[234] ⎕wi "∆limit" (,3 10)[235] ⎕wi "∆mandatory" 0 0[236] ⎕wi "∆helpid" 3899 3899[237] ⎕wi "∆type" "⍺Num⍺Num"[238] ⎕wi "∆valid" "⍺''⍺''"[239] ⎕wi "∆range" "⍺⍺"[240] ⎕wi "onXEndEdit" "(⎕wi 'xRow') Win∆ValidF1SSCell ⎕wi 'xCol' ⋄ 0 0⍴⎕ex 'F1SSEvent' "[241] ⎕wi "onExit" "Win∆ValidF1SSExit 'Display_FAudit'"[242] ⎕wi "onExitError" "MDISPLAY ⎕warg ⋄ ⎕wi 'XStartEdit' 0 1 1"[243] ⎕wi "onXCancelEdit" "⎕wi 'AllowArrows' 1 ⋄ ⎕wi 'SetColWidthAuto' 1 1 (⎕wi 'MaxRow') (⎕wi 'MaxCol') 0"[244] "fmDispFAudit.fNewFactors.ssNewFactors" Win∆F1SSProtectCells "Unlock"[245] ⎕wi "SetSelection" 1 1 1 1[246] list←list OVER "fmDispFAudit.bnDisplay_FAuditPrint"[247] ⎕wself←"fmDispFAudit.bnDisplay_FAuditPrint" ⎕wi "New" "Button"[248] ⎕wi "visible" (¯1+2×0)[249] ⎕wi "extent" (size←1×buttonsize×1⌈CharSize÷13 6)[250] x←0.5×⍴where←Win∆Calcwhere 1,(¯10-size[1]),1,buttonwhere←buttonwhere-5+size[2][251] ⎕wi "∆where" ((x,2)⍴where)[252] ⎕wi "where" (("fmDispFAudit" ⎕wi "size") Win∆Resize ⎕wi "∆where")[253] ⎕wi "tooltip" "Print Factors Audit"[254] ⎕wi "onClick" ("fmSV.mDisplay_FAuditFile.mPrint"⎕wi "onClick")[255] ⎕wi "∆helpid" 3900[256] ⎕wi "caption" "Print"[257] :if buttonimage[258]     ⎕wi "imagelist" "fmSV.iStandard"[259]     ⎕wi "imageindex" 15[260] :endif[261] [262] "fmDispFAudit" ⎕wi "∆multifile" ""[263] "fmDispFAudit" ⎕wi "∆singlefile" ""[264] "fmDispFAudit" ⎕wi "∆format" ""[265] "fmDispFAudit" ⎕wi "∆financial" 0[266] "fmDispFAudit" ⎕wi "∆relrules" 0[267] "fmDispFAudit" ⎕wi "∆parm" 0[268] "fmDispFAudit" ⎕wi "∆decr" 0[269] "fmDispFAudit" ⎕wi "∆file" 0[270] "fmDispFAudit" ⎕wi "∆codefile" CodeFile[271] "fmDispFAudit" ⎕wi "∆inputstype" ""[272] "fmDispFAudit" ⎕wi "∆inputsentry" ""[273] "fmDispFAudit" ⎕wi "∆savecn" (⍳0)[274] "fmDispFAudit" ⎕wi "∆savedesc" ""[275] list←list OVER "fmDispFAudit"[276] "fmDispFAudit" ⎕wi "∆fieldlist" Fieldlist[277] "fmDispFAudit" ⎕wi "∆fieldcontrol" Fieldcontrol[278] childlist←"fmSV" ⎕wi "∆childlist"[279] list←(⊃¯1↑childlist) OVER list[280] childlist[⍴childlist]←⊂list[281] "fmSV" ⎕wi "∆childlist" childlist[282] list←,⎕split list[283] 0 0⍴((∨/¨(⊂".mDisplay_FAudit")⍷¨list)/list) MultiWI "enabled" 1[284] :if 300<fnsize[285]     (fnsize fnsize ".") Win∆ProgressBar "MemberUpdate"[286]     Win∆ProgressBar "Hide"[287] :endif[288] "Init" OpenParameters "Display_FAudit"[289] "fmDispFAudit.bnDisplay_FAuditHelp" ⎕wi "visible" 1[290] "fmDispFAudit.bnDisplay_FAuditQuit" ⎕wi "visible" 1[291] "#" ⎕wi "focus" "fmDispFAudit.edChangeType"[292] :if ~0∊⍴,Error←Win∆Initialise "Display_FAudit"[293]     "Quit" EndModule Module[294]     "fmSV" ⎕wi "pointer" 0[295]     0 0⍴"fmDispFAudit" ⎕wi "Delete"[296]     :return[297] :endif[298] :if bar_open←commandbar^"Multi"≡""[299]     bar_open←0×"fmDispFAudit.mDisplay_FAuditFile.m" Win∆CommandBar "QuitHelp"[300] :endif[301] "fmDispFAudit" ⎕wi "Paint"[302] "fmSV" ⎕wi "pointer" 11[303] "fmDispFAudit" ⎕wi "onWait" "0 0⍴Display_FAudit 'Wait' ⋄ 'fmDispFAudit' ⎕wi 'modified' 0"[304] 0 0⍴"fmDispFAudit" ⎕wi "Wait"[305] 0 0⍴"fmDispFAudit" ⎕wi "Delete"[306] "fmSV" ⎕wi "pointer" 0 ∇