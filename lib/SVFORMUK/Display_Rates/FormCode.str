∇ Container←Form_Make;⎕wself;ControlName;childlist;list;Fieldlist;Fieldcontrol;FrameWidth;Caption;buttonsize;buttonwhere;where;size;alignment;Header;PickList;NameList;value;sortorder;SortList;MaxRow;MaxCol;Parent;level;node;no;nn;NN;x;fnsize;framelist;relTests[1] [2] Fieldlist←Fieldcontrol←list←0 0⍴""[3] "fmSV" ⎕wi "pointer" 13[4] buttonsize←25 65 ⋄ buttonwhere←¯5[5] FormName ⎕wi "caption" ((FormName ⎕wi "caption")," - Display Rates")[6] "fmSV" ⎕wi "∆caption" (("fmSV" ⎕wi "∆caption"),⊂("fmSV" ⎕wi "caption"))[7] :if 300<fnsize←1↑⍴⎕cr "Form_Make"[8]     "Generating Form" Win∆ProgressBar "Open"[9]     ("Menu Items:" "Form Controls:") Win∆ProgressBar "SetLabels"[10]     (1 1 "Help About") Win∆ProgressBar "FileUpdate"[11] :endif[12] [13] Container←"∆Dialog"[14] [15] ⎕wself←"fmDispRates" ⎕wi "New" "Form" "Hide"[16] ⎕wi "caption" ("fmSV" ⎕wi "caption")[17] ⎕wi "scale" 5[18] ⎕wi "font" ("fmSV" ⎕wi "font")[19] ⎕wi "border" 2 32 64[20] ⎕wi "where" (Win∆CentrePos .34 .56×768 1024×1⌈CharSize÷13 6)[21] ⎕wi "limitwhere" (0.8×¯2↑⎕wi "where")[22] ⎕wi "tooltipwidth" 200[23] ⎕wi "onResize" "AutoResize"[24] ⎕wi "onClose" "ExitSystem ''"[25] ControlName←"fmDispRates"[26] relTests←0[27] 0 Menu_Make "fmSV"[28] 0 Menu_Make "fmDispRates"[29] "fmDispRates" Win∆CutCopyPaste "Build"[30] "fmDispRates" ⎕wi "∆helpid" 2109[31] list←list OVER "fmDispRates.bnDisplay_RatesHelp"[32] ⎕wself←"fmDispRates.bnDisplay_RatesHelp" ⎕wi "New" "Button"[33] ⎕wi "deferexit" 1[34] ⎕wi "extent" (size←1×buttonsize×1⌈CharSize÷13 6)[35] x←0.5×⍴where←Win∆Calcwhere 1,(¯10-size[1]),1,buttonwhere←buttonwhere-5+size[2][36] ⎕wi "∆where" ((x,2)⍴where)[37] ⎕wi "where" (("fmDispRates" ⎕wi "size") Win∆Resize ⎕wi "∆where")[38] ⎕wi "tooltip" "SuperVal Help"[39] ⎕wi "onClick" ("fmSV.mDisplay_RatesHelp.mContext"⎕wi "onClick")[40] ⎕wi "caption" "Help"[41] :if buttonimage[42]     ⎕wi "imagelist" "fmSV.iStandard"[43]     ⎕wi "imageindex" 12[44] :endif[45] ⎕wi "visible" ¯1[46] ⎕wi "onMouseDown" "∆HelpField←'#' ⎕wi 'focus' "[47] list←list OVER "fmDispRates.bnDisplay_RatesQuit"[48] ⎕wself←"fmDispRates.bnDisplay_RatesQuit" ⎕wi "New" "Button"[49] ⎕wi "style" 2[50] ⎕wi "deferexit" 1[51] ⎕wi "extent" (size←1×buttonsize×1⌈CharSize÷13 6)[52] x←0.5×⍴where←Win∆Calcwhere 1,(¯10-size[1]),1,buttonwhere←buttonwhere-5+size[2][53] ⎕wi "∆where" ((x,2)⍴where)[54] ⎕wi "where" (("fmDispRates" ⎕wi "size") Win∆Resize ⎕wi "∆where")[55] ⎕wi "tooltip" "Cancel and Return"[56] ⎕wi "onClick" ("fmSV.mDisplay_RatesFile.mQuit"⎕wi "onClick")[57] ⎕wi "caption" "Cancel"[58] ⎕wi "∆helpid" 4037[59] ⎕wi "order" .5[60] ⎕wi "visible" ¯1[61] list←list OVER "fmDispRates.bnDisplay_RatesSave"[62] ⎕wself←"fmDispRates.bnDisplay_RatesSave" ⎕wi "New" "Button"[63] ⎕wi "style" 1[64] ⎕wi "extent" (size←1×buttonsize×1⌈CharSize÷13 6)[65] x←0.5×⍴where←Win∆Calcwhere 1,(¯10-size[1]),1,buttonwhere←buttonwhere-5+size[2][66] ⎕wi "∆where" ((x,2)⍴where)[67] ⎕wi "where" (("fmDispRates" ⎕wi "size") Win∆Resize ⎕wi "∆where")[68] ⎕wi "tooltip" "Save Parameters"[69] ⎕wi "onClick" ("fmSV.mDisplay_RatesFile.mSave"⎕wi "onClick")[70] ⎕wi "caption" "OK"[71] ⎕wi "∆helpid" 4038[72] ⎕wi "order" .5[73] ⎕wi "visible" ¯1[74] "fmDispRates" ⎕wi "∆modified" 1[75] [76] ⎕wself←"fmDispRates.fAgeRates" ⎕wi "New" "Frame"[77] ⎕wi "scale" 5[78] ⎕wi "visible" (¯1+2×0)[79] ⎕wi "∆where" (4 2⍴0 0 0 0 1 ¯45 1 0)[80] ⎕wi "where" (("fmDispRates" ⎕wi "size") Win∆Resize (4 2⍴0 0 0 0 1 ¯45 1 0))[81] ⎕wi "caption" "Age Related Rates"[82] ⎕wi "style" 0[83] ⎕wi "onResize" "AutoResize"[84] ⎕wself←"fmDispRates.fAgeRates.ssAgeRates" ⎕wi "New" "{13E51003-A52B-11D0-86DA-00608CB9FBFB}6D5ECD55-86B8-11d0-95AD-0020AF1E9EB2"[85] ⎕wi "∆where" (4 2⍴0 15 0 10 0.999 ¯25 1 ¯20)[86] ⎕wi "where" (("fmDispRates.fAgeRates" ⎕wi "size") Win∆Resize (4 2⍴0 15 0 10 0.999 ¯25 1 ¯20))[87] Fieldlist←Fieldlist OVER "fmDispRates.fAgeRates.ssAgeRates"[88] Fieldcontrol←Fieldcontrol OVER "F1SS"[89] Win∆F1SSDefaults 0[90] ⎕wi "MaxRow" (MaxRow←1)[91] ⎕wi "MaxCol" (MaxCol←1)[92] ⎕wi "xDoStartEdit" 1[93] ⎕wi "xDoEndEdit" 1[94] ⎕wi "xDoCancelEdit" 1[95] ⎕wi "onClick" "Win∆F1SSClick 'fmDispRates.fAgeRates.ssAgeRates'"[96] ⎕wi "onXStartEdit" "⎕wi 'AllowArrows' 0"[97] NameList←0 0⍴" "[98] ⎕wi "MaxCol" (MaxCol←MaxCol⌈1)[99] ⎕wi "ColText" 1 (("/⍺/",⎕tcnl,⎕tclf) TEXTREPL "Age")[100] ⎕wi "XSetRowHeight" 1 1 255 1[101] NameList←NameList OVER "DispAges[;]"[102] ⎕wi "MaxCol" (MaxCol←MaxCol⌈2)[103] ⎕wi "ColText" 2 (("/⍺/",⎕tcnl,⎕tclf) TEXTREPL "Rate")[104] ⎕wi "XSetRowHeight" 1 1 255 1[105] NameList←NameList OVER "DispRATES[;]"[106] ⎕wi "xHdrHeight" (350⌈250×1)[107] ⎕wi "onXRClick" "0 Win∆F1SSRowMenu ('Display_Rates' 'fmDispRates.fAgeRates.ssAgeRates')"[108] ⎕wi "∆roworcol" "Col"[109] ⎕wi "∆name" NameList[110] ⎕wi "∆limit" (,3 11)[111] ⎕wi "∆mandatory" 0 0[112] ⎕wi "∆helpid" 4039 4039[113] ⎕wi "∆type" "⍺Num⍺Num"[114] ⎕wi "∆valid" "⍺''⍺''"[115] ⎕wi "∆range" "⍺⍺"[116] ⎕wi "onXEndEdit" "(⎕wi 'xRow') Win∆ValidF1SSCell ⎕wi 'xCol' ⋄ 0 0⍴⎕ex 'F1SSEvent' "[117] ⎕wi "onExit" "Win∆ValidF1SSExit 'Display_Rates'"[118] ⎕wi "onExitError" "MDISPLAY ⎕warg ⋄ ⎕wi 'XStartEdit' 0 1 1"[119] ⎕wi "onXCancelEdit" "⎕wi 'AllowArrows' 1 ⋄ ⎕wi 'SetColWidthAuto' 1 1 (⎕wi 'MaxRow') (⎕wi 'MaxCol') 0"[120] "fmDispRates.fAgeRates.ssAgeRates" Win∆F1SSProtectCells "Unlock"[121] ⎕wi "SetSelection" 1 1 1 1[122] [123] ⎕wself←"fmDispRates.fDurnRates" ⎕wi "New" "Frame"[124] ⎕wi "scale" 5[125] ⎕wi "visible" (¯1+2×0)[126] ⎕wi "∆where" (4 2⍴0 0 0 0 1 ¯45 1 0)[127] ⎕wi "where" (("fmDispRates" ⎕wi "size") Win∆Resize (4 2⍴0 0 0 0 1 ¯45 1 0))[128] ⎕wi "caption" "Duration Related Rates"[129] ⎕wi "style" 0[130] ⎕wi "onResize" "AutoResize"[131] ⎕wself←"fmDispRates.fDurnRates.ssDurnRates" ⎕wi "New" "{13E51003-A52B-11D0-86DA-00608CB9FBFB}6D5ECD55-86B8-11d0-95AD-0020AF1E9EB2"[132] ⎕wi "∆where" (4 2⍴0 15 0 10 0.999 ¯25 1 ¯20)[133] ⎕wi "where" (("fmDispRates.fDurnRates" ⎕wi "size") Win∆Resize (4 2⍴0 15 0 10 0.999 ¯25 1 ¯20))[134] Fieldlist←Fieldlist OVER "fmDispRates.fDurnRates.ssDurnRates"[135] Fieldcontrol←Fieldcontrol OVER "F1SS"[136] Win∆F1SSDefaults 0[137] ⎕wi "MaxRow" (MaxRow←1)[138] ⎕wi "MaxCol" (MaxCol←1)[139] ⎕wi "xDoStartEdit" 1[140] ⎕wi "xDoEndEdit" 1[141] ⎕wi "xDoCancelEdit" 1[142] ⎕wi "onClick" "Win∆F1SSClick 'fmDispRates.fDurnRates.ssDurnRates'"[143] ⎕wi "onXStartEdit" "⎕wi 'AllowArrows' 0"[144] NameList←0 0⍴" "[145] ⎕wi "MaxCol" (MaxCol←MaxCol⌈1)[146] ⎕wi "ColText" 1 (("/⍺/",⎕tcnl,⎕tclf) TEXTREPL "Duration")[147] ⎕wi "XSetRowHeight" 1 1 255 1[148] NameList←NameList OVER "DispDurns[;]"[149] ⎕wi "MaxCol" (MaxCol←MaxCol⌈2)[150] ⎕wi "ColText" 2 (("/⍺/",⎕tcnl,⎕tclf) TEXTREPL "Rate")[151] ⎕wi "XSetRowHeight" 1 1 255 1[152] NameList←NameList OVER "DispRATES[;]"[153] ⎕wi "xHdrHeight" (350⌈250×1)[154] ⎕wi "onXRClick" "0 Win∆F1SSRowMenu ('Display_Rates' 'fmDispRates.fDurnRates.ssDurnRates')"[155] ⎕wi "∆roworcol" "Col"[156] ⎕wi "∆name" NameList[157] ⎕wi "∆limit" (,2 11)[158] ⎕wi "∆mandatory" 0 0[159] ⎕wi "∆helpid" 4039 4039[160] ⎕wi "∆type" "⍺Num⍺Num"[161] ⎕wi "∆valid" "⍺''⍺''"[162] ⎕wi "∆range" "⍺⍺"[163] ⎕wi "onXEndEdit" "(⎕wi 'xRow') Win∆ValidF1SSCell ⎕wi 'xCol' ⋄ 0 0⍴⎕ex 'F1SSEvent' "[164] ⎕wi "onExit" "Win∆ValidF1SSExit 'Display_Rates'"[165] ⎕wi "onExitError" "MDISPLAY ⎕warg ⋄ ⎕wi 'XStartEdit' 0 1 1"[166] ⎕wi "onXCancelEdit" "⎕wi 'AllowArrows' 1 ⋄ ⎕wi 'SetColWidthAuto' 1 1 (⎕wi 'MaxRow') (⎕wi 'MaxCol') 0"[167] "fmDispRates.fDurnRates.ssDurnRates" Win∆F1SSProtectCells "Unlock"[168] ⎕wi "SetSelection" 1 1 1 1[169] [170] ⎕wself←"fmDispRates.fTwoDRates" ⎕wi "New" "Frame"[171] ⎕wi "scale" 5[172] ⎕wi "visible" (¯1+2×0)[173] ⎕wi "∆where" (4 2⍴0 0 0 0 1 ¯45 1 0)[174] ⎕wi "where" (("fmDispRates" ⎕wi "size") Win∆Resize (4 2⍴0 0 0 0 1 ¯45 1 0))[175] ⎕wi "caption" "2 Dimensional Rates"[176] ⎕wi "style" 0[177] ⎕wi "onResize" "AutoResize"[178] ⎕wself←"fmDispRates.fTwoDRates.ssTwoDRates" ⎕wi "New" "{13E51003-A52B-11D0-86DA-00608CB9FBFB}6D5ECD55-86B8-11d0-95AD-0020AF1E9EB2"[179] ⎕wi "∆where" (4 2⍴0 15 0 10 0.999 ¯25 1 ¯20)[180] ⎕wi "where" (("fmDispRates.fTwoDRates" ⎕wi "size") Win∆Resize (4 2⍴0 15 0 10 0.999 ¯25 1 ¯20))[181] Fieldlist←Fieldlist OVER "fmDispRates.fTwoDRates.ssTwoDRates"[182] Fieldcontrol←Fieldcontrol OVER "F1SS"[183] Win∆F1SSDefaults 0[184] ⎕wi "MaxRow" (MaxRow←1)[185] ⎕wi "MaxCol" (MaxCol←1)[186] ⎕wi "xDoStartEdit" 1[187] ⎕wi "xDoEndEdit" 1[188] ⎕wi "xDoCancelEdit" 1[189] ⎕wi "onClick" "Win∆F1SSClick 'fmDispRates.fTwoDRates.ssTwoDRates'"[190] ⎕wi "onXStartEdit" "⎕wi 'AllowArrows' 0"[191] NameList←0 0⍴" "[192] ⎕wi "MaxCol" (MaxCol←MaxCol⌈1)[193] ⎕wi "ColText" 1 (("/⍺/",⎕tcnl,⎕tclf) TEXTREPL "Rate")[194] ⎕wi "XSetRowHeight" 1 1 255 1[195] NameList←NameList OVER "DispRATES[;]"[196] ⎕wi "xHdrHeight" (350⌈250×1)[197] ⎕wi "onXRClick" "0 Win∆F1SSRowMenu ('Display_Rates' 'fmDispRates.fTwoDRates.ssTwoDRates')"[198] ⎕wi "∆roworcol" "Col"[199] ⎕wi "∆name" NameList[200] ⎕wi "∆limit" (,11)[201] ⎕wi "∆mandatory" 0[202] ⎕wi "∆helpid" 4039[203] ⎕wi "∆type" "⍺Num"[204] ⎕wi "∆valid" "⍺''"[205] ⎕wi "∆range" "⍺"[206] ⎕wi "onXEndEdit" "(⎕wi 'xRow') Win∆ValidF1SSCell ⎕wi 'xCol' ⋄ 0 0⍴⎕ex 'F1SSEvent' "[207] ⎕wi "onExit" "Win∆ValidF1SSExit 'Display_Rates'"[208] ⎕wi "onExitError" "MDISPLAY ⎕warg ⋄ ⎕wi 'XStartEdit' 0 1 1"[209] ⎕wi "onXCancelEdit" "⎕wi 'AllowArrows' 1 ⋄ ⎕wi 'SetColWidthAuto' 1 1 (⎕wi 'MaxRow') (⎕wi 'MaxCol') 0"[210] "fmDispRates.fTwoDRates.ssTwoDRates" Win∆F1SSProtectCells "Unlock"[211] ⎕wi "SetSelection" 1 1 1 1[212] [213] ⎕wself←"fmDispRates.lNew" ⎕wi "New" "Label"[214] ⎕wi "scale" 5[215] ⎕wi "extent" (↑⎕wi "Draw" ("?text" "Inserted values are coloured Red"))[216] ⎕wi "caption" "Inserted values are coloured Red"[217] ⎕wi "∆where" (2 2⍴0.95 0 0.1 0)[218] ⎕wi "where" (("fmDispRates" ⎕wi "size") Win∆Resize (2 2⍴0.95 0 0.1 0))[219] [220] ⎕wself←"fmDispRates.lDiff" ⎕wi "New" "Label"[221] ⎕wi "scale" 5[222] ⎕wi "extent" (↑⎕wi "Draw" ("?text" "Changed values are coloured Red"))[223] ⎕wi "caption" "Changed values are coloured Red"[224] ⎕wi "∆where" (2 2⍴0.95 0 0.3 0)[225] ⎕wi "where" (("fmDispRates" ⎕wi "size") Win∆Resize (2 2⍴0.95 0 0.3 0))[226] [227] ⎕wself←"fmDispRates.lMoved" ⎕wi "New" "Label"[228] ⎕wi "scale" 5[229] ⎕wi "extent" (↑⎕wi "Draw" ("?text" "Moved values are coloured Blue"))[230] ⎕wi "caption" "Moved values are coloured Blue"[231] ⎕wi "∆where" (2 2⍴0.95 0 0.5 0)[232] ⎕wi "where" (("fmDispRates" ⎕wi "size") Win∆Resize (2 2⍴0.95 0 0.5 0))[233] [234] "fmDispRates" ⎕wi "∆multifile" ""[235] "fmDispRates" ⎕wi "∆singlefile" ""[236] "fmDispRates" ⎕wi "∆format" ""[237] "fmDispRates" ⎕wi "∆financial" 0[238] "fmDispRates" ⎕wi "∆relrules" 0[239] "fmDispRates" ⎕wi "∆parm" 0[240] "fmDispRates" ⎕wi "∆decr" 0[241] "fmDispRates" ⎕wi "∆file" 0[242] "fmDispRates" ⎕wi "∆codefile" CodeFile[243] "fmDispRates" ⎕wi "∆inputstype" ""[244] "fmDispRates" ⎕wi "∆inputsentry" ""[245] "fmDispRates" ⎕wi "∆savecn" (⍳0)[246] "fmDispRates" ⎕wi "∆savedesc" ""[247] list←list OVER "fmDispRates"[248] "fmDispRates" ⎕wi "∆fieldlist" Fieldlist[249] "fmDispRates" ⎕wi "∆fieldcontrol" Fieldcontrol[250] childlist←"fmSV" ⎕wi "∆childlist"[251] list←(⊃¯1↑childlist) OVER list[252] childlist[⍴childlist]←⊂list[253] "fmSV" ⎕wi "∆childlist" childlist[254] list←,⎕split list[255] 0 0⍴((∨/¨(⊂".mDisplay_Rates")⍷¨list)/list) MultiWI "enabled" 1[256] :if 300<fnsize[257]     (fnsize fnsize ".") Win∆ProgressBar "MemberUpdate"[258]     Win∆ProgressBar "Hide"[259] :endif[260] "Init" OpenParameters "Display_Rates"[261] "fmDispRates.bnDisplay_RatesHelp" ⎕wi "visible" 1[262] "fmDispRates.bnDisplay_RatesQuit" ⎕wi "visible" 1[263] "fmDispRates.bnDisplay_RatesSave" ⎕wi "visible" 1[264] "#" ⎕wi "focus" "fmDispRates.fAgeRates.ssAgeRates"[265] :if ~0∊⍴,Error←Win∆Initialise "Display_Rates"[266]     "Quit" EndModule Module[267]     "fmSV" ⎕wi "pointer" 0[268]     0 0⍴"fmDispRates" ⎕wi "Delete"[269]     :return[270] :endif[271] :if bar_open←commandbar^"Multi"≡""[272]     bar_open←0×"fmDispRates.mDisplay_RatesFile.m" Win∆CommandBar "OKHelp"[273] :endif[274] "fmDispRates" ⎕wi "Paint"[275] "fmSV" ⎕wi "pointer" 11[276] "fmDispRates" ⎕wi "onWait" "0 0⍴Display_Rates 'Wait' ⋄ 'fmDispRates' ⎕wi 'modified' 0"[277] 0 0⍴"fmDispRates" ⎕wi "Wait"[278] 0 0⍴"fmDispRates" ⎕wi "Delete"[279] "fmSV" ⎕wi "pointer" 0 ∇