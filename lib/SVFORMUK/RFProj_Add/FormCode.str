∇ Container←Form_Make;⎕wself;ControlName;childlist;list;Fieldlist;Fieldcontrol;FrameWidth;Caption;buttonsize;buttonwhere;where;size;alignment;Header;PickList;NameList;value;sortorder;SortList;MaxRow;MaxCol;Parent;level;node;no;nn;NN;x;fnsize;framelist;relTests[1] [2] Fieldlist←Fieldcontrol←list←0 0⍴""[3] "fmSV" ⎕wi "pointer" 13[4] buttonsize←25 65 ⋄ buttonwhere←¯5[5] FormName ⎕wi "caption" ((FormName ⎕wi "caption")," - Add Rows to Roll Forward Projection")[6] "fmSV" ⎕wi "∆caption" (("fmSV" ⎕wi "∆caption"),⊂("fmSV" ⎕wi "caption"))[7] :if 300<fnsize←1↑⍴⎕cr "Form_Make"[8]     "Generating Form" Win∆ProgressBar "Open"[9]     ("Menu Items:" "Form Controls:") Win∆ProgressBar "SetLabels"[10]     (1 1 "Help About") Win∆ProgressBar "FileUpdate"[11] :endif[12] [13] Container←"∆Dialog"[14] [15] ⎕wself←"fmRFProj_Add" ⎕wi "New" "Form" "Hide"[16] ⎕wi "caption" ("fmSV" ⎕wi "caption")[17] ⎕wi "scale" 5[18] ⎕wi "font" ("fmSV" ⎕wi "font")[19] ⎕wi "border" 2 32 64[20] ⎕wi "where" (Win∆CentrePos .30 .45×768 1024×1⌈CharSize÷13 6)[21] ⎕wi "limitwhere" (0.8×¯2↑⎕wi "where")[22] ⎕wi "tooltipwidth" 200[23] ⎕wi "onResize" "AutoResize"[24] ⎕wi "onClose" "ExitSystem ''"[25] ControlName←"fmRFProj_Add"[26] relTests←0[27] 0 Menu_Make "fmSV"[28] 0 Menu_Make "fmRFProj_Add"[29] "fmRFProj_Add" Win∆CutCopyPaste "Build"[30] list←list OVER "fmRFProj_Add.bnRFProj_AddHelp"[31] ⎕wself←"fmRFProj_Add.bnRFProj_AddHelp" ⎕wi "New" "Button"[32] ⎕wi "deferexit" 1[33] ⎕wi "extent" (size←1×buttonsize×1⌈CharSize÷13 6)[34] x←0.5×⍴where←Win∆Calcwhere 1,(¯10-size[1]),1,buttonwhere←buttonwhere-5+size[2][35] ⎕wi "∆where" ((x,2)⍴where)[36] ⎕wi "where" (("fmRFProj_Add" ⎕wi "size") Win∆Resize ⎕wi "∆where")[37] ⎕wi "tooltip" "SuperVal Help"[38] ⎕wi "onClick" ("fmSV.mRFProj_AddHelp.mContext"⎕wi "onClick")[39] ⎕wi "caption" "Help"[40] :if buttonimage[41]     ⎕wi "imagelist" "fmSV.iStandard"[42]     ⎕wi "imageindex" 12[43] :endif[44] ⎕wi "visible" ¯1[45] ⎕wi "onMouseDown" "∆HelpField←'#' ⎕wi 'focus' "[46] list←list OVER "fmRFProj_Add.bnRFProj_AddQuit"[47] ⎕wself←"fmRFProj_Add.bnRFProj_AddQuit" ⎕wi "New" "Button"[48] ⎕wi "style" 2[49] ⎕wi "deferexit" 1[50] ⎕wi "extent" (size←1×buttonsize×1⌈CharSize÷13 6)[51] x←0.5×⍴where←Win∆Calcwhere 1,(¯10-size[1]),1,buttonwhere←buttonwhere-5+size[2][52] ⎕wi "∆where" ((x,2)⍴where)[53] ⎕wi "where" (("fmRFProj_Add" ⎕wi "size") Win∆Resize ⎕wi "∆where")[54] ⎕wi "tooltip" "Cancel and Return"[55] ⎕wi "onClick" ("fmSV.mRFProj_AddFile.mQuit"⎕wi "onClick")[56] ⎕wi "caption" "Cancel"[57] ⎕wi "order" .5[58] ⎕wi "visible" ¯1[59] list←list OVER "fmRFProj_Add.bnRFProj_AddSave"[60] ⎕wself←"fmRFProj_Add.bnRFProj_AddSave" ⎕wi "New" "Button"[61] ⎕wi "style" 1[62] ⎕wi "extent" (size←1×buttonsize×1⌈CharSize÷13 6)[63] x←0.5×⍴where←Win∆Calcwhere 1,(¯10-size[1]),1,buttonwhere←buttonwhere-5+size[2][64] ⎕wi "∆where" ((x,2)⍴where)[65] ⎕wi "where" (("fmRFProj_Add" ⎕wi "size") Win∆Resize ⎕wi "∆where")[66] ⎕wi "tooltip" "Save Parameters"[67] ⎕wi "onClick" ("fmSV.mRFProj_AddFile.mSave"⎕wi "onClick")[68] ⎕wi "caption" "OK"[69] ⎕wi "order" .5[70] ⎕wi "visible" ¯1[71] [72] ⎕wself←"fmRFProj_Add.edNumRows" ⎕wi "New" "Edit"[73] Fieldlist←Fieldlist OVER "fmRFProj_Add.edNumRows"[74] Fieldcontrol←Fieldcontrol OVER "Edit"[75] ⎕wi "∆name" "NumRows"[76] ⎕wi "∆type" "Num"[77] ⎕wi "∆mandatory" 1[78] ⎕wi "∆valid" ('Scalar' '+')[79] ⎕wi "tooltip" "Specify the number of Rows"[80] ⎕wi "limit" 3[81] ⎕wi "∆where" (2 2⍴0.4 0 0.2 0)[82] ⎕wi "where" (("fmRFProj_Add" ⎕wi "size") Win∆Resize (2 2⍴0.4 0 0.2 0))[83] ⎕wi "onExit" "⍎(0∊⍴,⎕wres←0 INPUT∆CHECK 'fmRFProj_Add.edNumRows')/'0 0⍴(⊂⎕wi ''name'') RFProj_Add ''Change'' ' "[84] ⎕wi "onExitError" "Win∆ExitError ⎕warg"[85] ⎕wi "onKeyPress" "⎕wres←¯2×~⎕warg∊46 8 32 48 49 50 51 52 53 54 55 56 57"[86] ⎕wi "extent" (2+CharSize×1 4)[87] [88] ⎕wself←"fmRFProj_Add.llNumRows" ⎕wi "New" "Label"[89] ⎕wi "scale" 5[90] ⎕wi "style" 2[91] ⎕wi "extent" (↑⎕wi "Draw" ("?text" (("⍺",⎕tcnl) char_replace "Number⍺of Rows")))[92] ⎕wi "caption" (("⍺",⎕tcnl) char_replace "Number⍺of Rows")[93] where←4↑,"fmRFProj_Add.edNumRows" ⎕wi "∆where"[94] size←1↑"fmRFProj_Add.edNumRows" ⎕wi "extent"[95] size←¯3⌈0.5×(1↑⎕wi "extent")-size[96] x←0.5×⍴where←Win∆Calcwhere where-0,size,0,10+¯1↑⎕wi "extent"[97] ⎕wi "∆where" ((x,2)⍴where)[98] ⎕wi "where" (("fmRFProj_Add" ⎕wi "size") Win∆Resize ⎕wi "∆where")[99] [100] ⎕wself←"fmRFProj_Add.cbfrequency" ⎕wi "New" "Combo"[101] Fieldlist←Fieldlist OVER "fmRFProj_Add.cbfrequency"[102] Fieldcontrol←Fieldcontrol OVER "Combo"[103] ⎕wi "∆name" "frequency"[104] ⎕wi "∆type" "Combo"[105] ⎕wi "∆mandatory" 1[106] ⎕wi "tooltip" "Specify the frequency of the dates for the added Rows"[107] ⎕wi "style" 16 128 256 2[108] ⎕wi "∆where" (2 2⍴0.4 0 0.5 0)[109] ⎕wi "where" (("fmRFProj_Add" ⎕wi "size") Win∆Resize (2 2⍴0.4 0 0.5 0))[110] PickList←⍙POPUPSdict ReadDictFile "RowFreq"[111] PickList←⊃m2n 1 0↓PickList[112] ⎕wi "list" PickList[113] ⎕wi "extent" (150,(¯10+6×¯1↑CharSize)+¯1↑Win∆TextSize ((0,⎕wi "limit")⌈⍴PickList)↑PickList)[114] ⎕wi "onClick" "0 0⍴(⊂⎕wi 'name') RFProj_Add 'Change' "[115] ⎕wi "∆rightlabel" "fmRFProj_Add.lrfrequency"[116] [117] ⎕wself←"fmRFProj_Add.lrfrequency" ⎕wi "New" "Label"[118] ⎕wi "scale" 5[119] ⎕wi "extent" (↑⎕wi "Draw" ("?text" (("⍺",⎕tcnl) char_replace "after latest⍺Current Date")))[120] ⎕wi "caption" (("⍺",⎕tcnl) char_replace "after latest⍺Current Date")[121] where←4↑,"fmRFProj_Add.cbfrequency" ⎕wi "∆where"[122] size←1↑"fmRFProj_Add.cbfrequency" ⎕wi "extent"[123] size←¯3⌈0.5×(1↑⎕wi "extent")-size[124] x←0.5×⍴where←Win∆Calcwhere where+0,(-size),0,10+¯1↑"fmRFProj_Add.cbfrequency" ⎕wi "extent"[125] ⎕wi "∆where" ((x,2)⍴where)[126] ⎕wi "where" (("fmRFProj_Add" ⎕wi "size") Win∆Resize ⎕wi "∆where")[127] [128] ⎕wself←"fmRFProj_Add.llfrequency" ⎕wi "New" "Label"[129] ⎕wi "scale" 5[130] ⎕wi "style" 2[131] ⎕wi "extent" (↑⎕wi "Draw" ("?text" "Frequency"))[132] ⎕wi "caption" "Frequency"[133] where←4↑,"fmRFProj_Add.cbfrequency" ⎕wi "∆where"[134] x←0.5×⍴where←Win∆Calcwhere where-0 ¯3 0,10+¯1↑⎕wi "extent"[135] ⎕wi "∆where" ((x,2)⍴where)[136] ⎕wi "where" (("fmRFProj_Add" ⎕wi "size") Win∆Resize ⎕wi "∆where")[137] [138] "fmRFProj_Add" ⎕wi "∆multifile" ""[139] "fmRFProj_Add" ⎕wi "∆singlefile" ""[140] "fmRFProj_Add" ⎕wi "∆format" ""[141] "fmRFProj_Add" ⎕wi "∆financial" 0[142] "fmRFProj_Add" ⎕wi "∆relrules" 0[143] "fmRFProj_Add" ⎕wi "∆parm" 0[144] "fmRFProj_Add" ⎕wi "∆decr" 0[145] "fmRFProj_Add" ⎕wi "∆file" 0[146] "fmRFProj_Add" ⎕wi "∆codefile" CodeFile[147] "fmRFProj_Add" ⎕wi "∆inputstype" "ClientFile"[148] "fmRFProj_Add" ⎕wi "∆inputsentry" "Single"[149] "fmRFProj_Add" ⎕wi "∆savecn" (⍳0)[150] "fmRFProj_Add" ⎕wi "∆savedesc" ""[151] list←list OVER "fmRFProj_Add"[152] "fmRFProj_Add" ⎕wi "∆fieldlist" Fieldlist[153] "fmRFProj_Add" ⎕wi "∆fieldcontrol" Fieldcontrol[154] childlist←"fmSV" ⎕wi "∆childlist"[155] list←(⊃¯1↑childlist) OVER list[156] childlist[⍴childlist]←⊂list[157] "fmSV" ⎕wi "∆childlist" childlist[158] list←,⎕split list[159] 0 0⍴((∨/¨(⊂".mRFProj_Add")⍷¨list)/list) MultiWI "enabled" 1[160] :if 300<fnsize[161]     (fnsize fnsize ".") Win∆ProgressBar "MemberUpdate"[162]     Win∆ProgressBar "Hide"[163] :endif[164] "Init" OpenParameters "RFProj_Add"[165] "fmRFProj_Add.bnRFProj_AddHelp" ⎕wi "visible" 1[166] "fmRFProj_Add.bnRFProj_AddQuit" ⎕wi "visible" 1[167] "fmRFProj_Add.bnRFProj_AddSave" ⎕wi "visible" 1[168] "#" ⎕wi "focus" "fmRFProj_Add.edNumRows"[169] :if ~0∊⍴,Error←Win∆Initialise "RFProj_Add"[170]     "Quit" EndModule Module[171]     "fmSV" ⎕wi "pointer" 0[172]     0 0⍴"fmRFProj_Add" ⎕wi "Delete"[173]     :return[174] :endif[175] :if bar_open←commandbar^"Multi"≡"Single"[176]     bar_open←0×"fmRFProj_Add.mRFProj_AddFile.m" Win∆CommandBar "OKHelp"[177] :endif[178] "fmRFProj_Add" ⎕wi "Paint"[179] "fmSV" ⎕wi "pointer" 11[180] "fmRFProj_Add" ⎕wi "onWait" "0 0⍴RFProj_Add 'Wait' ⋄ 'fmRFProj_Add' ⎕wi 'modified' 0"[181] 0 0⍴"fmRFProj_Add" ⎕wi "Wait"[182] 0 0⍴"fmRFProj_Add" ⎕wi "Delete"[183] "fmSV" ⎕wi "pointer" 0 ∇