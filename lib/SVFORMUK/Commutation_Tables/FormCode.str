∇ Container←Form_Make;⎕wself;ControlName;childlist;list;Fieldlist;Fieldcontrol;FrameWidth;Caption;buttonsize;buttonwhere;where;size;alignment;Header;PickList;NameList;value;sortorder;SortList;MaxRow;MaxCol;Parent;level;node;no;nn;NN;x;fnsize;framelist;relTests[1] [2] Fieldlist←Fieldcontrol←list←0 0⍴""[3] "fmSV" ⎕wi "pointer" 13[4] buttonsize←25 65 ⋄ buttonwhere←¯5[5] FormName ⎕wi "caption" ((FormName ⎕wi "caption")," - Commutation Tables Definition")[6] "fmSV" ⎕wi "∆caption" (("fmSV" ⎕wi "∆caption"),⊂("fmSV" ⎕wi "caption"))[7] :if 300<fnsize←1↑⍴⎕cr "Form_Make"[8]     "Generating Form" Win∆ProgressBar "Open"[9]     ("Menu Items:" "Form Controls:") Win∆ProgressBar "SetLabels"[10]     (1 1 "Help About") Win∆ProgressBar "FileUpdate"[11] :endif[12] [13] Container←"∆Dialog"[14] [15] ⎕wself←"fmCommTable" ⎕wi "New" "Form" "Hide"[16] ⎕wi "caption" ("fmSV" ⎕wi "caption")[17] ⎕wi "scale" 5[18] ⎕wi "font" ("fmSV" ⎕wi "font")[19] ⎕wi "border" 2 32 64[20] ⎕wi "where" (Win∆CentrePos 0.8 1.0×768 1024×1⌈CharSize÷13 6)[21] ⎕wi "limitwhere" (0.8×¯2↑⎕wi "where")[22] ⎕wi "tooltipwidth" 200[23] ⎕wi "onResize" "AutoResize"[24] ⎕wi "onClose" "ExitSystem ''"[25] ControlName←"fmCommTable"[26] relTests←1[27] 0 Menu_Make "fmSV"[28] 1 Menu_Make "fmCommTable"[29] "fmCommTable" Win∆CutCopyPaste "Build"[30] "fmCommTable" ⎕wi "∆helpid" 2165[31] list←list OVER "fmCommTable.bnCommutation_TablesHelp"[32] ⎕wself←"fmCommTable.bnCommutation_TablesHelp" ⎕wi "New" "Button"[33] ⎕wi "deferexit" 1[34] ⎕wi "extent" (size←1×buttonsize×1⌈CharSize÷13 6)[35] x←0.5×⍴where←Win∆Calcwhere 1,(¯10-size[1]),1,buttonwhere←buttonwhere-5+size[2][36] ⎕wi "∆where" ((x,2)⍴where)[37] ⎕wi "where" (("fmCommTable" ⎕wi "size") Win∆Resize ⎕wi "∆where")[38] ⎕wi "tooltip" "SuperVal Help"[39] ⎕wi "onClick" ("fmSV.mCommutation_TablesHelp.mContext"⎕wi "onClick")[40] ⎕wi "caption" "Help"[41] :if buttonimage[42]     ⎕wi "imagelist" "fmSV.iStandard"[43]     ⎕wi "imageindex" 12[44] :endif[45] ⎕wi "visible" ¯1[46] ⎕wi "onMouseDown" "∆HelpField←'#' ⎕wi 'focus' "[47] list←list OVER "fmCommTable.bnCommutation_TablesQuit"[48] ⎕wself←"fmCommTable.bnCommutation_TablesQuit" ⎕wi "New" "Button"[49] ⎕wi "style" 2[50] ⎕wi "deferexit" 1[51] ⎕wi "extent" (size←1×buttonsize×1⌈CharSize÷13 6)[52] x←0.5×⍴where←Win∆Calcwhere 1,(¯10-size[1]),1,buttonwhere←buttonwhere-5+size[2][53] ⎕wi "∆where" ((x,2)⍴where)[54] ⎕wi "where" (("fmCommTable" ⎕wi "size") Win∆Resize ⎕wi "∆where")[55] ⎕wi "tooltip" "Quit and Return"[56] ⎕wi "onClick" ("fmSV.mCommutation_TablesFile.mQuit"⎕wi "onClick")[57] ⎕wi "caption" "Quit"[58] ⎕wi "∆helpid" 4268[59] ⎕wi "order" .5[60] ⎕wi "visible" ¯1[61] ControlName ⎕wi "∆quitbutton" "fmCommTable.bnCommutation_TablesQuit"[62] list←list OVER "fmCommTable.bnCommutation_TablesSave"[63] ⎕wself←"fmCommTable.bnCommutation_TablesSave" ⎕wi "New" "Button"[64] ⎕wi "extent" (size←1×buttonsize×1⌈CharSize÷13 6)[65] x←0.5×⍴where←Win∆Calcwhere 1,(¯10-size[1]),1,buttonwhere←buttonwhere-5+size[2][66] ⎕wi "∆where" ((x,2)⍴where)[67] ⎕wi "where" (("fmCommTable" ⎕wi "size") Win∆Resize ⎕wi "∆where")[68] ⎕wi "tooltip" "Save Parameters"[69] ⎕wi "onClick" ("fmSV.mCommutation_TablesFile.mSave"⎕wi "onClick")[70] ⎕wi "caption" "Save"[71] :if buttonimage[72]     ⎕wi "imagelist" "fmSV.iStandard"[73]     ⎕wi "imageindex" 9[74] :endif[75] ⎕wi "∆helpid" 4269[76] ⎕wi "enabled" 0[77] ⎕wi "order" .5[78] ⎕wi "visible" ¯1[79] "fmCommTable" ⎕wi "onModified" "('Commutation_Tables' 'fmCommTable.bnCommutation_TablesSave') Win∆SaveEnabled (0≠⎕warg[1])"[80] list←list OVER "fmCommTable.bnCommutation_TablesSaveAs"[81] ⎕wself←"fmCommTable.bnCommutation_TablesSaveAs" ⎕wi "New" "Button"[82] ⎕wi "extent" (size←1×buttonsize×1⌈CharSize÷13 6)[83] x←0.5×⍴where←Win∆Calcwhere 1,(¯10-size[1]),1,buttonwhere←buttonwhere-5+size[2][84] ⎕wi "∆where" ((x,2)⍴where)[85] ⎕wi "where" (("fmCommTable" ⎕wi "size") Win∆Resize ⎕wi "∆where")[86] ⎕wi "tooltip" "Save Parameters As ..."[87] ⎕wi "onClick" ("fmSV.mCommutation_TablesFile.mSaveAs"⎕wi "onClick")[88] ⎕wi "caption" "Save As"[89] ⎕wi "∆helpid" 4270[90] ⎕wi "order" .5[91] ⎕wi "visible" ¯1[92] "fmCommTable" ⎕wi "∆audit" 1[93] [94] :if 300<fnsize[95]     ((1↑⎕lc) fnsize "FrameV - Commutation Factor Calculation") Win∆ProgressBar "MemberUpdate"[96] :endif[97] [98] ⎕wself←"fmCommTable.fCommTCalc" ⎕wi "New" "Frame"[99] ⎕wi "scale" 5[100] ⎕wi "∆where" (4 2⍴0 0 0 0 0.2 0 1 0)[101] ⎕wi "where" (("fmCommTable" ⎕wi "size") Win∆Resize (4 2⍴0 0 0 0 0.2 0 1 0))[102] ⎕wi "caption" "Commutation Factor Calculation"[103] ⎕wi "style" 0[104] ⎕wi "onResize" "AutoResize"[105] [106] ⎕wself←"fmCommTable.fCommTCalc.ckgctCOMValBas" ⎕wi "New" "Check"[107] Fieldlist←Fieldlist OVER "fmCommTable.fCommTCalc.ckgctCOMValBas"[108] Fieldcontrol←Fieldcontrol OVER "Check"[109] ⎕wi "∆name" "gctCOMValBas"[110] ⎕wi "∆type" "Check"[111] ⎕wi "∆helpid" 4271[112] ⎕wi "tooltip" "Check this if Commutation Factors are to be calculated based on the Valuation Basis"[113] ⎕wi "style" 0[114] ⎕wi "caption" "Calculate Commutation Factors based on Valuation Basis"[115] ⎕wi "∆where" (2 2⍴0.3 0 0.35 0)[116] ⎕wi "where" (("fmCommTable.fCommTCalc" ⎕wi "size") Win∆Resize (2 2⍴0.3 0 0.35 0))[117] ⎕wi "extent" ((0 5×CharSize)+Win∆TextSize ⎕wi "caption")[118] ⎕wi "onClick" "(0 0⍴(⊂⎕wi 'name') Commutation_Tables 'Change' )"[119] [120] ⎕wself←"fmCommTable.fCommTCalc.edgctCOMValpc" ⎕wi "New" "Edit"[121] Fieldlist←Fieldlist OVER "fmCommTable.fCommTCalc.edgctCOMValpc"[122] Fieldcontrol←Fieldcontrol OVER "Edit"[123] ⎕wi "∆name" "gctCOMValpc"[124] ⎕wi "∆type" "Num"[125] ⎕wi "∆mandatory" 1[126] ⎕wi "∆valid" ('Int' 'Scalar' '+')[127] ⎕wi "∆helpid" 4272[128] ⎕wi "tooltip" "Specify the % of the Valuation Basis Commutation Factor"[129] ⎕wi "limit" 3[130] ⎕wi "∆where" (2 2⍴0.65 0 0.35 0)[131] ⎕wi "where" (("fmCommTable.fCommTCalc" ⎕wi "size") Win∆Resize (2 2⍴0.65 0 0.35 0))[132] ⎕wi "∆range" "0 100"[133] ⎕wi "onChange" "0 0⍴(⊂⎕wi 'name') Commutation_Tables 'Change' "[134] ⎕wi "onExit" "⍎(0∊⍴,⎕wres←0 INPUT∆CHECK 'fmCommTable.fCommTCalc.edgctCOMValpc')/'0 0⍴(⊂⎕wi ''name'') Commutation_Tables ''Change'' ' "[135] ⎕wi "onExitError" "Win∆ExitError ⎕warg"[136] ⎕wi "onKeyPress" "⎕wres←¯2×~⎕warg∊8 32 48 49 50 51 52 53 54 55 56 57"[137] ⎕wi "extent" (2+CharSize×1 4)[138] [139] ⎕wself←"fmCommTable.fCommTCalc.lrgctCOMValpc" ⎕wi "New" "Label"[140] ⎕wi "scale" 5[141] ⎕wi "extent" (↑⎕wi "Draw" ("?text" "%"))[142] ⎕wi "caption" "%"[143] where←4↑,"fmCommTable.fCommTCalc.edgctCOMValpc" ⎕wi "∆where"[144] x←0.5×⍴where←Win∆Calcwhere where+0,3,0,10+¯1↑"fmCommTable.fCommTCalc.edgctCOMValpc" ⎕wi "extent"[145] ⎕wi "∆where" ((x,2)⍴where)[146] ⎕wi "where" (("fmCommTable.fCommTCalc" ⎕wi "size") Win∆Resize ⎕wi "∆where")[147] [148] ⎕wself←"fmCommTable.fCommTCalc.llgctCOMValpc" ⎕wi "New" "Label"[149] ⎕wi "scale" 5[150] ⎕wi "style" 2[151] ⎕wi "extent" (↑⎕wi "Draw" ("?text" "% of Valuation Basis Factor"))[152] ⎕wi "caption" "% of Valuation Basis Factor"[153] where←4↑,"fmCommTable.fCommTCalc.edgctCOMValpc" ⎕wi "∆where"[154] x←0.5×⍴where←Win∆Calcwhere where-0 ¯3 0,10+¯1↑⎕wi "extent"[155] ⎕wi "∆where" ((x,2)⍴where)[156] ⎕wi "where" (("fmCommTable.fCommTCalc" ⎕wi "size") Win∆Resize ⎕wi "∆where")[157] [158] :if 300<fnsize[159]     ((1↑⎕lc) fnsize "FrameV - Commutation Factors") Win∆ProgressBar "MemberUpdate"[160] :endif[161] [162] ⎕wself←"fmCommTable.fCommF" ⎕wi "New" "Frame"[163] ⎕wi "scale" 5[164] ⎕wi "∆where" (4 2⍴0.2 0 0 0 0.8 ¯45 1 0)[165] ⎕wi "where" (("fmCommTable" ⎕wi "size") Win∆Resize (4 2⍴0.2 0 0 0 0.8 ¯45 1 0))[166] ⎕wi "caption" "Commutation Factors"[167] ⎕wi "style" 0[168] ⎕wi "onResize" "AutoResize"[169] [170] ⎕wself←"fmCommTable.fCommF.edgctCOMTAB2" ⎕wi "New" "Edit"[171] Fieldlist←Fieldlist OVER "fmCommTable.fCommF.edgctCOMTAB2"[172] Fieldcontrol←Fieldcontrol OVER "Edit"[173] ⎕wi "∆name" "gctCOMTAB2"[174] ⎕wi "∆type" "Decr"[175] ⎕wi "∆mandatory" 1[176] ⎕wi "∆valid" ('RA' 'IA' 'EX' 'FX' 'GX' 'HX' 'EF' 'FF' 'GF' 'HF' 'ER' 'FR' 'GR' 'HR')[177] ⎕wi "∆helpid" 4273[178] ⎕wi "tooltip" "Specify the Table Code of the Commutation Factor Table
(Right Click for List, Double Click for Rate Tables Display or '<' or '>' to Scroll through the Rate Tables)"[179] ⎕wi "limit" 5[180] ⎕wi "∆where" (2 2⍴0.1 0 0.35 0)[181] ⎕wi "where" (("fmCommTable.fCommF" ⎕wi "size") Win∆Resize (2 2⍴0.1 0 0.35 0))[182] ⎕wi "onExit" "⍎(0∊⍴,⎕wres←0 INPUT∆CHECK 'fmCommTable.fCommF.edgctCOMTAB2')/'0 0⍴(⊂⎕wi ''name'') Commutation_Tables ''Change'' ' "[183] ⎕wi "onExitError" "Win∆ExitError ⎕warg"[184] ⎕wi "extent" (2+CharSize×1 6)[185] ⎕wi "keys" (60 62)[186] ⎕wi "pointer" ">cur 1001 shell32.dll"[187] ⎕wi "onFocus" "0 0⍴GetDecrList 'List' "[188] ⎕wi "onKeyPress" "(⎕wi 'self') Win∆DecrToggle ⎕wi '∆valid' "[189] ⎕wi "onMouseDown" "(⎕wi 'self') Win∆DecrPopup ⎕wi '∆valid' "[190] ⎕wi "onMouseDouble" "(⎕wi '∆valid') RunDecr 'Form'"[191] ⎕wi "onChange" "(⎕wi 'self') Win∆LabelUpdate (FormName ⎕wi '∆decrdesc') (FormName ⎕wi '∆decrlist') ⋄ 0 0⍴(⊂⎕wi 'name') Commutation_Tables 'Change' "[192] ⎕wi "∆rightlabel" "fmCommTable.fCommF.lrgctCOMTAB2"[193] [194] ⎕wself←"fmCommTable.fCommF.llgctCOMTAB2" ⎕wi "New" "Label"[195] ⎕wi "scale" 5[196] ⎕wi "style" 2[197] ⎕wi "extent" (↑⎕wi "Draw" ("?text" "Main Increase Commutation Table"))[198] ⎕wi "caption" "Main Increase Commutation Table"[199] where←4↑,"fmCommTable.fCommF.edgctCOMTAB2" ⎕wi "∆where"[200] x←0.5×⍴where←Win∆Calcwhere where-0 ¯3 0,10+¯1↑⎕wi "extent"[201] ⎕wi "∆where" ((x,2)⍴where)[202] ⎕wi "where" (("fmCommTable.fCommF" ⎕wi "size") Win∆Resize ⎕wi "∆where")[203] [204] ⎕wself←"fmCommTable.fCommF.lrgctCOMTAB2" ⎕wi "New" "Label"[205] ⎕wi "scale" 5[206] ⎕wi "extent" (CharSize×¯2↑1,45)[207] ⎕wi "style" 32[208] ⎕wi "caption" " "[209] where←4↑,"fmCommTable.fCommF.edgctCOMTAB2" ⎕wi "∆where"[210] x←0.5×⍴where←Win∆Calcwhere where+0,3,0,10+¯1↑"fmCommTable.fCommF.edgctCOMTAB2" ⎕wi "extent"[211] ⎕wi "∆where" ((x,2)⍴where)[212] ⎕wi "where" (("fmCommTable.fCommF" ⎕wi "size") Win∆Resize ⎕wi "∆where")[213] [214] ⎕wself←"fmCommTable.fCommF.edgctCOMTAB1" ⎕wi "New" "Edit"[215] Fieldlist←Fieldlist OVER "fmCommTable.fCommF.edgctCOMTAB1"[216] Fieldcontrol←Fieldcontrol OVER "Edit"[217] ⎕wi "∆name" "gctCOMTAB1"[218] ⎕wi "∆type" "Decr"[219] ⎕wi "∆mandatory" 1[220] ⎕wi "∆valid" ('RA' 'IA' 'EX' 'FX' 'GX' 'HX' 'EF' 'FF' 'GF' 'HF' 'ER' 'FR' 'GR' 'HR')[221] ⎕wi "∆helpid" 4273[222] ⎕wi "tooltip" "Specify the Table Code of the Commutation Factor Table
(Right Click for List, Double Click for Rate Tables Display or '<' or '>' to Scroll through the Rate Tables)"[223] ⎕wi "limit" 5[224] ⎕wi "∆where" (2 2⍴0.28 0 0.35 0)[225] ⎕wi "where" (("fmCommTable.fCommF" ⎕wi "size") Win∆Resize (2 2⍴0.28 0 0.35 0))[226] ⎕wi "onExit" "⍎(0∊⍴,⎕wres←0 INPUT∆CHECK 'fmCommTable.fCommF.edgctCOMTAB1')/'0 0⍴(⊂⎕wi ''name'') Commutation_Tables ''Change'' ' "[227] ⎕wi "onExitError" "Win∆ExitError ⎕warg"[228] ⎕wi "extent" (2+CharSize×1 6)[229] ⎕wi "keys" (60 62)[230] ⎕wi "pointer" ">cur 1001 shell32.dll"[231] ⎕wi "onFocus" "0 0⍴GetDecrList 'List' "[232] ⎕wi "onKeyPress" "(⎕wi 'self') Win∆DecrToggle ⎕wi '∆valid' "[233] ⎕wi "onMouseDown" "(⎕wi 'self') Win∆DecrPopup ⎕wi '∆valid' "[234] ⎕wi "onMouseDouble" "(⎕wi '∆valid') RunDecr 'Form'"[235] ⎕wi "onChange" "(⎕wi 'self') Win∆LabelUpdate (FormName ⎕wi '∆decrdesc') (FormName ⎕wi '∆decrlist') ⋄ 0 0⍴(⊂⎕wi 'name') Commutation_Tables 'Change' "[236] ⎕wi "∆rightlabel" "fmCommTable.fCommF.lrgctCOMTAB1"[237] [238] ⎕wself←"fmCommTable.fCommF.llgctCOMTAB1" ⎕wi "New" "Label"[239] ⎕wi "scale" 5[240] ⎕wi "style" 2[241] ⎕wi "extent" (↑⎕wi "Draw" ("?text" "Special Increase Commutation Table"))[242] ⎕wi "caption" "Special Increase Commutation Table"[243] where←4↑,"fmCommTable.fCommF.edgctCOMTAB1" ⎕wi "∆where"[244] x←0.5×⍴where←Win∆Calcwhere where-0 ¯3 0,10+¯1↑⎕wi "extent"[245] ⎕wi "∆where" ((x,2)⍴where)[246] ⎕wi "where" (("fmCommTable.fCommF" ⎕wi "size") Win∆Resize ⎕wi "∆where")[247] [248] ⎕wself←"fmCommTable.fCommF.lrgctCOMTAB1" ⎕wi "New" "Label"[249] ⎕wi "scale" 5[250] ⎕wi "extent" (CharSize×¯2↑1,45)[251] ⎕wi "style" 32[252] ⎕wi "caption" " "[253] where←4↑,"fmCommTable.fCommF.edgctCOMTAB1" ⎕wi "∆where"[254] x←0.5×⍴where←Win∆Calcwhere where+0,3,0,10+¯1↑"fmCommTable.fCommF.edgctCOMTAB1" ⎕wi "extent"[255] ⎕wi "∆where" ((x,2)⍴where)[256] ⎕wi "where" (("fmCommTable.fCommF" ⎕wi "size") Win∆Resize ⎕wi "∆where")[257] [258] ⎕wself←"fmCommTable.fCommF.edgctCOMTAB3" ⎕wi "New" "Edit"[259] Fieldlist←Fieldlist OVER "fmCommTable.fCommF.edgctCOMTAB3"[260] Fieldcontrol←Fieldcontrol OVER "Edit"[261] ⎕wi "∆name" "gctCOMTAB3"[262] ⎕wi "∆type" "Decr"[263] ⎕wi "∆mandatory" 1[264] ⎕wi "∆valid" ('RA' 'IA' 'EX' 'FX' 'GX' 'HX' 'EF' 'FF' 'GF' 'HF' 'ER' 'FR' 'GR' 'HR')[265] ⎕wi "∆helpid" 4273[266] ⎕wi "tooltip" "Specify the Table Code of the Commutation Factor Table
(Right Click for List, Double Click for Rate Tables Display or '<' or '>' to Scroll through the Rate Tables)"[267] ⎕wi "limit" 5[268] ⎕wi "∆where" (2 2⍴0.46 0 0.35 0)[269] ⎕wi "where" (("fmCommTable.fCommF" ⎕wi "size") Win∆Resize (2 2⍴0.46 0 0.35 0))[270] ⎕wi "onExit" "⍎(0∊⍴,⎕wres←0 INPUT∆CHECK 'fmCommTable.fCommF.edgctCOMTAB3')/'0 0⍴(⊂⎕wi ''name'') Commutation_Tables ''Change'' ' "[271] ⎕wi "onExitError" "Win∆ExitError ⎕warg"[272] ⎕wi "extent" (2+CharSize×1 6)[273] ⎕wi "keys" (60 62)[274] ⎕wi "pointer" ">cur 1001 shell32.dll"[275] ⎕wi "onFocus" "0 0⍴GetDecrList 'List' "[276] ⎕wi "onKeyPress" "(⎕wi 'self') Win∆DecrToggle ⎕wi '∆valid' "[277] ⎕wi "onMouseDown" "(⎕wi 'self') Win∆DecrPopup ⎕wi '∆valid' "[278] ⎕wi "onMouseDouble" "(⎕wi '∆valid') RunDecr 'Form'"[279] ⎕wi "onChange" "(⎕wi 'self') Win∆LabelUpdate (FormName ⎕wi '∆decrdesc') (FormName ⎕wi '∆decrlist') ⋄ 0 0⍴(⊂⎕wi 'name') Commutation_Tables 'Change' "[280] ⎕wi "∆rightlabel" "fmCommTable.fCommF.lrgctCOMTAB3"[281] [282] ⎕wself←"fmCommTable.fCommF.llgctCOMTAB3" ⎕wi "New" "Label"[283] ⎕wi "scale" 5[284] ⎕wi "style" 2[285] ⎕wi "extent" (↑⎕wi "Draw" ("?text" "PenInc3 Commutation Table"))[286] ⎕wi "caption" "PenInc3 Commutation Table"[287] where←4↑,"fmCommTable.fCommF.edgctCOMTAB3" ⎕wi "∆where"[288] x←0.5×⍴where←Win∆Calcwhere where-0 ¯3 0,10+¯1↑⎕wi "extent"[289] ⎕wi "∆where" ((x,2)⍴where)[290] ⎕wi "where" (("fmCommTable.fCommF" ⎕wi "size") Win∆Resize ⎕wi "∆where")[291] [292] ⎕wself←"fmCommTable.fCommF.lrgctCOMTAB3" ⎕wi "New" "Label"[293] ⎕wi "scale" 5[294] ⎕wi "extent" (CharSize×¯2↑1,45)[295] ⎕wi "style" 32[296] ⎕wi "caption" " "[297] where←4↑,"fmCommTable.fCommF.edgctCOMTAB3" ⎕wi "∆where"[298] x←0.5×⍴where←Win∆Calcwhere where+0,3,0,10+¯1↑"fmCommTable.fCommF.edgctCOMTAB3" ⎕wi "extent"[299] ⎕wi "∆where" ((x,2)⍴where)[300] ⎕wi "where" (("fmCommTable.fCommF" ⎕wi "size") Win∆Resize ⎕wi "∆where")[301] [302] ⎕wself←"fmCommTable.fCommF.edgctCOMTAB4" ⎕wi "New" "Edit"[303] Fieldlist←Fieldlist OVER "fmCommTable.fCommF.edgctCOMTAB4"[304] Fieldcontrol←Fieldcontrol OVER "Edit"[305] ⎕wi "∆name" "gctCOMTAB4"[306] ⎕wi "∆type" "Decr"[307] ⎕wi "∆mandatory" 1[308] ⎕wi "∆valid" ('RA' 'IA' 'EX' 'FX' 'GX' 'HX' 'EF' 'FF' 'GF' 'HF' 'ER' 'FR' 'GR' 'HR')[309] ⎕wi "∆helpid" 4273[310] ⎕wi "tooltip" "Specify the Table Code of the Commutation Factor Table
(Right Click for List, Double Click for Rate Tables Display or '<' or '>' to Scroll through the Rate Tables)"[311] ⎕wi "limit" 5[312] ⎕wi "∆where" (2 2⍴0.64 0 0.35 0)[313] ⎕wi "where" (("fmCommTable.fCommF" ⎕wi "size") Win∆Resize (2 2⍴0.64 0 0.35 0))[314] ⎕wi "onExit" "⍎(0∊⍴,⎕wres←0 INPUT∆CHECK 'fmCommTable.fCommF.edgctCOMTAB4')/'0 0⍴(⊂⎕wi ''name'') Commutation_Tables ''Change'' ' "[315] ⎕wi "onExitError" "Win∆ExitError ⎕warg"[316] ⎕wi "extent" (2+CharSize×1 6)[317] ⎕wi "keys" (60 62)[318] ⎕wi "pointer" ">cur 1001 shell32.dll"[319] ⎕wi "onFocus" "0 0⍴GetDecrList 'List' "[320] ⎕wi "onKeyPress" "(⎕wi 'self') Win∆DecrToggle ⎕wi '∆valid' "[321] ⎕wi "onMouseDown" "(⎕wi 'self') Win∆DecrPopup ⎕wi '∆valid' "[322] ⎕wi "onMouseDouble" "(⎕wi '∆valid') RunDecr 'Form'"[323] ⎕wi "onChange" "(⎕wi 'self') Win∆LabelUpdate (FormName ⎕wi '∆decrdesc') (FormName ⎕wi '∆decrlist') ⋄ 0 0⍴(⊂⎕wi 'name') Commutation_Tables 'Change' "[324] ⎕wi "∆rightlabel" "fmCommTable.fCommF.lrgctCOMTAB4"[325] [326] ⎕wself←"fmCommTable.fCommF.llgctCOMTAB4" ⎕wi "New" "Label"[327] ⎕wi "scale" 5[328] ⎕wi "style" 2[329] ⎕wi "extent" (↑⎕wi "Draw" ("?text" "PenInc4 Commutation Table"))[330] ⎕wi "caption" "PenInc4 Commutation Table"[331] where←4↑,"fmCommTable.fCommF.edgctCOMTAB4" ⎕wi "∆where"[332] x←0.5×⍴where←Win∆Calcwhere where-0 ¯3 0,10+¯1↑⎕wi "extent"[333] ⎕wi "∆where" ((x,2)⍴where)[334] ⎕wi "where" (("fmCommTable.fCommF" ⎕wi "size") Win∆Resize ⎕wi "∆where")[335] [336] ⎕wself←"fmCommTable.fCommF.lrgctCOMTAB4" ⎕wi "New" "Label"[337] ⎕wi "scale" 5[338] ⎕wi "extent" (CharSize×¯2↑1,45)[339] ⎕wi "style" 32[340] ⎕wi "caption" " "[341] where←4↑,"fmCommTable.fCommF.edgctCOMTAB4" ⎕wi "∆where"[342] x←0.5×⍴where←Win∆Calcwhere where+0,3,0,10+¯1↑"fmCommTable.fCommF.edgctCOMTAB4" ⎕wi "extent"[343] ⎕wi "∆where" ((x,2)⍴where)[344] ⎕wi "where" (("fmCommTable.fCommF" ⎕wi "size") Win∆Resize ⎕wi "∆where")[345] [346] ⎕wself←"fmCommTable.fCommF.ckgctCOMTABExactAge" ⎕wi "New" "Check"[347] Fieldlist←Fieldlist OVER "fmCommTable.fCommF.ckgctCOMTABExactAge"[348] Fieldcontrol←Fieldcontrol OVER "Check"[349] ⎕wi "∆name" "gctCOMTABExactAge"[350] ⎕wi "∆type" "Check"[351] ⎕wi "∆helpid" 4274[352] ⎕wi "tooltip" "Check this if Commutation Tables need to be interpolated for mid-point Exit ages (required if Tables are to be used for varying Normal Retirement Ages)"[353] ⎕wi "style" 0[354] ⎕wi "caption" "Linearly Interpolate Commutation Tables for mid-point Exit values"[355] ⎕wi "∆where" (2 2⍴0.77 0 0.35 0)[356] ⎕wi "where" (("fmCommTable.fCommF" ⎕wi "size") Win∆Resize (2 2⍴0.77 0 0.35 0))[357] ⎕wi "extent" ((0 5×CharSize)+Win∆TextSize ⎕wi "caption")[358] ⎕wi "onClick" "(0 0⍴(⊂⎕wi 'name') Commutation_Tables 'Change' )"[359] [360] ⎕wself←"fmCommTable.fCommF.ckgctCOMAdjbyEx" ⎕wi "New" "Check"[361] Fieldlist←Fieldlist OVER "fmCommTable.fCommF.ckgctCOMAdjbyEx"[362] Fieldcontrol←Fieldcontrol OVER "Check"[363] ⎕wi "∆name" "gctCOMAdjbyEx"[364] ⎕wi "∆type" "Check"[365] ⎕wi "∆helpid" 4275[366] ⎕wi "tooltip" "Check this if Commutation Tables are to be adjusted by the change in member's expectation of life"[367] ⎕wi "style" 0[368] ⎕wi "caption" "Adjust Commutation Tables by the change in member's expectation of life"[369] ⎕wi "∆where" (2 2⍴0.9 0 0.35 0)[370] ⎕wi "where" (("fmCommTable.fCommF" ⎕wi "size") Win∆Resize (2 2⍴0.9 0 0.35 0))[371] ⎕wi "extent" ((0 5×CharSize)+Win∆TextSize ⎕wi "caption")[372] ⎕wi "onClick" "(0 0⍴(⊂⎕wi 'name') Commutation_Tables 'Change' )"[373] [374] ⎕wself←"fmCommTable.lParmDesc" ⎕wi "New" "Label"[375] ⎕wi "scale" 5[376] ⎕wi "extent" (CharSize×¯2↑1,80)[377] ⎕wi "style" 32[378] ⎕wi "caption" " "[379] ⎕wi "∆where" (2 2⍴0.96 0 0.02 0)[380] ⎕wi "where" (("fmCommTable" ⎕wi "size") Win∆Resize (2 2⍴0.96 0 0.02 0))[381] [382] "fmCommTable" ⎕wi "∆multifile" ""[383] "fmCommTable" ⎕wi "∆singlefile" ""[384] "fmCommTable" ⎕wi "∆format" ""[385] "fmCommTable" ⎕wi "∆financial" 0[386] "fmCommTable" ⎕wi "∆relrules" 1[387] "fmCommTable" ⎕wi "∆parm" 0[388] "fmCommTable" ⎕wi "∆decr" 1[389] "fmCommTable" ⎕wi "∆file" 0[390] "fmCommTable" ⎕wi "∆codefile" CodeFile[391] "fmCommTable" ⎕wi "∆inputstype" "ClientFile"[392] "fmCommTable" ⎕wi "∆inputsentry" "Multi"[393] "fmCommTable" ⎕wi "∆savecn" (⍳0)[394] "fmCommTable" ⎕wi "∆savedesc" ""[395] list←list OVER "fmCommTable"[396] "fmCommTable" ⎕wi "∆fieldlist" Fieldlist[397] "fmCommTable" ⎕wi "∆fieldcontrol" Fieldcontrol[398] childlist←"fmSV" ⎕wi "∆childlist"[399] list←(⊃¯1↑childlist) OVER list[400] childlist[⍴childlist]←⊂list[401] "fmSV" ⎕wi "∆childlist" childlist[402] list←,⎕split list[403] 0 0⍴((∨/¨(⊂".mCommutation_Tables")⍷¨list)/list) MultiWI "enabled" 1[404] :if 300<fnsize[405]     (fnsize fnsize ".") Win∆ProgressBar "MemberUpdate"[406]     Win∆ProgressBar "Hide"[407] :endif[408] "Init" OpenParameters "Commutation_Tables"[409] "fmCommTable.bnCommutation_TablesHelp" ⎕wi "visible" 1[410] "fmCommTable.bnCommutation_TablesQuit" ⎕wi "visible" 1[411] "fmCommTable.bnCommutation_TablesSave" ⎕wi "visible" 1[412] "fmCommTable.bnCommutation_TablesSaveAs" ⎕wi "visible" 1[413] "#" ⎕wi "focus" "fmCommTable.fCommTCalc.ckgctCOMValBas"[414] :if ~0∊⍴,Error←Win∆Initialise "Commutation_Tables"[415]     "Quit" EndModule Module[416]     "fmSV" ⎕wi "pointer" 0[417]     0 0⍴"fmCommTable" ⎕wi "Delete"[418]     :return[419] :endif[420] :if bar_open←commandbar^"Multi"≡"Multi"[421]     bar_open←0×"fmCommTable.mCommutation_TablesFile.m" Win∆CommandBar "SaveAsHelp"[422] :endif[423] "fmCommTable" ⎕wi "Paint"[424] "fmSV" ⎕wi "pointer" 11[425] "fmCommTable" ⎕wi "onWait" "0 0⍴Commutation_Tables 'Wait'"[426] 0 0⍴"fmCommTable" ⎕wi "Wait"[427] 0 0⍴"fmCommTable" ⎕wi "Delete"[428] "fmSV" ⎕wi "pointer" 0 ∇