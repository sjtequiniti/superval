∇ Container←Form_Make;⎕wself;ControlName;childlist;list;Fieldlist;Fieldcontrol;FrameWidth;Caption;buttonsize;buttonwhere;where;size;alignment;Header;PickList;NameList;value;sortorder;SortList;MaxRow;MaxCol;Parent;level;node;no;nn;NN;x;fnsize;framelist;relTests[1] [2] Fieldlist←Fieldcontrol←list←0 0⍴""[3] "fmSV" ⎕wi "pointer" 13[4] buttonsize←25 65 ⋄ buttonwhere←¯5[5] FormName ⎕wi "caption" ((FormName ⎕wi "caption")," - Edit PUPs")[6] "fmSV" ⎕wi "∆caption" (("fmSV" ⎕wi "∆caption"),⊂("fmSV" ⎕wi "caption"))[7] :if 300<fnsize←1↑⍴⎕cr "Form_Make"[8]     "Generating Form" Win∆ProgressBar "Open"[9]     ("Menu Items:" "Form Controls:") Win∆ProgressBar "SetLabels"[10]     (1 1 "Help About") Win∆ProgressBar "FileUpdate"[11] :endif[12] [13] Container←"∆Dialog"[14] [15] ⎕wself←"fmEditIndPUP" ⎕wi "New" "Form" "Hide"[16] ⎕wi "caption" ("fmSV" ⎕wi "caption")[17] ⎕wi "scale" 5[18] ⎕wi "font" ("fmSV" ⎕wi "font")[19] ⎕wi "border" 2 32 64[20] ⎕wi "where" (Win∆CentrePos 1.2 1.2 ×768 1024×1⌈CharSize÷13 6)[21] ⎕wi "limitwhere" (0.8×¯2↑⎕wi "where")[22] ⎕wi "tooltipwidth" 200[23] ⎕wi "onResize" "AutoResize"[24] ⎕wi "onClose" "ExitSystem ''"[25] ControlName←"fmEditIndPUP"[26] relTests←2[27] 0 Menu_Make "fmSV"[28] 1 Menu_Make "fmEditIndPUP"[29] "fmEditIndPUP" Win∆CutCopyPaste "Build"[30] "fmEditIndPUP" ⎕wi "∆helpid" 2227[31] list←list OVER "fmEditIndPUP.bnEdit_IndPUPHelp"[32] ⎕wself←"fmEditIndPUP.bnEdit_IndPUPHelp" ⎕wi "New" "Button"[33] ⎕wi "deferexit" 1[34] ⎕wi "extent" (size←1×buttonsize×1⌈CharSize÷13 6)[35] x←0.5×⍴where←Win∆Calcwhere 1,(¯10-size[1]),1,buttonwhere←buttonwhere-5+size[2][36] ⎕wi "∆where" ((x,2)⍴where)[37] ⎕wi "where" (("fmEditIndPUP" ⎕wi "size") Win∆Resize ⎕wi "∆where")[38] ⎕wi "tooltip" "SuperVal Help"[39] ⎕wi "onClick" ("fmSV.mEdit_IndPUPHelp.mContext"⎕wi "onClick")[40] ⎕wi "caption" "Help"[41] :if buttonimage[42]     ⎕wi "imagelist" "fmSV.iStandard"[43]     ⎕wi "imageindex" 12[44] :endif[45] ⎕wi "visible" ¯1[46] ⎕wi "onMouseDown" "∆HelpField←'#' ⎕wi 'focus' "[47] list←list OVER "fmEditIndPUP.bnEdit_IndPUPQuit"[48] ⎕wself←"fmEditIndPUP.bnEdit_IndPUPQuit" ⎕wi "New" "Button"[49] ⎕wi "style" 2[50] ⎕wi "deferexit" 1[51] ⎕wi "extent" (size←1×buttonsize×1⌈CharSize÷13 6)[52] x←0.5×⍴where←Win∆Calcwhere 1,(¯10-size[1]),1,buttonwhere←buttonwhere-5+size[2][53] ⎕wi "∆where" ((x,2)⍴where)[54] ⎕wi "where" (("fmEditIndPUP" ⎕wi "size") Win∆Resize ⎕wi "∆where")[55] ⎕wi "tooltip" "Cancel and Return"[56] ⎕wi "onClick" ("fmSV.mEdit_IndPUPFile.mQuit"⎕wi "onClick")[57] ⎕wi "caption" "Cancel"[58] ⎕wi "∆helpid" 5156[59] ⎕wi "order" .5[60] ⎕wi "visible" ¯1[61] list←list OVER "fmEditIndPUP.bnEdit_IndPUPSave"[62] ⎕wself←"fmEditIndPUP.bnEdit_IndPUPSave" ⎕wi "New" "Button"[63] ⎕wi "style" 1[64] ⎕wi "extent" (size←1×buttonsize×1⌈CharSize÷13 6)[65] x←0.5×⍴where←Win∆Calcwhere 1,(¯10-size[1]),1,buttonwhere←buttonwhere-5+size[2][66] ⎕wi "∆where" ((x,2)⍴where)[67] ⎕wi "where" (("fmEditIndPUP" ⎕wi "size") Win∆Resize ⎕wi "∆where")[68] ⎕wi "tooltip" "Save Parameters"[69] ⎕wi "onClick" ("fmSV.mEdit_IndPUPFile.mSave"⎕wi "onClick")[70] ⎕wi "caption" "OK"[71] ⎕wi "∆helpid" 5157[72] ⎕wi "order" .5[73] ⎕wi "visible" ¯1[74] [75] ⎕wself←"fmEditIndPUP.cbFormattrick" ⎕wi "New" "Combo"[76] Fieldlist←Fieldlist OVER "fmEditIndPUP.cbFormattrick"[77] Fieldcontrol←Fieldcontrol OVER "Combo"[78] ⎕wi "∆name" "Formattrick"[79] ⎕wi "∆type" "Format"[80] ⎕wi "enabled" (0)[81] ⎕wi "∆valid" ('D')[82] ⎕wi "tooltip" "Select the Data Format of File"[83] ⎕wi "style" 16 128 256 2[84] ⎕wi "∆where" (2 2⍴1 0 1 0)[85] ⎕wi "where" (("fmEditIndPUP" ⎕wi "size") Win∆Resize (2 2⍴1 0 1 0))[86] PickList←Formats 'D'[87] ⎕wi "∆update" "Formats 'D'"[88] PickList←⊃m2n 1 0↓PickList[89] PickList←" " OVER PickList[90] ⎕wi "list" PickList[91] ⎕wi "extent" (150,(¯10+6×¯1↑CharSize)+¯1↑(50×CharSize)⌊Win∆TextSize PickList)[92] ⎕wi "onClick" "0 0⍴(⊂⎕wi 'name') Edit_IndPUP 'Change' ⋄ UpdateDataVars"[93] [94] ⎕wself←"fmEditIndPUP.edPUPDESC" ⎕wi "New" "Edit"[95] Fieldlist←Fieldlist OVER "fmEditIndPUP.edPUPDESC"[96] Fieldcontrol←Fieldcontrol OVER "Edit"[97] ⎕wi "∆name" "PUPDESC"[98] ⎕wi "∆type" "Char"[99] ⎕wi "∆helpid" 5158[100] ⎕wi "∆where" (2 2⍴0.02 0 0.45 0)[101] ⎕wi "where" (("fmEditIndPUP" ⎕wi "size") Win∆Resize (2 2⍴0.02 0 0.45 0))[102] ⎕wi "onChange" "0 0⍴(⊂⎕wi 'name') Edit_IndPUP 'Change' "[103] ⎕wi "onExit" "⍎(0∊⍴,⎕wres←0 INPUT∆CHECK 'fmEditIndPUP.edPUPDESC')/'0 0⍴(⊂⎕wi ''name'') Edit_IndPUP ''Change'' ' "[104] ⎕wi "onExitError" "Win∆ExitError ⎕warg"[105] ⎕wi "extent" (2+CharSize×1 31)[106] [107] ⎕wself←"fmEditIndPUP.llPUPDESC" ⎕wi "New" "Label"[108] ⎕wi "scale" 5[109] ⎕wi "style" 2[110] ⎕wi "extent" (↑⎕wi "Draw" ("?text" "Independent PUP Description"))[111] ⎕wi "caption" "Independent PUP Description"[112] where←4↑,"fmEditIndPUP.edPUPDESC" ⎕wi "∆where"[113] x←0.5×⍴where←Win∆Calcwhere where-0 ¯3 0,10+¯1↑⎕wi "extent"[114] ⎕wi "∆where" ((x,2)⍴where)[115] ⎕wi "where" (("fmEditIndPUP" ⎕wi "size") Win∆Resize ⎕wi "∆where")[116] [117] :if 300<fnsize[118]     ((1↑⎕lc) fnsize "FrameV - Independent PUP Payment Parameters") Win∆ProgressBar "MemberUpdate"[119] :endif[120] [121] ⎕wself←"fmEditIndPUP.fPUPPay" ⎕wi "New" "Frame"[122] ⎕wi "scale" 5[123] ⎕wi "∆where" (4 2⍴0.06 0 0 0 0.42 0 1 0)[124] ⎕wi "where" (("fmEditIndPUP" ⎕wi "size") Win∆Resize (4 2⍴0.06 0 0 0 0.42 0 1 0))[125] ⎕wi "caption" "Independent PUP Payment Parameters"[126] ⎕wi "style" 0[127] ⎕wi "onResize" "AutoResize"[128] [129] ⎕wself←"fmEditIndPUP.fPUPPay.cbpup" ⎕wi "New" "Combo"[130] Fieldlist←Fieldlist OVER "fmEditIndPUP.fPUPPay.cbpup"[131] Fieldcontrol←Fieldcontrol OVER "Combo"[132] ⎕wi "∆name" "pup"[133] ⎕wi "∆type" "Char"[134] ⎕wi "∆mandatory" 1[135] ⎕wi "∆valid" ('Scalar' '+')[136] ⎕wi "∆helpid" 5159[137] ⎕wi "style" 16 128 256 2[138] ⎕wi "∆where" (2 2⍴0.06 0 0.2 0)[139] ⎕wi "where" (("fmEditIndPUP.fPUPPay" ⎕wi "size") Win∆Resize (2 2⍴0.06 0 0.2 0))[140] PickList←GetVarNumList 'All'[141] ⎕wi "∆update" "GetVarNumList 'All'"[142] PickList←⊃m2n 1 0↓PickList[143] ⎕wi "list" PickList[144] ⎕wi "extent" (150,(¯10+6×¯1↑CharSize)+¯1↑Win∆TextSize ((0,⎕wi "limit")⌈⍴PickList)↑PickList)[145] ⎕wi "onClick" "0 0⍴(⊂⎕wi 'name') Edit_IndPUP 'Change' "[146] [147] ⎕wself←"fmEditIndPUP.fPUPPay.llpup" ⎕wi "New" "Label"[148] ⎕wi "scale" 5[149] ⎕wi "style" 2[150] ⎕wi "extent" (↑⎕wi "Draw" ("?text" "PUP Amount"))[151] ⎕wi "caption" "PUP Amount"[152] where←4↑,"fmEditIndPUP.fPUPPay.cbpup" ⎕wi "∆where"[153] x←0.5×⍴where←Win∆Calcwhere where-0 ¯3 0,10+¯1↑⎕wi "extent"[154] ⎕wi "∆where" ((x,2)⍴where)[155] ⎕wi "where" (("fmEditIndPUP.fPUPPay" ⎕wi "size") Win∆Resize ⎕wi "∆where")[156] [157] ⎕wself←"fmEditIndPUP.fPUPPay.cbindrev" ⎕wi "New" "Combo"[158] Fieldlist←Fieldlist OVER "fmEditIndPUP.fPUPPay.cbindrev"[159] Fieldcontrol←Fieldcontrol OVER "Combo"[160] ⎕wi "∆name" "indrev"[161] ⎕wi "∆type" "Char"[162] ⎕wi "∆helpid" 5160[163] ⎕wi "style" 16 128 256 2[164] ⎕wi "∆where" (2 2⍴0.18 0 0.2 0)[165] ⎕wi "where" (("fmEditIndPUP.fPUPPay" ⎕wi "size") Win∆Resize (2 2⍴0.18 0 0.2 0))[166] PickList←GetFinList 'Rev'[167] ⎕wi "∆update" "GetFinList 'Rev'"[168] PickList←⊃m2n 1 0↓PickList[169] PickList←" " OVER PickList[170] ⎕wi "list" PickList[171] ⎕wi "extent" (150,(¯10+6×¯1↑CharSize)+¯1↑Win∆TextSize ((0,⎕wi "limit")⌈⍴PickList)↑PickList)[172] ⎕wi "onClick" "(⎕wi 'self') Win∆FinLabelUpdate ⊃¨(⊂⍙FinAssdict) at¨'List' 'Label' ⋄ 0 0⍴(⊂⎕wi 'name') Edit_IndPUP 'Change' "[173] ⎕wi "∆rightlabel" "fmEditIndPUP.fPUPPay.lrindrev"[174] [175] ⎕wself←"fmEditIndPUP.fPUPPay.lrindrev" ⎕wi "New" "Label"[176] ⎕wi "scale" 5[177] ⎕wi "extent" (CharSize×¯2↑1,2 45)[178] ⎕wi "caption" " "[179] where←4↑,"fmEditIndPUP.fPUPPay.cbindrev" ⎕wi "∆where"[180] x←0.5×⍴where←Win∆Calcwhere where+0,¯3,0,10+¯1↑"fmEditIndPUP.fPUPPay.cbindrev" ⎕wi "extent"[181] ⎕wi "∆where" ((x,2)⍴where)[182] ⎕wi "where" (("fmEditIndPUP.fPUPPay" ⎕wi "size") Win∆Resize ⎕wi "∆where")[183] [184] ⎕wself←"fmEditIndPUP.fPUPPay.llindrev" ⎕wi "New" "Label"[185] ⎕wi "scale" 5[186] ⎕wi "style" 2[187] ⎕wi "extent" (↑⎕wi "Draw" ("?text" "Revaluation Rate Override"))[188] ⎕wi "caption" "Revaluation Rate Override"[189] where←4↑,"fmEditIndPUP.fPUPPay.cbindrev" ⎕wi "∆where"[190] x←0.5×⍴where←Win∆Calcwhere where-0 ¯3 0,10+¯1↑⎕wi "extent"[191] ⎕wi "∆where" ((x,2)⍴where)[192] ⎕wi "where" (("fmEditIndPUP.fPUPPay" ⎕wi "size") Win∆Resize ⎕wi "∆where")[193] [194] ⎕wself←"fmEditIndPUP.fPUPPay.cbindwarfrac" ⎕wi "New" "Combo"[195] Fieldlist←Fieldlist OVER "fmEditIndPUP.fPUPPay.cbindwarfrac"[196] Fieldcontrol←Fieldcontrol OVER "Combo"[197] ⎕wi "∆name" "indwarfrac"[198] ⎕wi "∆type" "Num"[199] ⎕wi "∆valid" ('Scalar' '0+')[200] ⎕wi "∆helpid" 5161[201] ⎕wi "limit" 8[202] ⎕wi "onExit" "⍎(mt ,⎕wres←0 INPUT∆CHECK 'fmEditIndPUP.fPUPPay.cbindwarfrac')/'0 0⍴(⊂⎕wi ''name'') Edit_IndPUP ''Change'' ' "[203] ⎕wi "onExitError" "Win∆ExitError ⎕warg"[204] ⎕wi "onKeyPress" "⎕wres←¯2×~⎕warg∊46 8 32 48 49 50 51 52 53 54 55 56 57"[205] ⎕wi "style" 16 128 256 0[206] ⎕wi "∆where" (2 2⍴0.3 0 0.2 0)[207] ⎕wi "where" (("fmEditIndPUP.fPUPPay" ⎕wi "size") Win∆Resize (2 2⍴0.3 0 0.2 0))[208] PickList←GetVarNumList 'All'[209] ⎕wi "∆update" "GetVarNumList 'All'"[210] PickList←⊃m2n 1 0↓PickList[211] PickList←" " OVER PickList[212] ⎕wi "list" PickList[213] ⎕wi "extent" (150,(¯10+8×¯1↑CharSize)+¯1↑Win∆TextSize ((0,⎕wi "limit")⌈⍴PickList)↑PickList)[214] ⎕wi "onClick" "0 0⍴(⊂⎕wi 'name') Edit_IndPUP 'Change' "[215] ⎕wi "onChange" "Win∆ComboFudge ⎕wi 'self' ⋄ 0 0⍴(⊂⎕wi 'name') Edit_IndPUP 'Change' "[216] ⎕wi "∆rightlabel" "fmEditIndPUP.fPUPPay.lrindwarfrac"[217] [218] ⎕wself←"fmEditIndPUP.fPUPPay.lrindwarfrac" ⎕wi "New" "Label"[219] ⎕wi "scale" 5[220] ⎕wi "extent" (↑⎕wi "Draw" ("?text" "%"))[221] ⎕wi "caption" "%"[222] where←4↑,"fmEditIndPUP.fPUPPay.cbindwarfrac" ⎕wi "∆where"[223] x←0.5×⍴where←Win∆Calcwhere where+0,3,0,10+¯1↑"fmEditIndPUP.fPUPPay.cbindwarfrac" ⎕wi "extent"[224] ⎕wi "∆where" ((x,2)⍴where)[225] ⎕wi "where" (("fmEditIndPUP.fPUPPay" ⎕wi "size") Win∆Resize ⎕wi "∆where")[226] [227] ⎕wself←"fmEditIndPUP.fPUPPay.llindwarfrac" ⎕wi "New" "Label"[228] ⎕wi "scale" 5[229] ⎕wi "style" 2[230] ⎕wi "extent" (↑⎕wi "Draw" ("?text" "Spouses DAR Override"))[231] ⎕wi "caption" "Spouses DAR Override"[232] where←4↑,"fmEditIndPUP.fPUPPay.cbindwarfrac" ⎕wi "∆where"[233] x←0.5×⍴where←Win∆Calcwhere where-0 ¯3 0,10+¯1↑⎕wi "extent"[234] ⎕wi "∆where" ((x,2)⍴where)[235] ⎕wi "where" (("fmEditIndPUP.fPUPPay" ⎕wi "size") Win∆Resize ⎕wi "∆where")[236] [237] ⎕wself←"fmEditIndPUP.fPUPPay.cbindrevyrs" ⎕wi "New" "Combo"[238] Fieldlist←Fieldlist OVER "fmEditIndPUP.fPUPPay.cbindrevyrs"[239] Fieldcontrol←Fieldcontrol OVER "Combo"[240] ⎕wi "∆name" "indrevyrs"[241] ⎕wi "∆type" "Char"[242] ⎕wi "∆helpid" 5162[243] ⎕wi "style" 16 128 256 2[244] ⎕wi "∆where" (2 2⍴0.42 0 0.2 0)[245] ⎕wi "where" (("fmEditIndPUP.fPUPPay" ⎕wi "size") Win∆Resize (2 2⍴0.42 0 0.2 0))[246] PickList←⍙POPUPSdict ReadDictFile "YesNo"[247] PickList←⊃m2n 1 0↓PickList[248] PickList←" " OVER PickList[249] ⎕wi "list" PickList[250] ⎕wi "extent" (150,(¯10+6×¯1↑CharSize)+¯1↑Win∆TextSize ((0,⎕wi "limit")⌈⍴PickList)↑PickList)[251] ⎕wi "onClick" "0 0⍴(⊂⎕wi 'name') Edit_IndPUP 'Change' "[252] [253] ⎕wself←"fmEditIndPUP.fPUPPay.llindrevyrs" ⎕wi "New" "Label"[254] ⎕wi "scale" 5[255] ⎕wi "style" 2[256] ⎕wi "extent" (↑⎕wi "Draw" ("?text" "Complete Years Only Override"))[257] ⎕wi "caption" "Complete Years Only Override"[258] where←4↑,"fmEditIndPUP.fPUPPay.cbindrevyrs" ⎕wi "∆where"[259] x←0.5×⍴where←Win∆Calcwhere where-0 ¯3 0,10+¯1↑⎕wi "extent"[260] ⎕wi "∆where" ((x,2)⍴where)[261] ⎕wi "where" (("fmEditIndPUP.fPUPPay" ⎕wi "size") Win∆Resize ⎕wi "∆where")[262] [263] ⎕wself←"fmEditIndPUP.fPUPPay.cbindnrarnd" ⎕wi "New" "Combo"[264] Fieldlist←Fieldlist OVER "fmEditIndPUP.fPUPPay.cbindnrarnd"[265] Fieldcontrol←Fieldcontrol OVER "Combo"[266] ⎕wi "∆name" "indnrarnd"[267] ⎕wi "∆type" "Char"[268] ⎕wi "∆helpid" 5163[269] ⎕wi "tooltip" "Select the Service Rounding Override (if any)"[270] ⎕wi "style" 16 128 256 2[271] ⎕wi "∆where" (2 2⍴0.42 0 0.6 0)[272] ⎕wi "where" (("fmEditIndPUP.fPUPPay" ⎕wi "size") Win∆Resize (2 2⍴0.42 0 0.6 0))[273] PickList←⍙POPUPSdict ReadDictFile "ServRound"[274] PickList←⊃m2n 1 0↓PickList[275] PickList←" " OVER PickList[276] ⎕wi "list" PickList[277] ⎕wi "extent" (150,(¯10+6×¯1↑CharSize)+¯1↑Win∆TextSize ((0,⎕wi "limit")⌈⍴PickList)↑PickList)[278] ⎕wi "onClick" "0 0⍴(⊂⎕wi 'name') Edit_IndPUP 'Change' "[279] [280] ⎕wself←"fmEditIndPUP.fPUPPay.llindnrarnd" ⎕wi "New" "Label"[281] ⎕wi "scale" 5[282] ⎕wi "style" 2[283] ⎕wi "extent" (↑⎕wi "Draw" ("?text" "NRA Exits Rounding Override"))[284] ⎕wi "caption" "NRA Exits Rounding Override"[285] where←4↑,"fmEditIndPUP.fPUPPay.cbindnrarnd" ⎕wi "∆where"[286] x←0.5×⍴where←Win∆Calcwhere where-0 ¯3 0,10+¯1↑⎕wi "extent"[287] ⎕wi "∆where" ((x,2)⍴where)[288] ⎕wi "where" (("fmEditIndPUP.fPUPPay" ⎕wi "size") Win∆Resize ⎕wi "∆where")[289] [290] ⎕wself←"fmEditIndPUP.fPUPPay.cbindstart" ⎕wi "New" "Combo"[291] Fieldlist←Fieldlist OVER "fmEditIndPUP.fPUPPay.cbindstart"[292] Fieldcontrol←Fieldcontrol OVER "Combo"[293] ⎕wi "∆name" "indstart"[294] ⎕wi "∆type" "Date"[295] ⎕wi "∆helpid" 5164[296] ⎕wi "tooltip" "Select or specify the Start Date of the Independent PUP"[297] ⎕wi "limit" 10[298] ⎕wi "onExit" "⍎(mt ,⎕wres←0 INPUT∆CHECK 'fmEditIndPUP.fPUPPay.cbindstart')/'0 0⍴(⊂⎕wi ''name'') Edit_IndPUP ''Change'' ' "[299] ⎕wi "onExitError" "Win∆ExitError ⎕warg"[300] ⎕wi "onKeyPress" "⎕wres←¯2×~⎕warg∊8 32 45 46 47 48 49 50 51 52 53 54 55 56 57"[301] ⎕wi "onKeyDown" "(⎕wi 'self') ChangesDates ⎕warg"[302] ⎕wi "style" 16 128 256 0[303] ⎕wi "∆where" (2 2⍴0.54 0 0.2 0)[304] ⎕wi "where" (("fmEditIndPUP.fPUPPay" ⎕wi "size") Win∆Resize (2 2⍴0.54 0 0.2 0))[305] PickList←GetAllDateList 0[306] ⎕wi "∆update" "GetAllDateList 0"[307] PickList←⊃m2n 1 0↓PickList[308] PickList←" " OVER PickList[309] ⎕wi "list" PickList[310] ⎕wi "extent" (150,(¯10+6×¯1↑CharSize)+¯1↑(50×CharSize)⌊Win∆TextSize PickList)[311] ⎕wi "onClick" "(⎕wi 'self') Win∆LabelUpdate ⊃¨(AbsDict for 'Type' 'Date' ) at 'Parameter' 'List' ⋄ 0 0⍴(⊂⎕wi 'name') Edit_IndPUP 'Change' "[312] ⎕wi "onChange" "Win∆ComboFudge ⎕wi 'self' ⋄ (⎕wi 'self') Win∆LabelUpdate ⊃¨(AbsDict for 'Type' 'Date' ) at 'Parameter' 'List' ⋄ 0 0⍴(⊂⎕wi 'name') Edit_IndPUP 'Change' "[313] ⎕wi "∆rightlabel" "fmEditIndPUP.fPUPPay.lrindstart"[314] [315] ⎕wself←"fmEditIndPUP.fPUPPay.lrindstart" ⎕wi "New" "Label"[316] ⎕wi "scale" 5[317] ⎕wi "extent" (CharSize×¯2↑1,10)[318] ⎕wi "style" 32[319] ⎕wi "caption" " "[320] where←4↑,"fmEditIndPUP.fPUPPay.cbindstart" ⎕wi "∆where"[321] x←0.5×⍴where←Win∆Calcwhere where+0,3,0,10+¯1↑"fmEditIndPUP.fPUPPay.cbindstart" ⎕wi "extent"[322] ⎕wi "∆where" ((x,2)⍴where)[323] ⎕wi "where" (("fmEditIndPUP.fPUPPay" ⎕wi "size") Win∆Resize ⎕wi "∆where")[324] [325] ⎕wself←"fmEditIndPUP.fPUPPay.llindstart" ⎕wi "New" "Label"[326] ⎕wi "scale" 5[327] ⎕wi "style" 2[328] ⎕wi "extent" (↑⎕wi "Draw" ("?text" "Start Date"))[329] ⎕wi "caption" "Start Date"[330] where←4↑,"fmEditIndPUP.fPUPPay.cbindstart" ⎕wi "∆where"[331] x←0.5×⍴where←Win∆Calcwhere where-0 ¯3 0,10+¯1↑⎕wi "extent"[332] ⎕wi "∆where" ((x,2)⍴where)[333] ⎕wi "where" (("fmEditIndPUP.fPUPPay" ⎕wi "size") Win∆Resize ⎕wi "∆where")[334] [335] ⎕wself←"fmEditIndPUP.fPUPPay.cbindfinish" ⎕wi "New" "Combo"[336] Fieldlist←Fieldlist OVER "fmEditIndPUP.fPUPPay.cbindfinish"[337] Fieldcontrol←Fieldcontrol OVER "Combo"[338] ⎕wi "∆name" "indfinish"[339] ⎕wi "∆type" "Date"[340] ⎕wi "∆helpid" 5165[341] ⎕wi "tooltip" "Select or specify the Finish Date of the Independent PUP"[342] ⎕wi "limit" 10[343] ⎕wi "onExit" "⍎(mt ,⎕wres←0 INPUT∆CHECK 'fmEditIndPUP.fPUPPay.cbindfinish')/'0 0⍴(⊂⎕wi ''name'') Edit_IndPUP ''Change'' ' "[344] ⎕wi "onExitError" "Win∆ExitError ⎕warg"[345] ⎕wi "onKeyPress" "⎕wres←¯2×~⎕warg∊8 32 45 46 47 48 49 50 51 52 53 54 55 56 57"[346] ⎕wi "onKeyDown" "(⎕wi 'self') ChangesDates ⎕warg"[347] ⎕wi "style" 16 128 256 0[348] ⎕wi "∆where" (2 2⍴0.54 0 0.6 0)[349] ⎕wi "where" (("fmEditIndPUP.fPUPPay" ⎕wi "size") Win∆Resize (2 2⍴0.54 0 0.6 0))[350] PickList←GetAllDateList 0[351] ⎕wi "∆update" "GetAllDateList 0"[352] PickList←⊃m2n 1 0↓PickList[353] PickList←" " OVER PickList[354] ⎕wi "list" PickList[355] ⎕wi "extent" (150,(¯10+6×¯1↑CharSize)+¯1↑(50×CharSize)⌊Win∆TextSize PickList)[356] ⎕wi "onClick" "(⎕wi 'self') Win∆LabelUpdate ⊃¨(AbsDict for 'Type' 'Date' ) at 'Parameter' 'List' ⋄ 0 0⍴(⊂⎕wi 'name') Edit_IndPUP 'Change' "[357] ⎕wi "onChange" "Win∆ComboFudge ⎕wi 'self' ⋄ (⎕wi 'self') Win∆LabelUpdate ⊃¨(AbsDict for 'Type' 'Date' ) at 'Parameter' 'List' ⋄ 0 0⍴(⊂⎕wi 'name') Edit_IndPUP 'Change' "[358] ⎕wi "∆rightlabel" "fmEditIndPUP.fPUPPay.lrindfinish"[359] [360] ⎕wself←"fmEditIndPUP.fPUPPay.lrindfinish" ⎕wi "New" "Label"[361] ⎕wi "scale" 5[362] ⎕wi "extent" (CharSize×¯2↑1,10)[363] ⎕wi "style" 32[364] ⎕wi "caption" " "[365] where←4↑,"fmEditIndPUP.fPUPPay.cbindfinish" ⎕wi "∆where"[366] x←0.5×⍴where←Win∆Calcwhere where+0,3,0,10+¯1↑"fmEditIndPUP.fPUPPay.cbindfinish" ⎕wi "extent"[367] ⎕wi "∆where" ((x,2)⍴where)[368] ⎕wi "where" (("fmEditIndPUP.fPUPPay" ⎕wi "size") Win∆Resize ⎕wi "∆where")[369] [370] ⎕wself←"fmEditIndPUP.fPUPPay.llindfinish" ⎕wi "New" "Label"[371] ⎕wi "scale" 5[372] ⎕wi "style" 2[373] ⎕wi "extent" (↑⎕wi "Draw" ("?text" "Finish Date"))[374] ⎕wi "caption" "Finish Date"[375] where←4↑,"fmEditIndPUP.fPUPPay.cbindfinish" ⎕wi "∆where"[376] x←0.5×⍴where←Win∆Calcwhere where-0 ¯3 0,10+¯1↑⎕wi "extent"[377] ⎕wi "∆where" ((x,2)⍴where)[378] ⎕wi "where" (("fmEditIndPUP.fPUPPay" ⎕wi "size") Win∆Resize ⎕wi "∆where")[379] [380] ⎕wself←"fmEditIndPUP.fPUPPay.cbm_indpaystart" ⎕wi "New" "Combo"[381] Fieldlist←Fieldlist OVER "fmEditIndPUP.fPUPPay.cbm_indpaystart"[382] Fieldcontrol←Fieldcontrol OVER "Combo"[383] ⎕wi "∆name" "m_indpaystart"[384] ⎕wi "∆type" "Num"[385] ⎕wi "∆helpid" 5166[386] ⎕wi "∆range" "20 99"[387] ⎕wi "limit" 2[388] ⎕wi "onExit" "⍎(mt ,⎕wres←0 INPUT∆CHECK 'fmEditIndPUP.fPUPPay.cbm_indpaystart')/'0 0⍴(⊂⎕wi ''name'') Edit_IndPUP ''Change'' ' "[389] ⎕wi "onExitError" "Win∆ExitError ⎕warg"[390] ⎕wi "onKeyPress" "⎕wres←¯2×~⎕warg∊45 46 8 32 48 49 50 51 52 53 54 55 56 57"[391] ⎕wi "style" 16 128 256 0[392] ⎕wi "∆where" (2 2⍴0.66 0 0.2 0)[393] ⎕wi "where" (("fmEditIndPUP.fPUPPay" ⎕wi "size") Win∆Resize (2 2⍴0.66 0 0.2 0))[394] PickList←GetVarNumList 'All'[395] ⎕wi "∆update" "GetVarNumList 'All'"[396] PickList←⊃m2n 1 0↓PickList[397] PickList←" " OVER PickList[398] ⎕wi "list" PickList[399] ⎕wi "extent" (150,(¯10+8×¯1↑CharSize)+¯1↑Win∆TextSize ((0,⎕wi "limit")⌈⍴PickList)↑PickList)[400] ⎕wi "onClick" "0 0⍴(⊂⎕wi 'name') Edit_IndPUP 'Change' "[401] ⎕wi "onChange" "Win∆ComboFudge ⎕wi 'self' ⋄ 0 0⍴(⊂⎕wi 'name') Edit_IndPUP 'Change' "[402] ⎕wi "∆rightlabel" "fmEditIndPUP.fPUPPay.lrm_indpaystart"[403] [404] ⎕wself←"fmEditIndPUP.fPUPPay.lrm_indpaystart" ⎕wi "New" "Label"[405] ⎕wi "scale" 5[406] ⎕wi "extent" (↑⎕wi "Draw" ("?text" "years"))[407] ⎕wi "caption" "years"[408] where←4↑,"fmEditIndPUP.fPUPPay.cbm_indpaystart" ⎕wi "∆where"[409] x←0.5×⍴where←Win∆Calcwhere where+0,3,0,10+¯1↑"fmEditIndPUP.fPUPPay.cbm_indpaystart" ⎕wi "extent"[410] ⎕wi "∆where" ((x,2)⍴where)[411] ⎕wi "where" (("fmEditIndPUP.fPUPPay" ⎕wi "size") Win∆Resize ⎕wi "∆where")[412] [413] ⎕wself←"fmEditIndPUP.fPUPPay.llm_indpaystart" ⎕wi "New" "Label"[414] ⎕wi "scale" 5[415] ⎕wi "style" 2[416] ⎕wi "extent" (↑⎕wi "Draw" ("?text" "Male Payment Start Age"))[417] ⎕wi "caption" "Male Payment Start Age"[418] where←4↑,"fmEditIndPUP.fPUPPay.cbm_indpaystart" ⎕wi "∆where"[419] x←0.5×⍴where←Win∆Calcwhere where-0 ¯3 0,10+¯1↑⎕wi "extent"[420] ⎕wi "∆where" ((x,2)⍴where)[421] ⎕wi "where" (("fmEditIndPUP.fPUPPay" ⎕wi "size") Win∆Resize ⎕wi "∆where")[422] [423] ⎕wself←"fmEditIndPUP.fPUPPay.cbf_indpaystart" ⎕wi "New" "Combo"[424] Fieldlist←Fieldlist OVER "fmEditIndPUP.fPUPPay.cbf_indpaystart"[425] Fieldcontrol←Fieldcontrol OVER "Combo"[426] ⎕wi "∆name" "f_indpaystart"[427] ⎕wi "∆type" "Num"[428] ⎕wi "∆helpid" 5166[429] ⎕wi "∆range" "20 99"[430] ⎕wi "limit" 2[431] ⎕wi "onExit" "⍎(mt ,⎕wres←0 INPUT∆CHECK 'fmEditIndPUP.fPUPPay.cbf_indpaystart')/'0 0⍴(⊂⎕wi ''name'') Edit_IndPUP ''Change'' ' "[432] ⎕wi "onExitError" "Win∆ExitError ⎕warg"[433] ⎕wi "onKeyPress" "⎕wres←¯2×~⎕warg∊45 46 8 32 48 49 50 51 52 53 54 55 56 57"[434] ⎕wi "style" 16 128 256 0[435] ⎕wi "∆where" (2 2⍴0.66 0 0.6 0)[436] ⎕wi "where" (("fmEditIndPUP.fPUPPay" ⎕wi "size") Win∆Resize (2 2⍴0.66 0 0.6 0))[437] PickList←GetVarNumList 'All'[438] ⎕wi "∆update" "GetVarNumList 'All'"[439] PickList←⊃m2n 1 0↓PickList[440] PickList←" " OVER PickList[441] ⎕wi "list" PickList[442] ⎕wi "extent" (150,(¯10+8×¯1↑CharSize)+¯1↑Win∆TextSize ((0,⎕wi "limit")⌈⍴PickList)↑PickList)[443] ⎕wi "onClick" "0 0⍴(⊂⎕wi 'name') Edit_IndPUP 'Change' "[444] ⎕wi "onChange" "Win∆ComboFudge ⎕wi 'self' ⋄ 0 0⍴(⊂⎕wi 'name') Edit_IndPUP 'Change' "[445] ⎕wi "∆rightlabel" "fmEditIndPUP.fPUPPay.lrf_indpaystart"[446] [447] ⎕wself←"fmEditIndPUP.fPUPPay.lrf_indpaystart" ⎕wi "New" "Label"[448] ⎕wi "scale" 5[449] ⎕wi "extent" (↑⎕wi "Draw" ("?text" "years"))[450] ⎕wi "caption" "years"[451] where←4↑,"fmEditIndPUP.fPUPPay.cbf_indpaystart" ⎕wi "∆where"[452] x←0.5×⍴where←Win∆Calcwhere where+0,3,0,10+¯1↑"fmEditIndPUP.fPUPPay.cbf_indpaystart" ⎕wi "extent"[453] ⎕wi "∆where" ((x,2)⍴where)[454] ⎕wi "where" (("fmEditIndPUP.fPUPPay" ⎕wi "size") Win∆Resize ⎕wi "∆where")[455] [456] ⎕wself←"fmEditIndPUP.fPUPPay.llf_indpaystart" ⎕wi "New" "Label"[457] ⎕wi "scale" 5[458] ⎕wi "style" 2[459] ⎕wi "extent" (↑⎕wi "Draw" ("?text" "Female Payment Start Age"))[460] ⎕wi "caption" "Female Payment Start Age"[461] where←4↑,"fmEditIndPUP.fPUPPay.cbf_indpaystart" ⎕wi "∆where"[462] x←0.5×⍴where←Win∆Calcwhere where-0 ¯3 0,10+¯1↑⎕wi "extent"[463] ⎕wi "∆where" ((x,2)⍴where)[464] ⎕wi "where" (("fmEditIndPUP.fPUPPay" ⎕wi "size") Win∆Resize ⎕wi "∆where")[465] [466] ⎕wself←"fmEditIndPUP.fPUPPay.cbm_indpayend" ⎕wi "New" "Combo"[467] Fieldlist←Fieldlist OVER "fmEditIndPUP.fPUPPay.cbm_indpayend"[468] Fieldcontrol←Fieldcontrol OVER "Combo"[469] ⎕wi "∆name" "m_indpayend"[470] ⎕wi "∆type" "Num"[471] ⎕wi "∆helpid" 5167[472] ⎕wi "∆range" "20 120"[473] ⎕wi "limit" 3[474] ⎕wi "onExit" "⍎(mt ,⎕wres←0 INPUT∆CHECK 'fmEditIndPUP.fPUPPay.cbm_indpayend')/'0 0⍴(⊂⎕wi ''name'') Edit_IndPUP ''Change'' ' "[475] ⎕wi "onExitError" "Win∆ExitError ⎕warg"[476] ⎕wi "onKeyPress" "⎕wres←¯2×~⎕warg∊45 46 8 32 48 49 50 51 52 53 54 55 56 57"[477] ⎕wi "style" 16 128 256 0[478] ⎕wi "∆where" (2 2⍴0.78 0 0.2 0)[479] ⎕wi "where" (("fmEditIndPUP.fPUPPay" ⎕wi "size") Win∆Resize (2 2⍴0.78 0 0.2 0))[480] PickList←GetVarNumList 'All'[481] ⎕wi "∆update" "GetVarNumList 'All'"[482] PickList←⊃m2n 1 0↓PickList[483] PickList←" " OVER PickList[484] ⎕wi "list" PickList[485] ⎕wi "extent" (150,(¯10+8×¯1↑CharSize)+¯1↑Win∆TextSize ((0,⎕wi "limit")⌈⍴PickList)↑PickList)[486] ⎕wi "onClick" "0 0⍴(⊂⎕wi 'name') Edit_IndPUP 'Change' "[487] ⎕wi "onChange" "Win∆ComboFudge ⎕wi 'self' ⋄ 0 0⍴(⊂⎕wi 'name') Edit_IndPUP 'Change' "[488] ⎕wi "∆rightlabel" "fmEditIndPUP.fPUPPay.lrm_indpayend"[489] [490] ⎕wself←"fmEditIndPUP.fPUPPay.lrm_indpayend" ⎕wi "New" "Label"[491] ⎕wi "scale" 5[492] ⎕wi "extent" (↑⎕wi "Draw" ("?text" "years"))[493] ⎕wi "caption" "years"[494] where←4↑,"fmEditIndPUP.fPUPPay.cbm_indpayend" ⎕wi "∆where"[495] x←0.5×⍴where←Win∆Calcwhere where+0,3,0,10+¯1↑"fmEditIndPUP.fPUPPay.cbm_indpayend" ⎕wi "extent"[496] ⎕wi "∆where" ((x,2)⍴where)[497] ⎕wi "where" (("fmEditIndPUP.fPUPPay" ⎕wi "size") Win∆Resize ⎕wi "∆where")[498] [499] ⎕wself←"fmEditIndPUP.fPUPPay.llm_indpayend" ⎕wi "New" "Label"[500] ⎕wi "scale" 5[501] ⎕wi "style" 2[502] ⎕wi "extent" (↑⎕wi "Draw" ("?text" "Male Payment End Age"))[503] ⎕wi "caption" "Male Payment End Age"[504] where←4↑,"fmEditIndPUP.fPUPPay.cbm_indpayend" ⎕wi "∆where"[505] x←0.5×⍴where←Win∆Calcwhere where-0 ¯3 0,10+¯1↑⎕wi "extent"[506] ⎕wi "∆where" ((x,2)⍴where)[507] ⎕wi "where" (("fmEditIndPUP.fPUPPay" ⎕wi "size") Win∆Resize ⎕wi "∆where")[508] [509] ⎕wself←"fmEditIndPUP.fPUPPay.cbf_indpayend" ⎕wi "New" "Combo"[510] Fieldlist←Fieldlist OVER "fmEditIndPUP.fPUPPay.cbf_indpayend"[511] Fieldcontrol←Fieldcontrol OVER "Combo"[512] ⎕wi "∆name" "f_indpayend"[513] ⎕wi "∆type" "Num"[514] ⎕wi "∆helpid" 5167[515] ⎕wi "∆range" "20 120"[516] ⎕wi "limit" 3[517] ⎕wi "onExit" "⍎(mt ,⎕wres←0 INPUT∆CHECK 'fmEditIndPUP.fPUPPay.cbf_indpayend')/'0 0⍴(⊂⎕wi ''name'') Edit_IndPUP ''Change'' ' "[518] ⎕wi "onExitError" "Win∆ExitError ⎕warg"[519] ⎕wi "onKeyPress" "⎕wres←¯2×~⎕warg∊45 46 8 32 48 49 50 51 52 53 54 55 56 57"[520] ⎕wi "style" 16 128 256 0[521] ⎕wi "∆where" (2 2⍴0.78 0 0.6 0)[522] ⎕wi "where" (("fmEditIndPUP.fPUPPay" ⎕wi "size") Win∆Resize (2 2⍴0.78 0 0.6 0))[523] PickList←GetVarNumList 'All'[524] ⎕wi "∆update" "GetVarNumList 'All'"[525] PickList←⊃m2n 1 0↓PickList[526] PickList←" " OVER PickList[527] ⎕wi "list" PickList[528] ⎕wi "extent" (150,(¯10+8×¯1↑CharSize)+¯1↑Win∆TextSize ((0,⎕wi "limit")⌈⍴PickList)↑PickList)[529] ⎕wi "onClick" "0 0⍴(⊂⎕wi 'name') Edit_IndPUP 'Change' "[530] ⎕wi "onChange" "Win∆ComboFudge ⎕wi 'self' ⋄ 0 0⍴(⊂⎕wi 'name') Edit_IndPUP 'Change' "[531] ⎕wi "∆rightlabel" "fmEditIndPUP.fPUPPay.lrf_indpayend"[532] [533] ⎕wself←"fmEditIndPUP.fPUPPay.lrf_indpayend" ⎕wi "New" "Label"[534] ⎕wi "scale" 5[535] ⎕wi "extent" (↑⎕wi "Draw" ("?text" "years"))[536] ⎕wi "caption" "years"[537] where←4↑,"fmEditIndPUP.fPUPPay.cbf_indpayend" ⎕wi "∆where"[538] x←0.5×⍴where←Win∆Calcwhere where+0,3,0,10+¯1↑"fmEditIndPUP.fPUPPay.cbf_indpayend" ⎕wi "extent"[539] ⎕wi "∆where" ((x,2)⍴where)[540] ⎕wi "where" (("fmEditIndPUP.fPUPPay" ⎕wi "size") Win∆Resize ⎕wi "∆where")[541] [542] ⎕wself←"fmEditIndPUP.fPUPPay.llf_indpayend" ⎕wi "New" "Label"[543] ⎕wi "scale" 5[544] ⎕wi "style" 2[545] ⎕wi "extent" (↑⎕wi "Draw" ("?text" "Female Payment End Age"))[546] ⎕wi "caption" "Female Payment End Age"[547] where←4↑,"fmEditIndPUP.fPUPPay.cbf_indpayend" ⎕wi "∆where"[548] x←0.5×⍴where←Win∆Calcwhere where-0 ¯3 0,10+¯1↑⎕wi "extent"[549] ⎕wi "∆where" ((x,2)⍴where)[550] ⎕wi "where" (("fmEditIndPUP.fPUPPay" ⎕wi "size") Win∆Resize ⎕wi "∆where")[551] [552] ⎕wself←"fmEditIndPUP.fPUPPay.cbpupadj" ⎕wi "New" "Combo"[553] Fieldlist←Fieldlist OVER "fmEditIndPUP.fPUPPay.cbpupadj"[554] Fieldcontrol←Fieldcontrol OVER "Combo"[555] ⎕wi "∆name" "pupadj"[556] ⎕wi "∆type" "Num"[557] ⎕wi "∆mandatory" 1[558] ⎕wi "∆valid" ('Scalar')[559] ⎕wi "∆helpid" 5168[560] ⎕wi "limit" 8[561] ⎕wi "onExit" "⍎(mt ,⎕wres←0 INPUT∆CHECK 'fmEditIndPUP.fPUPPay.cbpupadj')/'0 0⍴(⊂⎕wi ''name'') Edit_IndPUP ''Change'' ' "[562] ⎕wi "onExitError" "Win∆ExitError ⎕warg"[563] ⎕wi "onKeyPress" "⎕wres←¯2×~⎕warg∊45 46 8 32 48 49 50 51 52 53 54 55 56 57"[564] ⎕wi "style" 16 128 256 0[565] ⎕wi "∆where" (2 2⍴0.9 0 0.2 0)[566] ⎕wi "where" (("fmEditIndPUP.fPUPPay" ⎕wi "size") Win∆Resize (2 2⍴0.9 0 0.2 0))[567] PickList←('Scalar') GetAbsNumList 'Fund'[568] ⎕wi "∆update" "('Scalar') GetAbsNumList 'Fund'"[569] PickList←⊃m2n 1 0↓PickList[570] PickList←" " OVER PickList[571] ⎕wi "list" PickList[572] ⎕wi "extent" (150,(¯10+6×¯1↑CharSize)+¯1↑(50×CharSize)⌊Win∆TextSize PickList)[573] ⎕wi "onClick" "(⎕wi 'self') Win∆LabelUpdate ⊃¨(AbsDict for 'Type' 'Number') at 'Parameter' 'List' ⋄ 0 0⍴(⊂⎕wi 'name') Edit_IndPUP 'Change' "[574] ⎕wi "onChange" "Win∆ComboFudge ⎕wi 'self' ⋄ (⎕wi 'self') Win∆LabelUpdate ⊃¨(AbsDict for 'Type' 'Number') at 'Parameter' 'List' ⋄ 0 0⍴(⊂⎕wi 'name') Edit_IndPUP 'Change' "[575] ⎕wi "∆rightlabel" "fmEditIndPUP.fPUPPay.lrpupadj"[576] [577] ⎕wself←"fmEditIndPUP.fPUPPay.lrpupadj" ⎕wi "New" "Label"[578] ⎕wi "scale" 5[579] ⎕wi "extent" (CharSize×¯2↑1,15)[580] ⎕wi "style" 32[581] ⎕wi "caption" " "[582] where←4↑,"fmEditIndPUP.fPUPPay.cbpupadj" ⎕wi "∆where"[583] x←0.5×⍴where←Win∆Calcwhere where+0,3,0,10+¯1↑"fmEditIndPUP.fPUPPay.cbpupadj" ⎕wi "extent"[584] ⎕wi "∆where" ((x,2)⍴where)[585] ⎕wi "where" (("fmEditIndPUP.fPUPPay" ⎕wi "size") Win∆Resize ⎕wi "∆where")[586] [587] ⎕wself←"fmEditIndPUP.fPUPPay.llpupadj" ⎕wi "New" "Label"[588] ⎕wi "scale" 5[589] ⎕wi "style" 2[590] ⎕wi "extent" (↑⎕wi "Draw" ("?text" "PUP Adjustment Factor"))[591] ⎕wi "caption" "PUP Adjustment Factor"[592] where←4↑,"fmEditIndPUP.fPUPPay.cbpupadj" ⎕wi "∆where"[593] x←0.5×⍴where←Win∆Calcwhere where-0 ¯3 0,10+¯1↑⎕wi "extent"[594] ⎕wi "∆where" ((x,2)⍴where)[595] ⎕wi "where" (("fmEditIndPUP.fPUPPay" ⎕wi "size") Win∆Resize ⎕wi "∆where")[596] [597] :if 300<fnsize[598]     ((1↑⎕lc) fnsize "FrameV - Independent PUP Indicators") Win∆ProgressBar "MemberUpdate"[599] :endif[600] [601] ⎕wself←"fmEditIndPUP.fPUPInd" ⎕wi "New" "Frame"[602] ⎕wi "scale" 5[603] ⎕wi "∆where" (4 2⍴0.48 0 0 0 0.18 0 1 0)[604] ⎕wi "where" (("fmEditIndPUP" ⎕wi "size") Win∆Resize (4 2⍴0.48 0 0 0 0.18 0 1 0))[605] ⎕wi "caption" "Independent PUP Indicators"[606] ⎕wi "style" 0[607] ⎕wi "onResize" "AutoResize"[608] [609] ⎕wself←"fmEditIndPUP.fPUPInd.cbbarbind" ⎕wi "New" "Combo"[610] Fieldlist←Fieldlist OVER "fmEditIndPUP.fPUPInd.cbbarbind"[611] Fieldcontrol←Fieldcontrol OVER "Combo"[612] ⎕wi "∆name" "barbind"[613] ⎕wi "∆type" "Char"[614] ⎕wi "∆mandatory" 1[615] ⎕wi "∆helpid" 5169[616] ⎕wi "style" 16 128 256 2[617] ⎕wi "∆where" (2 2⍴0.3 0 0.2 0)[618] ⎕wi "where" (("fmEditIndPUP.fPUPInd" ⎕wi "size") Win∆Resize (2 2⍴0.3 0 0.2 0))[619] PickList←⍙POPUPSdict ReadDictFile "ERF2NDF"[620] PickList←⊃m2n 1 0↓PickList[621] ⎕wi "list" PickList[622] ⎕wi "extent" (150,(¯10+6×¯1↑CharSize)+¯1↑Win∆TextSize ((0,⎕wi "limit")⌈⍴PickList)↑PickList)[623] ⎕wi "onClick" "0 0⍴(⊂⎕wi 'name') Edit_IndPUP 'Change' "[624] [625] ⎕wself←"fmEditIndPUP.fPUPInd.llbarbind" ⎕wi "New" "Label"[626] ⎕wi "scale" 5[627] ⎕wi "style" 2[628] ⎕wi "extent" (↑⎕wi "Draw" ("?text" "ERF Indicator"))[629] ⎕wi "caption" "ERF Indicator"[630] where←4↑,"fmEditIndPUP.fPUPInd.cbbarbind" ⎕wi "∆where"[631] x←0.5×⍴where←Win∆Calcwhere where-0 ¯3 0,10+¯1↑⎕wi "extent"[632] ⎕wi "∆where" ((x,2)⍴where)[633] ⎕wi "where" (("fmEditIndPUP.fPUPInd" ⎕wi "size") Win∆Resize ⎕wi "∆where")[634] [635] ⎕wself←"fmEditIndPUP.fPUPInd.cbdynind" ⎕wi "New" "Combo"[636] Fieldlist←Fieldlist OVER "fmEditIndPUP.fPUPInd.cbdynind"[637] Fieldcontrol←Fieldcontrol OVER "Combo"[638] ⎕wi "∆name" "dynind"[639] ⎕wi "∆type" "Char"[640] ⎕wi "∆mandatory" 1[641] ⎕wi "∆helpid" 5170[642] ⎕wi "tooltip" "Select the Escalation Rate"[643] ⎕wi "style" 16 128 256 2[644] ⎕wi "∆where" (2 2⍴0.3 0 0.6 0)[645] ⎕wi "where" (("fmEditIndPUP.fPUPInd" ⎕wi "size") Win∆Resize (2 2⍴0.3 0 0.6 0))[646] PickList←⍙POPUPSdict ReadDictFile "EscRate"[647] PickList←⊃m2n 1 0↓PickList[648] ⎕wi "list" PickList[649] ⎕wi "extent" (150,(¯10+6×¯1↑CharSize)+¯1↑Win∆TextSize ((0,⎕wi "limit")⌈⍴PickList)↑PickList)[650] ⎕wi "onClick" "0 0⍴(⊂⎕wi 'name') Edit_IndPUP 'Change' "[651] [652] ⎕wself←"fmEditIndPUP.fPUPInd.lldynind" ⎕wi "New" "Label"[653] ⎕wi "scale" 5[654] ⎕wi "style" 2[655] ⎕wi "extent" (↑⎕wi "Draw" ("?text" (("⍺",⎕tcnl) char_replace "Pension Increases⍺in Payment")))[656] ⎕wi "caption" (("⍺",⎕tcnl) char_replace "Pension Increases⍺in Payment")[657] where←4↑,"fmEditIndPUP.fPUPInd.cbdynind" ⎕wi "∆where"[658] size←1↑"fmEditIndPUP.fPUPInd.cbdynind" ⎕wi "extent"[659] size←¯3⌈0.5×(1↑⎕wi "extent")-size[660] x←0.5×⍴where←Win∆Calcwhere where-0,size,0,10+¯1↑⎕wi "extent"[661] ⎕wi "∆where" ((x,2)⍴where)[662] ⎕wi "where" (("fmEditIndPUP.fPUPInd" ⎕wi "size") Win∆Resize ⎕wi "∆where")[663] [664] ⎕wself←"fmEditIndPUP.fPUPInd.cbdynind2" ⎕wi "New" "Combo"[665] Fieldlist←Fieldlist OVER "fmEditIndPUP.fPUPInd.cbdynind2"[666] Fieldcontrol←Fieldcontrol OVER "Combo"[667] ⎕wi "∆name" "dynind2"[668] ⎕wi "∆type" "Char"[669] ⎕wi "∆mandatory" 1[670] ⎕wi "∆helpid" 5171[671] ⎕wi "tooltip" "Select the Escalation Rate"[672] ⎕wi "style" 16 128 256 2[673] ⎕wi "∆where" (2 2⍴0.6 0 0.2 0)[674] ⎕wi "where" (("fmEditIndPUP.fPUPInd" ⎕wi "size") Win∆Resize (2 2⍴0.6 0 0.2 0))[675] PickList←⍙POPUPSdict ReadDictFile "EscRate"[676] PickList←⊃m2n 1 0↓PickList[677] ⎕wi "list" PickList[678] ⎕wi "extent" (150,(¯10+6×¯1↑CharSize)+¯1↑Win∆TextSize ((0,⎕wi "limit")⌈⍴PickList)↑PickList)[679] ⎕wi "onClick" "0 0⍴(⊂⎕wi 'name') Edit_IndPUP 'Change' "[680] [681] ⎕wself←"fmEditIndPUP.fPUPInd.lldynind2" ⎕wi "New" "Label"[682] ⎕wi "scale" 5[683] ⎕wi "style" 2[684] ⎕wi "extent" (↑⎕wi "Draw" ("?text" (("⍺",⎕tcnl) char_replace "Pension Increases⍺Pre Start")))[685] ⎕wi "caption" (("⍺",⎕tcnl) char_replace "Pension Increases⍺Pre Start")[686] where←4↑,"fmEditIndPUP.fPUPInd.cbdynind2" ⎕wi "∆where"[687] size←1↑"fmEditIndPUP.fPUPInd.cbdynind2" ⎕wi "extent"[688] size←¯3⌈0.5×(1↑⎕wi "extent")-size[689] x←0.5×⍴where←Win∆Calcwhere where-0,size,0,10+¯1↑⎕wi "extent"[690] ⎕wi "∆where" ((x,2)⍴where)[691] ⎕wi "where" (("fmEditIndPUP.fPUPInd" ⎕wi "size") Win∆Resize ⎕wi "∆where")[692] [693] ⎕wself←"fmEditIndPUP.fPUPInd.cbundind" ⎕wi "New" "Combo"[694] Fieldlist←Fieldlist OVER "fmEditIndPUP.fPUPInd.cbundind"[695] Fieldcontrol←Fieldcontrol OVER "Combo"[696] ⎕wi "∆name" "undind"[697] ⎕wi "∆type" "Char"[698] ⎕wi "∆mandatory" 1[699] ⎕wi "∆helpid" 5172[700] ⎕wi "style" 16 128 256 2[701] ⎕wi "∆where" (2 2⍴0.6 0 0.6 0)[702] ⎕wi "where" (("fmEditIndPUP.fPUPInd" ⎕wi "size") Win∆Resize (2 2⍴0.6 0 0.6 0))[703] PickList←⍙POPUPSdict ReadDictFile "Underpin"[704] PickList←⊃m2n 1 0↓PickList[705] ⎕wi "list" PickList[706] ⎕wi "extent" (150,(¯10+6×¯1↑CharSize)+¯1↑Win∆TextSize ((0,⎕wi "limit")⌈⍴PickList)↑PickList)[707] ⎕wi "onClick" "0 0⍴(⊂⎕wi 'name') Edit_IndPUP 'Change' "[708] [709] ⎕wself←"fmEditIndPUP.fPUPInd.llundind" ⎕wi "New" "Label"[710] ⎕wi "scale" 5[711] ⎕wi "style" 2[712] ⎕wi "extent" (↑⎕wi "Draw" ("?text" "Include In Underpin"))[713] ⎕wi "caption" "Include In Underpin"[714] where←4↑,"fmEditIndPUP.fPUPInd.cbundind" ⎕wi "∆where"[715] x←0.5×⍴where←Win∆Calcwhere where-0 ¯3 0,10+¯1↑⎕wi "extent"[716] ⎕wi "∆where" ((x,2)⍴where)[717] ⎕wi "where" (("fmEditIndPUP.fPUPInd" ⎕wi "size") Win∆Resize ⎕wi "∆where")[718] [719] :if 300<fnsize[720]     ((1↑⎕lc) fnsize "FrameV - Independent PUP PPF Parameters") Win∆ProgressBar "MemberUpdate"[721] :endif[722] [723] ⎕wself←"fmEditIndPUP.fPPF" ⎕wi "New" "Frame"[724] ⎕wi "scale" 5[725] ⎕wi "∆where" (4 2⍴0.66 0 0 0 0.22 0 1 0)[726] ⎕wi "where" (("fmEditIndPUP" ⎕wi "size") Win∆Resize (4 2⍴0.66 0 0 0 0.22 0 1 0))[727] ⎕wi "caption" "Independent PUP PPF Parameters"[728] ⎕wi "style" 0[729] ⎕wi "onResize" "AutoResize"[730] [731] ⎕wself←"fmEditIndPUP.fPPF.cbm_ppfnra" ⎕wi "New" "Combo"[732] Fieldlist←Fieldlist OVER "fmEditIndPUP.fPPF.cbm_ppfnra"[733] Fieldcontrol←Fieldcontrol OVER "Combo"[734] ⎕wi "∆name" "m_ppfnra"[735] ⎕wi "∆type" "Num"[736] ⎕wi "enabled" (ppfenabled)[737] ⎕wi "∆valid" ('Int' 'Scalar' '+')[738] ⎕wi "∆helpid" 5173[739] ⎕wi "∆range" "50 80"[740] ⎕wi "style" 16 128 256 2[741] ⎕wi "∆where" (2 2⍴0.4 0 0.2 0)[742] ⎕wi "where" (("fmEditIndPUP.fPPF" ⎕wi "size") Win∆Resize (2 2⍴0.4 0 0.2 0))[743] PickList←GetPPFNRA 'M'[744] ⎕wi "∆update" "GetPPFNRA 'M'"[745] PickList←⊃m2n 1 0↓PickList[746] PickList←" " OVER PickList[747] ⎕wi "list" PickList[748] ⎕wi "extent" (150,(¯10+6×¯1↑CharSize)+¯1↑Win∆TextSize ((0,⎕wi "limit")⌈⍴PickList)↑PickList)[749] ⎕wi "onClick" "0 0⍴(⊂⎕wi 'name') Edit_IndPUP 'Change' "[750] [751] ⎕wself←"fmEditIndPUP.fPPF.llm_ppfnra" ⎕wi "New" "Label"[752] ⎕wi "scale" 5[753] ⎕wi "style" 2[754] ⎕wi "enabled" (ppfenabled)[755] ⎕wi "extent" (↑⎕wi "Draw" ("?text" (("⍺",⎕tcnl) char_replace "Male PPF NRA⍺(Levy Valuations)")))[756] ⎕wi "caption" (("⍺",⎕tcnl) char_replace "Male PPF NRA⍺(Levy Valuations)")[757] where←4↑,"fmEditIndPUP.fPPF.cbm_ppfnra" ⎕wi "∆where"[758] size←1↑"fmEditIndPUP.fPPF.cbm_ppfnra" ⎕wi "extent"[759] size←¯3⌈0.5×(1↑⎕wi "extent")-size[760] x←0.5×⍴where←Win∆Calcwhere where-0,size,0,10+¯1↑⎕wi "extent"[761] ⎕wi "∆where" ((x,2)⍴where)[762] ⎕wi "where" (("fmEditIndPUP.fPPF" ⎕wi "size") Win∆Resize ⎕wi "∆where")[763] [764] ⎕wself←"fmEditIndPUP.fPPF.cbf_ppfnra" ⎕wi "New" "Combo"[765] Fieldlist←Fieldlist OVER "fmEditIndPUP.fPPF.cbf_ppfnra"[766] Fieldcontrol←Fieldcontrol OVER "Combo"[767] ⎕wi "∆name" "f_ppfnra"[768] ⎕wi "∆type" "Num"[769] ⎕wi "enabled" (ppfenabled)[770] ⎕wi "∆valid" ('Int' 'Scalar' '+')[771] ⎕wi "∆helpid" 5173[772] ⎕wi "∆range" "50 80"[773] ⎕wi "style" 16 128 256 2[774] ⎕wi "∆where" (2 2⍴0.4 0 0.45 0)[775] ⎕wi "where" (("fmEditIndPUP.fPPF" ⎕wi "size") Win∆Resize (2 2⍴0.4 0 0.45 0))[776] PickList←GetPPFNRA 'F'[777] ⎕wi "∆update" "GetPPFNRA 'F'"[778] PickList←⊃m2n 1 0↓PickList[779] PickList←" " OVER PickList[780] ⎕wi "list" PickList[781] ⎕wi "extent" (150,(¯10+6×¯1↑CharSize)+¯1↑Win∆TextSize ((0,⎕wi "limit")⌈⍴PickList)↑PickList)[782] ⎕wi "onClick" "0 0⍴(⊂⎕wi 'name') Edit_IndPUP 'Change' "[783] [784] ⎕wself←"fmEditIndPUP.fPPF.llf_ppfnra" ⎕wi "New" "Label"[785] ⎕wi "scale" 5[786] ⎕wi "style" 2[787] ⎕wi "enabled" (ppfenabled)[788] ⎕wi "extent" (↑⎕wi "Draw" ("?text" (("⍺",⎕tcnl) char_replace "Female PPF NRA⍺(Levy Valuations)")))[789] ⎕wi "caption" (("⍺",⎕tcnl) char_replace "Female PPF NRA⍺(Levy Valuations)")[790] where←4↑,"fmEditIndPUP.fPPF.cbf_ppfnra" ⎕wi "∆where"[791] size←1↑"fmEditIndPUP.fPPF.cbf_ppfnra" ⎕wi "extent"[792] size←¯3⌈0.5×(1↑⎕wi "extent")-size[793] x←0.5×⍴where←Win∆Calcwhere where-0,size,0,10+¯1↑⎕wi "extent"[794] ⎕wi "∆where" ((x,2)⍴where)[795] ⎕wi "where" (("fmEditIndPUP.fPPF" ⎕wi "size") Win∆Resize ⎕wi "∆where")[796] [797] ⎕wself←"fmEditIndPUP.fPPF.cbppfpayinc" ⎕wi "New" "Combo"[798] Fieldlist←Fieldlist OVER "fmEditIndPUP.fPPF.cbppfpayinc"[799] Fieldcontrol←Fieldcontrol OVER "Combo"[800] ⎕wi "∆name" "ppfpayinc"[801] ⎕wi "∆type" "Char"[802] ⎕wi "enabled" (ppfenabled∨capenabled)[803] ⎕wi "∆helpid" 5174[804] ⎕wi "tooltip" "Select the PPF Service Period"[805] ⎕wi "style" 16 128 256 2[806] ⎕wi "∆where" (2 2⍴0.4 0 0.7 0)[807] ⎕wi "where" (("fmEditIndPUP.fPPF" ⎕wi "size") Win∆Resize (2 2⍴0.4 0 0.7 0))[808] PickList←⍙POPUPSdict ReadDictFile "ServPeriods"[809] PickList←⊃m2n 1 0↓PickList[810] PickList←" " OVER PickList[811] ⎕wi "list" PickList[812] ⎕wi "extent" (150,(¯10+6×¯1↑CharSize)+¯1↑Win∆TextSize ((0,⎕wi "limit")⌈⍴PickList)↑PickList)[813] ⎕wi "onClick" "0 0⍴(⊂⎕wi 'name') Edit_IndPUP 'Change' "[814] [815] ⎕wself←"fmEditIndPUP.fPPF.llppfpayinc" ⎕wi "New" "Label"[816] ⎕wi "scale" 5[817] ⎕wi "style" 2[818] ⎕wi "enabled" (ppfenabled∨capenabled)[819] ⎕wi "extent" (↑⎕wi "Draw" ("?text" "PPF Service Period"))[820] ⎕wi "caption" "PPF Service Period"[821] where←4↑,"fmEditIndPUP.fPPF.cbppfpayinc" ⎕wi "∆where"[822] x←0.5×⍴where←Win∆Calcwhere where-0 ¯3 0,10+¯1↑⎕wi "extent"[823] ⎕wi "∆where" ((x,2)⍴where)[824] ⎕wi "where" (("fmEditIndPUP.fPPF" ⎕wi "size") Win∆Resize ⎕wi "∆where")[825] [826] :if 300<fnsize[827]     ((1↑⎕lc) fnsize "Frame - Buttons") Win∆ProgressBar "MemberUpdate"[828] :endif[829] [830] ⎕wself←"fmEditIndPUP.fButtons" ⎕wi "New" "Frame"[831] ⎕wi "scale" 5[832] ⎕wi "∆where" (4 2⍴0.88 0 0 0 0.12 ¯45 1 0)[833] ⎕wi "where" (("fmEditIndPUP" ⎕wi "size") Win∆Resize (4 2⍴0.88 0 0 0 0.12 ¯45 1 0))[834] ⎕wi "style" 7[835] ⎕wi "onResize" "AutoResize"[836] list←list OVER "fmEditIndPUP.fButtons.bnEdit_IndPUPEditFin"[837] ⎕wself←"fmEditIndPUP.fButtons.bnEdit_IndPUPEditFin" ⎕wi "New" "Button"[838] ⎕wi "deferexit" 1[839] ⎕wi "extent" (size←1.4 1.384615385×buttonsize×1⌈CharSize÷13 6)[840] ⎕wi "∆where" (2 2⍴0.1 0 0.44 0)[841] ⎕wi "where" (("fmEditIndPUP.fButtons" ⎕wi "size") Win∆Resize (2 2⍴0.1 0 0.44 0))[842] ⎕wi "tooltip" "Edit/Add the Scheme Financial Assumptions"[843] ⎕wi "onClick" ("fmSV.mEdit_IndPUPFile.mEditFin"⎕wi "onClick")[844] ⎕wi "∆helpid" 5175[845] ⎕wi "caption" (("⍺",⎕tcnl) char_replace "Edit Scheme⍺Financials")[846] list←list OVER "fmEditIndPUP.fButtons.bnEdit_IndPUPPrevious"[847] ⎕wself←"fmEditIndPUP.fButtons.bnEdit_IndPUPPrevious" ⎕wi "New" "Button"[848] ⎕wi "enabled" (0 )[849] ⎕wi "extent" (size←1.28 1×buttonsize×1⌈CharSize÷13 6)[850] ⎕wi "∆where" (2 2⍴0.15 0 0.82 0)[851] ⎕wi "where" (("fmEditIndPUP.fButtons" ⎕wi "size") Win∆Resize (2 2⍴0.15 0 0.82 0))[852] ⎕wi "tooltip" "Move back to the Previous Independent PUP"[853] ⎕wi "onClick" ("fmSV.mEdit_IndPUPFile.mPrevious"⎕wi "onClick")[854] ⎕wi "∆helpid" 5176[855] ⎕wi "caption" (("⍺",⎕tcnl) char_replace "Previous⍺Ind. PUP")[856] list←list OVER "fmEditIndPUP.fButtons.bnEdit_IndPUPNext"[857] ⎕wself←"fmEditIndPUP.fButtons.bnEdit_IndPUPNext" ⎕wi "New" "Button"[858] ⎕wi "enabled" (0 )[859] ⎕wi "extent" (size←1.28 1×buttonsize×1⌈CharSize÷13 6)[860] ⎕wi "∆where" (2 2⍴0.15 0 0.9 0)[861] ⎕wi "where" (("fmEditIndPUP.fButtons" ⎕wi "size") Win∆Resize (2 2⍴0.15 0 0.9 0))[862] ⎕wi "tooltip" "Move on to the Next Independent PUP"[863] ⎕wi "onClick" ("fmSV.mEdit_IndPUPFile.mNext"⎕wi "onClick")[864] ⎕wi "∆helpid" 5177[865] ⎕wi "caption" (("⍺",⎕tcnl) char_replace "Next⍺Ind. PUP")[866] [867] "fmEditIndPUP" ⎕wi "∆multifile" ""[868] "fmEditIndPUP" ⎕wi "∆singlefile" ""[869] "fmEditIndPUP" ⎕wi "∆format" "fmEditIndPUP.cbFormattrick"[870] "fmEditIndPUP" ⎕wi "∆financial" 1[871] "fmEditIndPUP" ⎕wi "∆relrules" 2[872] "fmEditIndPUP" ⎕wi "∆parm" 0[873] "fmEditIndPUP" ⎕wi "∆decr" 0[874] "fmEditIndPUP" ⎕wi "∆file" 0[875] "fmEditIndPUP" ⎕wi "∆codefile" CodeFile[876] "fmEditIndPUP" ⎕wi "∆inputstype" ""[877] "fmEditIndPUP" ⎕wi "∆inputsentry" ""[878] "fmEditIndPUP" ⎕wi "∆savecn" (⍳0)[879] "fmEditIndPUP" ⎕wi "∆savedesc" ""[880] list←list OVER "fmEditIndPUP"[881] "fmEditIndPUP" ⎕wi "∆fieldlist" Fieldlist[882] "fmEditIndPUP" ⎕wi "∆fieldcontrol" Fieldcontrol[883] childlist←"fmSV" ⎕wi "∆childlist"[884] list←(⊃¯1↑childlist) OVER list[885] childlist[⍴childlist]←⊂list[886] "fmSV" ⎕wi "∆childlist" childlist[887] list←,⎕split list[888] 0 0⍴((∨/¨(⊂".mEdit_IndPUP")⍷¨list)/list) MultiWI "enabled" 1[889] :if 300<fnsize[890]     (fnsize fnsize ".") Win∆ProgressBar "MemberUpdate"[891]     Win∆ProgressBar "Hide"[892] :endif[893] "Init" OpenParameters "Edit_IndPUP"[894] "fmEditIndPUP.bnEdit_IndPUPHelp" ⎕wi "visible" 1[895] "fmEditIndPUP.bnEdit_IndPUPQuit" ⎕wi "visible" 1[896] "fmEditIndPUP.bnEdit_IndPUPSave" ⎕wi "visible" 1[897] "#" ⎕wi "focus" "fmEditIndPUP.cbFormattrick"[898] :if ~0∊⍴,Error←Win∆Initialise "Edit_IndPUP"[899]     "Quit" EndModule Module[900]     "fmSV" ⎕wi "pointer" 0[901]     0 0⍴"fmEditIndPUP" ⎕wi "Delete"[902]     :return[903] :endif[904] :if bar_open←commandbar^"Multi"≡""[905]     bar_open←0×"fmEditIndPUP.mEdit_IndPUPFile.m" Win∆CommandBar "OKHelp"[906] :endif[907] "fmEditIndPUP" ⎕wi "Paint"[908] "fmSV" ⎕wi "pointer" 11[909] "fmEditIndPUP" ⎕wi "onWait" "0 0⍴Edit_IndPUP 'Wait'"[910] 0 0⍴"fmEditIndPUP" ⎕wi "Wait"[911] 0 0⍴"fmEditIndPUP" ⎕wi "Delete"[912] "fmSV" ⎕wi "pointer" 0 ∇