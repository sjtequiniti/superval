∇ Container←Form_Make;⎕wself;ControlName;childlist;list;Fieldlist;Fieldcontrol;FrameWidth;Caption;buttonsize;buttonwhere;where;size;alignment;Header;PickList;NameList;value;sortorder;SortList;MaxRow;MaxCol;Parent;level;node;no;nn;NN;x;fnsize;framelist;relTests[1] [2] Fieldlist←Fieldcontrol←list←0 0⍴""[3] "fmSV" ⎕wi "pointer" 13[4] buttonsize←25 65 ⋄ buttonwhere←¯5[5] FormName ⎕wi "caption" ((FormName ⎕wi "caption")," - Contributions Definition")[6] "fmSV" ⎕wi "∆caption" (("fmSV" ⎕wi "∆caption"),⊂("fmSV" ⎕wi "caption"))[7] :if 300<fnsize←1↑⍴⎕cr "Form_Make"[8]     "Generating Form" Win∆ProgressBar "Open"[9]     ("Menu Items:" "Form Controls:") Win∆ProgressBar "SetLabels"[10]     (1 1 "Help About") Win∆ProgressBar "FileUpdate"[11] :endif[12] [13] Container←"∆Dialog"[14] [15] ⎕wself←"fmContsDef" ⎕wi "New" "Form" "Hide"[16] ⎕wi "caption" ("fmSV" ⎕wi "caption")[17] ⎕wi "scale" 5[18] ⎕wi "font" ("fmSV" ⎕wi "font")[19] ⎕wi "border" 2 32 64[20] ⎕wi "where" (Win∆CentrePos 0.9 0.9 ×768 1024×1⌈CharSize÷13 6)[21] ⎕wi "limitwhere" (0.8×¯2↑⎕wi "where")[22] ⎕wi "tooltipwidth" 200[23] ⎕wi "onResize" "AutoResize"[24] ⎕wi "onClose" "ExitSystem ''"[25] ControlName←"fmContsDef"[26] relTests←1[27] 0 Menu_Make "fmSV"[28] 1 Menu_Make "fmContsDef"[29] "fmContsDef" Win∆CutCopyPaste "Build"[30] "fmContsDef" ⎕wi "∆helpid" 2168[31] list←list OVER "fmContsDef.bnContributionsHelp"[32] ⎕wself←"fmContsDef.bnContributionsHelp" ⎕wi "New" "Button"[33] ⎕wi "deferexit" 1[34] ⎕wi "extent" (size←1×buttonsize×1⌈CharSize÷13 6)[35] x←0.5×⍴where←Win∆Calcwhere 1,(¯10-size[1]),1,buttonwhere←buttonwhere-5+size[2][36] ⎕wi "∆where" ((x,2)⍴where)[37] ⎕wi "where" (("fmContsDef" ⎕wi "size") Win∆Resize ⎕wi "∆where")[38] ⎕wi "tooltip" "SuperVal Help"[39] ⎕wi "onClick" ("fmSV.mContributionsHelp.mContext"⎕wi "onClick")[40] ⎕wi "caption" "Help"[41] :if buttonimage[42]     ⎕wi "imagelist" "fmSV.iStandard"[43]     ⎕wi "imageindex" 12[44] :endif[45] ⎕wi "visible" ¯1[46] ⎕wi "onMouseDown" "∆HelpField←'#' ⎕wi 'focus' "[47] list←list OVER "fmContsDef.bnContributionsQuit"[48] ⎕wself←"fmContsDef.bnContributionsQuit" ⎕wi "New" "Button"[49] ⎕wi "style" 2[50] ⎕wi "deferexit" 1[51] ⎕wi "extent" (size←1×buttonsize×1⌈CharSize÷13 6)[52] x←0.5×⍴where←Win∆Calcwhere 1,(¯10-size[1]),1,buttonwhere←buttonwhere-5+size[2][53] ⎕wi "∆where" ((x,2)⍴where)[54] ⎕wi "where" (("fmContsDef" ⎕wi "size") Win∆Resize ⎕wi "∆where")[55] ⎕wi "tooltip" "Quit and Return"[56] ⎕wi "onClick" ("fmSV.mContributionsFile.mQuit"⎕wi "onClick")[57] ⎕wi "caption" "Quit"[58] ⎕wi "∆helpid" 4292[59] ⎕wi "order" .5[60] ⎕wi "visible" ¯1[61] ControlName ⎕wi "∆quitbutton" "fmContsDef.bnContributionsQuit"[62] list←list OVER "fmContsDef.bnContributionsSave"[63] ⎕wself←"fmContsDef.bnContributionsSave" ⎕wi "New" "Button"[64] ⎕wi "extent" (size←1×buttonsize×1⌈CharSize÷13 6)[65] x←0.5×⍴where←Win∆Calcwhere 1,(¯10-size[1]),1,buttonwhere←buttonwhere-5+size[2][66] ⎕wi "∆where" ((x,2)⍴where)[67] ⎕wi "where" (("fmContsDef" ⎕wi "size") Win∆Resize ⎕wi "∆where")[68] ⎕wi "tooltip" "Save Parameters"[69] ⎕wi "onClick" ("fmSV.mContributionsFile.mSave"⎕wi "onClick")[70] ⎕wi "caption" "Save"[71] :if buttonimage[72]     ⎕wi "imagelist" "fmSV.iStandard"[73]     ⎕wi "imageindex" 9[74] :endif[75] ⎕wi "∆helpid" 4293[76] ⎕wi "enabled" 0[77] ⎕wi "order" .5[78] ⎕wi "visible" ¯1[79] "fmContsDef" ⎕wi "onModified" "('Contributions' 'fmContsDef.bnContributionsSave') Win∆SaveEnabled (0≠⎕warg[1])"[80] list←list OVER "fmContsDef.bnContributionsSaveAs"[81] ⎕wself←"fmContsDef.bnContributionsSaveAs" ⎕wi "New" "Button"[82] ⎕wi "extent" (size←1×buttonsize×1⌈CharSize÷13 6)[83] x←0.5×⍴where←Win∆Calcwhere 1,(¯10-size[1]),1,buttonwhere←buttonwhere-5+size[2][84] ⎕wi "∆where" ((x,2)⍴where)[85] ⎕wi "where" (("fmContsDef" ⎕wi "size") Win∆Resize ⎕wi "∆where")[86] ⎕wi "tooltip" "Save Parameters As ..."[87] ⎕wi "onClick" ("fmSV.mContributionsFile.mSaveAs"⎕wi "onClick")[88] ⎕wi "caption" "Save As"[89] ⎕wi "∆helpid" 4294[90] ⎕wi "order" .5[91] ⎕wi "visible" ¯1[92] "fmContsDef" ⎕wi "∆audit" 1[93] [94] :if 300<fnsize[95]     ((1↑⎕lc) fnsize "FrameV - Contributions Method") Win∆ProgressBar "MemberUpdate"[96] :endif[97] [98] ⎕wself←"fmContsDef.fContsDef" ⎕wi "New" "Frame"[99] ⎕wi "scale" 5[100] ⎕wi "∆where" (4 2⍴0 0 0 0 0.08 0 1 0)[101] ⎕wi "where" (("fmContsDef" ⎕wi "size") Win∆Resize (4 2⍴0 0 0 0 0.08 0 1 0))[102] ⎕wi "caption" "Contributions Method"[103] ⎕wi "style" 0[104] ⎕wi "onResize" "AutoResize"[105] [106] :if ~bGAD[107] [108] ⎕wself←"fmContsDef.fContsDef.cbgcdDEF" ⎕wi "New" "Combo"[109] Fieldlist←Fieldlist OVER "fmContsDef.fContsDef.cbgcdDEF"[110] Fieldcontrol←Fieldcontrol OVER "Combo"[111] ⎕wi "∆name" "gcdDEF"[112] ⎕wi "∆type" "Char"[113] ⎕wi "∆mandatory" 1[114] ⎕wi "visible" (¯1+2×~bGAD)[115] ⎕wi "∆helpid" 4295[116] ⎕wi "tooltip" "Select the Contributions Definition"[117] ⎕wi "style" 16 128 256 2[118] ⎕wi "∆where" (2 2⍴0.4 0 0.3 0)[119] ⎕wi "where" (("fmContsDef.fContsDef" ⎕wi "size") Win∆Resize (2 2⍴0.4 0 0.3 0))[120] PickList←⍙POPUPSdict ReadDictFile "ContsDef"[121] PickList←⊃m2n 1 0↓PickList[122] ⎕wi "list" PickList[123] ⎕wi "extent" (150,(¯10+6×¯1↑CharSize)+¯1↑Win∆TextSize ((0,⎕wi "limit")⌈⍴PickList)↑PickList)[124] ⎕wi "onClick" "0 0⍴(⊂⎕wi 'name') Contributions 'Change' "[125] [126] ⎕wself←"fmContsDef.fContsDef.llgcdDEF" ⎕wi "New" "Label"[127] ⎕wi "scale" 5[128] ⎕wi "style" 2[129] ⎕wi "visible" (¯1+2×~bGAD)[130] ⎕wi "extent" (↑⎕wi "Draw" ("?text" "Contributions Method"))[131] ⎕wi "caption" "Contributions Method"[132] where←4↑,"fmContsDef.fContsDef.cbgcdDEF" ⎕wi "∆where"[133] x←0.5×⍴where←Win∆Calcwhere where-0 ¯3 0,10+¯1↑⎕wi "extent"[134] ⎕wi "∆where" ((x,2)⍴where)[135] ⎕wi "where" (("fmContsDef.fContsDef" ⎕wi "size") Win∆Resize ⎕wi "∆where")[136] :endif[137] [138] :if bGAD[139] [140] ⎕wself←"fmContsDef.fContsDef.cbgcdDEF" ⎕wi "New" "Combo"[141] Fieldlist←Fieldlist OVER "fmContsDef.fContsDef.cbgcdDEF"[142] Fieldcontrol←Fieldcontrol OVER "Combo"[143] ⎕wi "∆name" "gcdDEF"[144] ⎕wi "∆type" "Char"[145] ⎕wi "∆mandatory" 1[146] ⎕wi "visible" (¯1+2×bGAD)[147] ⎕wi "∆helpid" 4295[148] ⎕wi "tooltip" "Select the Contributions Definition"[149] ⎕wi "style" 16 128 256 2[150] ⎕wi "∆where" (2 2⍴0.4 0 0.3 0)[151] ⎕wi "where" (("fmContsDef.fContsDef" ⎕wi "size") Win∆Resize (2 2⍴0.4 0 0.3 0))[152] PickList←⍙POPUPSdict ReadDictFile "ContsDefGAD"[153] PickList←⊃m2n 1 0↓PickList[154] ⎕wi "list" PickList[155] ⎕wi "extent" (150,(¯10+6×¯1↑CharSize)+¯1↑Win∆TextSize ((0,⎕wi "limit")⌈⍴PickList)↑PickList)[156] ⎕wi "onClick" "0 0⍴(⊂⎕wi 'name') Contributions 'Change' "[157] [158] ⎕wself←"fmContsDef.fContsDef.llgcdDEF" ⎕wi "New" "Label"[159] ⎕wi "scale" 5[160] ⎕wi "style" 2[161] ⎕wi "visible" (¯1+2×bGAD)[162] ⎕wi "extent" (↑⎕wi "Draw" ("?text" "Contributions Method"))[163] ⎕wi "caption" "Contributions Method"[164] where←4↑,"fmContsDef.fContsDef.cbgcdDEF" ⎕wi "∆where"[165] x←0.5×⍴where←Win∆Calcwhere where-0 ¯3 0,10+¯1↑⎕wi "extent"[166] ⎕wi "∆where" ((x,2)⍴where)[167] ⎕wi "where" (("fmContsDef.fContsDef" ⎕wi "size") Win∆Resize ⎕wi "∆where")[168] :endif[169] [170] :if 300<fnsize[171]     ((1↑⎕lc) fnsize "FrameV - Contribution Rate") Win∆ProgressBar "MemberUpdate"[172] :endif[173] [174] ⎕wself←"fmContsDef.fContRates" ⎕wi "New" "Frame"[175] ⎕wi "scale" 5[176] ⎕wi "∆where" (4 2⍴0.08 0 0 0 0.12 0 1 0)[177] ⎕wi "where" (("fmContsDef" ⎕wi "size") Win∆Resize (4 2⍴0.08 0 0 0 0.12 0 1 0))[178] ⎕wi "caption" "Contribution Rate"[179] ⎕wi "style" 0[180] ⎕wi "onResize" "AutoResize"[181] [182] ⎕wself←"fmContsDef.fContRates.edgcdCR" ⎕wi "New" "Edit"[183] Fieldlist←Fieldlist OVER "fmContsDef.fContRates.edgcdCR"[184] Fieldcontrol←Fieldcontrol OVER "Edit"[185] ⎕wi "∆name" "gcdCR"[186] ⎕wi "∆type" "Num"[187] ⎕wi "∆mandatory" 1[188] ⎕wi "∆valid" ('Scalar' '0+')[189] ⎕wi "∆helpid" 4296[190] ⎕wi "tooltip" "Specify the Contribution Rate"[191] ⎕wi "limit" 7[192] ⎕wi "∆where" (2 2⍴0.4 0 0.2 0)[193] ⎕wi "where" (("fmContsDef.fContRates" ⎕wi "size") Win∆Resize (2 2⍴0.4 0 0.2 0))[194] ⎕wi "∆range" "0 60"[195] ⎕wi "onChange" "0 0⍴(⊂⎕wi 'name') Contributions 'Change' "[196] ⎕wi "onExit" "⍎(0∊⍴,⎕wres←0 INPUT∆CHECK 'fmContsDef.fContRates.edgcdCR')/'0 0⍴(⊂⎕wi ''name'') Contributions ''Change'' ' "[197] ⎕wi "onExitError" "Win∆ExitError ⎕warg"[198] ⎕wi "onKeyPress" "⎕wres←¯2×~⎕warg∊46 8 32 48 49 50 51 52 53 54 55 56 57"[199] ⎕wi "extent" (2+CharSize×1 8)[200] [201] ⎕wself←"fmContsDef.fContRates.lrgcdCR" ⎕wi "New" "Label"[202] ⎕wi "scale" 5[203] ⎕wi "extent" (↑⎕wi "Draw" ("?text" "%"))[204] ⎕wi "caption" "%"[205] where←4↑,"fmContsDef.fContRates.edgcdCR" ⎕wi "∆where"[206] x←0.5×⍴where←Win∆Calcwhere where+0,3,0,10+¯1↑"fmContsDef.fContRates.edgcdCR" ⎕wi "extent"[207] ⎕wi "∆where" ((x,2)⍴where)[208] ⎕wi "where" (("fmContsDef.fContRates" ⎕wi "size") Win∆Resize ⎕wi "∆where")[209] [210] ⎕wself←"fmContsDef.fContRates.llgcdCR" ⎕wi "New" "Label"[211] ⎕wi "scale" 5[212] ⎕wi "style" 2[213] ⎕wi "extent" (↑⎕wi "Draw" ("?text" "Contribution Rate"))[214] ⎕wi "caption" "Contribution Rate"[215] where←4↑,"fmContsDef.fContRates.edgcdCR" ⎕wi "∆where"[216] x←0.5×⍴where←Win∆Calcwhere where-0 ¯3 0,10+¯1↑⎕wi "extent"[217] ⎕wi "∆where" ((x,2)⍴where)[218] ⎕wi "where" (("fmContsDef.fContRates" ⎕wi "size") Win∆Resize ⎕wi "∆where")[219] [220] :if 300<fnsize[221]     ((1↑⎕lc) fnsize "FrameV - Contribution Rates and Bands") Win∆ProgressBar "MemberUpdate"[222] :endif[223] [224] ⎕wself←"fmContsDef.fBands" ⎕wi "New" "Frame"[225] ⎕wi "scale" 5[226] ⎕wi "∆where" (4 2⍴0.2 0 0 0 0.4 0 1 0)[227] ⎕wi "where" (("fmContsDef" ⎕wi "size") Win∆Resize (4 2⍴0.2 0 0 0 0.4 0 1 0))[228] ⎕wi "caption" "Contribution Rates and Bands"[229] ⎕wi "style" 0[230] ⎕wi "onResize" "AutoResize"[231] [232] ⎕wself←"fmContsDef.fBands.fBandCont" ⎕wi "New" "Frame"[233] ⎕wi "scale" 5[234] ⎕wi "tooltip" "Right Click Top Left Corner for Grid Options
Right Click Row/Column Headings to Add/Delete Rows/Columns"[235] ⎕wi "∆where" (4 2⍴0.1 0 0.02 0 0.85 0 0.25 0)[236] ⎕wi "where" (("fmContsDef.fBands" ⎕wi "size") Win∆Resize (4 2⍴0.1 0 0.02 0 0.85 0 0.25 0))[237] ⎕wi "caption" "Band Contribution Rates"[238] ⎕wi "style" 0[239] ⎕wi "onResize" "AutoResize"[240] ⎕wself←"fmContsDef.fBands.fBandCont.ssBandCont" ⎕wi "New" "{13E51003-A52B-11D0-86DA-00608CB9FBFB}6D5ECD55-86B8-11d0-95AD-0020AF1E9EB2"[241] ⎕wi "∆where" (4 2⍴0 15 0 10 0.999 ¯25 1 ¯20)[242] ⎕wi "where" (("fmContsDef.fBands.fBandCont" ⎕wi "size") Win∆Resize (4 2⍴0 15 0 10 0.999 ¯25 1 ¯20))[243] Fieldlist←Fieldlist OVER "fmContsDef.fBands.fBandCont.ssBandCont"[244] Fieldcontrol←Fieldcontrol OVER "F1SS"[245] ⎕wi "∆max" 10[246] Win∆F1SSDefaults 0[247] ⎕wi "MaxRow" (MaxRow←1)[248] ⎕wi "MaxCol" (MaxCol←1)[249] ⎕wi "xDoStartEdit" 1[250] ⎕wi "xDoEndEdit" 1[251] ⎕wi "xDoCancelEdit" 1[252] ⎕wi "onClick" "Win∆F1SSClick 'fmContsDef.fBands.fBandCont.ssBandCont'"[253] ⎕wi "onXStartEdit" "⎕wi 'AllowArrows' 0"[254] NameList←0 0⍴" "[255] ⎕wi "MaxCol" (MaxCol←MaxCol⌈1)[256] ⎕wi "ColText" 1 (("/⍺/",⎕tcnl,⎕tclf) TEXTREPL "Lower Band⍺Amount")[257] ⎕wi "XSetRowHeight" 1 1 255 1[258] NameList←NameList OVER "gcdBand[;]"[259] ⎕wi "MaxCol" (MaxCol←MaxCol⌈2)[260] ⎕wi "ColText" 2 (("/⍺/",⎕tcnl,⎕tclf) TEXTREPL "Contribution⍺Rate %")[261] ⎕wi "XSetRowHeight" 1 1 255 1[262] NameList←NameList OVER "gcdBandCR[;]"[263] ⎕wi "xHdrHeight" (350⌈250×2)[264] ⎕wi "onXRClick" "1 Win∆F1SSRowMenu ('Contributions' 'fmContsDef.fBands.fBandCont.ssBandCont')"[265] ⎕wi "∆roworcol" "Col"[266] ⎕wi "∆name" NameList[267] ⎕wi "∆limit" (,8 8)[268] ⎕wi "∆mandatory" 1 1[269] ⎕wi "∆helpid" 4297 4298[270] ⎕wi "∆type" "⍺Num⍺Num"[271] ⎕wi "∆valid" "⍺'Scalar' '0+'⍺'Scalar' '0+'"[272] ⎕wi "∆range" "⍺⍺0 60"[273] ⎕wi "onXEndEdit" "(⎕wi 'xRow') Win∆ValidF1SSCell ⎕wi 'xCol' ⋄ 0 0⍴⎕ex 'F1SSEvent' "[274] ⎕wi "onExit" "Win∆ValidF1SSExit 'Contributions'"[275] ⎕wi "onExitError" "MDISPLAY ⎕warg ⋄ ⎕wi 'XStartEdit' 0 1 1"[276] ⎕wi "onXCancelEdit" "⎕wi 'AllowArrows' 1 ⋄ ⎕wi 'SetColWidthAuto' 1 1 (⎕wi 'MaxRow') (⎕wi 'MaxCol') 0"[277] "fmContsDef.fBands.fBandCont.ssBandCont" Win∆F1SSProtectCells "Unlock"[278] ⎕wi "SetSelection" 1 1 1 1[279] [280] ⎕wself←"fmContsDef.fBands.cbgcdBandmeth" ⎕wi "New" "Combo"[281] Fieldlist←Fieldlist OVER "fmContsDef.fBands.cbgcdBandmeth"[282] Fieldcontrol←Fieldcontrol OVER "Combo"[283] ⎕wi "∆name" "gcdBandmeth"[284] ⎕wi "∆type" "Combo"[285] ⎕wi "∆mandatory" 1[286] ⎕wi "∆helpid" 4299[287] ⎕wi "tooltip" "Specify the Band Contribution Method"[288] ⎕wi "style" 16 128 256 2[289] ⎕wi "∆where" (2 2⍴0.11 0 0.45 0)[290] ⎕wi "where" (("fmContsDef.fBands" ⎕wi "size") Win∆Resize (2 2⍴0.11 0 0.45 0))[291] PickList←⍙POPUPSdict ReadDictFile "BandConts"[292] PickList←⊃m2n 1 0↓PickList[293] ⎕wi "list" PickList[294] ⎕wi "extent" (150,(¯10+6×¯1↑CharSize)+¯1↑Win∆TextSize ((0,⎕wi "limit")⌈⍴PickList)↑PickList)[295] ⎕wi "onClick" "0 0⍴(⊂⎕wi 'name') Contributions 'Change' "[296] [297] ⎕wself←"fmContsDef.fBands.llgcdBandmeth" ⎕wi "New" "Label"[298] ⎕wi "scale" 5[299] ⎕wi "style" 2[300] ⎕wi "extent" (↑⎕wi "Draw" ("?text" (("⍺",⎕tcnl) char_replace "Contributions Band⍺Method")))[301] ⎕wi "caption" (("⍺",⎕tcnl) char_replace "Contributions Band⍺Method")[302] where←4↑,"fmContsDef.fBands.cbgcdBandmeth" ⎕wi "∆where"[303] size←1↑"fmContsDef.fBands.cbgcdBandmeth" ⎕wi "extent"[304] size←¯3⌈0.5×(1↑⎕wi "extent")-size[305] x←0.5×⍴where←Win∆Calcwhere where-0,size,0,10+¯1↑⎕wi "extent"[306] ⎕wi "∆where" ((x,2)⍴where)[307] ⎕wi "where" (("fmContsDef.fBands" ⎕wi "size") Win∆Resize ⎕wi "∆where")[308] [309] ⎕wself←"fmContsDef.fBands.edgcdREVDAT" ⎕wi "New" "Edit"[310] Fieldlist←Fieldlist OVER "fmContsDef.fBands.edgcdREVDAT"[311] Fieldcontrol←Fieldcontrol OVER "Edit"[312] ⎕wi "∆name" "gcdREVDAT"[313] ⎕wi "∆type" "Date"[314] ⎕wi "∆mandatory" 1[315] ⎕wi "visible" (¯1+2×0)[316] ⎕wi "∆valid" ('DD/MM')[317] ⎕wi "tooltip" "Specify the Day and Month of the Contribution Bands Review Date"[318] ⎕wi "limit" 5[319] ⎕wi "∆where" (2 2⍴0.11 0 0.75 0)[320] ⎕wi "where" (("fmContsDef.fBands" ⎕wi "size") Win∆Resize (2 2⍴0.11 0 0.75 0))[321] ⎕wi "onChange" "0 0⍴(⊂⎕wi 'name') Contributions 'Change' "[322] ⎕wi "onExit" "⍎(0∊⍴,⎕wres←0 INPUT∆CHECK 'fmContsDef.fBands.edgcdREVDAT')/'0 0⍴(⊂⎕wi ''name'') Contributions ''Change'' ' "[323] ⎕wi "onExitError" "Win∆ExitError ⎕warg"[324] ⎕wi "onKeyPress" "⎕wres←¯2×~⎕warg∊8 32 45 46 47 48 49 50 51 52 53 54 55 56 57"[325] ⎕wi "onKeyDown" "(⎕wi 'self') ChangesDates ⎕warg"[326] ⎕wi "extent" (2+CharSize×1 6)[327] [328] ⎕wself←"fmContsDef.fBands.lrgcdREVDAT" ⎕wi "New" "Label"[329] ⎕wi "scale" 5[330] ⎕wi "visible" (¯1+2×0)[331] ⎕wi "extent" (↑⎕wi "Draw" ("?text" "DD/MM"))[332] ⎕wi "caption" "DD/MM"[333] where←4↑,"fmContsDef.fBands.edgcdREVDAT" ⎕wi "∆where"[334] x←0.5×⍴where←Win∆Calcwhere where+0,3,0,10+¯1↑"fmContsDef.fBands.edgcdREVDAT" ⎕wi "extent"[335] ⎕wi "∆where" ((x,2)⍴where)[336] ⎕wi "where" (("fmContsDef.fBands" ⎕wi "size") Win∆Resize ⎕wi "∆where")[337] [338] ⎕wself←"fmContsDef.fBands.llgcdREVDAT" ⎕wi "New" "Label"[339] ⎕wi "scale" 5[340] ⎕wi "style" 2[341] ⎕wi "visible" (¯1+2×0)[342] ⎕wi "extent" (↑⎕wi "Draw" ("?text" "Review Date"))[343] ⎕wi "caption" "Review Date"[344] where←4↑,"fmContsDef.fBands.edgcdREVDAT" ⎕wi "∆where"[345] x←0.5×⍴where←Win∆Calcwhere where-0 ¯3 0,10+¯1↑⎕wi "extent"[346] ⎕wi "∆where" ((x,2)⍴where)[347] ⎕wi "where" (("fmContsDef.fBands" ⎕wi "size") Win∆Resize ⎕wi "∆where")[348] [349] ⎕wself←"fmContsDef.fBands.cbgcdF" ⎕wi "New" "Combo"[350] Fieldlist←Fieldlist OVER "fmContsDef.fBands.cbgcdF"[351] Fieldcontrol←Fieldcontrol OVER "Combo"[352] ⎕wi "∆name" "gcdF"[353] ⎕wi "∆type" "Char"[354] ⎕wi "∆mandatory" 1[355] ⎕wi "∆helpid" 4300[356] ⎕wi "tooltip" "Select the Earnings Limits Inflation Rate(s) (% p.a.)"[357] ⎕wi "style" 16 128 256 2[358] ⎕wi "∆where" (2 2⍴0.34 0 0.45 0)[359] ⎕wi "where" (("fmContsDef.fBands" ⎕wi "size") Win∆Resize (2 2⍴0.34 0 0.45 0))[360] PickList←GetFinList 'Inf'[361] ⎕wi "∆update" "GetFinList 'Inf'"[362] PickList←⊃m2n 1 0↓PickList[363] ⎕wi "list" PickList[364] ⎕wi "extent" (150,(¯10+6×¯1↑CharSize)+¯1↑Win∆TextSize ((0,⎕wi "limit")⌈⍴PickList)↑PickList)[365] ⎕wi "onClick" "(⎕wi 'self') Win∆FinLabelUpdate ⊃¨(⊂⍙FinAssdict) at¨'List' 'Label' ⋄ 0 0⍴(⊂⎕wi 'name') Contributions 'Change' "[366] ⎕wi "∆rightlabel" "fmContsDef.fBands.lrgcdF"[367] [368] ⎕wself←"fmContsDef.fBands.lrgcdF" ⎕wi "New" "Label"[369] ⎕wi "scale" 5[370] ⎕wi "extent" (CharSize×¯2↑1,2 55)[371] ⎕wi "caption" " "[372] where←4↑,"fmContsDef.fBands.cbgcdF" ⎕wi "∆where"[373] x←0.5×⍴where←Win∆Calcwhere where+0,¯3,0,10+¯1↑"fmContsDef.fBands.cbgcdF" ⎕wi "extent"[374] ⎕wi "∆where" ((x,2)⍴where)[375] ⎕wi "where" (("fmContsDef.fBands" ⎕wi "size") Win∆Resize ⎕wi "∆where")[376] [377] ⎕wself←"fmContsDef.fBands.llgcdF" ⎕wi "New" "Label"[378] ⎕wi "scale" 5[379] ⎕wi "style" 2[380] ⎕wi "extent" (↑⎕wi "Draw" ("?text" (("⍺",⎕tcnl) char_replace "Earnings Bands⍺Increase")))[381] ⎕wi "caption" (("⍺",⎕tcnl) char_replace "Earnings Bands⍺Increase")[382] where←4↑,"fmContsDef.fBands.cbgcdF" ⎕wi "∆where"[383] size←1↑"fmContsDef.fBands.cbgcdF" ⎕wi "extent"[384] size←¯3⌈0.5×(1↑⎕wi "extent")-size[385] x←0.5×⍴where←Win∆Calcwhere where-0,size,0,10+¯1↑⎕wi "extent"[386] ⎕wi "∆where" ((x,2)⍴where)[387] ⎕wi "where" (("fmContsDef.fBands" ⎕wi "size") Win∆Resize ⎕wi "∆where")[388] [389] ⎕wself←"fmContsDef.fBands.edgcdSalTab" ⎕wi "New" "Edit"[390] Fieldlist←Fieldlist OVER "fmContsDef.fBands.edgcdSalTab"[391] Fieldcontrol←Fieldcontrol OVER "Edit"[392] ⎕wi "∆name" "gcdSalTab"[393] ⎕wi "∆type" "Decr"[394] ⎕wi "∆mandatory" 1[395] ⎕wi "∆valid" ('CM')[396] ⎕wi "∆helpid" 4301[397] ⎕wi "tooltip" "Specify the Table Code of the Contribution Rates Salary Bands
(Right Click for List, Double Click for Rate Tables Display or '<' or '>' to Scroll through the Rate Tables)"[398] ⎕wi "limit" 5[399] ⎕wi "∆where" (2 2⍴0.57 0 0.45 0)[400] ⎕wi "where" (("fmContsDef.fBands" ⎕wi "size") Win∆Resize (2 2⍴0.57 0 0.45 0))[401] ⎕wi "onExit" "⍎(0∊⍴,⎕wres←0 INPUT∆CHECK 'fmContsDef.fBands.edgcdSalTab')/'0 0⍴(⊂⎕wi ''name'') Contributions ''Change'' ' "[402] ⎕wi "onExitError" "Win∆ExitError ⎕warg"[403] ⎕wi "extent" (2+CharSize×1 6)[404] ⎕wi "keys" (60 62)[405] ⎕wi "pointer" ">cur 1001 shell32.dll"[406] ⎕wi "onFocus" "0 0⍴GetDecrList 'List' "[407] ⎕wi "onKeyPress" "(⎕wi 'self') Win∆DecrToggle ⎕wi '∆valid' "[408] ⎕wi "onMouseDown" "(⎕wi 'self') Win∆DecrPopup ⎕wi '∆valid' "[409] ⎕wi "onMouseDouble" "(⎕wi '∆valid') RunDecr 'Form'"[410] ⎕wi "onChange" "(⎕wi 'self') Win∆LabelUpdate (FormName ⎕wi '∆decrdesc') (FormName ⎕wi '∆decrlist') ⋄ 0 0⍴(⊂⎕wi 'name') Contributions 'Change' "[411] ⎕wi "∆rightlabel" "fmContsDef.fBands.lrgcdSalTab"[412] [413] ⎕wself←"fmContsDef.fBands.llgcdSalTab" ⎕wi "New" "Label"[414] ⎕wi "scale" 5[415] ⎕wi "style" 2[416] ⎕wi "extent" (↑⎕wi "Draw" ("?text" (("⍺",⎕tcnl) char_replace "Contribution Rate⍺Salary Bands Table")))[417] ⎕wi "caption" (("⍺",⎕tcnl) char_replace "Contribution Rate⍺Salary Bands Table")[418] where←4↑,"fmContsDef.fBands.edgcdSalTab" ⎕wi "∆where"[419] size←1↑"fmContsDef.fBands.edgcdSalTab" ⎕wi "extent"[420] size←¯3⌈0.5×(1↑⎕wi "extent")-size[421] x←0.5×⍴where←Win∆Calcwhere where-0,size,0,10+¯1↑⎕wi "extent"[422] ⎕wi "∆where" ((x,2)⍴where)[423] ⎕wi "where" (("fmContsDef.fBands" ⎕wi "size") Win∆Resize ⎕wi "∆where")[424] [425] ⎕wself←"fmContsDef.fBands.lrgcdSalTab" ⎕wi "New" "Label"[426] ⎕wi "scale" 5[427] ⎕wi "extent" (CharSize×¯2↑1,55)[428] ⎕wi "style" 32[429] ⎕wi "caption" " "[430] where←4↑,"fmContsDef.fBands.edgcdSalTab" ⎕wi "∆where"[431] x←0.5×⍴where←Win∆Calcwhere where+0,3,0,10+¯1↑"fmContsDef.fBands.edgcdSalTab" ⎕wi "extent"[432] ⎕wi "∆where" ((x,2)⍴where)[433] ⎕wi "where" (("fmContsDef.fBands" ⎕wi "size") Win∆Resize ⎕wi "∆where")[434] [435] ⎕wself←"fmContsDef.fBands.edgcdSalBase" ⎕wi "New" "Edit"[436] Fieldlist←Fieldlist OVER "fmContsDef.fBands.edgcdSalBase"[437] Fieldcontrol←Fieldcontrol OVER "Edit"[438] ⎕wi "∆name" "gcdSalBase"[439] ⎕wi "∆type" "Num"[440] ⎕wi "∆mandatory" 1[441] ⎕wi "∆valid" ('Int' 'Scalar' '+')[442] ⎕wi "∆helpid" 4302[443] ⎕wi "tooltip" "Specify the Base Year of Contribution Rates Salary Bands Table"[444] ⎕wi "limit" 4[445] ⎕wi "∆where" (2 2⍴0.8 0 0.45 0)[446] ⎕wi "where" (("fmContsDef.fBands" ⎕wi "size") Win∆Resize (2 2⍴0.8 0 0.45 0))[447] ⎕wi "∆range" "1900 2100"[448] ⎕wi "onChange" "0 0⍴(⊂⎕wi 'name') Contributions 'Change' "[449] ⎕wi "onExit" "⍎(0∊⍴,⎕wres←0 INPUT∆CHECK 'fmContsDef.fBands.edgcdSalBase')/'0 0⍴(⊂⎕wi ''name'') Contributions ''Change'' ' "[450] ⎕wi "onExitError" "Win∆ExitError ⎕warg"[451] ⎕wi "onKeyPress" "⎕wres←¯2×~⎕warg∊8 32 48 49 50 51 52 53 54 55 56 57"[452] ⎕wi "extent" (2+CharSize×1 5)[453] [454] ⎕wself←"fmContsDef.fBands.lrgcdSalBase" ⎕wi "New" "Label"[455] ⎕wi "scale" 5[456] ⎕wi "extent" (↑⎕wi "Draw" ("?text" "CCYY"))[457] ⎕wi "caption" "CCYY"[458] where←4↑,"fmContsDef.fBands.edgcdSalBase" ⎕wi "∆where"[459] x←0.5×⍴where←Win∆Calcwhere where+0,3,0,10+¯1↑"fmContsDef.fBands.edgcdSalBase" ⎕wi "extent"[460] ⎕wi "∆where" ((x,2)⍴where)[461] ⎕wi "where" (("fmContsDef.fBands" ⎕wi "size") Win∆Resize ⎕wi "∆where")[462] [463] ⎕wself←"fmContsDef.fBands.llgcdSalBase" ⎕wi "New" "Label"[464] ⎕wi "scale" 5[465] ⎕wi "style" 2[466] ⎕wi "extent" (↑⎕wi "Draw" ("?text" (("⍺",⎕tcnl) char_replace "Base Year of⍺Salary Bands Table")))[467] ⎕wi "caption" (("⍺",⎕tcnl) char_replace "Base Year of⍺Salary Bands Table")[468] where←4↑,"fmContsDef.fBands.edgcdSalBase" ⎕wi "∆where"[469] size←1↑"fmContsDef.fBands.edgcdSalBase" ⎕wi "extent"[470] size←¯3⌈0.5×(1↑⎕wi "extent")-size[471] x←0.5×⍴where←Win∆Calcwhere where-0,size,0,10+¯1↑⎕wi "extent"[472] ⎕wi "∆where" ((x,2)⍴where)[473] ⎕wi "where" (("fmContsDef.fBands" ⎕wi "size") Win∆Resize ⎕wi "∆where")[474] [475] :if 300<fnsize[476]     ((1↑⎕lc) fnsize "FrameV - Contributions Tables") Win∆ProgressBar "MemberUpdate"[477] :endif[478] [479] ⎕wself←"fmContsDef.fTables" ⎕wi "New" "Frame"[480] ⎕wi "scale" 5[481] ⎕wi "∆where" (4 2⍴0.6 0 0 0 0.15 0 1 0)[482] ⎕wi "where" (("fmContsDef" ⎕wi "size") Win∆Resize (4 2⍴0.6 0 0 0 0.15 0 1 0))[483] ⎕wi "caption" "Contributions Tables"[484] ⎕wi "style" 0[485] ⎕wi "onResize" "AutoResize"[486] [487] ⎕wself←"fmContsDef.fTables.edgcdAgeTab" ⎕wi "New" "Edit"[488] Fieldlist←Fieldlist OVER "fmContsDef.fTables.edgcdAgeTab"[489] Fieldcontrol←Fieldcontrol OVER "Edit"[490] ⎕wi "∆name" "gcdAgeTab"[491] ⎕wi "∆type" "Decr"[492] ⎕wi "∆mandatory" 1[493] ⎕wi "∆valid" ('EX' 'FX' 'GX' 'HX' 'EF' 'FF' 'GF' 'HF')[494] ⎕wi "∆helpid" 4303[495] ⎕wi "tooltip" "Specify the Table Code of the Contribution Rates
(Right Click for List, Double Click for Rate Tables Display or '<' or '>' to Scroll through the Rate Tables)"[496] ⎕wi "limit" 5[497] ⎕wi "∆where" (2 2⍴0.25 0 0.2 0)[498] ⎕wi "where" (("fmContsDef.fTables" ⎕wi "size") Win∆Resize (2 2⍴0.25 0 0.2 0))[499] ⎕wi "onExit" "⍎(0∊⍴,⎕wres←0 INPUT∆CHECK 'fmContsDef.fTables.edgcdAgeTab')/'0 0⍴(⊂⎕wi ''name'') Contributions ''Change'' ' "[500] ⎕wi "onExitError" "Win∆ExitError ⎕warg"[501] ⎕wi "extent" (2+CharSize×1 6)[502] ⎕wi "keys" (60 62)[503] ⎕wi "pointer" ">cur 1001 shell32.dll"[504] ⎕wi "onFocus" "0 0⍴GetDecrList 'List' "[505] ⎕wi "onKeyPress" "(⎕wi 'self') Win∆DecrToggle ⎕wi '∆valid' "[506] ⎕wi "onMouseDown" "(⎕wi 'self') Win∆DecrPopup ⎕wi '∆valid' "[507] ⎕wi "onMouseDouble" "(⎕wi '∆valid') RunDecr 'Form'"[508] ⎕wi "onChange" "(⎕wi 'self') Win∆LabelUpdate (FormName ⎕wi '∆decrdesc') (FormName ⎕wi '∆decrlist') ⋄ 0 0⍴(⊂⎕wi 'name') Contributions 'Change' "[509] ⎕wi "∆rightlabel" "fmContsDef.fTables.lrgcdAgeTab"[510] [511] ⎕wself←"fmContsDef.fTables.llgcdAgeTab" ⎕wi "New" "Label"[512] ⎕wi "scale" 5[513] ⎕wi "style" 2[514] ⎕wi "extent" (↑⎕wi "Draw" ("?text" (("⍺",⎕tcnl) char_replace "Contribution Rate⍺Age Table")))[515] ⎕wi "caption" (("⍺",⎕tcnl) char_replace "Contribution Rate⍺Age Table")[516] where←4↑,"fmContsDef.fTables.edgcdAgeTab" ⎕wi "∆where"[517] size←1↑"fmContsDef.fTables.edgcdAgeTab" ⎕wi "extent"[518] size←¯3⌈0.5×(1↑⎕wi "extent")-size[519] x←0.5×⍴where←Win∆Calcwhere where-0,size,0,10+¯1↑⎕wi "extent"[520] ⎕wi "∆where" ((x,2)⍴where)[521] ⎕wi "where" (("fmContsDef.fTables" ⎕wi "size") Win∆Resize ⎕wi "∆where")[522] [523] ⎕wself←"fmContsDef.fTables.lrgcdAgeTab" ⎕wi "New" "Label"[524] ⎕wi "scale" 5[525] ⎕wi "extent" (CharSize×¯2↑1,25)[526] ⎕wi "style" 32[527] ⎕wi "caption" " "[528] where←4↑,"fmContsDef.fTables.edgcdAgeTab" ⎕wi "∆where"[529] x←0.5×⍴where←Win∆Calcwhere where+0,3,0,10+¯1↑"fmContsDef.fTables.edgcdAgeTab" ⎕wi "extent"[530] ⎕wi "∆where" ((x,2)⍴where)[531] ⎕wi "where" (("fmContsDef.fTables" ⎕wi "size") Win∆Resize ⎕wi "∆where")[532] [533] ⎕wself←"fmContsDef.fTables.edgcdDurnTab" ⎕wi "New" "Edit"[534] Fieldlist←Fieldlist OVER "fmContsDef.fTables.edgcdDurnTab"[535] Fieldcontrol←Fieldcontrol OVER "Edit"[536] ⎕wi "∆name" "gcdDurnTab"[537] ⎕wi "∆type" "Decr"[538] ⎕wi "∆mandatory" 1[539] ⎕wi "∆valid" ('ET' 'FT' 'GT' 'HT')[540] ⎕wi "∆helpid" 4304[541] ⎕wi "tooltip" "Specify the Table Code of the Contribution Rates
(Right Click for List, Double Click for Rate Tables Display or '<' or '>' to Scroll through the Rate Tables)"[542] ⎕wi "limit" 5[543] ⎕wi "∆where" (2 2⍴0.25 0 0.65 0)[544] ⎕wi "where" (("fmContsDef.fTables" ⎕wi "size") Win∆Resize (2 2⍴0.25 0 0.65 0))[545] ⎕wi "onExit" "⍎(0∊⍴,⎕wres←0 INPUT∆CHECK 'fmContsDef.fTables.edgcdDurnTab')/'0 0⍴(⊂⎕wi ''name'') Contributions ''Change'' ' "[546] ⎕wi "onExitError" "Win∆ExitError ⎕warg"[547] ⎕wi "extent" (2+CharSize×1 6)[548] ⎕wi "keys" (60 62)[549] ⎕wi "pointer" ">cur 1001 shell32.dll"[550] ⎕wi "onFocus" "0 0⍴GetDecrList 'List' "[551] ⎕wi "onKeyPress" "(⎕wi 'self') Win∆DecrToggle ⎕wi '∆valid' "[552] ⎕wi "onMouseDown" "(⎕wi 'self') Win∆DecrPopup ⎕wi '∆valid' "[553] ⎕wi "onMouseDouble" "(⎕wi '∆valid') RunDecr 'Form'"[554] ⎕wi "onChange" "(⎕wi 'self') Win∆LabelUpdate (FormName ⎕wi '∆decrdesc') (FormName ⎕wi '∆decrlist') ⋄ 0 0⍴(⊂⎕wi 'name') Contributions 'Change' "[555] ⎕wi "∆rightlabel" "fmContsDef.fTables.lrgcdDurnTab"[556] [557] ⎕wself←"fmContsDef.fTables.llgcdDurnTab" ⎕wi "New" "Label"[558] ⎕wi "scale" 5[559] ⎕wi "style" 2[560] ⎕wi "extent" (↑⎕wi "Draw" ("?text" (("⍺",⎕tcnl) char_replace "Contribution Rate⍺Duration Table")))[561] ⎕wi "caption" (("⍺",⎕tcnl) char_replace "Contribution Rate⍺Duration Table")[562] where←4↑,"fmContsDef.fTables.edgcdDurnTab" ⎕wi "∆where"[563] size←1↑"fmContsDef.fTables.edgcdDurnTab" ⎕wi "extent"[564] size←¯3⌈0.5×(1↑⎕wi "extent")-size[565] x←0.5×⍴where←Win∆Calcwhere where-0,size,0,10+¯1↑⎕wi "extent"[566] ⎕wi "∆where" ((x,2)⍴where)[567] ⎕wi "where" (("fmContsDef.fTables" ⎕wi "size") Win∆Resize ⎕wi "∆where")[568] [569] ⎕wself←"fmContsDef.fTables.lrgcdDurnTab" ⎕wi "New" "Label"[570] ⎕wi "scale" 5[571] ⎕wi "extent" (CharSize×¯2↑1,25)[572] ⎕wi "style" 32[573] ⎕wi "caption" " "[574] where←4↑,"fmContsDef.fTables.edgcdDurnTab" ⎕wi "∆where"[575] x←0.5×⍴where←Win∆Calcwhere where+0,3,0,10+¯1↑"fmContsDef.fTables.edgcdDurnTab" ⎕wi "extent"[576] ⎕wi "∆where" ((x,2)⍴where)[577] ⎕wi "where" (("fmContsDef.fTables" ⎕wi "size") Win∆Resize ⎕wi "∆where")[578] [579] ⎕wself←"fmContsDef.fTables.cbgcdEntryDate" ⎕wi "New" "Combo"[580] Fieldlist←Fieldlist OVER "fmContsDef.fTables.cbgcdEntryDate"[581] Fieldcontrol←Fieldcontrol OVER "Combo"[582] ⎕wi "∆name" "gcdEntryDate"[583] ⎕wi "∆type" "Char"[584] ⎕wi "∆mandatory" 1[585] ⎕wi "∆helpid" 4305[586] ⎕wi "tooltip" "Select the Membership Date to be used as the Entry Date"[587] ⎕wi "style" 16 128 256 2[588] ⎕wi "∆where" (2 2⍴0.6 0 0.45 0)[589] ⎕wi "where" (("fmContsDef.fTables" ⎕wi "size") Win∆Resize (2 2⍴0.6 0 0.45 0))[590] PickList←⍙POPUPSdict ReadDictFile "MemServ"[591] PickList←⊃m2n 1 0↓PickList[592] ⎕wi "list" PickList[593] ⎕wi "extent" (150,(¯10+6×¯1↑CharSize)+¯1↑Win∆TextSize ((0,⎕wi "limit")⌈⍴PickList)↑PickList)[594] ⎕wi "onClick" "0 0⍴(⊂⎕wi 'name') Contributions 'Change' "[595] [596] ⎕wself←"fmContsDef.fTables.llgcdEntryDate" ⎕wi "New" "Label"[597] ⎕wi "scale" 5[598] ⎕wi "style" 2[599] ⎕wi "extent" (↑⎕wi "Draw" ("?text" "Based on"))[600] ⎕wi "caption" "Based on"[601] where←4↑,"fmContsDef.fTables.cbgcdEntryDate" ⎕wi "∆where"[602] x←0.5×⍴where←Win∆Calcwhere where-0 ¯3 0,10+¯1↑⎕wi "extent"[603] ⎕wi "∆where" ((x,2)⍴where)[604] ⎕wi "where" (("fmContsDef.fTables" ⎕wi "size") Win∆Resize ⎕wi "∆where")[605] [606] :if 300<fnsize[607]     ((1↑⎕lc) fnsize "FrameV - Contributions Cessation") Win∆ProgressBar "MemberUpdate"[608] :endif[609] [610] ⎕wself←"fmContsDef.fCease" ⎕wi "New" "Frame"[611] ⎕wi "scale" 5[612] ⎕wi "∆where" (4 2⍴0.75 0 0 0 0.15 0 1 0)[613] ⎕wi "where" (("fmContsDef" ⎕wi "size") Win∆Resize (4 2⍴0.75 0 0 0 0.15 0 1 0))[614] ⎕wi "caption" "Contributions Cessation"[615] ⎕wi "style" 0[616] ⎕wi "onResize" "AutoResize"[617] [618] ⎕wself←"fmContsDef.fCease.edgcdCease" ⎕wi "New" "Edit"[619] Fieldlist←Fieldlist OVER "fmContsDef.fCease.edgcdCease"[620] Fieldcontrol←Fieldcontrol OVER "Edit"[621] ⎕wi "∆name" "gcdCease"[622] ⎕wi "∆type" "Num"[623] ⎕wi "∆mandatory" 1[624] ⎕wi "∆valid" ('Int' '+' 'Scalar')[625] ⎕wi "∆helpid" 4306[626] ⎕wi "tooltip" "Specify the Period that Contributions Cease after (years)"[627] ⎕wi "limit" 2[628] ⎕wi "∆where" (2 2⍴0.4 0 0.2 0)[629] ⎕wi "where" (("fmContsDef.fCease" ⎕wi "size") Win∆Resize (2 2⍴0.4 0 0.2 0))[630] ⎕wi "∆range" "1 99"[631] ⎕wi "onChange" "0 0⍴(⊂⎕wi 'name') Contributions 'Change' "[632] ⎕wi "onExit" "⍎(0∊⍴,⎕wres←0 INPUT∆CHECK 'fmContsDef.fCease.edgcdCease')/'0 0⍴(⊂⎕wi ''name'') Contributions ''Change'' ' "[633] ⎕wi "onExitError" "Win∆ExitError ⎕warg"[634] ⎕wi "onKeyPress" "⎕wres←¯2×~⎕warg∊8 32 48 49 50 51 52 53 54 55 56 57"[635] ⎕wi "extent" (2+CharSize×1 3)[636] [637] ⎕wself←"fmContsDef.fCease.lrgcdCease" ⎕wi "New" "Label"[638] ⎕wi "scale" 5[639] ⎕wi "extent" (↑⎕wi "Draw" ("?text" "years"))[640] ⎕wi "caption" "years"[641] where←4↑,"fmContsDef.fCease.edgcdCease" ⎕wi "∆where"[642] x←0.5×⍴where←Win∆Calcwhere where+0,3,0,10+¯1↑"fmContsDef.fCease.edgcdCease" ⎕wi "extent"[643] ⎕wi "∆where" ((x,2)⍴where)[644] ⎕wi "where" (("fmContsDef.fCease" ⎕wi "size") Win∆Resize ⎕wi "∆where")[645] [646] ⎕wself←"fmContsDef.fCease.llgcdCease" ⎕wi "New" "Label"[647] ⎕wi "scale" 5[648] ⎕wi "style" 2[649] ⎕wi "extent" (↑⎕wi "Draw" ("?text" "Contributions Cease after"))[650] ⎕wi "caption" "Contributions Cease after"[651] where←4↑,"fmContsDef.fCease.edgcdCease" ⎕wi "∆where"[652] x←0.5×⍴where←Win∆Calcwhere where-0 ¯3 0,10+¯1↑⎕wi "extent"[653] ⎕wi "∆where" ((x,2)⍴where)[654] ⎕wi "where" (("fmContsDef.fCease" ⎕wi "size") Win∆Resize ⎕wi "∆where")[655] [656] ⎕wself←"fmContsDef.fCease.cbgcdCeaseDate" ⎕wi "New" "Combo"[657] Fieldlist←Fieldlist OVER "fmContsDef.fCease.cbgcdCeaseDate"[658] Fieldcontrol←Fieldcontrol OVER "Combo"[659] ⎕wi "∆name" "gcdCeaseDate"[660] ⎕wi "∆type" "Char"[661] ⎕wi "∆mandatory" 1[662] ⎕wi "∆helpid" 4307[663] ⎕wi "tooltip" "Select the Membership Date to be used as the Start Date"[664] ⎕wi "style" 16 128 256 2[665] ⎕wi "∆where" (2 2⍴0.4 0 0.65 0)[666] ⎕wi "where" (("fmContsDef.fCease" ⎕wi "size") Win∆Resize (2 2⍴0.4 0 0.65 0))[667] PickList←⍙POPUPSdict ReadDictFile "MemServ"[668] PickList←⊃m2n 1 0↓PickList[669] ⎕wi "list" PickList[670] ⎕wi "extent" (150,(¯10+6×¯1↑CharSize)+¯1↑Win∆TextSize ((0,⎕wi "limit")⌈⍴PickList)↑PickList)[671] ⎕wi "onClick" "0 0⍴(⊂⎕wi 'name') Contributions 'Change' "[672] [673] ⎕wself←"fmContsDef.fCease.llgcdCeaseDate" ⎕wi "New" "Label"[674] ⎕wi "scale" 5[675] ⎕wi "style" 2[676] ⎕wi "extent" (↑⎕wi "Draw" ("?text" "Based on"))[677] ⎕wi "caption" "Based on"[678] where←4↑,"fmContsDef.fCease.cbgcdCeaseDate" ⎕wi "∆where"[679] x←0.5×⍴where←Win∆Calcwhere where-0 ¯3 0,10+¯1↑⎕wi "extent"[680] ⎕wi "∆where" ((x,2)⍴where)[681] ⎕wi "where" (("fmContsDef.fCease" ⎕wi "size") Win∆Resize ⎕wi "∆where")[682] [683] :if 300<fnsize[684]     ((1↑⎕lc) fnsize "Frame - Buttons") Win∆ProgressBar "MemberUpdate"[685] :endif[686] [687] ⎕wself←"fmContsDef.fButtons" ⎕wi "New" "Frame"[688] ⎕wi "scale" 5[689] ⎕wi "∆where" (4 2⍴0.9 0 0 0 0.099 0 1 0)[690] ⎕wi "where" (("fmContsDef" ⎕wi "size") Win∆Resize (4 2⍴0.9 0 0 0 0.099 0 1 0))[691] ⎕wi "style" 7[692] ⎕wi "onResize" "AutoResize"[693] list←list OVER "fmContsDef.fButtons.bnContributionsEditFin"[694] ⎕wself←"fmContsDef.fButtons.bnContributionsEditFin" ⎕wi "New" "Button"[695] ⎕wi "deferexit" 1[696] ⎕wi "extent" (size←1.4 1.384615385×buttonsize×1⌈CharSize÷13 6)[697] ⎕wi "∆where" (2 2⍴0.1 0 0.44 0)[698] ⎕wi "where" (("fmContsDef.fButtons" ⎕wi "size") Win∆Resize (2 2⍴0.1 0 0.44 0))[699] ⎕wi "tooltip" "Edit/Add the Scheme Financial Assumptions"[700] ⎕wi "onClick" ("fmSV.mContributionsFile.mEditFin"⎕wi "onClick")[701] ⎕wi "∆helpid" 4308[702] ⎕wi "caption" (("⍺",⎕tcnl) char_replace "Edit Scheme⍺Financials")[703] [704] ⎕wself←"fmContsDef.lParmDesc" ⎕wi "New" "Label"[705] ⎕wi "scale" 5[706] ⎕wi "extent" (CharSize×¯2↑1,80)[707] ⎕wi "style" 32[708] ⎕wi "caption" " "[709] ⎕wi "∆where" (2 2⍴0.96 0 0.02 0)[710] ⎕wi "where" (("fmContsDef" ⎕wi "size") Win∆Resize (2 2⍴0.96 0 0.02 0))[711] [712] "fmContsDef" ⎕wi "∆multifile" ""[713] "fmContsDef" ⎕wi "∆singlefile" ""[714] "fmContsDef" ⎕wi "∆format" ""[715] "fmContsDef" ⎕wi "∆financial" 1[716] "fmContsDef" ⎕wi "∆relrules" 1[717] "fmContsDef" ⎕wi "∆parm" 0[718] "fmContsDef" ⎕wi "∆decr" 1[719] "fmContsDef" ⎕wi "∆file" 0[720] "fmContsDef" ⎕wi "∆codefile" CodeFile[721] "fmContsDef" ⎕wi "∆inputstype" "ClientFile"[722] "fmContsDef" ⎕wi "∆inputsentry" "Multi"[723] "fmContsDef" ⎕wi "∆savecn" (⍳0)[724] "fmContsDef" ⎕wi "∆savedesc" ""[725] list←list OVER "fmContsDef"[726] "fmContsDef" ⎕wi "∆fieldlist" Fieldlist[727] "fmContsDef" ⎕wi "∆fieldcontrol" Fieldcontrol[728] childlist←"fmSV" ⎕wi "∆childlist"[729] list←(⊃¯1↑childlist) OVER list[730] childlist[⍴childlist]←⊂list[731] "fmSV" ⎕wi "∆childlist" childlist[732] list←,⎕split list[733] 0 0⍴((∨/¨(⊂".mContributions")⍷¨list)/list) MultiWI "enabled" 1[734] :if 300<fnsize[735]     (fnsize fnsize ".") Win∆ProgressBar "MemberUpdate"[736]     Win∆ProgressBar "Hide"[737] :endif[738] "Init" OpenParameters "Contributions"[739] "fmContsDef.bnContributionsHelp" ⎕wi "visible" 1[740] "fmContsDef.bnContributionsQuit" ⎕wi "visible" 1[741] "fmContsDef.bnContributionsSave" ⎕wi "visible" 1[742] "fmContsDef.bnContributionsSaveAs" ⎕wi "visible" 1[743] "#" ⎕wi "focus" "fmContsDef.fContsDef.cbgcdDEF"[744] :if ~0∊⍴,Error←Win∆Initialise "Contributions"[745]     "Quit" EndModule Module[746]     "fmSV" ⎕wi "pointer" 0[747]     0 0⍴"fmContsDef" ⎕wi "Delete"[748]     :return[749] :endif[750] :if bar_open←commandbar^"Multi"≡"Multi"[751]     bar_open←0×"fmContsDef.mContributionsFile.m" Win∆CommandBar "SaveAsHelp"[752] :endif[753] "fmContsDef" ⎕wi "Paint"[754] "fmSV" ⎕wi "pointer" 11[755] "fmContsDef" ⎕wi "onWait" "0 0⍴Contributions 'Wait' ⋄ 'fmContsDef' ⎕wi 'modified' 0"[756] 0 0⍴"fmContsDef" ⎕wi "Wait"[757] 0 0⍴"fmContsDef" ⎕wi "Delete"[758] "fmSV" ⎕wi "pointer" 0 ∇