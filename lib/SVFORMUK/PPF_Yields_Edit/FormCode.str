∇ Container←Form_Make;⎕wself;ControlName;childlist;list;Fieldlist;Fieldcontrol;FrameWidth;Caption;buttonsize;buttonwhere;where;size;alignment;Header;PickList;NameList;value;sortorder;SortList;MaxRow;MaxCol;Parent;level;node;no;nn;NN;x;fnsize;framelist;relTests[1] [2] Fieldlist←Fieldcontrol←list←0 0⍴""[3] "fmSV" ⎕wi "pointer" 13[4] buttonsize←25 65 ⋄ buttonwhere←¯5[5] FormName ⎕wi "caption" ((FormName ⎕wi "caption")," - PPF Yields Editing")[6] "fmSV" ⎕wi "∆caption" (("fmSV" ⎕wi "∆caption"),⊂("fmSV" ⎕wi "caption"))[7] :if 300<fnsize←1↑⍴⎕cr "Form_Make"[8]     "Generating Form" Win∆ProgressBar "Open"[9]     ("Menu Items:" "Form Controls:") Win∆ProgressBar "SetLabels"[10]     (1 1 "Help About") Win∆ProgressBar "FileUpdate"[11] :endif[12] [13] Container←"∆Dialog"[14] [15] ⎕wself←"fmPPFYEdit" ⎕wi "New" "Form" "Hide"[16] ⎕wi "caption" ("fmSV" ⎕wi "caption")[17] ⎕wi "scale" 5[18] ⎕wi "font" ("fmSV" ⎕wi "font")[19] ⎕wi "border" 2 32 64[20] ⎕wi "where" (Win∆CentrePos 0.5 1.2×768 1024×1⌈CharSize÷13 6)[21] ⎕wi "limitwhere" (0.8×¯2↑⎕wi "where")[22] ⎕wi "tooltipwidth" 200[23] ⎕wi "onResize" "AutoResize"[24] ⎕wi "onClose" "ExitSystem ''"[25] ControlName←"fmPPFYEdit"[26] relTests←2[27] 0 Menu_Make "fmSV"[28] 0 Menu_Make "fmPPFYEdit"[29] "fmPPFYEdit" Win∆CutCopyPaste "Build"[30] "fmPPFYEdit" ⎕wi "∆helpid" 2095[31] list←list OVER "fmPPFYEdit.bnPPF_Yields_EditHelp"[32] ⎕wself←"fmPPFYEdit.bnPPF_Yields_EditHelp" ⎕wi "New" "Button"[33] ⎕wi "deferexit" 1[34] ⎕wi "extent" (size←1×buttonsize×1⌈CharSize÷13 6)[35] x←0.5×⍴where←Win∆Calcwhere 1,(¯10-size[1]),1,buttonwhere←buttonwhere-5+size[2][36] ⎕wi "∆where" ((x,2)⍴where)[37] ⎕wi "where" (("fmPPFYEdit" ⎕wi "size") Win∆Resize ⎕wi "∆where")[38] ⎕wi "tooltip" "SuperVal Help"[39] ⎕wi "onClick" ("fmSV.mPPF_Yields_EditHelp.mContext"⎕wi "onClick")[40] ⎕wi "caption" "Help"[41] :if buttonimage[42]     ⎕wi "imagelist" "fmSV.iStandard"[43]     ⎕wi "imageindex" 12[44] :endif[45] ⎕wi "visible" ¯1[46] ⎕wi "onMouseDown" "∆HelpField←'#' ⎕wi 'focus' "[47] list←list OVER "fmPPFYEdit.bnPPF_Yields_EditQuit"[48] ⎕wself←"fmPPFYEdit.bnPPF_Yields_EditQuit" ⎕wi "New" "Button"[49] ⎕wi "style" 2[50] ⎕wi "deferexit" 1[51] ⎕wi "extent" (size←1×buttonsize×1⌈CharSize÷13 6)[52] x←0.5×⍴where←Win∆Calcwhere 1,(¯10-size[1]),1,buttonwhere←buttonwhere-5+size[2][53] ⎕wi "∆where" ((x,2)⍴where)[54] ⎕wi "where" (("fmPPFYEdit" ⎕wi "size") Win∆Resize ⎕wi "∆where")[55] ⎕wi "tooltip" "Cancel and Return"[56] ⎕wi "onClick" ("fmSV.mPPF_Yields_EditFile.mQuit"⎕wi "onClick")[57] ⎕wi "caption" "Cancel"[58] ⎕wi "∆helpid" 3929[59] ⎕wi "order" .5[60] ⎕wi "visible" ¯1[61] list←list OVER "fmPPFYEdit.bnPPF_Yields_EditSave"[62] ⎕wself←"fmPPFYEdit.bnPPF_Yields_EditSave" ⎕wi "New" "Button"[63] ⎕wi "style" 1[64] ⎕wi "extent" (size←1×buttonsize×1⌈CharSize÷13 6)[65] x←0.5×⍴where←Win∆Calcwhere 1,(¯10-size[1]),1,buttonwhere←buttonwhere-5+size[2][66] ⎕wi "∆where" ((x,2)⍴where)[67] ⎕wi "where" (("fmPPFYEdit" ⎕wi "size") Win∆Resize ⎕wi "∆where")[68] ⎕wi "tooltip" "Save Parameters"[69] ⎕wi "onClick" ("fmSV.mPPF_Yields_EditFile.mSave"⎕wi "onClick")[70] ⎕wi "caption" "OK"[71] ⎕wi "∆helpid" 3930[72] ⎕wi "order" .5[73] ⎕wi "visible" ¯1[74] "fmPPFYEdit" ⎕wi "∆modified" 1[75] [76] ⎕wself←"fmPPFYEdit.lYields" ⎕wi "New" "Label"[77] ⎕wi "scale" 5[78] ⎕wi "tooltip" "Right Click Top Left Corner for Grid Options
Right Click Row/Column Headings to Add/Delete Rows/Columns"[79] ⎕wi "extent" (↑⎕wi "Draw" ("?text" "PPF Yield Assumptions"))[80] ⎕wi "caption" "PPF Yield Assumptions"[81] ⎕wi "∆where" (2 2⍴0 ¯20 0 0)[82] ⎕wi "where" (("fmPPFYEdit" ⎕wi "size") Win∆Resize (2 2⍴0 ¯20 0 0))[83] ⎕wself←"fmPPFYEdit.ssYields" ⎕wi "New" "{13E51003-A52B-11D0-86DA-00608CB9FBFB}6D5ECD55-86B8-11d0-95AD-0020AF1E9EB2"[84] ⎕wi "∆where" (4 2⍴0 0 0 0 1 ¯45 1 0)[85] ⎕wi "where" (("fmPPFYEdit" ⎕wi "size") Win∆Resize (4 2⍴0 0 0 0 1 ¯45 1 0))[86] Fieldlist←Fieldlist OVER "fmPPFYEdit.ssYields"[87] Fieldcontrol←Fieldcontrol OVER "F1SS"[88] Win∆F1SSDefaults 0[89] ⎕wi "MaxRow" (MaxRow←1)[90] ⎕wi "MaxCol" (MaxCol←1)[91] ⎕wi "xDoStartEdit" 1[92] ⎕wi "xDoEndEdit" 1[93] ⎕wi "xDoCancelEdit" 1[94] ⎕wi "onClick" "Win∆F1SSClick 'fmPPFYEdit.ssYields'"[95] ⎕wi "onXStartEdit" "⎕wi 'AllowArrows' 0"[96] NameList←0 0⍴" "[97] ⎕wi "MaxCol" (MaxCol←MaxCol⌈1)[98] ⎕wi "ColText" 1 (("/⍺/",⎕tcnl,⎕tclf) TEXTREPL "Applicable⍺Date")[99] ⎕wi "XSetRowHeight" 1 1 255 1[100] NameList←NameList OVER "yielddate[;]"[101] ⎕wi "MaxCol" (MaxCol←MaxCol⌈2)[102] ⎕wi "ColText" 2 (("/⍺/",⎕tcnl,⎕tclf) TEXTREPL "Secondary⍺Key⍺(Optional)")[103] ⎕wi "XSetRowHeight" 1 1 255 1[104] NameList←NameList OVER "yieldkey[;]"[105] ⎕wi "MaxCol" (MaxCol←MaxCol⌈3)[106] ⎕wi "ColText" 3 (("/⍺/",⎕tcnl,⎕tclf) TEXTREPL "Index-⍺Linked⍺5yrs 5%")[107] ⎕wi "XSetRowHeight" 1 1 255 1[108] NameList←NameList OVER "ppf55[;]"[109] ⎕wi "MaxCol" (MaxCol←MaxCol⌈4)[110] ⎕wi "ColText" 4 (("/⍺/",⎕tcnl,⎕tclf) TEXTREPL "Index-⍺Linked⍺5yrs 0%")[111] ⎕wi "XSetRowHeight" 1 1 255 1[112] NameList←NameList OVER "ppf50[;]"[113] ⎕wi "MaxCol" (MaxCol←MaxCol⌈5)[114] ⎕wi "ColText" 5 (("/⍺/",⎕tcnl,⎕tclf) TEXTREPL "Index-⍺Linked⍺5-15yrs 5%")[115] ⎕wi "XSetRowHeight" 1 1 255 1[116] NameList←NameList OVER "ppf5_155[;]"[117] ⎕wi "MaxCol" (MaxCol←MaxCol⌈6)[118] ⎕wi "ColText" 6 (("/⍺/",⎕tcnl,⎕tclf) TEXTREPL "Index-⍺Linked⍺5-15yrs 0%")[119] ⎕wi "XSetRowHeight" 1 1 255 1[120] NameList←NameList OVER "ppf5_150[;]"[121] ⎕wi "MaxCol" (MaxCol←MaxCol⌈7)[122] ⎕wi "ColText" 7 (("/⍺/",⎕tcnl,⎕tclf) TEXTREPL "Index-⍺Linked⍺15yrs 5%")[123] ⎕wi "XSetRowHeight" 1 1 255 1[124] NameList←NameList OVER "ppf155[;]"[125] ⎕wi "MaxCol" (MaxCol←MaxCol⌈8)[126] ⎕wi "ColText" 8 (("/⍺/",⎕tcnl,⎕tclf) TEXTREPL "Index-⍺Linked⍺15yrs 0%")[127] ⎕wi "XSetRowHeight" 1 1 255 1[128] NameList←NameList OVER "ppf150[;]"[129] ⎕wi "MaxCol" (MaxCol←MaxCol⌈9)[130] ⎕wi "ColText" 9 (("/⍺/",⎕tcnl,⎕tclf) TEXTREPL "Fixed⍺10yrs")[131] ⎕wi "XSetRowHeight" 1 1 255 1[132] NameList←NameList OVER "ppf10[;]"[133] ⎕wi "MaxCol" (MaxCol←MaxCol⌈10)[134] ⎕wi "ColText" 10 (("/⍺/",⎕tcnl,⎕tclf) TEXTREPL "Fixed⍺15yrs")[135] ⎕wi "XSetRowHeight" 1 1 255 1[136] NameList←NameList OVER "ppf15[;]"[137] ⎕wi "MaxCol" (MaxCol←MaxCol⌈11)[138] ⎕wi "ColText" 11 (("/⍺/",⎕tcnl,⎕tclf) TEXTREPL "Fixed⍺20yrs")[139] ⎕wi "XSetRowHeight" 1 1 255 1[140] NameList←NameList OVER "ppf20[;]"[141] ⎕wi "MaxCol" (MaxCol←MaxCol⌈12)[142] ⎕wi "ColText" 12 (("/⍺/",⎕tcnl,⎕tclf) TEXTREPL "Pre Retirement⍺Adjustment")[143] ⎕wi "XSetRowHeight" 1 1 255 1[144] NameList←NameList OVER "adjppfi[;]"[145] ⎕wi "MaxCol" (MaxCol←MaxCol⌈13)[146] ⎕wi "ColText" 13 (("/⍺/",⎕tcnl,⎕tclf) TEXTREPL "Post 2009⍺Pre Retirement⍺Adjustment")[147] ⎕wi "XSetRowHeight" 1 1 255 1[148] NameList←NameList OVER "adjppfi20[;]"[149] ⎕wi "MaxCol" (MaxCol←MaxCol⌈14)[150] ⎕wi "ColText" 14 (("/⍺/",⎕tcnl,⎕tclf) TEXTREPL "Pensioner⍺Post Retirement⍺(With Increases)⍺Adjustment")[151] ⎕wi "XSetRowHeight" 1 1 255 1[152] NameList←NameList OVER "adjppfPENpiI[;]"[153] ⎕wi "MaxCol" (MaxCol←MaxCol⌈15)[154] ⎕wi "ColText" 15 (("/⍺/",⎕tcnl,⎕tclf) TEXTREPL "Pensioner⍺Post Retirement⍺(No Increases)⍺Adjustment")[155] ⎕wi "XSetRowHeight" 1 1 255 1[156] NameList←NameList OVER "adjppfPENpiF[;]"[157] ⎕wi "MaxCol" (MaxCol←MaxCol⌈16)[158] ⎕wi "ColText" 16 (("/⍺/",⎕tcnl,⎕tclf) TEXTREPL "Non-Pensioner⍺Post Retirement⍺(With Increases)⍺Adjustment")[159] ⎕wi "XSetRowHeight" 1 1 255 1[160] NameList←NameList OVER "adjppfpiI[;]"[161] ⎕wi "MaxCol" (MaxCol←MaxCol⌈17)[162] ⎕wi "ColText" 17 (("/⍺/",⎕tcnl,⎕tclf) TEXTREPL "Non-Pensioner⍺Post Retirement⍺(No Increases)⍺Adjustment")[163] ⎕wi "XSetRowHeight" 1 1 255 1[164] NameList←NameList OVER "adjppfpiF[;]"[165] ⎕wi "xHdrHeight" (350⌈250×4)[166] ⎕wi "onXRClick" "1 Win∆F1SSRowMenu ('PPF_Yields_Edit' 'fmPPFYEdit.ssYields')"[167] ⎕wi "∆roworcol" "Col"[168] ⎕wi "∆name" NameList[169] ⎕wi "∆limit" (,12 0 6 6 6 6 6 6 6 6 6 6 6 6 6 6 6)[170] ⎕wi "∆mandatory" 1 0 1 1 1 1 1 1 1 1 1 0 0 0 0 0 0[171] ⎕wi "∆helpid" 3931 3932 3933 3934 3935 3936 3937 3938 3939 3940 3941 3942 3943 3944 3945 3946 3947[172] ⎕wi "∆type" "⍺Date⍺Char⍺Num⍺Num⍺Num⍺Num⍺Num⍺Num⍺Num⍺Num⍺Num⍺Num⍺Num⍺Num⍺Num⍺Num⍺Num"[173] ⎕wi "∆valid" "⍺''⍺''⍺'Scalar'⍺'Scalar'⍺'Scalar'⍺'Scalar'⍺'Scalar'⍺'Scalar'⍺'Scalar'⍺'Scalar'⍺'Scalar'⍺'Scalar'⍺'Scalar'⍺'Scalar'⍺'Scalar'⍺'Scalar'⍺'Scalar'"[174] ⎕wi "∆range" "⍺⍺⍺¯20 40⍺¯20 40⍺¯20 40⍺¯20 40⍺¯20 40⍺¯20 40⍺¯20 40⍺¯20 40⍺¯20 40⍺¯9.99 9.99⍺¯9.99 9.99⍺¯9.99 9.99⍺¯9.99 9.99⍺¯9.99 9.99⍺¯9.99 9.99"[175] ⎕wi "onXEndEdit" "(⎕wi 'xRow') Win∆ValidF1SSCell ⎕wi 'xCol' ⋄ 0 0⍴⎕ex 'F1SSEvent' "[176] ⎕wi "onExit" "Win∆ValidF1SSExit 'PPF_Yields_Edit'"[177] ⎕wi "onExitError" "MDISPLAY ⎕warg ⋄ ⎕wi 'XStartEdit' 0 1 1"[178] ⎕wi "onXCancelEdit" "⎕wi 'AllowArrows' 1 ⋄ ⎕wi 'SetColWidthAuto' 1 1 (⎕wi 'MaxRow') (⎕wi 'MaxCol') 0"[179] "fmPPFYEdit.ssYields" Win∆F1SSProtectCells "Unlock"[180] ⎕wi "SetSelection" 1 1 1 1[181] [182] "fmPPFYEdit" ⎕wi "∆multifile" ""[183] "fmPPFYEdit" ⎕wi "∆singlefile" ""[184] "fmPPFYEdit" ⎕wi "∆format" ""[185] "fmPPFYEdit" ⎕wi "∆financial" 0[186] "fmPPFYEdit" ⎕wi "∆relrules" 2[187] "fmPPFYEdit" ⎕wi "∆parm" 0[188] "fmPPFYEdit" ⎕wi "∆decr" 0[189] "fmPPFYEdit" ⎕wi "∆file" 0[190] "fmPPFYEdit" ⎕wi "∆codefile" CodeFile[191] "fmPPFYEdit" ⎕wi "∆inputstype" ""[192] "fmPPFYEdit" ⎕wi "∆inputsentry" ""[193] "fmPPFYEdit" ⎕wi "∆savecn" (⍳0)[194] "fmPPFYEdit" ⎕wi "∆savedesc" ""[195] list←list OVER "fmPPFYEdit"[196] "fmPPFYEdit" ⎕wi "∆fieldlist" Fieldlist[197] "fmPPFYEdit" ⎕wi "∆fieldcontrol" Fieldcontrol[198] childlist←"fmSV" ⎕wi "∆childlist"[199] list←(⊃¯1↑childlist) OVER list[200] childlist[⍴childlist]←⊂list[201] "fmSV" ⎕wi "∆childlist" childlist[202] list←,⎕split list[203] 0 0⍴((∨/¨(⊂".mPPF_Yields_Edit")⍷¨list)/list) MultiWI "enabled" 1[204] :if 300<fnsize[205]     (fnsize fnsize ".") Win∆ProgressBar "MemberUpdate"[206]     Win∆ProgressBar "Hide"[207] :endif[208] "Init" OpenParameters "PPF_Yields_Edit"[209] "fmPPFYEdit.bnPPF_Yields_EditHelp" ⎕wi "visible" 1[210] "fmPPFYEdit.bnPPF_Yields_EditQuit" ⎕wi "visible" 1[211] "fmPPFYEdit.bnPPF_Yields_EditSave" ⎕wi "visible" 1[212] "#" ⎕wi "focus" "fmPPFYEdit.ssYields"[213] :if ~0∊⍴,Error←Win∆Initialise "PPF_Yields_Edit"[214]     "Quit" EndModule Module[215]     "fmSV" ⎕wi "pointer" 0[216]     0 0⍴"fmPPFYEdit" ⎕wi "Delete"[217]     :return[218] :endif[219] :if bar_open←commandbar^"Multi"≡""[220]     bar_open←0×"fmPPFYEdit.mPPF_Yields_EditFile.m" Win∆CommandBar "OKHelp"[221] :endif[222] "fmPPFYEdit" ⎕wi "Paint"[223] "fmSV" ⎕wi "pointer" 11[224] "fmPPFYEdit" ⎕wi "onWait" "0 0⍴PPF_Yields_Edit 'Wait' ⋄ 'fmPPFYEdit' ⎕wi 'modified' 0"[225] 0 0⍴"fmPPFYEdit" ⎕wi "Wait"[226] 0 0⍴"fmPPFYEdit" ⎕wi "Delete"[227] "fmSV" ⎕wi "pointer" 0 ∇