∇ Container←Form_Make;⎕wself;ControlName;childlist;list;Fieldlist;Fieldcontrol;FrameWidth;Caption;buttonsize;buttonwhere;where;size;alignment;Header;PickList;NameList;value;sortorder;SortList;MaxRow;MaxCol;Parent;level;node;no;nn;NN;x;fnsize;framelist;relTests[1] [2] Fieldlist←Fieldcontrol←list←0 0⍴""[3] "fmSV" ⎕wi "pointer" 13[4] buttonsize←25 65 ⋄ buttonwhere←¯5[5] FormName ⎕wi "caption" ((FormName ⎕wi "caption")," - Select Mortality Table Definition")[6] "fmSV" ⎕wi "∆caption" (("fmSV" ⎕wi "∆caption"),⊂("fmSV" ⎕wi "caption"))[7] :if 300<fnsize←1↑⍴⎕cr "Form_Make"[8]     "Generating Form" Win∆ProgressBar "Open"[9]     ("Menu Items:" "Form Controls:") Win∆ProgressBar "SetLabels"[10]     (1 1 "Help About") Win∆ProgressBar "FileUpdate"[11] :endif[12] [13] Container←"∆Dialog"[14] [15] ⎕wself←"fmMortRate" ⎕wi "New" "Form" "Hide"[16] ⎕wi "caption" ("fmSV" ⎕wi "caption")[17] ⎕wi "scale" 5[18] ⎕wi "font" ("fmSV" ⎕wi "font")[19] ⎕wi "border" 2 32 64[20] ⎕wi "where" (Win∆CentrePos 0.3 1.0×768 1024×1⌈CharSize÷13 6)[21] ⎕wi "limitwhere" (0.8×¯2↑⎕wi "where")[22] ⎕wi "tooltipwidth" 200[23] ⎕wi "onResize" "AutoResize"[24] ⎕wi "onClose" "ExitSystem ''"[25] ControlName←"fmMortRate"[26] relTests←1[27] 0 Menu_Make "fmSV"[28] 1 Menu_Make "fmMortRate"[29] "fmMortRate" Win∆CutCopyPaste "Build"[30] "fmMortRate" ⎕wi "∆helpid" 2159[31] list←list OVER "fmMortRate.bnMortality_Rate_SelectHelp"[32] ⎕wself←"fmMortRate.bnMortality_Rate_SelectHelp" ⎕wi "New" "Button"[33] ⎕wi "deferexit" 1[34] ⎕wi "extent" (size←1×buttonsize×1⌈CharSize÷13 6)[35] x←0.5×⍴where←Win∆Calcwhere 1,(¯10-size[1]),1,buttonwhere←buttonwhere-5+size[2][36] ⎕wi "∆where" ((x,2)⍴where)[37] ⎕wi "where" (("fmMortRate" ⎕wi "size") Win∆Resize ⎕wi "∆where")[38] ⎕wi "tooltip" "SuperVal Help"[39] ⎕wi "onClick" ("fmSV.mMortality_Rate_SelectHelp.mContext"⎕wi "onClick")[40] ⎕wi "caption" "Help"[41] :if buttonimage[42]     ⎕wi "imagelist" "fmSV.iStandard"[43]     ⎕wi "imageindex" 12[44] :endif[45] ⎕wi "visible" ¯1[46] ⎕wi "onMouseDown" "∆HelpField←'#' ⎕wi 'focus' "[47] list←list OVER "fmMortRate.bnMortality_Rate_SelectQuit"[48] ⎕wself←"fmMortRate.bnMortality_Rate_SelectQuit" ⎕wi "New" "Button"[49] ⎕wi "style" 2[50] ⎕wi "deferexit" 1[51] ⎕wi "extent" (size←1×buttonsize×1⌈CharSize÷13 6)[52] x←0.5×⍴where←Win∆Calcwhere 1,(¯10-size[1]),1,buttonwhere←buttonwhere-5+size[2][53] ⎕wi "∆where" ((x,2)⍴where)[54] ⎕wi "where" (("fmMortRate" ⎕wi "size") Win∆Resize ⎕wi "∆where")[55] ⎕wi "tooltip" "Quit and Return"[56] ⎕wi "onClick" ("fmSV.mMortality_Rate_SelectFile.mQuit"⎕wi "onClick")[57] ⎕wi "caption" "Quit"[58] ⎕wi "∆helpid" 4215[59] ⎕wi "order" .5[60] ⎕wi "visible" ¯1[61] ControlName ⎕wi "∆quitbutton" "fmMortRate.bnMortality_Rate_SelectQuit"[62] list←list OVER "fmMortRate.bnMortality_Rate_SelectSave"[63] ⎕wself←"fmMortRate.bnMortality_Rate_SelectSave" ⎕wi "New" "Button"[64] ⎕wi "extent" (size←1×buttonsize×1⌈CharSize÷13 6)[65] x←0.5×⍴where←Win∆Calcwhere 1,(¯10-size[1]),1,buttonwhere←buttonwhere-5+size[2][66] ⎕wi "∆where" ((x,2)⍴where)[67] ⎕wi "where" (("fmMortRate" ⎕wi "size") Win∆Resize ⎕wi "∆where")[68] ⎕wi "tooltip" "Save Parameters"[69] ⎕wi "onClick" ("fmSV.mMortality_Rate_SelectFile.mSave"⎕wi "onClick")[70] ⎕wi "caption" "Save"[71] :if buttonimage[72]     ⎕wi "imagelist" "fmSV.iStandard"[73]     ⎕wi "imageindex" 9[74] :endif[75] ⎕wi "∆helpid" 4216[76] ⎕wi "enabled" 0[77] ⎕wi "order" .5[78] ⎕wi "visible" ¯1[79] "fmMortRate" ⎕wi "onModified" "('Mortality_Rate_Select' 'fmMortRate.bnMortality_Rate_SelectSave') Win∆SaveEnabled (0≠⎕warg[1])"[80] list←list OVER "fmMortRate.bnMortality_Rate_SelectSaveAs"[81] ⎕wself←"fmMortRate.bnMortality_Rate_SelectSaveAs" ⎕wi "New" "Button"[82] ⎕wi "extent" (size←1×buttonsize×1⌈CharSize÷13 6)[83] x←0.5×⍴where←Win∆Calcwhere 1,(¯10-size[1]),1,buttonwhere←buttonwhere-5+size[2][84] ⎕wi "∆where" ((x,2)⍴where)[85] ⎕wi "where" (("fmMortRate" ⎕wi "size") Win∆Resize ⎕wi "∆where")[86] ⎕wi "tooltip" "Save Parameters As ..."[87] ⎕wi "onClick" ("fmSV.mMortality_Rate_SelectFile.mSaveAs"⎕wi "onClick")[88] ⎕wi "caption" "Save As"[89] ⎕wi "∆helpid" 4217[90] ⎕wi "order" .5[91] ⎕wi "visible" ¯1[92] "fmMortRate" ⎕wi "∆audit" 1[93] [94] ⎕wself←"fmMortRate.edmtTABXX1" ⎕wi "New" "Edit"[95] Fieldlist←Fieldlist OVER "fmMortRate.edmtTABXX1"[96] Fieldcontrol←Fieldcontrol OVER "Edit"[97] ⎕wi "∆name" "mtTABXX[1;]"[98] ⎕wi "∆type" "Decr"[99] ⎕wi "∆mandatory" 1[100] ⎕wi "∆valid" ('DS')[101] ⎕wi "∆helpid" 4218[102] ⎕wi "tooltip" "Specify the Table Code of the Select Mortality Table
(Right Click for List, Double Click for Rate Tables Display or '<' or '>' to Scroll through the Rate Tables)"[103] ⎕wi "limit" 5[104] ⎕wi "∆where" (2 2⍴0.25 0 0.12 0)[105] ⎕wi "where" (("fmMortRate" ⎕wi "size") Win∆Resize (2 2⍴0.25 0 0.12 0))[106] ⎕wi "onExit" "⍎(0∊⍴,⎕wres←0 INPUT∆CHECK 'fmMortRate.edmtTABXX1')/'0 0⍴(⊂⎕wi ''name'') Mortality_Rate_Select ''Change'' ' "[107] ⎕wi "onExitError" "Win∆ExitError ⎕warg"[108] ⎕wi "extent" (2+CharSize×1 6)[109] ⎕wi "keys" (60 62)[110] ⎕wi "pointer" ">cur 1001 shell32.dll"[111] ⎕wi "onFocus" "0 0⍴GetDecrList 'List' "[112] ⎕wi "onKeyPress" "(⎕wi 'self') Win∆DecrToggle ⎕wi '∆valid' "[113] ⎕wi "onMouseDown" "(⎕wi 'self') Win∆DecrPopup ⎕wi '∆valid' "[114] ⎕wi "onMouseDouble" "(⎕wi '∆valid') RunDecr 'Form'"[115] ⎕wi "onChange" "(⎕wi 'self') Win∆LabelUpdate (FormName ⎕wi '∆decrdesc') (FormName ⎕wi '∆decrlist') ⋄ 0 0⍴(⊂⎕wi 'name') Mortality_Rate_Select 'Change' "[116] ⎕wi "∆rightlabel" "fmMortRate.lrmtTABXX1"[117] [118] ⎕wself←"fmMortRate.llmtTABXX1" ⎕wi "New" "Label"[119] ⎕wi "scale" 5[120] ⎕wi "style" 2[121] ⎕wi "extent" (↑⎕wi "Draw" ("?text" "Mortality Rates"))[122] ⎕wi "caption" "Mortality Rates"[123] where←4↑,"fmMortRate.edmtTABXX1" ⎕wi "∆where"[124] x←0.5×⍴where←Win∆Calcwhere where-0 ¯3 0,10+¯1↑⎕wi "extent"[125] ⎕wi "∆where" ((x,2)⍴where)[126] ⎕wi "where" (("fmMortRate" ⎕wi "size") Win∆Resize ⎕wi "∆where")[127] [128] ⎕wself←"fmMortRate.lrmtTABXX1" ⎕wi "New" "Label"[129] ⎕wi "scale" 5[130] ⎕wi "extent" (CharSize×¯2↑1,70)[131] ⎕wi "style" 32[132] ⎕wi "caption" " "[133] where←4↑,"fmMortRate.edmtTABXX1" ⎕wi "∆where"[134] x←0.5×⍴where←Win∆Calcwhere where+0,3,0,10+¯1↑"fmMortRate.edmtTABXX1" ⎕wi "extent"[135] ⎕wi "∆where" ((x,2)⍴where)[136] ⎕wi "where" (("fmMortRate" ⎕wi "size") Win∆Resize ⎕wi "∆where")[137] [138] ⎕wself←"fmMortRate.edmtTABXX2" ⎕wi "New" "Edit"[139] Fieldlist←Fieldlist OVER "fmMortRate.edmtTABXX2"[140] Fieldcontrol←Fieldcontrol OVER "Edit"[141] ⎕wi "∆name" "mtTABXX[2;]"[142] ⎕wi "∆type" "CharNum"[143] ⎕wi "∆valid" ('Int' 'Rating')[144] ⎕wi "∆helpid" 4219[145] ⎕wi "tooltip" "Specify the Age Rating of the Mortality Table"[146] ⎕wi "limit" 3[147] ⎕wi "∆where" (2 2⍴0.25 0 0.7 0)[148] ⎕wi "where" (("fmMortRate" ⎕wi "size") Win∆Resize (2 2⍴0.25 0 0.7 0))[149] ⎕wi "∆range" "¯20 20"[150] ⎕wi "onChange" "0 0⍴(⊂⎕wi 'name') Mortality_Rate_Select 'Change' "[151] ⎕wi "onExit" "⍎(0∊⍴,⎕wres←0 INPUT∆CHECK 'fmMortRate.edmtTABXX2')/'0 0⍴(⊂⎕wi ''name'') Mortality_Rate_Select ''Change'' ' "[152] ⎕wi "onExitError" "Win∆ExitError ⎕warg"[153] ⎕wi "onKeyPress" "⎕wres←¯2×~⎕warg∊43 45 8 32 48 49 50 51 52 53 54 55 56 57"[154] ⎕wi "extent" (2+CharSize×1 4)[155] [156] ⎕wself←"fmMortRate.lrmtTABXX2" ⎕wi "New" "Label"[157] ⎕wi "scale" 5[158] ⎕wi "extent" (↑⎕wi "Draw" ("?text" "years"))[159] ⎕wi "caption" "years"[160] where←4↑,"fmMortRate.edmtTABXX2" ⎕wi "∆where"[161] x←0.5×⍴where←Win∆Calcwhere where+0,3,0,10+¯1↑"fmMortRate.edmtTABXX2" ⎕wi "extent"[162] ⎕wi "∆where" ((x,2)⍴where)[163] ⎕wi "where" (("fmMortRate" ⎕wi "size") Win∆Resize ⎕wi "∆where")[164] [165] ⎕wself←"fmMortRate.llmtTABXX2" ⎕wi "New" "Label"[166] ⎕wi "scale" 5[167] ⎕wi "style" 2[168] ⎕wi "extent" (↑⎕wi "Draw" ("?text" "Age Rating"))[169] ⎕wi "caption" "Age Rating"[170] where←4↑,"fmMortRate.edmtTABXX2" ⎕wi "∆where"[171] x←0.5×⍴where←Win∆Calcwhere where-0 ¯3 0,10+¯1↑⎕wi "extent"[172] ⎕wi "∆where" ((x,2)⍴where)[173] ⎕wi "where" (("fmMortRate" ⎕wi "size") Win∆Resize ⎕wi "∆where")[174] [175] ⎕wself←"fmMortRate.edmtTABXX3" ⎕wi "New" "Edit"[176] Fieldlist←Fieldlist OVER "fmMortRate.edmtTABXX3"[177] Fieldcontrol←Fieldcontrol OVER "Edit"[178] ⎕wi "∆name" "mtTABXX[3;]"[179] ⎕wi "∆type" "CharNum"[180] ⎕wi "∆valid" ('Rating')[181] ⎕wi "∆helpid" 4220[182] ⎕wi "tooltip" "Specify the Percentage Rating of the Mortality Table"[183] ⎕wi "limit" 7[184] ⎕wi "∆where" (2 2⍴0.25 0 0.9 0)[185] ⎕wi "where" (("fmMortRate" ⎕wi "size") Win∆Resize (2 2⍴0.25 0 0.9 0))[186] ⎕wi "∆range" "¯99 1000"[187] ⎕wi "onChange" "0 0⍴(⊂⎕wi 'name') Mortality_Rate_Select 'Change' "[188] ⎕wi "onExit" "⍎(0∊⍴,⎕wres←0 INPUT∆CHECK 'fmMortRate.edmtTABXX3')/'0 0⍴(⊂⎕wi ''name'') Mortality_Rate_Select ''Change'' ' "[189] ⎕wi "onExitError" "Win∆ExitError ⎕warg"[190] ⎕wi "onKeyPress" "⎕wres←¯2×~⎕warg∊43 45 46 8 32 48 49 50 51 52 53 54 55 56 57"[191] ⎕wi "extent" (2+CharSize×1 8)[192] [193] ⎕wself←"fmMortRate.lrmtTABXX3" ⎕wi "New" "Label"[194] ⎕wi "scale" 5[195] ⎕wi "extent" (↑⎕wi "Draw" ("?text" "%"))[196] ⎕wi "caption" "%"[197] where←4↑,"fmMortRate.edmtTABXX3" ⎕wi "∆where"[198] x←0.5×⍴where←Win∆Calcwhere where+0,3,0,10+¯1↑"fmMortRate.edmtTABXX3" ⎕wi "extent"[199] ⎕wi "∆where" ((x,2)⍴where)[200] ⎕wi "where" (("fmMortRate" ⎕wi "size") Win∆Resize ⎕wi "∆where")[201] [202] ⎕wself←"fmMortRate.llmtTABXX3" ⎕wi "New" "Label"[203] ⎕wi "scale" 5[204] ⎕wi "style" 2[205] ⎕wi "extent" (↑⎕wi "Draw" ("?text" "% Rating"))[206] ⎕wi "caption" "% Rating"[207] where←4↑,"fmMortRate.edmtTABXX3" ⎕wi "∆where"[208] x←0.5×⍴where←Win∆Calcwhere where-0 ¯3 0,10+¯1↑⎕wi "extent"[209] ⎕wi "∆where" ((x,2)⍴where)[210] ⎕wi "where" (("fmMortRate" ⎕wi "size") Win∆Resize ⎕wi "∆where")[211] [212] ⎕wself←"fmMortRate.edmtORIG" ⎕wi "New" "Edit"[213] Fieldlist←Fieldlist OVER "fmMortRate.edmtORIG"[214] Fieldcontrol←Fieldcontrol OVER "Edit"[215] ⎕wi "∆name" "mtORIG"[216] ⎕wi "∆type" "Num"[217] ⎕wi "∆valid" ('Int' 'Scalar' '+')[218] ⎕wi "∆helpid" 4221[219] ⎕wi "tooltip" "Specify the Origin Year of Mortality Table"[220] ⎕wi "limit" 4[221] ⎕wi "∆where" (2 2⍴0.55 0 0.4 0)[222] ⎕wi "where" (("fmMortRate" ⎕wi "size") Win∆Resize (2 2⍴0.55 0 0.4 0))[223] ⎕wi "∆range" "1980 2100"[224] ⎕wi "onChange" "0 0⍴(⊂⎕wi 'name') Mortality_Rate_Select 'Change' "[225] ⎕wi "onExit" "⍎(0∊⍴,⎕wres←0 INPUT∆CHECK 'fmMortRate.edmtORIG')/'0 0⍴(⊂⎕wi ''name'') Mortality_Rate_Select ''Change'' ' "[226] ⎕wi "onExitError" "Win∆ExitError ⎕warg"[227] ⎕wi "onKeyPress" "⎕wres←¯2×~⎕warg∊8 32 48 49 50 51 52 53 54 55 56 57"[228] ⎕wi "extent" (2+CharSize×1 5)[229] [230] ⎕wself←"fmMortRate.lrmtORIG" ⎕wi "New" "Label"[231] ⎕wi "scale" 5[232] ⎕wi "extent" (↑⎕wi "Draw" ("?text" "CCYY (Blank defaults to the Base Year of the Mortality Improvement Table)"))[233] ⎕wi "caption" "CCYY (Blank defaults to the Base Year of the Mortality Improvement Table)"[234] where←4↑,"fmMortRate.edmtORIG" ⎕wi "∆where"[235] x←0.5×⍴where←Win∆Calcwhere where+0,3,0,10+¯1↑"fmMortRate.edmtORIG" ⎕wi "extent"[236] ⎕wi "∆where" ((x,2)⍴where)[237] ⎕wi "where" (("fmMortRate" ⎕wi "size") Win∆Resize ⎕wi "∆where")[238] [239] ⎕wself←"fmMortRate.llmtORIG" ⎕wi "New" "Label"[240] ⎕wi "scale" 5[241] ⎕wi "style" 2[242] ⎕wi "extent" (↑⎕wi "Draw" ("?text" "Base Year of Mortality Table"))[243] ⎕wi "caption" "Base Year of Mortality Table"[244] where←4↑,"fmMortRate.edmtORIG" ⎕wi "∆where"[245] x←0.5×⍴where←Win∆Calcwhere where-0 ¯3 0,10+¯1↑⎕wi "extent"[246] ⎕wi "∆where" ((x,2)⍴where)[247] ⎕wi "where" (("fmMortRate" ⎕wi "size") Win∆Resize ⎕wi "∆where")[248] [249] ⎕wself←"fmMortRate.lParmDesc" ⎕wi "New" "Label"[250] ⎕wi "scale" 5[251] ⎕wi "extent" (CharSize×¯2↑1,80)[252] ⎕wi "style" 32[253] ⎕wi "caption" " "[254] ⎕wi "∆where" (2 2⍴0.92 0 0.02 0)[255] ⎕wi "where" (("fmMortRate" ⎕wi "size") Win∆Resize (2 2⍴0.92 0 0.02 0))[256] [257] "fmMortRate" ⎕wi "∆multifile" ""[258] "fmMortRate" ⎕wi "∆singlefile" ""[259] "fmMortRate" ⎕wi "∆format" ""[260] "fmMortRate" ⎕wi "∆financial" 0[261] "fmMortRate" ⎕wi "∆relrules" 1[262] "fmMortRate" ⎕wi "∆parm" 0[263] "fmMortRate" ⎕wi "∆decr" 1[264] "fmMortRate" ⎕wi "∆file" 0[265] "fmMortRate" ⎕wi "∆codefile" CodeFile[266] "fmMortRate" ⎕wi "∆inputstype" "ClientFile"[267] "fmMortRate" ⎕wi "∆inputsentry" "Multi"[268] "fmMortRate" ⎕wi "∆savecn" (⍳0)[269] "fmMortRate" ⎕wi "∆savedesc" ""[270] list←list OVER "fmMortRate"[271] "fmMortRate" ⎕wi "∆fieldlist" Fieldlist[272] "fmMortRate" ⎕wi "∆fieldcontrol" Fieldcontrol[273] childlist←"fmSV" ⎕wi "∆childlist"[274] list←(⊃¯1↑childlist) OVER list[275] childlist[⍴childlist]←⊂list[276] "fmSV" ⎕wi "∆childlist" childlist[277] list←,⎕split list[278] 0 0⍴((∨/¨(⊂".mMortality_Rate_Select")⍷¨list)/list) MultiWI "enabled" 1[279] :if 300<fnsize[280]     (fnsize fnsize ".") Win∆ProgressBar "MemberUpdate"[281]     Win∆ProgressBar "Hide"[282] :endif[283] "Init" OpenParameters "Mortality_Rate_Select"[284] "fmMortRate.bnMortality_Rate_SelectHelp" ⎕wi "visible" 1[285] "fmMortRate.bnMortality_Rate_SelectQuit" ⎕wi "visible" 1[286] "fmMortRate.bnMortality_Rate_SelectSave" ⎕wi "visible" 1[287] "fmMortRate.bnMortality_Rate_SelectSaveAs" ⎕wi "visible" 1[288] "#" ⎕wi "focus" "fmMortRate.edmtTABXX1"[289] :if ~0∊⍴,Error←Win∆Initialise "Mortality_Rate_Select"[290]     "Quit" EndModule Module[291]     "fmSV" ⎕wi "pointer" 0[292]     0 0⍴"fmMortRate" ⎕wi "Delete"[293]     :return[294] :endif[295] :if bar_open←commandbar^"Multi"≡"Multi"[296]     bar_open←0×"fmMortRate.mMortality_Rate_SelectFile.m" Win∆CommandBar "SaveAsHelp"[297] :endif[298] "fmMortRate" ⎕wi "Paint"[299] "fmSV" ⎕wi "pointer" 11[300] "fmMortRate" ⎕wi "onWait" "0 0⍴Mortality_Rate_Select 'Wait'"[301] 0 0⍴"fmMortRate" ⎕wi "Wait"[302] 0 0⍴"fmMortRate" ⎕wi "Delete"[303] "fmSV" ⎕wi "pointer" 0 ∇