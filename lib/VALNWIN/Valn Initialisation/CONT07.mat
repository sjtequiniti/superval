 res←contsl ⍵⍵⍵⍵∆CONT contsr;NO;pm                                                ⍝ Contributions Formula of Salary × Contribution Rate depending on                ⍝ Date of Entry (up to 4 Different Periods)                                       ⍝                                                                                 ⍝                                                                                 ⍝ V2.50u RE 1/11/93 Standardised                                                  ⍝ contsl 0th element Maximum Term for Contributions                               ⍝ contsl 1st element Term Indicator 0 for Service, 1 for Membership                                                                                                 ⍝ contsr 0th element - Contribution Rate 1 (prior to Date 1)                      ⍝ contsr 1st element - Contribution Rate 2 (between Date 1 & Date 2)              ⍝ contsr 2nd element - Contribution Rate 3 (between Date 2 & Date 3)              ⍝ contsr 3rd element - Contribution Rate 4 (after Date 3)                         ⍝ contsr 4th, 5th & 6th elements - Dates 1, 2 & 3 (Julian Numbers)                ⍝ contsr 7th element - Entry Indicator 0 for Service, 1 for Membership            ⍝ contsr 8th element Indicator of Company Contributions                                                                                                             ⍝ ⍺AdditCR (either Addit Cont Rate or Field Name) is "global"                                                                                                        NO←+/contsr[4 5 6]≤JUL ¯3↑DJS,contsr[7]/DJF                                       res←NX↑(contsr[NO]+0.01×ZWB ⍺AdditCR)×(-SNX)↓contsSALMP                                                                                                             :if contsl[0]>60-10×uk=1 ⍝ No Limit on Conts Term                                                                                                                   :elseif uk=1 ⍝ UK use term at mid-point of year to determine if any Cont for year    pm←(-NX)↑PSMP,contsl[1]/PMMP                                                      res←(contsl[0]≥pm)×res ⍝ Limit Conts to Term                                                                                                                     :else ⍝ Others use partial contribution in last year                                 pm←(-NX)↑PS,contsl[1]/PM                                                          res←(1⌊0⌈contsl[0]-pm)×res ⍝ Limit Conts to Term                                                                                                                 :endif                                                                                                                                                              :if 1=NX-SNX ⍝ Conts beyond NRA only if Benefit Accrual (Member and MPU only)         res←res×ExactConts×NX↑servind⌈contsr[8]⌈NRA=LRA                               :else                                                                                 res←res×ExactConts×(ENX_1,(LNX-SNX),SNX+1)/1,(servind⌈contsr[8]),0            :endif                                                                           