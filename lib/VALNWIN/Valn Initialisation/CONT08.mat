 res←contsl ⍵⍵⍵⍵∆CONT contsr;sal;pm;limits                                                     ⍝ Contributions Formula of                                                                     ⍝    Salary below Limit 1        × Contribution Rate 1                                         ⍝  + Salary between Limits 1 & 2 × Contribution Rate 2                                         ⍝  + Salary between Limits 2 & 3 × Contribution Rate 3                                         ⍝  + .... etc, if Progressive                                                                  ⍝  or Salary × Current Band Contribution Rate, if Band-related                                 ⍝                                                                                              ⍝ V2.50u RE 1/11/93 Standardised                                                                                                                                                              ⍝ contsl 2D Salary Bands Table (rows of Bands and Columns of Duration - from Base Year)                                                                                                       ⍝ contsr 0th element Band Approach - 0 = Band-Related, 1 = Progressive                         ⍝ contsr 1st element Base Year for Salary Bands Table to Valuation Date ⍝⍝⍝ FIXME allow for AOS⍝ contsr 2nd element Maximum Term for Contributions                                            ⍝ contsr 3rd element Term Indicator 0 for Service, 1 for Membership                            ⍝ contsr 4th element Indicator of Company Contributions                                        ⍝ contsr 5th, 6th, 7th etc elements - Contribution Rate 1, 2, 3 etc                                                                                                                           ⍝ ⍺AdditCR (either Addit Cont Rate or Field Name) is "global"                                                                                                                                  sal←NX↑(-SNX)↓contsSALMP                                                                       limits←NOM×NX↑[1](term+contsr[1])↓[1]contsl                                                                                                                                                   :if contsr[0] ⍝ Band-Related is all at "current" Band Rate                                        res←sal×contsr[5++⌿sal>[1]limits]                                                           :else ⍝ Progressive                                                                               res←+⌿(5↓contsr)×[0]0⌈(sal⌊[1]limits)-0⍪¯1↓[0]limits                                        :endif                                                                                                                                                                                        res←res+sal×0.01×ZWB ⍺AdditCR ⍝ Additional Member Contributions                                                                                                                               :if contsr[2]>60-10×uk=1 ⍝ No Limit on Conts Term                                                                                                                                             :elseif uk=1 ⍝ UK use term at mid-point of year to determine if any Cont for year                 pm←(-NX)↑PSMP,contsr[3]/PMMP                                                                   res←(contsr[2]≥pm)×res ⍝ Limit Conts to Term                                                                                                                                               :else ⍝ Others use partial contribution in last year                                              pm←(-NX)↑PS,contsr[3]/PM                                                                       res←(1⌊0⌈contsr[2]-pm)×res ⍝ Limit Conts to Term                                                                                                                                           :endif                                                                                                                                                                                        :if 1=NX-SNX ⍝ Conts beyond NRA only if Benefit Accrual (Member and MPU only)                      res←res×ExactConts×NX↑servind⌈contsr[4]⌈NRA=LRA                                            :else                                                                                              res←res×ExactConts×(ENX_1,(LNX-SNX),SNX+1)/1,(servind⌈contsr[4]),0                         :endif                                                                                        