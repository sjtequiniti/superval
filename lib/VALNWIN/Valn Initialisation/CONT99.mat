 res←contsl ⍵⍵⍵⍵∆CONT contsr;pm;X                                                 ⍝ Contribution Formula of Salary × Cont Rate on Age at Entry and Duration         ⍝                                                                                 ⍝                                                                                 ⍝                                                                                 ⍝ V2.50u RE 1/11/93 Standardised                                                  ⍝ contsl Matrix of Age and Duartion Related Contribution Rates (%)                                                                                                  ⍝ contsr 0th element Entry Indicator 0 for Service, 1 for Membership              ⍝ contsr 1st element Maximum Term for Contributions                               ⍝ contsr 2nd element Term Indicator 0 for Service, 1 for Membership               ⍝ contsr 3rd element Indicator of Company Contributions                                                                                                             ⍝ ⍺AdditCR (either Addit Cont Rate or Field Name) is "global"                                                                                                        X←⍬⍴49⌊0⌈¯16+X0-pm←⌊0.5+((1↑PS),1↑PM)[contsr[0]]                                  res←((0.01×NX↑pm↓contsl[X;])+0.01×ZWB ⍺AdditCR)×NX↑(-SNX)↓contsSALMP                                                                                                :if contsr[1]>60-10×uk=1 ⍝ No Limit on Conts Term                                                                                                                   :elseif uk=1 ⍝ UK use term at mid-point of year to determine if any Cont for year    pm←(-NX)↑PSMP,contsr[2]/PMMP                                                      res←(contsr[1]≥pm)×res ⍝ Limit Conts to Term                                                                                                                     :else ⍝ Others use partial contribution in last year                                 pm←(-NX)↑PS,contsr[2]/PM                                                          res←(1⌊0⌈contsr[1]-pm)×res ⍝ Limit Conts to Term                                                                                                                 :endif                                                                                                                                                              :if 1=NX-SNX ⍝ Conts beyond NRA only if Benefit Accrual (Member and MPU only)         res←res×ExactConts×NX↑servind⌈contsr[3]⌈NRA=LRA                               :else                                                                                 res←res×ExactConts×(ENX_1,(LNX-SNX),SNX+1)/1,(servind⌈contsr[3]),0            :endif                                                                           