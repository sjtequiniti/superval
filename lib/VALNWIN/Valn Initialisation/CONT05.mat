 res←contsl ⍵⍵⍵⍵∆CONT contsr;pm                                                     ⍝ Conts Formula of Salary × Cont Rate based on Duration from Valn Date              ⍝                                                                                   ⍝                                                                                   ⍝                                                                                   ⍝ V2.50u RE 1/11/93 Standardised                                                    ⍝ contsl Vector of Duration Related Contribution Rates (%)                                                                                                              ⍝ contsr 0th element Maximum Term for Contributions                                 ⍝ contsr 1st element Term Indicator 0 for Service, 1 for Membership                 ⍝ contsr 2nd element Indicator of Company Contributions                                                                                                                 ⍝ ⍺AdditCR (either Addit Cont Rate or Field Name) is "global"                                                                                                            res←(contsl[⍳NX]+0.01×ZWB ⍺AdditCR)×NX↑(-SNX)↓contsSALMP                                                                                                                :if contsr[0]>60-10×uk=1 ⍝ No Limit on Conts Term                                                                                                                       :elseif uk=1 ⍝ UK use term at mid-point of year to determine if any Cont for year      pm←(-NX)↑PSMP,contsr[1]/PMMP                                                        res←(contsr[0]≥pm)×res ⍝ Limit Conts to Term                                                                                                                         :else ⍝ Others use partial contribution in last year                                   pm←(-NX)↑PS,contsr[1]/PM                                                            res←(1⌊0⌈contsr[0]-pm)×res ⍝ Limit Conts to Term                                                                                                                     :endif                                                                                                                                                                  :if 1=NX-SNX ⍝ Conts beyond NRA only if Benefit Accrual (Member and MPU only)           res←res×ExactConts×NX↑servind⌈contsr[2]⌈NRA=LRA                                 :else                                                                                   res←res×ExactConts×(ENX_1,(LNX-SNX),SNX+1)/1,(servind⌈contsr[2]),0              :endif                                                                             